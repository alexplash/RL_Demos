{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.360537092980518, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.437478644458166, "policy_loss": -0.020088375784376618, "vf_loss": 7.454648335392196, "vf_explained_var": 0.010850244760513305, "kl": 0.014593402308791185, "entropy": 5.686888240998791, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 465.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": -100.20991829490413, "episode_reward_min": -119.37345565429641, "episode_reward_mean": -108.25379759398207, "episode_len_mean": 507.42857142857144, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 3552, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-106.69923103574303, -108.32895085933929, -109.88018457645713, -100.79863420576913, -112.48620853136542, -119.37345565429641, -100.20991829490413], "episode_lengths": [1600, 76, 1600, 53, 49, 67, 107]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26681667103743223, "mean_inference_ms": 0.8624962227770219, "mean_action_processing_ms": 0.16918927569405343, "mean_env_wait_ms": 0.34735265257799913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005630084446498326, "StateBufferConnector_ms": 0.004863739013671875, "ViewRequirementAgentConnector_ms": 0.1020533697945731}}, "episode_reward_max": -100.20991829490413, "episode_reward_min": -119.37345565429641, "episode_reward_mean": -108.25379759398207, "episode_len_mean": 507.42857142857144, "episodes_this_iter": 7, "episodes_timesteps_total": 3552, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-106.69923103574303, -108.32895085933929, -109.88018457645713, -100.79863420576913, -112.48620853136542, -119.37345565429641, -100.20991829490413], "episode_lengths": [1600, 76, 1600, 53, 49, 67, 107]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26681667103743223, "mean_inference_ms": 0.8624962227770219, "mean_action_processing_ms": 0.16918927569405343, "mean_env_wait_ms": 0.34735265257799913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005630084446498326, "StateBufferConnector_ms": 0.004863739013671875, "ViewRequirementAgentConnector_ms": 0.1020533697945731}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 366.5712556556768, "num_env_steps_trained_throughput_per_sec": 366.5712556556768, "timesteps_total": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 10911.94, "restore_workers_time_ms": 0.018, "training_step_time_ms": 10911.89, "sample_time_ms": 3330.534, "load_time_ms": 0.914, "load_throughput": 4377045.656, "learn_time_ms": 7571.857, "learn_throughput": 528.272, "synch_weights_time_ms": 7.743}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 7, "training_iteration": 1, "trial_id": "3adab_00000", "date": "2024-04-27_20-56-43", "timestamp": 1714276603, "time_this_iter_s": 10.915866136550903, "time_total_s": 10.915866136550903, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 10.915866136550903, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 36.64375, "ram_util_percent": 66.76875000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.53438239020686, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.4256139331379587, "policy_loss": -0.049635287998144026, "vf_loss": 3.472058474713115, "vf_explained_var": 0.029943688646439582, "kl": 0.01595370737939262, "entropy": 5.705273606700282, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1395.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": -100.20991829490413, "episode_reward_min": -123.26563492036983, "episode_reward_mean": -109.29306228030916, "episode_len_mean": 489.8666666666667, "episode_media": {}, "episodes_this_iter": 8, "episodes_timesteps_total": 7348, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-106.69923103574303, -108.32895085933929, -109.88018457645713, -100.79863420576913, -112.48620853136542, -119.37345565429641, -100.20991829490413, -114.62269220503973, -113.88680945530287, -107.798961677722, -101.73277856792944, -123.26563492036983, -112.11779813104741, -105.74261578084094, -102.45206030851044], "episode_lengths": [1600, 76, 1600, 53, 49, 67, 107, 1600, 152, 56, 72, 136, 1600, 76, 104]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29030720265096904, "mean_inference_ms": 0.9730201954167441, "mean_action_processing_ms": 0.19040507209252092, "mean_env_wait_ms": 0.38252613233866123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006351470947265625, "StateBufferConnector_ms": 0.004558563232421875, "ViewRequirementAgentConnector_ms": 0.11509895324707031}}, "episode_reward_max": -100.20991829490413, "episode_reward_min": -123.26563492036983, "episode_reward_mean": -109.29306228030916, "episode_len_mean": 489.8666666666667, "episodes_this_iter": 8, "episodes_timesteps_total": 7348, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-106.69923103574303, -108.32895085933929, -109.88018457645713, -100.79863420576913, -112.48620853136542, -119.37345565429641, -100.20991829490413, -114.62269220503973, -113.88680945530287, -107.798961677722, -101.73277856792944, -123.26563492036983, -112.11779813104741, -105.74261578084094, -102.45206030851044], "episode_lengths": [1600, 76, 1600, 53, 49, 67, 107, 1600, 152, 56, 72, 136, 1600, 76, 104]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29030720265096904, "mean_inference_ms": 0.9730201954167441, "mean_action_processing_ms": 0.19040507209252092, "mean_env_wait_ms": 0.38252613233866123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006351470947265625, "StateBufferConnector_ms": 0.004558563232421875, "ViewRequirementAgentConnector_ms": 0.11509895324707031}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 363.885001153542, "num_env_steps_trained_throughput_per_sec": 363.885001153542, "timesteps_total": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 10952.216, "restore_workers_time_ms": 0.017, "training_step_time_ms": 10952.169, "sample_time_ms": 4051.291, "load_time_ms": 0.661, "load_throughput": 6046933.141, "learn_time_ms": 6891.634, "learn_throughput": 580.414, "synch_weights_time_ms": 7.909}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 15, "training_iteration": 2, "trial_id": "3adab_00000", "date": "2024-04-27_20-56-54", "timestamp": 1714276614, "time_this_iter_s": 10.997522354125977, "time_total_s": 21.91338849067688, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 21.91338849067688, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 37.2375, "ram_util_percent": 66.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.468440621258111, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.5305217927972716, "policy_loss": -0.021062587045373456, "vf_loss": 3.5487368523033074, "vf_explained_var": 0.072041251197938, "kl": 0.014237699424591863, "entropy": 5.7008740486637235, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2325.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": -99.97136980936973, "episode_reward_min": -235.33028118049674, "episode_reward_mean": -114.2090236603031, "episode_len_mean": 493.04545454545456, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 10847, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-106.69923103574303, -108.32895085933929, -109.88018457645713, -100.79863420576913, -112.48620853136542, -119.37345565429641, -100.20991829490413, -114.62269220503973, -113.88680945530287, -107.798961677722, -101.73277856792944, -123.26563492036983, -112.11779813104741, -105.74261578084094, -102.45206030851044, -99.97136980936973, -109.5457354993249, -101.43931917319509, -119.15313169982781, -104.96544682995851, -235.33028118049674, -102.79730212985787], "episode_lengths": [1600, 76, 1600, 53, 49, 67, 107, 1600, 152, 56, 72, 136, 1600, 76, 104, 1600, 63, 63, 92, 66, 1521, 94]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2957170079566735, "mean_inference_ms": 0.9988064447658598, "mean_action_processing_ms": 0.1951796468552863, "mean_env_wait_ms": 0.390291313839, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0061425295743075285, "StateBufferConnector_ms": 0.004596059972589666, "ViewRequirementAgentConnector_ms": 0.11876279657537286}}, "episode_reward_max": -99.97136980936973, "episode_reward_min": -235.33028118049674, "episode_reward_mean": -114.2090236603031, "episode_len_mean": 493.04545454545456, "episodes_this_iter": 7, "episodes_timesteps_total": 10847, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-106.69923103574303, -108.32895085933929, -109.88018457645713, -100.79863420576913, -112.48620853136542, -119.37345565429641, -100.20991829490413, -114.62269220503973, -113.88680945530287, -107.798961677722, -101.73277856792944, -123.26563492036983, -112.11779813104741, -105.74261578084094, -102.45206030851044, -99.97136980936973, -109.5457354993249, -101.43931917319509, -119.15313169982781, -104.96544682995851, -235.33028118049674, -102.79730212985787], "episode_lengths": [1600, 76, 1600, 53, 49, 67, 107, 1600, 152, 56, 72, 136, 1600, 76, 104, 1600, 63, 63, 92, 66, 1521, 94]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2957170079566735, "mean_inference_ms": 0.9988064447658598, "mean_action_processing_ms": 0.1951796468552863, "mean_env_wait_ms": 0.390291313839, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0061425295743075285, "StateBufferConnector_ms": 0.004596059972589666, "ViewRequirementAgentConnector_ms": 0.11876279657537286}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 397.83039748381503, "num_env_steps_trained_throughput_per_sec": 397.83039748381503, "timesteps_total": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 10652.993, "restore_workers_time_ms": 0.016, "training_step_time_ms": 10652.948, "sample_time_ms": 3991.815, "load_time_ms": 0.557, "load_throughput": 7176906.887, "learn_time_ms": 6652.437, "learn_throughput": 601.283, "synch_weights_time_ms": 7.544}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 22, "training_iteration": 3, "trial_id": "3adab_00000", "date": "2024-04-27_20-57-04", "timestamp": 1714276624, "time_this_iter_s": 10.058626174926758, "time_total_s": 31.972014665603638, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 31.972014665603638, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 35.364285714285714, "ram_util_percent": 65.46428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.501871304550477, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.913450751183379, "policy_loss": -0.024554860503763282, "vf_loss": 2.9346784266573125, "vf_explained_var": 0.0910481499087426, "kl": 0.016635909580815407, "entropy": 5.71362808699249, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3255.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": -99.97136980936973, "episode_reward_min": -235.33028118049674, "episode_reward_mean": -116.05421440097092, "episode_len_mean": 560.1538461538462, "episode_media": {}, "episodes_this_iter": 4, "episodes_timesteps_total": 14564, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-106.69923103574303, -108.32895085933929, -109.88018457645713, -100.79863420576913, -112.48620853136542, -119.37345565429641, -100.20991829490413, -114.62269220503973, -113.88680945530287, -107.798961677722, -101.73277856792944, -123.26563492036983, -112.11779813104741, -105.74261578084094, -102.45206030851044, -99.97136980936973, -109.5457354993249, -101.43931917319509, -119.15313169982781, -104.96544682995851, -235.33028118049674, -102.79730212985787, -103.45773466033185, -139.14156347253856, -108.30934477867929, -153.90241098702637], "episode_lengths": [1600, 76, 1600, 53, 49, 67, 107, 1600, 152, 56, 72, 136, 1600, 76, 104, 1600, 63, 63, 92, 66, 1521, 94, 1600, 201, 1600, 316]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2964620986836286, "mean_inference_ms": 1.0033952157080142, "mean_action_processing_ms": 0.1960015823467986, "mean_env_wait_ms": 0.3917004821789549, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006097096663254958, "StateBufferConnector_ms": 0.0046913440410907455, "ViewRequirementAgentConnector_ms": 0.11799335479736328}}, "episode_reward_max": -99.97136980936973, "episode_reward_min": -235.33028118049674, "episode_reward_mean": -116.05421440097092, "episode_len_mean": 560.1538461538462, "episodes_this_iter": 4, "episodes_timesteps_total": 14564, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-106.69923103574303, -108.32895085933929, -109.88018457645713, -100.79863420576913, -112.48620853136542, -119.37345565429641, -100.20991829490413, -114.62269220503973, -113.88680945530287, -107.798961677722, -101.73277856792944, -123.26563492036983, -112.11779813104741, -105.74261578084094, -102.45206030851044, -99.97136980936973, -109.5457354993249, -101.43931917319509, -119.15313169982781, -104.96544682995851, -235.33028118049674, -102.79730212985787, -103.45773466033185, -139.14156347253856, -108.30934477867929, -153.90241098702637], "episode_lengths": [1600, 76, 1600, 53, 49, 67, 107, 1600, 152, 56, 72, 136, 1600, 76, 104, 1600, 63, 63, 92, 66, 1521, 94, 1600, 201, 1600, 316]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2964620986836286, "mean_inference_ms": 1.0033952157080142, "mean_action_processing_ms": 0.1960015823467986, "mean_env_wait_ms": 0.3917004821789549, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006097096663254958, "StateBufferConnector_ms": 0.0046913440410907455, "ViewRequirementAgentConnector_ms": 0.11799335479736328}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 414.9224747728306, "num_env_steps_trained_throughput_per_sec": 414.9224747728306, "timesteps_total": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 10399.835, "restore_workers_time_ms": 0.016, "training_step_time_ms": 10399.792, "sample_time_ms": 3899.201, "load_time_ms": 0.534, "load_throughput": 7487321.656, "learn_time_ms": 6491.902, "learn_throughput": 616.152, "synch_weights_time_ms": 7.584}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 26, "training_iteration": 4, "trial_id": "3adab_00000", "date": "2024-04-27_20-57-13", "timestamp": 1714276633, "time_this_iter_s": 9.643712043762207, "time_total_s": 41.615726709365845, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 41.615726709365845, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 25.75714285714286, "ram_util_percent": 64.94285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.26657860500197, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4069259371529634, "policy_loss": -0.02130398497258323, "vf_loss": 2.425364323649355, "vf_explained_var": 0.11443792177784827, "kl": 0.014327978095001703, "entropy": 5.671592207365139, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4185.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": -99.97136980936973, "episode_reward_min": -235.33028118049674, "episode_reward_mean": -114.99995130067043, "episode_len_mean": 629.9354838709677, "episode_media": {}, "episodes_this_iter": 5, "episodes_timesteps_total": 19528, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-106.69923103574303, -108.32895085933929, -109.88018457645713, -100.79863420576913, -112.48620853136542, -119.37345565429641, -100.20991829490413, -114.62269220503973, -113.88680945530287, -107.798961677722, -101.73277856792944, -123.26563492036983, -112.11779813104741, -105.74261578084094, -102.45206030851044, -99.97136980936973, -109.5457354993249, -101.43931917319509, -119.15313169982781, -104.96544682995851, -235.33028118049674, -102.79730212985787, -103.45773466033185, -139.14156347253856, -108.30934477867929, -153.90241098702637, -118.41556737606967, -101.16211445601161, -122.4617705558737, -105.40242999805633, -100.1470335095278], "episode_lengths": [1600, 76, 1600, 53, 49, 67, 107, 1600, 152, 56, 72, 136, 1600, 76, 104, 1600, 63, 63, 92, 66, 1521, 94, 1600, 201, 1600, 316, 1600, 82, 1600, 82, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29702237124863495, "mean_inference_ms": 1.0083841915806933, "mean_action_processing_ms": 0.19673830322852898, "mean_env_wait_ms": 0.3930587696488037, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006467296231177545, "StateBufferConnector_ms": 0.004761449752315398, "ViewRequirementAgentConnector_ms": 0.11999299449305381}}, "episode_reward_max": -99.97136980936973, "episode_reward_min": -235.33028118049674, "episode_reward_mean": -114.99995130067043, "episode_len_mean": 629.9354838709677, "episodes_this_iter": 5, "episodes_timesteps_total": 19528, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-106.69923103574303, -108.32895085933929, -109.88018457645713, -100.79863420576913, -112.48620853136542, -119.37345565429641, -100.20991829490413, -114.62269220503973, -113.88680945530287, -107.798961677722, -101.73277856792944, -123.26563492036983, -112.11779813104741, -105.74261578084094, -102.45206030851044, -99.97136980936973, -109.5457354993249, -101.43931917319509, -119.15313169982781, -104.96544682995851, -235.33028118049674, -102.79730212985787, -103.45773466033185, -139.14156347253856, -108.30934477867929, -153.90241098702637, -118.41556737606967, -101.16211445601161, -122.4617705558737, -105.40242999805633, -100.1470335095278], "episode_lengths": [1600, 76, 1600, 53, 49, 67, 107, 1600, 152, 56, 72, 136, 1600, 76, 104, 1600, 63, 63, 92, 66, 1521, 94, 1600, 201, 1600, 316, 1600, 82, 1600, 82, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29702237124863495, "mean_inference_ms": 1.0083841915806933, "mean_action_processing_ms": 0.19673830322852898, "mean_env_wait_ms": 0.3930587696488037, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006467296231177545, "StateBufferConnector_ms": 0.004761449752315398, "ViewRequirementAgentConnector_ms": 0.11999299449305381}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 381.09893552625914, "num_env_steps_trained_throughput_per_sec": 381.09893552625914, "timesteps_total": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 10419.063, "restore_workers_time_ms": 0.015, "training_step_time_ms": 10419.019, "sample_time_ms": 3919.009, "load_time_ms": 0.504, "load_throughput": 7930240.121, "learn_time_ms": 6491.016, "learn_throughput": 616.236, "synch_weights_time_ms": 7.862}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 31, "training_iteration": 5, "trial_id": "3adab_00000", "date": "2024-04-27_20-57-24", "timestamp": 1714276644, "time_this_iter_s": 10.501528024673462, "time_total_s": 52.11725473403931, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 52.11725473403931, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 29.679999999999996, "ram_util_percent": 64.87333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.628581006488492, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5653968907514666, "policy_loss": -0.03150099073686907, "vf_loss": 2.5928580404008907, "vf_explained_var": 0.22146389753587783, "kl": 0.020199218252259107, "entropy": 5.592920630465271, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5115.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": -99.97136980936973, "episode_reward_min": -235.33028118049674, "episode_reward_mean": -114.0417598279486, "episode_len_mean": 581.225, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 23249, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-106.69923103574303, -108.32895085933929, -109.88018457645713, -100.79863420576913, -112.48620853136542, -119.37345565429641, -100.20991829490413, -114.62269220503973, -113.88680945530287, -107.798961677722, -101.73277856792944, -123.26563492036983, -112.11779813104741, -105.74261578084094, -102.45206030851044, -99.97136980936973, -109.5457354993249, -101.43931917319509, -119.15313169982781, -104.96544682995851, -235.33028118049674, -102.79730212985787, -103.45773466033185, -139.14156347253856, -108.30934477867929, -153.90241098702637, -118.41556737606967, -101.16211445601161, -122.4617705558737, -105.40242999805633, -100.1470335095278, -107.79713709658135, -104.30677952509944, -116.11250780874538, -101.90768641310558, -108.66597388942913, -125.12524251694916, -108.88658591585173, -116.69571974788109, -107.1742698835178], "episode_lengths": [1600, 76, 1600, 53, 49, 67, 107, 1600, 152, 56, 72, 136, 1600, 76, 104, 1600, 63, 63, 92, 66, 1521, 94, 1600, 201, 1600, 316, 1600, 82, 1600, 82, 1600, 40, 1600, 1600, 75, 50, 126, 95, 76, 59]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29785976452718316, "mean_inference_ms": 1.0116669617968004, "mean_action_processing_ms": 0.19730464179047427, "mean_env_wait_ms": 0.39429344243810976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006180405616760254, "StateBufferConnector_ms": 0.004651546478271484, "ViewRequirementAgentConnector_ms": 0.11822938919067383}}, "episode_reward_max": -99.97136980936973, "episode_reward_min": -235.33028118049674, "episode_reward_mean": -114.0417598279486, "episode_len_mean": 581.225, "episodes_this_iter": 9, "episodes_timesteps_total": 23249, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-106.69923103574303, -108.32895085933929, -109.88018457645713, -100.79863420576913, -112.48620853136542, -119.37345565429641, -100.20991829490413, -114.62269220503973, -113.88680945530287, -107.798961677722, -101.73277856792944, -123.26563492036983, -112.11779813104741, -105.74261578084094, -102.45206030851044, -99.97136980936973, -109.5457354993249, -101.43931917319509, -119.15313169982781, -104.96544682995851, -235.33028118049674, -102.79730212985787, -103.45773466033185, -139.14156347253856, -108.30934477867929, -153.90241098702637, -118.41556737606967, -101.16211445601161, -122.4617705558737, -105.40242999805633, -100.1470335095278, -107.79713709658135, -104.30677952509944, -116.11250780874538, -101.90768641310558, -108.66597388942913, -125.12524251694916, -108.88658591585173, -116.69571974788109, -107.1742698835178], "episode_lengths": [1600, 76, 1600, 53, 49, 67, 107, 1600, 152, 56, 72, 136, 1600, 76, 104, 1600, 63, 63, 92, 66, 1521, 94, 1600, 201, 1600, 316, 1600, 82, 1600, 82, 1600, 40, 1600, 1600, 75, 50, 126, 95, 76, 59]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29785976452718316, "mean_inference_ms": 1.0116669617968004, "mean_action_processing_ms": 0.19730464179047427, "mean_env_wait_ms": 0.39429344243810976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006180405616760254, "StateBufferConnector_ms": 0.004651546478271484, "ViewRequirementAgentConnector_ms": 0.11822938919067383}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 398.9537307376873, "num_env_steps_trained_throughput_per_sec": 398.9537307376873, "timesteps_total": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 10353.591, "restore_workers_time_ms": 0.016, "training_step_time_ms": 10353.548, "sample_time_ms": 3884.447, "load_time_ms": 0.505, "load_throughput": 7915648.03, "learn_time_ms": 6460.083, "learn_throughput": 619.187, "synch_weights_time_ms": 7.891}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 40, "training_iteration": 6, "trial_id": "3adab_00000", "date": "2024-04-27_20-57-34", "timestamp": 1714276654, "time_this_iter_s": 10.031288146972656, "time_total_s": 62.14854288101196, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 62.14854288101196, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 26.72142857142857, "ram_util_percent": 64.84285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.35947726862405, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.038174060064178, "policy_loss": -0.027973573791083468, "vf_loss": 3.060800728370105, "vf_explained_var": 0.17985333749043045, "kl": 0.017822990724403846, "entropy": 5.595669473114834, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6045.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": -90.93072269391072, "episode_reward_min": -235.33028118049674, "episode_reward_mean": -113.29685020155034, "episode_len_mean": 535.0, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 27285, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-106.69923103574303, -108.32895085933929, -109.88018457645713, -100.79863420576913, -112.48620853136542, -119.37345565429641, -100.20991829490413, -114.62269220503973, -113.88680945530287, -107.798961677722, -101.73277856792944, -123.26563492036983, -112.11779813104741, -105.74261578084094, -102.45206030851044, -99.97136980936973, -109.5457354993249, -101.43931917319509, -119.15313169982781, -104.96544682995851, -235.33028118049674, -102.79730212985787, -103.45773466033185, -139.14156347253856, -108.30934477867929, -153.90241098702637, -118.41556737606967, -101.16211445601161, -122.4617705558737, -105.40242999805633, -100.1470335095278, -107.79713709658135, -104.30677952509944, -116.11250780874538, -101.90768641310558, -108.66597388942913, -125.12524251694916, -108.88658591585173, -116.69571974788109, -107.1742698835178, -99.63495288486214, -118.69715090308897, -130.03023884021053, -104.6548820117712, -116.4082717362071, -99.24241344694668, -98.65514017825015, -90.93072269391072, -136.89249106894437, -118.23056261533003, -103.09214078160127], "episode_lengths": [1600, 76, 1600, 53, 49, 67, 107, 1600, 152, 56, 72, 136, 1600, 76, 104, 1600, 63, 63, 92, 66, 1521, 94, 1600, 201, 1600, 316, 1600, 82, 1600, 82, 1600, 40, 1600, 1600, 75, 50, 126, 95, 76, 59, 1600, 51, 196, 73, 84, 65, 61, 1600, 119, 67, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2983548867053602, "mean_inference_ms": 1.0145676433966677, "mean_action_processing_ms": 0.1976819933982695, "mean_env_wait_ms": 0.39499094115909295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006057234371409696, "StateBufferConnector_ms": 0.0045364978266697305, "ViewRequirementAgentConnector_ms": 0.11582094080307904}}, "episode_reward_max": -90.93072269391072, "episode_reward_min": -235.33028118049674, "episode_reward_mean": -113.29685020155034, "episode_len_mean": 535.0, "episodes_this_iter": 11, "episodes_timesteps_total": 27285, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-106.69923103574303, -108.32895085933929, -109.88018457645713, -100.79863420576913, -112.48620853136542, -119.37345565429641, -100.20991829490413, -114.62269220503973, -113.88680945530287, -107.798961677722, -101.73277856792944, -123.26563492036983, -112.11779813104741, -105.74261578084094, -102.45206030851044, -99.97136980936973, -109.5457354993249, -101.43931917319509, -119.15313169982781, -104.96544682995851, -235.33028118049674, -102.79730212985787, -103.45773466033185, -139.14156347253856, -108.30934477867929, -153.90241098702637, -118.41556737606967, -101.16211445601161, -122.4617705558737, -105.40242999805633, -100.1470335095278, -107.79713709658135, -104.30677952509944, -116.11250780874538, -101.90768641310558, -108.66597388942913, -125.12524251694916, -108.88658591585173, -116.69571974788109, -107.1742698835178, -99.63495288486214, -118.69715090308897, -130.03023884021053, -104.6548820117712, -116.4082717362071, -99.24241344694668, -98.65514017825015, -90.93072269391072, -136.89249106894437, -118.23056261533003, -103.09214078160127], "episode_lengths": [1600, 76, 1600, 53, 49, 67, 107, 1600, 152, 56, 72, 136, 1600, 76, 104, 1600, 63, 63, 92, 66, 1521, 94, 1600, 201, 1600, 316, 1600, 82, 1600, 82, 1600, 40, 1600, 1600, 75, 50, 126, 95, 76, 59, 1600, 51, 196, 73, 84, 65, 61, 1600, 119, 67, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2983548867053602, "mean_inference_ms": 1.0145676433966677, "mean_action_processing_ms": 0.1976819933982695, "mean_env_wait_ms": 0.39499094115909295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006057234371409696, "StateBufferConnector_ms": 0.0045364978266697305, "ViewRequirementAgentConnector_ms": 0.11582094080307904}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 385.59724019171915, "num_env_steps_trained_throughput_per_sec": 385.59724019171915, "timesteps_total": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 10356.439, "restore_workers_time_ms": 0.016, "training_step_time_ms": 10356.397, "sample_time_ms": 3890.256, "load_time_ms": 0.49, "load_throughput": 8163527.874, "learn_time_ms": 6456.994, "learn_throughput": 619.483, "synch_weights_time_ms": 8.041}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 51, "training_iteration": 7, "trial_id": "3adab_00000", "date": "2024-04-27_20-57-44", "timestamp": 1714276664, "time_this_iter_s": 10.378399848937988, "time_total_s": 72.52694272994995, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 72.52694272994995, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 31.413333333333338, "ram_util_percent": 65.25333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.709240517308634, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1478263458592557, "policy_loss": -0.013788802837652546, "vf_loss": 1.1582305459566014, "vf_explained_var": 0.28571205151978357, "kl": 0.011282015065361174, "entropy": 5.328290182031611, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6975.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": -90.93072269391072, "episode_reward_min": -235.33028118049674, "episode_reward_mean": -112.93402355073158, "episode_len_mean": 575.188679245283, "episode_media": {}, "episodes_this_iter": 2, "episodes_timesteps_total": 30485, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-106.69923103574303, -108.32895085933929, -109.88018457645713, -100.79863420576913, -112.48620853136542, -119.37345565429641, -100.20991829490413, -114.62269220503973, -113.88680945530287, -107.798961677722, -101.73277856792944, -123.26563492036983, -112.11779813104741, -105.74261578084094, -102.45206030851044, -99.97136980936973, -109.5457354993249, -101.43931917319509, -119.15313169982781, -104.96544682995851, -235.33028118049674, -102.79730212985787, -103.45773466033185, -139.14156347253856, -108.30934477867929, -153.90241098702637, -118.41556737606967, -101.16211445601161, -122.4617705558737, -105.40242999805633, -100.1470335095278, -107.79713709658135, -104.30677952509944, -116.11250780874538, -101.90768641310558, -108.66597388942913, -125.12524251694916, -108.88658591585173, -116.69571974788109, -107.1742698835178, -99.63495288486214, -118.69715090308897, -130.03023884021053, -104.6548820117712, -116.4082717362071, -99.24241344694668, -98.65514017825015, -90.93072269391072, -136.89249106894437, -118.23056261533003, -103.09214078160127, -100.92204699906085, -106.44184091064581], "episode_lengths": [1600, 76, 1600, 53, 49, 67, 107, 1600, 152, 56, 72, 136, 1600, 76, 104, 1600, 63, 63, 92, 66, 1521, 94, 1600, 201, 1600, 316, 1600, 82, 1600, 82, 1600, 40, 1600, 1600, 75, 50, 126, 95, 76, 59, 1600, 51, 196, 73, 84, 65, 61, 1600, 119, 67, 120, 1600, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2984830222690537, "mean_inference_ms": 1.0150985259915388, "mean_action_processing_ms": 0.1977781487155031, "mean_env_wait_ms": 0.3951900183161225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006045485442539431, "StateBufferConnector_ms": 0.0045371505449403006, "ViewRequirementAgentConnector_ms": 0.11661457565595519}}, "episode_reward_max": -90.93072269391072, "episode_reward_min": -235.33028118049674, "episode_reward_mean": -112.93402355073158, "episode_len_mean": 575.188679245283, "episodes_this_iter": 2, "episodes_timesteps_total": 30485, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-106.69923103574303, -108.32895085933929, -109.88018457645713, -100.79863420576913, -112.48620853136542, -119.37345565429641, -100.20991829490413, -114.62269220503973, -113.88680945530287, -107.798961677722, -101.73277856792944, -123.26563492036983, -112.11779813104741, -105.74261578084094, -102.45206030851044, -99.97136980936973, -109.5457354993249, -101.43931917319509, -119.15313169982781, -104.96544682995851, -235.33028118049674, -102.79730212985787, -103.45773466033185, -139.14156347253856, -108.30934477867929, -153.90241098702637, -118.41556737606967, -101.16211445601161, -122.4617705558737, -105.40242999805633, -100.1470335095278, -107.79713709658135, -104.30677952509944, -116.11250780874538, -101.90768641310558, -108.66597388942913, -125.12524251694916, -108.88658591585173, -116.69571974788109, -107.1742698835178, -99.63495288486214, -118.69715090308897, -130.03023884021053, -104.6548820117712, -116.4082717362071, -99.24241344694668, -98.65514017825015, -90.93072269391072, -136.89249106894437, -118.23056261533003, -103.09214078160127, -100.92204699906085, -106.44184091064581], "episode_lengths": [1600, 76, 1600, 53, 49, 67, 107, 1600, 152, 56, 72, 136, 1600, 76, 104, 1600, 63, 63, 92, 66, 1521, 94, 1600, 201, 1600, 316, 1600, 82, 1600, 82, 1600, 40, 1600, 1600, 75, 50, 126, 95, 76, 59, 1600, 51, 196, 73, 84, 65, 61, 1600, 119, 67, 120, 1600, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2984830222690537, "mean_inference_ms": 1.0150985259915388, "mean_action_processing_ms": 0.1977781487155031, "mean_env_wait_ms": 0.3951900183161225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006045485442539431, "StateBufferConnector_ms": 0.0045371505449403006, "ViewRequirementAgentConnector_ms": 0.11661457565595519}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 391.71020476815175, "num_env_steps_trained_throughput_per_sec": 391.71020476815175, "timesteps_total": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 10338.34, "restore_workers_time_ms": 0.016, "training_step_time_ms": 10338.297, "sample_time_ms": 3906.006, "load_time_ms": 0.471, "load_throughput": 8489956.86, "learn_time_ms": 6423.228, "learn_throughput": 622.74, "synch_weights_time_ms": 7.994}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 53, "training_iteration": 8, "trial_id": "3adab_00000", "date": "2024-04-27_20-57-55", "timestamp": 1714276675, "time_this_iter_s": 10.215170860290527, "time_total_s": 82.74211359024048, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 82.74211359024048, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 28.985714285714284, "ram_util_percent": 64.96428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.902357535977517, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9237593333410871, "policy_loss": -0.017412498338969164, "vf_loss": 0.9381005178776479, "vf_explained_var": 0.43906070474655395, "kl": 0.010237706284574582, "entropy": 5.294672666057464, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7905.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": -90.93072269391072, "episode_reward_min": -235.33028118049674, "episode_reward_mean": -112.54111520136254, "episode_len_mean": 612.4545454545455, "episode_media": {}, "episodes_this_iter": 2, "episodes_timesteps_total": 33685, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-106.69923103574303, -108.32895085933929, -109.88018457645713, -100.79863420576913, -112.48620853136542, -119.37345565429641, -100.20991829490413, -114.62269220503973, -113.88680945530287, -107.798961677722, -101.73277856792944, -123.26563492036983, -112.11779813104741, -105.74261578084094, -102.45206030851044, -99.97136980936973, -109.5457354993249, -101.43931917319509, -119.15313169982781, -104.96544682995851, -235.33028118049674, -102.79730212985787, -103.45773466033185, -139.14156347253856, -108.30934477867929, -153.90241098702637, -118.41556737606967, -101.16211445601161, -122.4617705558737, -105.40242999805633, -100.1470335095278, -107.79713709658135, -104.30677952509944, -116.11250780874538, -101.90768641310558, -108.66597388942913, -125.12524251694916, -108.88658591585173, -116.69571974788109, -107.1742698835178, -99.63495288486214, -118.69715090308897, -130.03023884021053, -104.6548820117712, -116.4082717362071, -99.24241344694668, -98.65514017825015, -90.93072269391072, -136.89249106894437, -118.23056261533003, -103.09214078160127, -100.92204699906085, -106.44184091064581, -100.3721384089502, -103.88594947721595], "episode_lengths": [1600, 76, 1600, 53, 49, 67, 107, 1600, 152, 56, 72, 136, 1600, 76, 104, 1600, 63, 63, 92, 66, 1521, 94, 1600, 201, 1600, 316, 1600, 82, 1600, 82, 1600, 40, 1600, 1600, 75, 50, 126, 95, 76, 59, 1600, 51, 196, 73, 84, 65, 61, 1600, 119, 67, 120, 1600, 1600, 1600, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29852266183019255, "mean_inference_ms": 1.0153196714178017, "mean_action_processing_ms": 0.1978233641960733, "mean_env_wait_ms": 0.39530666287500454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006106983531605114, "StateBufferConnector_ms": 0.0045282190496271305, "ViewRequirementAgentConnector_ms": 0.1165272972800515}}, "episode_reward_max": -90.93072269391072, "episode_reward_min": -235.33028118049674, "episode_reward_mean": -112.54111520136254, "episode_len_mean": 612.4545454545455, "episodes_this_iter": 2, "episodes_timesteps_total": 33685, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-106.69923103574303, -108.32895085933929, -109.88018457645713, -100.79863420576913, -112.48620853136542, -119.37345565429641, -100.20991829490413, -114.62269220503973, -113.88680945530287, -107.798961677722, -101.73277856792944, -123.26563492036983, -112.11779813104741, -105.74261578084094, -102.45206030851044, -99.97136980936973, -109.5457354993249, -101.43931917319509, -119.15313169982781, -104.96544682995851, -235.33028118049674, -102.79730212985787, -103.45773466033185, -139.14156347253856, -108.30934477867929, -153.90241098702637, -118.41556737606967, -101.16211445601161, -122.4617705558737, -105.40242999805633, -100.1470335095278, -107.79713709658135, -104.30677952509944, -116.11250780874538, -101.90768641310558, -108.66597388942913, -125.12524251694916, -108.88658591585173, -116.69571974788109, -107.1742698835178, -99.63495288486214, -118.69715090308897, -130.03023884021053, -104.6548820117712, -116.4082717362071, -99.24241344694668, -98.65514017825015, -90.93072269391072, -136.89249106894437, -118.23056261533003, -103.09214078160127, -100.92204699906085, -106.44184091064581, -100.3721384089502, -103.88594947721595], "episode_lengths": [1600, 76, 1600, 53, 49, 67, 107, 1600, 152, 56, 72, 136, 1600, 76, 104, 1600, 63, 63, 92, 66, 1521, 94, 1600, 201, 1600, 316, 1600, 82, 1600, 82, 1600, 40, 1600, 1600, 75, 50, 126, 95, 76, 59, 1600, 51, 196, 73, 84, 65, 61, 1600, 119, 67, 120, 1600, 1600, 1600, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29852266183019255, "mean_inference_ms": 1.0153196714178017, "mean_action_processing_ms": 0.1978233641960733, "mean_env_wait_ms": 0.39530666287500454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006106983531605114, "StateBufferConnector_ms": 0.0045282190496271305, "ViewRequirementAgentConnector_ms": 0.1165272972800515}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 381.32777590352686, "num_env_steps_trained_throughput_per_sec": 381.32777590352686, "timesteps_total": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 10355.154, "restore_workers_time_ms": 0.016, "training_step_time_ms": 10355.112, "sample_time_ms": 3879.986, "load_time_ms": 0.492, "load_throughput": 8128058.567, "learn_time_ms": 6466.045, "learn_throughput": 618.616, "synch_weights_time_ms": 7.978}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 55, "training_iteration": 9, "trial_id": "3adab_00000", "date": "2024-04-27_20-58-05", "timestamp": 1714276685, "time_this_iter_s": 10.49584698677063, "time_total_s": 93.23796057701111, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 93.23796057701111, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 28.766666666666666, "ram_util_percent": 64.88666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.571793438798638, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1798882318004686, "policy_loss": -0.02687252766342573, "vf_loss": 1.2036955667519442, "vf_explained_var": 0.3539152865127851, "kl": 0.010217326187070776, "entropy": 5.271508518342049, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8835.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": -90.5452398339198, "episode_reward_min": -235.33028118049674, "episode_reward_mean": -111.94847297836608, "episode_len_mean": 637.1551724137931, "episode_media": {}, "episodes_this_iter": 3, "episodes_timesteps_total": 36955, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-106.69923103574303, -108.32895085933929, -109.88018457645713, -100.79863420576913, -112.48620853136542, -119.37345565429641, -100.20991829490413, -114.62269220503973, -113.88680945530287, -107.798961677722, -101.73277856792944, -123.26563492036983, -112.11779813104741, -105.74261578084094, -102.45206030851044, -99.97136980936973, -109.5457354993249, -101.43931917319509, -119.15313169982781, -104.96544682995851, -235.33028118049674, -102.79730212985787, -103.45773466033185, -139.14156347253856, -108.30934477867929, -153.90241098702637, -118.41556737606967, -101.16211445601161, -122.4617705558737, -105.40242999805633, -100.1470335095278, -107.79713709658135, -104.30677952509944, -116.11250780874538, -101.90768641310558, -108.66597388942913, -125.12524251694916, -108.88658591585173, -116.69571974788109, -107.1742698835178, -99.63495288486214, -118.69715090308897, -130.03023884021053, -104.6548820117712, -116.4082717362071, -99.24241344694668, -98.65514017825015, -90.93072269391072, -136.89249106894437, -118.23056261533003, -103.09214078160127, -100.92204699906085, -106.44184091064581, -100.3721384089502, -103.88594947721595, -90.5452398339198, -93.63170284782423, -119.07315398854949], "episode_lengths": [1600, 76, 1600, 53, 49, 67, 107, 1600, 152, 56, 72, 136, 1600, 76, 104, 1600, 63, 63, 92, 66, 1521, 94, 1600, 201, 1600, 316, 1600, 82, 1600, 82, 1600, 40, 1600, 1600, 75, 50, 126, 95, 76, 59, 1600, 51, 196, 73, 84, 65, 61, 1600, 119, 67, 120, 1600, 1600, 1600, 1600, 1600, 1600, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29872149443034657, "mean_inference_ms": 1.0159085312973233, "mean_action_processing_ms": 0.1979470896767165, "mean_env_wait_ms": 0.3956110417638399, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0061585985381027745, "StateBufferConnector_ms": 0.004616688037740773, "ViewRequirementAgentConnector_ms": 0.11848827888225687}}, "episode_reward_max": -90.5452398339198, "episode_reward_min": -235.33028118049674, "episode_reward_mean": -111.94847297836608, "episode_len_mean": 637.1551724137931, "episodes_this_iter": 3, "episodes_timesteps_total": 36955, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-106.69923103574303, -108.32895085933929, -109.88018457645713, -100.79863420576913, -112.48620853136542, -119.37345565429641, -100.20991829490413, -114.62269220503973, -113.88680945530287, -107.798961677722, -101.73277856792944, -123.26563492036983, -112.11779813104741, -105.74261578084094, -102.45206030851044, -99.97136980936973, -109.5457354993249, -101.43931917319509, -119.15313169982781, -104.96544682995851, -235.33028118049674, -102.79730212985787, -103.45773466033185, -139.14156347253856, -108.30934477867929, -153.90241098702637, -118.41556737606967, -101.16211445601161, -122.4617705558737, -105.40242999805633, -100.1470335095278, -107.79713709658135, -104.30677952509944, -116.11250780874538, -101.90768641310558, -108.66597388942913, -125.12524251694916, -108.88658591585173, -116.69571974788109, -107.1742698835178, -99.63495288486214, -118.69715090308897, -130.03023884021053, -104.6548820117712, -116.4082717362071, -99.24241344694668, -98.65514017825015, -90.93072269391072, -136.89249106894437, -118.23056261533003, -103.09214078160127, -100.92204699906085, -106.44184091064581, -100.3721384089502, -103.88594947721595, -90.5452398339198, -93.63170284782423, -119.07315398854949], "episode_lengths": [1600, 76, 1600, 53, 49, 67, 107, 1600, 152, 56, 72, 136, 1600, 76, 104, 1600, 63, 63, 92, 66, 1521, 94, 1600, 201, 1600, 316, 1600, 82, 1600, 82, 1600, 40, 1600, 1600, 75, 50, 126, 95, 76, 59, 1600, 51, 196, 73, 84, 65, 61, 1600, 119, 67, 120, 1600, 1600, 1600, 1600, 1600, 1600, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29872149443034657, "mean_inference_ms": 1.0159085312973233, "mean_action_processing_ms": 0.1979470896767165, "mean_env_wait_ms": 0.3956110417638399, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0061585985381027745, "StateBufferConnector_ms": 0.004616688037740773, "ViewRequirementAgentConnector_ms": 0.11848827888225687}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 382.811346120274, "num_env_steps_trained_throughput_per_sec": 382.811346120274, "timesteps_total": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 10364.541, "restore_workers_time_ms": 0.015, "training_step_time_ms": 10364.5, "sample_time_ms": 3903.512, "load_time_ms": 0.487, "load_throughput": 8210039.638, "learn_time_ms": 6451.99, "learn_throughput": 619.964, "synch_weights_time_ms": 7.902}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 58, "training_iteration": 10, "trial_id": "3adab_00000", "date": "2024-04-27_20-58-16", "timestamp": 1714276696, "time_this_iter_s": 10.453534126281738, "time_total_s": 103.69149470329285, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 103.69149470329285, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 30.78666666666667, "ram_util_percent": 65.08}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.791260756600288, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.7281786792808944, "policy_loss": -0.029498009784247287, "vf_loss": 3.751280791056092, "vf_explained_var": 0.2231437195372838, "kl": 0.02131969625908504, "entropy": 6.312194768331384, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9765.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "sampler_results": {"episode_reward_max": -72.95007590135621, "episode_reward_min": -235.33028118049674, "episode_reward_mean": -110.77870618468498, "episode_len_mean": 571.9066666666666, "episode_media": {}, "episodes_this_iter": 17, "episodes_timesteps_total": 42893, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-106.69923103574303, -108.32895085933929, -109.88018457645713, -100.79863420576913, -112.48620853136542, -119.37345565429641, -100.20991829490413, -114.62269220503973, -113.88680945530287, -107.798961677722, -101.73277856792944, -123.26563492036983, -112.11779813104741, -105.74261578084094, -102.45206030851044, -99.97136980936973, -109.5457354993249, -101.43931917319509, -119.15313169982781, -104.96544682995851, -235.33028118049674, -102.79730212985787, -103.45773466033185, -139.14156347253856, -108.30934477867929, -153.90241098702637, -118.41556737606967, -101.16211445601161, -122.4617705558737, -105.40242999805633, -100.1470335095278, -107.79713709658135, -104.30677952509944, -116.11250780874538, -101.90768641310558, -108.66597388942913, -125.12524251694916, -108.88658591585173, -116.69571974788109, -107.1742698835178, -99.63495288486214, -118.69715090308897, -130.03023884021053, -104.6548820117712, -116.4082717362071, -99.24241344694668, -98.65514017825015, -90.93072269391072, -136.89249106894437, -118.23056261533003, -103.09214078160127, -100.92204699906085, -106.44184091064581, -100.3721384089502, -103.88594947721595, -90.5452398339198, -93.63170284782423, -119.07315398854949, -89.7958205201688, -117.77096657386484, -110.35086590666324, -110.074788587749, -98.94205488882463, -104.82640339145436, -99.52744296496112, -103.51996069358661, -107.09019411591565, -104.10792801132301, -119.46049343325446, -98.7459925398839, -72.95007590135621, -134.7712770838048, -127.66224715956176, -104.9857301557685, -110.80928917799952], "episode_lengths": [1600, 76, 1600, 53, 49, 67, 107, 1600, 152, 56, 72, 136, 1600, 76, 104, 1600, 63, 63, 92, 66, 1521, 94, 1600, 201, 1600, 316, 1600, 82, 1600, 82, 1600, 40, 1600, 1600, 75, 50, 126, 95, 76, 59, 1600, 51, 196, 73, 84, 65, 61, 1600, 119, 67, 120, 1600, 1600, 1600, 1600, 1600, 1600, 70, 1600, 63, 90, 102, 92, 69, 86, 67, 39, 94, 58, 83, 1600, 1600, 115, 114, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3007926585647592, "mean_inference_ms": 1.0233831705297203, "mean_action_processing_ms": 0.19950447810464045, "mean_env_wait_ms": 0.3980571722527532, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006364186604817708, "StateBufferConnector_ms": 0.004728635152180989, "ViewRequirementAgentConnector_ms": 0.12537225087483725}}, "episode_reward_max": -72.95007590135621, "episode_reward_min": -235.33028118049674, "episode_reward_mean": -110.77870618468498, "episode_len_mean": 571.9066666666666, "episodes_this_iter": 17, "episodes_timesteps_total": 42893, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-106.69923103574303, -108.32895085933929, -109.88018457645713, -100.79863420576913, -112.48620853136542, -119.37345565429641, -100.20991829490413, -114.62269220503973, -113.88680945530287, -107.798961677722, -101.73277856792944, -123.26563492036983, -112.11779813104741, -105.74261578084094, -102.45206030851044, -99.97136980936973, -109.5457354993249, -101.43931917319509, -119.15313169982781, -104.96544682995851, -235.33028118049674, -102.79730212985787, -103.45773466033185, -139.14156347253856, -108.30934477867929, -153.90241098702637, -118.41556737606967, -101.16211445601161, -122.4617705558737, -105.40242999805633, -100.1470335095278, -107.79713709658135, -104.30677952509944, -116.11250780874538, -101.90768641310558, -108.66597388942913, -125.12524251694916, -108.88658591585173, -116.69571974788109, -107.1742698835178, -99.63495288486214, -118.69715090308897, -130.03023884021053, -104.6548820117712, -116.4082717362071, -99.24241344694668, -98.65514017825015, -90.93072269391072, -136.89249106894437, -118.23056261533003, -103.09214078160127, -100.92204699906085, -106.44184091064581, -100.3721384089502, -103.88594947721595, -90.5452398339198, -93.63170284782423, -119.07315398854949, -89.7958205201688, -117.77096657386484, -110.35086590666324, -110.074788587749, -98.94205488882463, -104.82640339145436, -99.52744296496112, -103.51996069358661, -107.09019411591565, -104.10792801132301, -119.46049343325446, -98.7459925398839, -72.95007590135621, -134.7712770838048, -127.66224715956176, -104.9857301557685, -110.80928917799952], "episode_lengths": [1600, 76, 1600, 53, 49, 67, 107, 1600, 152, 56, 72, 136, 1600, 76, 104, 1600, 63, 63, 92, 66, 1521, 94, 1600, 201, 1600, 316, 1600, 82, 1600, 82, 1600, 40, 1600, 1600, 75, 50, 126, 95, 76, 59, 1600, 51, 196, 73, 84, 65, 61, 1600, 119, 67, 120, 1600, 1600, 1600, 1600, 1600, 1600, 70, 1600, 63, 90, 102, 92, 69, 86, 67, 39, 94, 58, 83, 1600, 1600, 115, 114, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3007926585647592, "mean_inference_ms": 1.0233831705297203, "mean_action_processing_ms": 0.19950447810464045, "mean_env_wait_ms": 0.3980571722527532, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006364186604817708, "StateBufferConnector_ms": 0.004728635152180989, "ViewRequirementAgentConnector_ms": 0.12537225087483725}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 356.61585960437344, "num_env_steps_trained_throughput_per_sec": 356.61585960437344, "timesteps_total": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 10395.003, "restore_workers_time_ms": 0.015, "training_step_time_ms": 10394.963, "sample_time_ms": 4045.356, "load_time_ms": 0.428, "load_throughput": 9349763.709, "learn_time_ms": 6340.615, "learn_throughput": 630.854, "synch_weights_time_ms": 7.979}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "episodes_total": 75, "training_iteration": 11, "trial_id": "3adab_00000", "date": "2024-04-27_20-58-27", "timestamp": 1714276707, "time_this_iter_s": 11.221182823181152, "time_total_s": 114.912677526474, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 114.912677526474, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 33.325, "ram_util_percent": 65.475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.138847744272601, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3203342502706394, "policy_loss": -0.029977543331602567, "vf_loss": 1.3455970951946832, "vf_explained_var": 0.3492388461866686, "kl": 0.01047708886138527, "entropy": 5.313123585588189, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10695.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": -72.95007590135621, "episode_reward_min": -235.33028118049674, "episode_reward_mean": -109.99946656129369, "episode_len_mean": 579.1625, "episode_media": {}, "episodes_this_iter": 5, "episodes_timesteps_total": 46333, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-106.69923103574303, -108.32895085933929, -109.88018457645713, -100.79863420576913, -112.48620853136542, -119.37345565429641, -100.20991829490413, -114.62269220503973, -113.88680945530287, -107.798961677722, -101.73277856792944, -123.26563492036983, -112.11779813104741, -105.74261578084094, -102.45206030851044, -99.97136980936973, -109.5457354993249, -101.43931917319509, -119.15313169982781, -104.96544682995851, -235.33028118049674, -102.79730212985787, -103.45773466033185, -139.14156347253856, -108.30934477867929, -153.90241098702637, -118.41556737606967, -101.16211445601161, -122.4617705558737, -105.40242999805633, -100.1470335095278, -107.79713709658135, -104.30677952509944, -116.11250780874538, -101.90768641310558, -108.66597388942913, -125.12524251694916, -108.88658591585173, -116.69571974788109, -107.1742698835178, -99.63495288486214, -118.69715090308897, -130.03023884021053, -104.6548820117712, -116.4082717362071, -99.24241344694668, -98.65514017825015, -90.93072269391072, -136.89249106894437, -118.23056261533003, -103.09214078160127, -100.92204699906085, -106.44184091064581, -100.3721384089502, -103.88594947721595, -90.5452398339198, -93.63170284782423, -119.07315398854949, -89.7958205201688, -117.77096657386484, -110.35086590666324, -110.074788587749, -98.94205488882463, -104.82640339145436, -99.52744296496112, -103.51996069358661, -107.09019411591565, -104.10792801132301, -119.46049343325446, -98.7459925398839, -72.95007590135621, -134.7712770838048, -127.66224715956176, -104.9857301557685, -110.80928917799952, -87.3538787528114, -104.85344151977573, -99.76325685500974, -79.88006541617705, -119.70371850834601], "episode_lengths": [1600, 76, 1600, 53, 49, 67, 107, 1600, 152, 56, 72, 136, 1600, 76, 104, 1600, 63, 63, 92, 66, 1521, 94, 1600, 201, 1600, 316, 1600, 82, 1600, 82, 1600, 40, 1600, 1600, 75, 50, 126, 95, 76, 59, 1600, 51, 196, 73, 84, 65, 61, 1600, 119, 67, 120, 1600, 1600, 1600, 1600, 1600, 1600, 70, 1600, 63, 90, 102, 92, 69, 86, 67, 39, 94, 58, 83, 1600, 1600, 115, 114, 66, 1600, 78, 77, 1600, 85]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30109177447035274, "mean_inference_ms": 1.0243865930339353, "mean_action_processing_ms": 0.1997379907334821, "mean_env_wait_ms": 0.39845642085194505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006406903266906738, "StateBufferConnector_ms": 0.004842579364776611, "ViewRequirementAgentConnector_ms": 0.12518852949142456}}, "episode_reward_max": -72.95007590135621, "episode_reward_min": -235.33028118049674, "episode_reward_mean": -109.99946656129369, "episode_len_mean": 579.1625, "episodes_this_iter": 5, "episodes_timesteps_total": 46333, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-106.69923103574303, -108.32895085933929, -109.88018457645713, -100.79863420576913, -112.48620853136542, -119.37345565429641, -100.20991829490413, -114.62269220503973, -113.88680945530287, -107.798961677722, -101.73277856792944, -123.26563492036983, -112.11779813104741, -105.74261578084094, -102.45206030851044, -99.97136980936973, -109.5457354993249, -101.43931917319509, -119.15313169982781, -104.96544682995851, -235.33028118049674, -102.79730212985787, -103.45773466033185, -139.14156347253856, -108.30934477867929, -153.90241098702637, -118.41556737606967, -101.16211445601161, -122.4617705558737, -105.40242999805633, -100.1470335095278, -107.79713709658135, -104.30677952509944, -116.11250780874538, -101.90768641310558, -108.66597388942913, -125.12524251694916, -108.88658591585173, -116.69571974788109, -107.1742698835178, -99.63495288486214, -118.69715090308897, -130.03023884021053, -104.6548820117712, -116.4082717362071, -99.24241344694668, -98.65514017825015, -90.93072269391072, -136.89249106894437, -118.23056261533003, -103.09214078160127, -100.92204699906085, -106.44184091064581, -100.3721384089502, -103.88594947721595, -90.5452398339198, -93.63170284782423, -119.07315398854949, -89.7958205201688, -117.77096657386484, -110.35086590666324, -110.074788587749, -98.94205488882463, -104.82640339145436, -99.52744296496112, -103.51996069358661, -107.09019411591565, -104.10792801132301, -119.46049343325446, -98.7459925398839, -72.95007590135621, -134.7712770838048, -127.66224715956176, -104.9857301557685, -110.80928917799952, -87.3538787528114, -104.85344151977573, -99.76325685500974, -79.88006541617705, -119.70371850834601], "episode_lengths": [1600, 76, 1600, 53, 49, 67, 107, 1600, 152, 56, 72, 136, 1600, 76, 104, 1600, 63, 63, 92, 66, 1521, 94, 1600, 201, 1600, 316, 1600, 82, 1600, 82, 1600, 40, 1600, 1600, 75, 50, 126, 95, 76, 59, 1600, 51, 196, 73, 84, 65, 61, 1600, 119, 67, 120, 1600, 1600, 1600, 1600, 1600, 1600, 70, 1600, 63, 90, 102, 92, 69, 86, 67, 39, 94, 58, 83, 1600, 1600, 115, 114, 66, 1600, 78, 77, 1600, 85]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30109177447035274, "mean_inference_ms": 1.0243865930339353, "mean_action_processing_ms": 0.1997379907334821, "mean_env_wait_ms": 0.39845642085194505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006406903266906738, "StateBufferConnector_ms": 0.004842579364776611, "ViewRequirementAgentConnector_ms": 0.12518852949142456}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 413.9087741708066, "num_env_steps_trained_throughput_per_sec": 413.9087741708066, "timesteps_total": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 10262.151, "restore_workers_time_ms": 0.016, "training_step_time_ms": 10262.11, "sample_time_ms": 3927.82, "load_time_ms": 0.421, "load_throughput": 9499046.541, "learn_time_ms": 6325.325, "learn_throughput": 632.379, "synch_weights_time_ms": 7.962}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 80, "training_iteration": 12, "trial_id": "3adab_00000", "date": "2024-04-27_20-58-37", "timestamp": 1714276717, "time_this_iter_s": 9.669456958770752, "time_total_s": 124.58213448524475, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 124.58213448524475, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 24.12142857142857, "ram_util_percent": 64.98571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.076376765902324, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7588308403377361, "policy_loss": -0.024807557125196552, "vf_loss": 0.7809313838840812, "vf_explained_var": 0.36667088462460423, "kl": 0.006015589932136349, "entropy": 5.229648403454853, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11625.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "sampler_results": {"episode_reward_max": -72.95007590135621, "episode_reward_min": -235.33028118049674, "episode_reward_mean": -109.54249822503378, "episode_len_mean": 597.6024096385543, "episode_media": {}, "episodes_this_iter": 3, "episodes_timesteps_total": 49601, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-106.69923103574303, -108.32895085933929, -109.88018457645713, -100.79863420576913, -112.48620853136542, -119.37345565429641, -100.20991829490413, -114.62269220503973, -113.88680945530287, -107.798961677722, -101.73277856792944, -123.26563492036983, -112.11779813104741, -105.74261578084094, -102.45206030851044, -99.97136980936973, -109.5457354993249, -101.43931917319509, -119.15313169982781, -104.96544682995851, -235.33028118049674, -102.79730212985787, -103.45773466033185, -139.14156347253856, -108.30934477867929, -153.90241098702637, -118.41556737606967, -101.16211445601161, -122.4617705558737, -105.40242999805633, -100.1470335095278, -107.79713709658135, -104.30677952509944, -116.11250780874538, -101.90768641310558, -108.66597388942913, -125.12524251694916, -108.88658591585173, -116.69571974788109, -107.1742698835178, -99.63495288486214, -118.69715090308897, -130.03023884021053, -104.6548820117712, -116.4082717362071, -99.24241344694668, -98.65514017825015, -90.93072269391072, -136.89249106894437, -118.23056261533003, -103.09214078160127, -100.92204699906085, -106.44184091064581, -100.3721384089502, -103.88594947721595, -90.5452398339198, -93.63170284782423, -119.07315398854949, -89.7958205201688, -117.77096657386484, -110.35086590666324, -110.074788587749, -98.94205488882463, -104.82640339145436, -99.52744296496112, -103.51996069358661, -107.09019411591565, -104.10792801132301, -119.46049343325446, -98.7459925398839, -72.95007590135621, -134.7712770838048, -127.66224715956176, -104.9857301557685, -110.80928917799952, -87.3538787528114, -104.85344151977573, -99.76325685500974, -79.88006541617705, -119.70371850834601, -87.75503661708159, -120.62659280303244, -83.6883983541963], "episode_lengths": [1600, 76, 1600, 53, 49, 67, 107, 1600, 152, 56, 72, 136, 1600, 76, 104, 1600, 63, 63, 92, 66, 1521, 94, 1600, 201, 1600, 316, 1600, 82, 1600, 82, 1600, 40, 1600, 1600, 75, 50, 126, 95, 76, 59, 1600, 51, 196, 73, 84, 65, 61, 1600, 119, 67, 120, 1600, 1600, 1600, 1600, 1600, 1600, 70, 1600, 63, 90, 102, 92, 69, 86, 67, 39, 94, 58, 83, 1600, 1600, 115, 114, 66, 1600, 78, 77, 1600, 85, 1600, 68, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3014742158129766, "mean_inference_ms": 1.0257443572717913, "mean_action_processing_ms": 0.19999989718472969, "mean_env_wait_ms": 0.3989412683887856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006409151008330196, "StateBufferConnector_ms": 0.004857419485069183, "ViewRequirementAgentConnector_ms": 0.12720090797148556}}, "episode_reward_max": -72.95007590135621, "episode_reward_min": -235.33028118049674, "episode_reward_mean": -109.54249822503378, "episode_len_mean": 597.6024096385543, "episodes_this_iter": 3, "episodes_timesteps_total": 49601, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-106.69923103574303, -108.32895085933929, -109.88018457645713, -100.79863420576913, -112.48620853136542, -119.37345565429641, -100.20991829490413, -114.62269220503973, -113.88680945530287, -107.798961677722, -101.73277856792944, -123.26563492036983, -112.11779813104741, -105.74261578084094, -102.45206030851044, -99.97136980936973, -109.5457354993249, -101.43931917319509, -119.15313169982781, -104.96544682995851, -235.33028118049674, -102.79730212985787, -103.45773466033185, -139.14156347253856, -108.30934477867929, -153.90241098702637, -118.41556737606967, -101.16211445601161, -122.4617705558737, -105.40242999805633, -100.1470335095278, -107.79713709658135, -104.30677952509944, -116.11250780874538, -101.90768641310558, -108.66597388942913, -125.12524251694916, -108.88658591585173, -116.69571974788109, -107.1742698835178, -99.63495288486214, -118.69715090308897, -130.03023884021053, -104.6548820117712, -116.4082717362071, -99.24241344694668, -98.65514017825015, -90.93072269391072, -136.89249106894437, -118.23056261533003, -103.09214078160127, -100.92204699906085, -106.44184091064581, -100.3721384089502, -103.88594947721595, -90.5452398339198, -93.63170284782423, -119.07315398854949, -89.7958205201688, -117.77096657386484, -110.35086590666324, -110.074788587749, -98.94205488882463, -104.82640339145436, -99.52744296496112, -103.51996069358661, -107.09019411591565, -104.10792801132301, -119.46049343325446, -98.7459925398839, -72.95007590135621, -134.7712770838048, -127.66224715956176, -104.9857301557685, -110.80928917799952, -87.3538787528114, -104.85344151977573, -99.76325685500974, -79.88006541617705, -119.70371850834601, -87.75503661708159, -120.62659280303244, -83.6883983541963], "episode_lengths": [1600, 76, 1600, 53, 49, 67, 107, 1600, 152, 56, 72, 136, 1600, 76, 104, 1600, 63, 63, 92, 66, 1521, 94, 1600, 201, 1600, 316, 1600, 82, 1600, 82, 1600, 40, 1600, 1600, 75, 50, 126, 95, 76, 59, 1600, 51, 196, 73, 84, 65, 61, 1600, 119, 67, 120, 1600, 1600, 1600, 1600, 1600, 1600, 70, 1600, 63, 90, 102, 92, 69, 86, 67, 39, 94, 58, 83, 1600, 1600, 115, 114, 66, 1600, 78, 77, 1600, 85, 1600, 68, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3014742158129766, "mean_inference_ms": 1.0257443572717913, "mean_action_processing_ms": 0.19999989718472969, "mean_env_wait_ms": 0.3989412683887856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006409151008330196, "StateBufferConnector_ms": 0.004857419485069183, "ViewRequirementAgentConnector_ms": 0.12720090797148556}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 333.9028602172293, "num_env_steps_trained_throughput_per_sec": 333.9028602172293, "timesteps_total": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 10454.654, "restore_workers_time_ms": 0.016, "training_step_time_ms": 10454.609, "sample_time_ms": 4039.501, "load_time_ms": 0.425, "load_throughput": 9405323.467, "learn_time_ms": 6406.01, "learn_throughput": 624.414, "synch_weights_time_ms": 8.09}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "episodes_total": 83, "training_iteration": 13, "trial_id": "3adab_00000", "date": "2024-04-27_20-58-49", "timestamp": 1714276729, "time_this_iter_s": 11.983338117599487, "time_total_s": 136.56547260284424, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 136.56547260284424, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 38.300000000000004, "ram_util_percent": 66.68823529411765}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.610424933061805, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2957974509348573, "policy_loss": -0.03000167657130508, "vf_loss": 2.3193530543957666, "vf_explained_var": 0.2119720728807552, "kl": 0.014324610638472722, "entropy": 5.610946887539279, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 12555.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "sampler_results": {"episode_reward_max": -72.95007590135621, "episode_reward_min": -235.33028118049674, "episode_reward_mean": -109.14344796163223, "episode_len_mean": 563.8736842105263, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 53568, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-106.69923103574303, -108.32895085933929, -109.88018457645713, -100.79863420576913, -112.48620853136542, -119.37345565429641, -100.20991829490413, -114.62269220503973, -113.88680945530287, -107.798961677722, -101.73277856792944, -123.26563492036983, -112.11779813104741, -105.74261578084094, -102.45206030851044, -99.97136980936973, -109.5457354993249, -101.43931917319509, -119.15313169982781, -104.96544682995851, -235.33028118049674, -102.79730212985787, -103.45773466033185, -139.14156347253856, -108.30934477867929, -153.90241098702637, -118.41556737606967, -101.16211445601161, -122.4617705558737, -105.40242999805633, -100.1470335095278, -107.79713709658135, -104.30677952509944, -116.11250780874538, -101.90768641310558, -108.66597388942913, -125.12524251694916, -108.88658591585173, -116.69571974788109, -107.1742698835178, -99.63495288486214, -118.69715090308897, -130.03023884021053, -104.6548820117712, -116.4082717362071, -99.24241344694668, -98.65514017825015, -90.93072269391072, -136.89249106894437, -118.23056261533003, -103.09214078160127, -100.92204699906085, -106.44184091064581, -100.3721384089502, -103.88594947721595, -90.5452398339198, -93.63170284782423, -119.07315398854949, -89.7958205201688, -117.77096657386484, -110.35086590666324, -110.074788587749, -98.94205488882463, -104.82640339145436, -99.52744296496112, -103.51996069358661, -107.09019411591565, -104.10792801132301, -119.46049343325446, -98.7459925398839, -72.95007590135621, -134.7712770838048, -127.66224715956176, -104.9857301557685, -110.80928917799952, -87.3538787528114, -104.85344151977573, -99.76325685500974, -79.88006541617705, -119.70371850834601, -87.75503661708159, -120.62659280303244, -83.6883983541963, -90.2256437196166, -99.25224420742319, -118.43325836632464, -102.31106377680848, -123.18347500504491, -120.9416708599062, -117.027008278373, -105.91690294635544, -103.51381328664472, -97.39853612722705, -85.40954183656908, -112.98704526696602], "episode_lengths": [1600, 76, 1600, 53, 49, 67, 107, 1600, 152, 56, 72, 136, 1600, 76, 104, 1600, 63, 63, 92, 66, 1521, 94, 1600, 201, 1600, 316, 1600, 82, 1600, 82, 1600, 40, 1600, 1600, 75, 50, 126, 95, 76, 59, 1600, 51, 196, 73, 84, 65, 61, 1600, 119, 67, 120, 1600, 1600, 1600, 1600, 1600, 1600, 70, 1600, 63, 90, 102, 92, 69, 86, 67, 39, 94, 58, 83, 1600, 1600, 115, 114, 66, 1600, 78, 77, 1600, 85, 1600, 68, 1600, 1600, 103, 65, 69, 81, 103, 69, 79, 67, 79, 1600, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3031342668115113, "mean_inference_ms": 1.0309237329811052, "mean_action_processing_ms": 0.2009337181962547, "mean_env_wait_ms": 0.4007062936359525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006397648861533717, "StateBufferConnector_ms": 0.00492121043958162, "ViewRequirementAgentConnector_ms": 0.12788120069001851}}, "episode_reward_max": -72.95007590135621, "episode_reward_min": -235.33028118049674, "episode_reward_mean": -109.14344796163223, "episode_len_mean": 563.8736842105263, "episodes_this_iter": 12, "episodes_timesteps_total": 53568, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-106.69923103574303, -108.32895085933929, -109.88018457645713, -100.79863420576913, -112.48620853136542, -119.37345565429641, -100.20991829490413, -114.62269220503973, -113.88680945530287, -107.798961677722, -101.73277856792944, -123.26563492036983, -112.11779813104741, -105.74261578084094, -102.45206030851044, -99.97136980936973, -109.5457354993249, -101.43931917319509, -119.15313169982781, -104.96544682995851, -235.33028118049674, -102.79730212985787, -103.45773466033185, -139.14156347253856, -108.30934477867929, -153.90241098702637, -118.41556737606967, -101.16211445601161, -122.4617705558737, -105.40242999805633, -100.1470335095278, -107.79713709658135, -104.30677952509944, -116.11250780874538, -101.90768641310558, -108.66597388942913, -125.12524251694916, -108.88658591585173, -116.69571974788109, -107.1742698835178, -99.63495288486214, -118.69715090308897, -130.03023884021053, -104.6548820117712, -116.4082717362071, -99.24241344694668, -98.65514017825015, -90.93072269391072, -136.89249106894437, -118.23056261533003, -103.09214078160127, -100.92204699906085, -106.44184091064581, -100.3721384089502, -103.88594947721595, -90.5452398339198, -93.63170284782423, -119.07315398854949, -89.7958205201688, -117.77096657386484, -110.35086590666324, -110.074788587749, -98.94205488882463, -104.82640339145436, -99.52744296496112, -103.51996069358661, -107.09019411591565, -104.10792801132301, -119.46049343325446, -98.7459925398839, -72.95007590135621, -134.7712770838048, -127.66224715956176, -104.9857301557685, -110.80928917799952, -87.3538787528114, -104.85344151977573, -99.76325685500974, -79.88006541617705, -119.70371850834601, -87.75503661708159, -120.62659280303244, -83.6883983541963, -90.2256437196166, -99.25224420742319, -118.43325836632464, -102.31106377680848, -123.18347500504491, -120.9416708599062, -117.027008278373, -105.91690294635544, -103.51381328664472, -97.39853612722705, -85.40954183656908, -112.98704526696602], "episode_lengths": [1600, 76, 1600, 53, 49, 67, 107, 1600, 152, 56, 72, 136, 1600, 76, 104, 1600, 63, 63, 92, 66, 1521, 94, 1600, 201, 1600, 316, 1600, 82, 1600, 82, 1600, 40, 1600, 1600, 75, 50, 126, 95, 76, 59, 1600, 51, 196, 73, 84, 65, 61, 1600, 119, 67, 120, 1600, 1600, 1600, 1600, 1600, 1600, 70, 1600, 63, 90, 102, 92, 69, 86, 67, 39, 94, 58, 83, 1600, 1600, 115, 114, 66, 1600, 78, 77, 1600, 85, 1600, 68, 1600, 1600, 103, 65, 69, 81, 103, 69, 79, 67, 79, 1600, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3031342668115113, "mean_inference_ms": 1.0309237329811052, "mean_action_processing_ms": 0.2009337181962547, "mean_env_wait_ms": 0.4007062936359525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006397648861533717, "StateBufferConnector_ms": 0.00492121043958162, "ViewRequirementAgentConnector_ms": 0.12788120069001851}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 387.5830406822963, "num_env_steps_trained_throughput_per_sec": 387.5830406822963, "timesteps_total": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 10522.655, "restore_workers_time_ms": 0.016, "training_step_time_ms": 10522.611, "sample_time_ms": 4106.442, "load_time_ms": 0.427, "load_throughput": 9371699.251, "learn_time_ms": 6406.968, "learn_throughput": 624.32, "synch_weights_time_ms": 8.177}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "episodes_total": 95, "training_iteration": 14, "trial_id": "3adab_00000", "date": "2024-04-27_20-58-59", "timestamp": 1714276739, "time_this_iter_s": 10.324334144592285, "time_total_s": 146.88980674743652, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 146.88980674743652, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 30.853333333333335, "ram_util_percent": 65.77333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.179059117519728, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7569692150554469, "policy_loss": -0.018421867083237377, "vf_loss": 0.7730780557559062, "vf_explained_var": 0.3855898371306799, "kl": 0.0051400575090097675, "entropy": 5.1299402216429355, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13485.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": -72.95007590135621, "episode_reward_min": -235.33028118049674, "episode_reward_mean": -108.54474954005153, "episode_len_mean": 580.030612244898, "episode_media": {}, "episodes_this_iter": 3, "episodes_timesteps_total": 56843, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-106.69923103574303, -108.32895085933929, -109.88018457645713, -100.79863420576913, -112.48620853136542, -119.37345565429641, -100.20991829490413, -114.62269220503973, -113.88680945530287, -107.798961677722, -101.73277856792944, -123.26563492036983, -112.11779813104741, -105.74261578084094, -102.45206030851044, -99.97136980936973, -109.5457354993249, -101.43931917319509, -119.15313169982781, -104.96544682995851, -235.33028118049674, -102.79730212985787, -103.45773466033185, -139.14156347253856, -108.30934477867929, -153.90241098702637, -118.41556737606967, -101.16211445601161, -122.4617705558737, -105.40242999805633, -100.1470335095278, -107.79713709658135, -104.30677952509944, -116.11250780874538, -101.90768641310558, -108.66597388942913, -125.12524251694916, -108.88658591585173, -116.69571974788109, -107.1742698835178, -99.63495288486214, -118.69715090308897, -130.03023884021053, -104.6548820117712, -116.4082717362071, -99.24241344694668, -98.65514017825015, -90.93072269391072, -136.89249106894437, -118.23056261533003, -103.09214078160127, -100.92204699906085, -106.44184091064581, -100.3721384089502, -103.88594947721595, -90.5452398339198, -93.63170284782423, -119.07315398854949, -89.7958205201688, -117.77096657386484, -110.35086590666324, -110.074788587749, -98.94205488882463, -104.82640339145436, -99.52744296496112, -103.51996069358661, -107.09019411591565, -104.10792801132301, -119.46049343325446, -98.7459925398839, -72.95007590135621, -134.7712770838048, -127.66224715956176, -104.9857301557685, -110.80928917799952, -87.3538787528114, -104.85344151977573, -99.76325685500974, -79.88006541617705, -119.70371850834601, -87.75503661708159, -120.62659280303244, -83.6883983541963, -90.2256437196166, -99.25224420742319, -118.43325836632464, -102.31106377680848, -123.18347500504491, -120.9416708599062, -117.027008278373, -105.91690294635544, -103.51381328664472, -97.39853612722705, -85.40954183656908, -112.98704526696602, -83.54776636303336, -104.72363158538441, -80.48650062157033], "episode_lengths": [1600, 76, 1600, 53, 49, 67, 107, 1600, 152, 56, 72, 136, 1600, 76, 104, 1600, 63, 63, 92, 66, 1521, 94, 1600, 201, 1600, 316, 1600, 82, 1600, 82, 1600, 40, 1600, 1600, 75, 50, 126, 95, 76, 59, 1600, 51, 196, 73, 84, 65, 61, 1600, 119, 67, 120, 1600, 1600, 1600, 1600, 1600, 1600, 70, 1600, 63, 90, 102, 92, 69, 86, 67, 39, 94, 58, 83, 1600, 1600, 115, 114, 66, 1600, 78, 77, 1600, 85, 1600, 68, 1600, 1600, 103, 65, 69, 81, 103, 69, 79, 67, 79, 1600, 52, 1600, 75, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30342269368988933, "mean_inference_ms": 1.0317480133857697, "mean_action_processing_ms": 0.20109161105850112, "mean_env_wait_ms": 0.4010373934585294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006357017828493702, "StateBufferConnector_ms": 0.004897312242157606, "ViewRequirementAgentConnector_ms": 0.12729946447878468}}, "episode_reward_max": -72.95007590135621, "episode_reward_min": -235.33028118049674, "episode_reward_mean": -108.54474954005153, "episode_len_mean": 580.030612244898, "episodes_this_iter": 3, "episodes_timesteps_total": 56843, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-106.69923103574303, -108.32895085933929, -109.88018457645713, -100.79863420576913, -112.48620853136542, -119.37345565429641, -100.20991829490413, -114.62269220503973, -113.88680945530287, -107.798961677722, -101.73277856792944, -123.26563492036983, -112.11779813104741, -105.74261578084094, -102.45206030851044, -99.97136980936973, -109.5457354993249, -101.43931917319509, -119.15313169982781, -104.96544682995851, -235.33028118049674, -102.79730212985787, -103.45773466033185, -139.14156347253856, -108.30934477867929, -153.90241098702637, -118.41556737606967, -101.16211445601161, -122.4617705558737, -105.40242999805633, -100.1470335095278, -107.79713709658135, -104.30677952509944, -116.11250780874538, -101.90768641310558, -108.66597388942913, -125.12524251694916, -108.88658591585173, -116.69571974788109, -107.1742698835178, -99.63495288486214, -118.69715090308897, -130.03023884021053, -104.6548820117712, -116.4082717362071, -99.24241344694668, -98.65514017825015, -90.93072269391072, -136.89249106894437, -118.23056261533003, -103.09214078160127, -100.92204699906085, -106.44184091064581, -100.3721384089502, -103.88594947721595, -90.5452398339198, -93.63170284782423, -119.07315398854949, -89.7958205201688, -117.77096657386484, -110.35086590666324, -110.074788587749, -98.94205488882463, -104.82640339145436, -99.52744296496112, -103.51996069358661, -107.09019411591565, -104.10792801132301, -119.46049343325446, -98.7459925398839, -72.95007590135621, -134.7712770838048, -127.66224715956176, -104.9857301557685, -110.80928917799952, -87.3538787528114, -104.85344151977573, -99.76325685500974, -79.88006541617705, -119.70371850834601, -87.75503661708159, -120.62659280303244, -83.6883983541963, -90.2256437196166, -99.25224420742319, -118.43325836632464, -102.31106377680848, -123.18347500504491, -120.9416708599062, -117.027008278373, -105.91690294635544, -103.51381328664472, -97.39853612722705, -85.40954183656908, -112.98704526696602, -83.54776636303336, -104.72363158538441, -80.48650062157033], "episode_lengths": [1600, 76, 1600, 53, 49, 67, 107, 1600, 152, 56, 72, 136, 1600, 76, 104, 1600, 63, 63, 92, 66, 1521, 94, 1600, 201, 1600, 316, 1600, 82, 1600, 82, 1600, 40, 1600, 1600, 75, 50, 126, 95, 76, 59, 1600, 51, 196, 73, 84, 65, 61, 1600, 119, 67, 120, 1600, 1600, 1600, 1600, 1600, 1600, 70, 1600, 63, 90, 102, 92, 69, 86, 67, 39, 94, 58, 83, 1600, 1600, 115, 114, 66, 1600, 78, 77, 1600, 85, 1600, 68, 1600, 1600, 103, 65, 69, 81, 103, 69, 79, 67, 79, 1600, 52, 1600, 75, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30342269368988933, "mean_inference_ms": 1.0317480133857697, "mean_action_processing_ms": 0.20109161105850112, "mean_env_wait_ms": 0.4010373934585294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006357017828493702, "StateBufferConnector_ms": 0.004897312242157606, "ViewRequirementAgentConnector_ms": 0.12729946447878468}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 418.01148092856204, "num_env_steps_trained_throughput_per_sec": 418.01148092856204, "timesteps_total": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 10429.971, "restore_workers_time_ms": 0.016, "training_step_time_ms": 10429.928, "sample_time_ms": 4068.785, "load_time_ms": 0.428, "load_throughput": 9347679.964, "learn_time_ms": 6352.177, "learn_throughput": 629.705, "synch_weights_time_ms": 7.975}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 98, "training_iteration": 15, "trial_id": "3adab_00000", "date": "2024-04-27_20-59-09", "timestamp": 1714276749, "time_this_iter_s": 9.57327675819397, "time_total_s": 156.4630835056305, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 156.4630835056305, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 24.56923076923077, "ram_util_percent": 64.4076923076923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.562510479457917, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9389975580519505, "policy_loss": -0.03613281467909454, "vf_loss": 1.9681986805412077, "vf_explained_var": 0.2754285095199462, "kl": 0.015403770231782295, "entropy": 5.476008336774765, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 14415.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": -72.95007590135621, "episode_reward_min": -235.33028118049674, "episode_reward_mean": -107.32010394049342, "episode_len_mean": 584.14, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 58414, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-107.798961677722, -101.73277856792944, -123.26563492036983, -112.11779813104741, -105.74261578084094, -102.45206030851044, -99.97136980936973, -109.5457354993249, -101.43931917319509, -119.15313169982781, -104.96544682995851, -235.33028118049674, -102.79730212985787, -103.45773466033185, -139.14156347253856, -108.30934477867929, -153.90241098702637, -118.41556737606967, -101.16211445601161, -122.4617705558737, -105.40242999805633, -100.1470335095278, -107.79713709658135, -104.30677952509944, -116.11250780874538, -101.90768641310558, -108.66597388942913, -125.12524251694916, -108.88658591585173, -116.69571974788109, -107.1742698835178, -99.63495288486214, -118.69715090308897, -130.03023884021053, -104.6548820117712, -116.4082717362071, -99.24241344694668, -98.65514017825015, -90.93072269391072, -136.89249106894437, -118.23056261533003, -103.09214078160127, -100.92204699906085, -106.44184091064581, -100.3721384089502, -103.88594947721595, -90.5452398339198, -93.63170284782423, -119.07315398854949, -89.7958205201688, -117.77096657386484, -110.35086590666324, -110.074788587749, -98.94205488882463, -104.82640339145436, -99.52744296496112, -103.51996069358661, -107.09019411591565, -104.10792801132301, -119.46049343325446, -98.7459925398839, -72.95007590135621, -134.7712770838048, -127.66224715956176, -104.9857301557685, -110.80928917799952, -87.3538787528114, -104.85344151977573, -99.76325685500974, -79.88006541617705, -119.70371850834601, -87.75503661708159, -120.62659280303244, -83.6883983541963, -90.2256437196166, -99.25224420742319, -118.43325836632464, -102.31106377680848, -123.18347500504491, -120.9416708599062, -117.027008278373, -105.91690294635544, -103.51381328664472, -97.39853612722705, -85.40954183656908, -112.98704526696602, -83.54776636303336, -104.72363158538441, -80.48650062157033, -91.15923745172165, -84.92183139163765, -107.85536147028891, -106.1092724044857, -108.01532635934836, -77.18308442212277, -99.5658217192913, -105.429144295703, -88.66844559451751, -105.25632432739872, -106.74717450599124], "episode_lengths": [56, 72, 136, 1600, 76, 104, 1600, 63, 63, 92, 66, 1521, 94, 1600, 201, 1600, 316, 1600, 82, 1600, 82, 1600, 40, 1600, 1600, 75, 50, 126, 95, 76, 59, 1600, 51, 196, 73, 84, 65, 61, 1600, 119, 67, 120, 1600, 1600, 1600, 1600, 1600, 1600, 70, 1600, 63, 90, 102, 92, 69, 86, 67, 39, 94, 58, 83, 1600, 1600, 115, 114, 66, 1600, 78, 77, 1600, 85, 1600, 68, 1600, 1600, 103, 65, 69, 81, 103, 69, 79, 67, 79, 1600, 52, 1600, 75, 1600, 1600, 1600, 37, 53, 59, 1600, 62, 67, 1600, 131, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3070309699318501, "mean_inference_ms": 1.0456031380463768, "mean_action_processing_ms": 0.20378892213179875, "mean_env_wait_ms": 0.40578646723152656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006319284439086914, "StateBufferConnector_ms": 0.004866361618041992, "ViewRequirementAgentConnector_ms": 0.12754559516906738}}, "episode_reward_max": -72.95007590135621, "episode_reward_min": -235.33028118049674, "episode_reward_mean": -107.32010394049342, "episode_len_mean": 584.14, "episodes_this_iter": 11, "episodes_timesteps_total": 58414, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-107.798961677722, -101.73277856792944, -123.26563492036983, -112.11779813104741, -105.74261578084094, -102.45206030851044, -99.97136980936973, -109.5457354993249, -101.43931917319509, -119.15313169982781, -104.96544682995851, -235.33028118049674, -102.79730212985787, -103.45773466033185, -139.14156347253856, -108.30934477867929, -153.90241098702637, -118.41556737606967, -101.16211445601161, -122.4617705558737, -105.40242999805633, -100.1470335095278, -107.79713709658135, -104.30677952509944, -116.11250780874538, -101.90768641310558, -108.66597388942913, -125.12524251694916, -108.88658591585173, -116.69571974788109, -107.1742698835178, -99.63495288486214, -118.69715090308897, -130.03023884021053, -104.6548820117712, -116.4082717362071, -99.24241344694668, -98.65514017825015, -90.93072269391072, -136.89249106894437, -118.23056261533003, -103.09214078160127, -100.92204699906085, -106.44184091064581, -100.3721384089502, -103.88594947721595, -90.5452398339198, -93.63170284782423, -119.07315398854949, -89.7958205201688, -117.77096657386484, -110.35086590666324, -110.074788587749, -98.94205488882463, -104.82640339145436, -99.52744296496112, -103.51996069358661, -107.09019411591565, -104.10792801132301, -119.46049343325446, -98.7459925398839, -72.95007590135621, -134.7712770838048, -127.66224715956176, -104.9857301557685, -110.80928917799952, -87.3538787528114, -104.85344151977573, -99.76325685500974, -79.88006541617705, -119.70371850834601, -87.75503661708159, -120.62659280303244, -83.6883983541963, -90.2256437196166, -99.25224420742319, -118.43325836632464, -102.31106377680848, -123.18347500504491, -120.9416708599062, -117.027008278373, -105.91690294635544, -103.51381328664472, -97.39853612722705, -85.40954183656908, -112.98704526696602, -83.54776636303336, -104.72363158538441, -80.48650062157033, -91.15923745172165, -84.92183139163765, -107.85536147028891, -106.1092724044857, -108.01532635934836, -77.18308442212277, -99.5658217192913, -105.429144295703, -88.66844559451751, -105.25632432739872, -106.74717450599124], "episode_lengths": [56, 72, 136, 1600, 76, 104, 1600, 63, 63, 92, 66, 1521, 94, 1600, 201, 1600, 316, 1600, 82, 1600, 82, 1600, 40, 1600, 1600, 75, 50, 126, 95, 76, 59, 1600, 51, 196, 73, 84, 65, 61, 1600, 119, 67, 120, 1600, 1600, 1600, 1600, 1600, 1600, 70, 1600, 63, 90, 102, 92, 69, 86, 67, 39, 94, 58, 83, 1600, 1600, 115, 114, 66, 1600, 78, 77, 1600, 85, 1600, 68, 1600, 1600, 103, 65, 69, 81, 103, 69, 79, 67, 79, 1600, 52, 1600, 75, 1600, 1600, 1600, 37, 53, 59, 1600, 62, 67, 1600, 131, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3070309699318501, "mean_inference_ms": 1.0456031380463768, "mean_action_processing_ms": 0.20378892213179875, "mean_env_wait_ms": 0.40578646723152656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006319284439086914, "StateBufferConnector_ms": 0.004866361618041992, "ViewRequirementAgentConnector_ms": 0.12754559516906738}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 404.7905721322711, "num_env_steps_trained_throughput_per_sec": 404.7905721322711, "timesteps_total": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 10415.514, "restore_workers_time_ms": 0.015, "training_step_time_ms": 10415.471, "sample_time_ms": 4099.77, "load_time_ms": 0.414, "load_throughput": 9666522.24, "learn_time_ms": 6306.804, "learn_throughput": 634.236, "synch_weights_time_ms": 7.932}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "episodes_total": 109, "training_iteration": 16, "trial_id": "3adab_00000", "date": "2024-04-27_20-59-18", "timestamp": 1714276758, "time_this_iter_s": 9.886473178863525, "time_total_s": 166.34955668449402, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 166.34955668449402, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 27.280000000000005, "ram_util_percent": 64.41333333333331}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.841088308281796, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4582091294605817, "policy_loss": -0.025438053625565702, "vf_loss": 1.47987602731233, "vf_explained_var": 0.18864112855285728, "kl": 0.008380365566992209, "entropy": 5.143281933056411, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 15345.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "sampler_results": {"episode_reward_max": -72.95007590135621, "episode_reward_min": -235.33028118049674, "episode_reward_mean": -106.85402275367358, "episode_len_mean": 598.8, "episode_media": {}, "episodes_this_iter": 4, "episodes_timesteps_total": 59880, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-105.74261578084094, -102.45206030851044, -99.97136980936973, -109.5457354993249, -101.43931917319509, -119.15313169982781, -104.96544682995851, -235.33028118049674, -102.79730212985787, -103.45773466033185, -139.14156347253856, -108.30934477867929, -153.90241098702637, -118.41556737606967, -101.16211445601161, -122.4617705558737, -105.40242999805633, -100.1470335095278, -107.79713709658135, -104.30677952509944, -116.11250780874538, -101.90768641310558, -108.66597388942913, -125.12524251694916, -108.88658591585173, -116.69571974788109, -107.1742698835178, -99.63495288486214, -118.69715090308897, -130.03023884021053, -104.6548820117712, -116.4082717362071, -99.24241344694668, -98.65514017825015, -90.93072269391072, -136.89249106894437, -118.23056261533003, -103.09214078160127, -100.92204699906085, -106.44184091064581, -100.3721384089502, -103.88594947721595, -90.5452398339198, -93.63170284782423, -119.07315398854949, -89.7958205201688, -117.77096657386484, -110.35086590666324, -110.074788587749, -98.94205488882463, -104.82640339145436, -99.52744296496112, -103.51996069358661, -107.09019411591565, -104.10792801132301, -119.46049343325446, -98.7459925398839, -72.95007590135621, -134.7712770838048, -127.66224715956176, -104.9857301557685, -110.80928917799952, -87.3538787528114, -104.85344151977573, -99.76325685500974, -79.88006541617705, -119.70371850834601, -87.75503661708159, -120.62659280303244, -83.6883983541963, -90.2256437196166, -99.25224420742319, -118.43325836632464, -102.31106377680848, -123.18347500504491, -120.9416708599062, -117.027008278373, -105.91690294635544, -103.51381328664472, -97.39853612722705, -85.40954183656908, -112.98704526696602, -83.54776636303336, -104.72363158538441, -80.48650062157033, -91.15923745172165, -84.92183139163765, -107.85536147028891, -106.1092724044857, -108.01532635934836, -77.18308442212277, -99.5658217192913, -105.429144295703, -88.66844559451751, -105.25632432739872, -106.74717450599124, -93.24713787307978, -105.51860236068008, -80.85274682837306, -118.68856755295147], "episode_lengths": [76, 104, 1600, 63, 63, 92, 66, 1521, 94, 1600, 201, 1600, 316, 1600, 82, 1600, 82, 1600, 40, 1600, 1600, 75, 50, 126, 95, 76, 59, 1600, 51, 196, 73, 84, 65, 61, 1600, 119, 67, 120, 1600, 1600, 1600, 1600, 1600, 1600, 70, 1600, 63, 90, 102, 92, 69, 86, 67, 39, 94, 58, 83, 1600, 1600, 115, 114, 66, 1600, 78, 77, 1600, 85, 1600, 68, 1600, 1600, 103, 65, 69, 81, 103, 69, 79, 67, 79, 1600, 52, 1600, 75, 1600, 1600, 1600, 37, 53, 59, 1600, 62, 67, 1600, 131, 66, 1600, 58, 1600, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3069353464705755, "mean_inference_ms": 1.0447473504810565, "mean_action_processing_ms": 0.20361674173825878, "mean_env_wait_ms": 0.4056793638683277, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006320476531982422, "StateBufferConnector_ms": 0.0048596858978271484, "ViewRequirementAgentConnector_ms": 0.12682747840881348}}, "episode_reward_max": -72.95007590135621, "episode_reward_min": -235.33028118049674, "episode_reward_mean": -106.85402275367358, "episode_len_mean": 598.8, "episodes_this_iter": 4, "episodes_timesteps_total": 59880, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-105.74261578084094, -102.45206030851044, -99.97136980936973, -109.5457354993249, -101.43931917319509, -119.15313169982781, -104.96544682995851, -235.33028118049674, -102.79730212985787, -103.45773466033185, -139.14156347253856, -108.30934477867929, -153.90241098702637, -118.41556737606967, -101.16211445601161, -122.4617705558737, -105.40242999805633, -100.1470335095278, -107.79713709658135, -104.30677952509944, -116.11250780874538, -101.90768641310558, -108.66597388942913, -125.12524251694916, -108.88658591585173, -116.69571974788109, -107.1742698835178, -99.63495288486214, -118.69715090308897, -130.03023884021053, -104.6548820117712, -116.4082717362071, -99.24241344694668, -98.65514017825015, -90.93072269391072, -136.89249106894437, -118.23056261533003, -103.09214078160127, -100.92204699906085, -106.44184091064581, -100.3721384089502, -103.88594947721595, -90.5452398339198, -93.63170284782423, -119.07315398854949, -89.7958205201688, -117.77096657386484, -110.35086590666324, -110.074788587749, -98.94205488882463, -104.82640339145436, -99.52744296496112, -103.51996069358661, -107.09019411591565, -104.10792801132301, -119.46049343325446, -98.7459925398839, -72.95007590135621, -134.7712770838048, -127.66224715956176, -104.9857301557685, -110.80928917799952, -87.3538787528114, -104.85344151977573, -99.76325685500974, -79.88006541617705, -119.70371850834601, -87.75503661708159, -120.62659280303244, -83.6883983541963, -90.2256437196166, -99.25224420742319, -118.43325836632464, -102.31106377680848, -123.18347500504491, -120.9416708599062, -117.027008278373, -105.91690294635544, -103.51381328664472, -97.39853612722705, -85.40954183656908, -112.98704526696602, -83.54776636303336, -104.72363158538441, -80.48650062157033, -91.15923745172165, -84.92183139163765, -107.85536147028891, -106.1092724044857, -108.01532635934836, -77.18308442212277, -99.5658217192913, -105.429144295703, -88.66844559451751, -105.25632432739872, -106.74717450599124, -93.24713787307978, -105.51860236068008, -80.85274682837306, -118.68856755295147], "episode_lengths": [76, 104, 1600, 63, 63, 92, 66, 1521, 94, 1600, 201, 1600, 316, 1600, 82, 1600, 82, 1600, 40, 1600, 1600, 75, 50, 126, 95, 76, 59, 1600, 51, 196, 73, 84, 65, 61, 1600, 119, 67, 120, 1600, 1600, 1600, 1600, 1600, 1600, 70, 1600, 63, 90, 102, 92, 69, 86, 67, 39, 94, 58, 83, 1600, 1600, 115, 114, 66, 1600, 78, 77, 1600, 85, 1600, 68, 1600, 1600, 103, 65, 69, 81, 103, 69, 79, 67, 79, 1600, 52, 1600, 75, 1600, 1600, 1600, 37, 53, 59, 1600, 62, 67, 1600, 131, 66, 1600, 58, 1600, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3069353464705755, "mean_inference_ms": 1.0447473504810565, "mean_action_processing_ms": 0.20361674173825878, "mean_env_wait_ms": 0.4056793638683277, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006320476531982422, "StateBufferConnector_ms": 0.0048596858978271484, "ViewRequirementAgentConnector_ms": 0.12682747840881348}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 416.7899212317684, "num_env_steps_trained_throughput_per_sec": 416.7899212317684, "timesteps_total": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 10337.878, "restore_workers_time_ms": 0.015, "training_step_time_ms": 10337.836, "sample_time_ms": 4063.487, "load_time_ms": 0.425, "load_throughput": 9407432.993, "learn_time_ms": 6265.564, "learn_throughput": 638.41, "synch_weights_time_ms": 7.822}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "episodes_total": 113, "training_iteration": 17, "trial_id": "3adab_00000", "date": "2024-04-27_20-59-28", "timestamp": 1714276768, "time_this_iter_s": 9.601052284240723, "time_total_s": 175.95060896873474, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 175.95060896873474, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 24.53076923076923, "ram_util_percent": 64.23846153846155}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.628629502109302, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8633679453639054, "policy_loss": -0.03313895903768078, "vf_loss": 0.8925911465199083, "vf_explained_var": 0.31758606863278216, "kl": 0.008701663041322368, "entropy": 5.163745315613285, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 16275.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": -71.26529871672517, "episode_reward_min": -235.33028118049674, "episode_reward_mean": -106.41742579486174, "episode_len_mean": 613.85, "episode_media": {}, "episodes_this_iter": 4, "episodes_timesteps_total": 61385, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-101.43931917319509, -119.15313169982781, -104.96544682995851, -235.33028118049674, -102.79730212985787, -103.45773466033185, -139.14156347253856, -108.30934477867929, -153.90241098702637, -118.41556737606967, -101.16211445601161, -122.4617705558737, -105.40242999805633, -100.1470335095278, -107.79713709658135, -104.30677952509944, -116.11250780874538, -101.90768641310558, -108.66597388942913, -125.12524251694916, -108.88658591585173, -116.69571974788109, -107.1742698835178, -99.63495288486214, -118.69715090308897, -130.03023884021053, -104.6548820117712, -116.4082717362071, -99.24241344694668, -98.65514017825015, -90.93072269391072, -136.89249106894437, -118.23056261533003, -103.09214078160127, -100.92204699906085, -106.44184091064581, -100.3721384089502, -103.88594947721595, -90.5452398339198, -93.63170284782423, -119.07315398854949, -89.7958205201688, -117.77096657386484, -110.35086590666324, -110.074788587749, -98.94205488882463, -104.82640339145436, -99.52744296496112, -103.51996069358661, -107.09019411591565, -104.10792801132301, -119.46049343325446, -98.7459925398839, -72.95007590135621, -134.7712770838048, -127.66224715956176, -104.9857301557685, -110.80928917799952, -87.3538787528114, -104.85344151977573, -99.76325685500974, -79.88006541617705, -119.70371850834601, -87.75503661708159, -120.62659280303244, -83.6883983541963, -90.2256437196166, -99.25224420742319, -118.43325836632464, -102.31106377680848, -123.18347500504491, -120.9416708599062, -117.027008278373, -105.91690294635544, -103.51381328664472, -97.39853612722705, -85.40954183656908, -112.98704526696602, -83.54776636303336, -104.72363158538441, -80.48650062157033, -91.15923745172165, -84.92183139163765, -107.85536147028891, -106.1092724044857, -108.01532635934836, -77.18308442212277, -99.5658217192913, -105.429144295703, -88.66844559451751, -105.25632432739872, -106.74717450599124, -93.24713787307978, -105.51860236068008, -80.85274682837306, -118.68856755295147, -84.24461424998856, -116.56000187537944, -101.98217067477044, -71.26529871672517], "episode_lengths": [63, 92, 66, 1521, 94, 1600, 201, 1600, 316, 1600, 82, 1600, 82, 1600, 40, 1600, 1600, 75, 50, 126, 95, 76, 59, 1600, 51, 196, 73, 84, 65, 61, 1600, 119, 67, 120, 1600, 1600, 1600, 1600, 1600, 1600, 70, 1600, 63, 90, 102, 92, 69, 86, 67, 39, 94, 58, 83, 1600, 1600, 115, 114, 66, 1600, 78, 77, 1600, 85, 1600, 68, 1600, 1600, 103, 65, 69, 81, 103, 69, 79, 67, 79, 1600, 52, 1600, 75, 1600, 1600, 1600, 37, 53, 59, 1600, 62, 67, 1600, 131, 66, 1600, 58, 1600, 72, 1600, 62, 86, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3069832290432107, "mean_inference_ms": 1.044121623843077, "mean_action_processing_ms": 0.2034967137685511, "mean_env_wait_ms": 0.4056400297206566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006281852722167969, "StateBufferConnector_ms": 0.004838705062866211, "ViewRequirementAgentConnector_ms": 0.12709903717041016}}, "episode_reward_max": -71.26529871672517, "episode_reward_min": -235.33028118049674, "episode_reward_mean": -106.41742579486174, "episode_len_mean": 613.85, "episodes_this_iter": 4, "episodes_timesteps_total": 61385, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-101.43931917319509, -119.15313169982781, -104.96544682995851, -235.33028118049674, -102.79730212985787, -103.45773466033185, -139.14156347253856, -108.30934477867929, -153.90241098702637, -118.41556737606967, -101.16211445601161, -122.4617705558737, -105.40242999805633, -100.1470335095278, -107.79713709658135, -104.30677952509944, -116.11250780874538, -101.90768641310558, -108.66597388942913, -125.12524251694916, -108.88658591585173, -116.69571974788109, -107.1742698835178, -99.63495288486214, -118.69715090308897, -130.03023884021053, -104.6548820117712, -116.4082717362071, -99.24241344694668, -98.65514017825015, -90.93072269391072, -136.89249106894437, -118.23056261533003, -103.09214078160127, -100.92204699906085, -106.44184091064581, -100.3721384089502, -103.88594947721595, -90.5452398339198, -93.63170284782423, -119.07315398854949, -89.7958205201688, -117.77096657386484, -110.35086590666324, -110.074788587749, -98.94205488882463, -104.82640339145436, -99.52744296496112, -103.51996069358661, -107.09019411591565, -104.10792801132301, -119.46049343325446, -98.7459925398839, -72.95007590135621, -134.7712770838048, -127.66224715956176, -104.9857301557685, -110.80928917799952, -87.3538787528114, -104.85344151977573, -99.76325685500974, -79.88006541617705, -119.70371850834601, -87.75503661708159, -120.62659280303244, -83.6883983541963, -90.2256437196166, -99.25224420742319, -118.43325836632464, -102.31106377680848, -123.18347500504491, -120.9416708599062, -117.027008278373, -105.91690294635544, -103.51381328664472, -97.39853612722705, -85.40954183656908, -112.98704526696602, -83.54776636303336, -104.72363158538441, -80.48650062157033, -91.15923745172165, -84.92183139163765, -107.85536147028891, -106.1092724044857, -108.01532635934836, -77.18308442212277, -99.5658217192913, -105.429144295703, -88.66844559451751, -105.25632432739872, -106.74717450599124, -93.24713787307978, -105.51860236068008, -80.85274682837306, -118.68856755295147, -84.24461424998856, -116.56000187537944, -101.98217067477044, -71.26529871672517], "episode_lengths": [63, 92, 66, 1521, 94, 1600, 201, 1600, 316, 1600, 82, 1600, 82, 1600, 40, 1600, 1600, 75, 50, 126, 95, 76, 59, 1600, 51, 196, 73, 84, 65, 61, 1600, 119, 67, 120, 1600, 1600, 1600, 1600, 1600, 1600, 70, 1600, 63, 90, 102, 92, 69, 86, 67, 39, 94, 58, 83, 1600, 1600, 115, 114, 66, 1600, 78, 77, 1600, 85, 1600, 68, 1600, 1600, 103, 65, 69, 81, 103, 69, 79, 67, 79, 1600, 52, 1600, 75, 1600, 1600, 1600, 37, 53, 59, 1600, 62, 67, 1600, 131, 66, 1600, 58, 1600, 72, 1600, 62, 86, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3069832290432107, "mean_inference_ms": 1.044121623843077, "mean_action_processing_ms": 0.2034967137685511, "mean_env_wait_ms": 0.4056400297206566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006281852722167969, "StateBufferConnector_ms": 0.004838705062866211, "ViewRequirementAgentConnector_ms": 0.12709903717041016}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 410.8402339866263, "num_env_steps_trained_throughput_per_sec": 410.8402339866263, "timesteps_total": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 10290.329, "restore_workers_time_ms": 0.014, "training_step_time_ms": 10290.288, "sample_time_ms": 4031.934, "load_time_ms": 0.432, "load_throughput": 9259971.299, "learn_time_ms": 6249.509, "learn_throughput": 640.05, "synch_weights_time_ms": 7.869}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 117, "training_iteration": 18, "trial_id": "3adab_00000", "date": "2024-04-27_20-59-38", "timestamp": 1714276778, "time_this_iter_s": 9.741105318069458, "time_total_s": 185.6917142868042, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 185.6917142868042, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 24.985714285714284, "ram_util_percent": 64.16428571428574}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.459798651997762, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8025155858554807, "policy_loss": -0.031236362361138865, "vf_loss": 1.828456490643082, "vf_explained_var": 0.2979880553419872, "kl": 0.011767686819915706, "entropy": 5.35874439003647, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 17205.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "sampler_results": {"episode_reward_max": -71.26529871672517, "episode_reward_min": -136.89249106894437, "episode_reward_mean": -104.00663924121301, "episode_len_mean": 595.55, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 59555, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-118.41556737606967, -101.16211445601161, -122.4617705558737, -105.40242999805633, -100.1470335095278, -107.79713709658135, -104.30677952509944, -116.11250780874538, -101.90768641310558, -108.66597388942913, -125.12524251694916, -108.88658591585173, -116.69571974788109, -107.1742698835178, -99.63495288486214, -118.69715090308897, -130.03023884021053, -104.6548820117712, -116.4082717362071, -99.24241344694668, -98.65514017825015, -90.93072269391072, -136.89249106894437, -118.23056261533003, -103.09214078160127, -100.92204699906085, -106.44184091064581, -100.3721384089502, -103.88594947721595, -90.5452398339198, -93.63170284782423, -119.07315398854949, -89.7958205201688, -117.77096657386484, -110.35086590666324, -110.074788587749, -98.94205488882463, -104.82640339145436, -99.52744296496112, -103.51996069358661, -107.09019411591565, -104.10792801132301, -119.46049343325446, -98.7459925398839, -72.95007590135621, -134.7712770838048, -127.66224715956176, -104.9857301557685, -110.80928917799952, -87.3538787528114, -104.85344151977573, -99.76325685500974, -79.88006541617705, -119.70371850834601, -87.75503661708159, -120.62659280303244, -83.6883983541963, -90.2256437196166, -99.25224420742319, -118.43325836632464, -102.31106377680848, -123.18347500504491, -120.9416708599062, -117.027008278373, -105.91690294635544, -103.51381328664472, -97.39853612722705, -85.40954183656908, -112.98704526696602, -83.54776636303336, -104.72363158538441, -80.48650062157033, -91.15923745172165, -84.92183139163765, -107.85536147028891, -106.1092724044857, -108.01532635934836, -77.18308442212277, -99.5658217192913, -105.429144295703, -88.66844559451751, -105.25632432739872, -106.74717450599124, -93.24713787307978, -105.51860236068008, -80.85274682837306, -118.68856755295147, -84.24461424998856, -116.56000187537944, -101.98217067477044, -71.26529871672517, -78.78109041943605, -112.75633861562734, -109.43128755094236, -103.24994748049355, -112.99290804542849, -105.96923963363594, -76.46731700440685, -108.7942864982169, -118.97546429885242], "episode_lengths": [1600, 82, 1600, 82, 1600, 40, 1600, 1600, 75, 50, 126, 95, 76, 59, 1600, 51, 196, 73, 84, 65, 61, 1600, 119, 67, 120, 1600, 1600, 1600, 1600, 1600, 1600, 70, 1600, 63, 90, 102, 92, 69, 86, 67, 39, 94, 58, 83, 1600, 1600, 115, 114, 66, 1600, 78, 77, 1600, 85, 1600, 68, 1600, 1600, 103, 65, 69, 81, 103, 69, 79, 67, 79, 1600, 52, 1600, 75, 1600, 1600, 1600, 37, 53, 59, 1600, 62, 67, 1600, 131, 66, 1600, 58, 1600, 72, 1600, 62, 86, 1600, 1600, 58, 55, 73, 59, 133, 1600, 61, 84]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3073458649148106, "mean_inference_ms": 1.0444324553212787, "mean_action_processing_ms": 0.20353325163919167, "mean_env_wait_ms": 0.40610212829125486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00638580322265625, "StateBufferConnector_ms": 0.0049550533294677734, "ViewRequirementAgentConnector_ms": 0.12922883033752441}}, "episode_reward_max": -71.26529871672517, "episode_reward_min": -136.89249106894437, "episode_reward_mean": -104.00663924121301, "episode_len_mean": 595.55, "episodes_this_iter": 9, "episodes_timesteps_total": 59555, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-118.41556737606967, -101.16211445601161, -122.4617705558737, -105.40242999805633, -100.1470335095278, -107.79713709658135, -104.30677952509944, -116.11250780874538, -101.90768641310558, -108.66597388942913, -125.12524251694916, -108.88658591585173, -116.69571974788109, -107.1742698835178, -99.63495288486214, -118.69715090308897, -130.03023884021053, -104.6548820117712, -116.4082717362071, -99.24241344694668, -98.65514017825015, -90.93072269391072, -136.89249106894437, -118.23056261533003, -103.09214078160127, -100.92204699906085, -106.44184091064581, -100.3721384089502, -103.88594947721595, -90.5452398339198, -93.63170284782423, -119.07315398854949, -89.7958205201688, -117.77096657386484, -110.35086590666324, -110.074788587749, -98.94205488882463, -104.82640339145436, -99.52744296496112, -103.51996069358661, -107.09019411591565, -104.10792801132301, -119.46049343325446, -98.7459925398839, -72.95007590135621, -134.7712770838048, -127.66224715956176, -104.9857301557685, -110.80928917799952, -87.3538787528114, -104.85344151977573, -99.76325685500974, -79.88006541617705, -119.70371850834601, -87.75503661708159, -120.62659280303244, -83.6883983541963, -90.2256437196166, -99.25224420742319, -118.43325836632464, -102.31106377680848, -123.18347500504491, -120.9416708599062, -117.027008278373, -105.91690294635544, -103.51381328664472, -97.39853612722705, -85.40954183656908, -112.98704526696602, -83.54776636303336, -104.72363158538441, -80.48650062157033, -91.15923745172165, -84.92183139163765, -107.85536147028891, -106.1092724044857, -108.01532635934836, -77.18308442212277, -99.5658217192913, -105.429144295703, -88.66844559451751, -105.25632432739872, -106.74717450599124, -93.24713787307978, -105.51860236068008, -80.85274682837306, -118.68856755295147, -84.24461424998856, -116.56000187537944, -101.98217067477044, -71.26529871672517, -78.78109041943605, -112.75633861562734, -109.43128755094236, -103.24994748049355, -112.99290804542849, -105.96923963363594, -76.46731700440685, -108.7942864982169, -118.97546429885242], "episode_lengths": [1600, 82, 1600, 82, 1600, 40, 1600, 1600, 75, 50, 126, 95, 76, 59, 1600, 51, 196, 73, 84, 65, 61, 1600, 119, 67, 120, 1600, 1600, 1600, 1600, 1600, 1600, 70, 1600, 63, 90, 102, 92, 69, 86, 67, 39, 94, 58, 83, 1600, 1600, 115, 114, 66, 1600, 78, 77, 1600, 85, 1600, 68, 1600, 1600, 103, 65, 69, 81, 103, 69, 79, 67, 79, 1600, 52, 1600, 75, 1600, 1600, 1600, 37, 53, 59, 1600, 62, 67, 1600, 131, 66, 1600, 58, 1600, 72, 1600, 62, 86, 1600, 1600, 58, 55, 73, 59, 133, 1600, 61, 84]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3073458649148106, "mean_inference_ms": 1.0444324553212787, "mean_action_processing_ms": 0.20353325163919167, "mean_env_wait_ms": 0.40610212829125486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00638580322265625, "StateBufferConnector_ms": 0.0049550533294677734, "ViewRequirementAgentConnector_ms": 0.12922883033752441}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 392.0520525881856, "num_env_steps_trained_throughput_per_sec": 392.0520525881856, "timesteps_total": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 10261.635, "restore_workers_time_ms": 0.014, "training_step_time_ms": 10261.595, "sample_time_ms": 4069.294, "load_time_ms": 0.433, "load_throughput": 9238555.066, "learn_time_ms": 6183.542, "learn_throughput": 646.878, "synch_weights_time_ms": 7.784}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "episodes_total": 126, "training_iteration": 19, "trial_id": "3adab_00000", "date": "2024-04-27_20-59-48", "timestamp": 1714276788, "time_this_iter_s": 10.207069873809814, "time_total_s": 195.898784160614, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 195.898784160614, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 27.113333333333333, "ram_util_percent": 64.3933333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.117412366629928, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7100764611188913, "policy_loss": -0.027257394568333704, "vf_loss": 0.7344953318517055, "vf_explained_var": 0.2728968259467873, "kl": 0.006307832887544122, "entropy": 5.061159992218018, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 18135.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "sampler_results": {"episode_reward_max": -71.26529871672517, "episode_reward_min": -136.89249106894437, "episode_reward_mean": -103.25447859349146, "episode_len_mean": 595.32, "episode_media": {}, "episodes_this_iter": 3, "episodes_timesteps_total": 59532, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-105.40242999805633, -100.1470335095278, -107.79713709658135, -104.30677952509944, -116.11250780874538, -101.90768641310558, -108.66597388942913, -125.12524251694916, -108.88658591585173, -116.69571974788109, -107.1742698835178, -99.63495288486214, -118.69715090308897, -130.03023884021053, -104.6548820117712, -116.4082717362071, -99.24241344694668, -98.65514017825015, -90.93072269391072, -136.89249106894437, -118.23056261533003, -103.09214078160127, -100.92204699906085, -106.44184091064581, -100.3721384089502, -103.88594947721595, -90.5452398339198, -93.63170284782423, -119.07315398854949, -89.7958205201688, -117.77096657386484, -110.35086590666324, -110.074788587749, -98.94205488882463, -104.82640339145436, -99.52744296496112, -103.51996069358661, -107.09019411591565, -104.10792801132301, -119.46049343325446, -98.7459925398839, -72.95007590135621, -134.7712770838048, -127.66224715956176, -104.9857301557685, -110.80928917799952, -87.3538787528114, -104.85344151977573, -99.76325685500974, -79.88006541617705, -119.70371850834601, -87.75503661708159, -120.62659280303244, -83.6883983541963, -90.2256437196166, -99.25224420742319, -118.43325836632464, -102.31106377680848, -123.18347500504491, -120.9416708599062, -117.027008278373, -105.91690294635544, -103.51381328664472, -97.39853612722705, -85.40954183656908, -112.98704526696602, -83.54776636303336, -104.72363158538441, -80.48650062157033, -91.15923745172165, -84.92183139163765, -107.85536147028891, -106.1092724044857, -108.01532635934836, -77.18308442212277, -99.5658217192913, -105.429144295703, -88.66844559451751, -105.25632432739872, -106.74717450599124, -93.24713787307978, -105.51860236068008, -80.85274682837306, -118.68856755295147, -84.24461424998856, -116.56000187537944, -101.98217067477044, -71.26529871672517, -78.78109041943605, -112.75633861562734, -109.43128755094236, -103.24994748049355, -112.99290804542849, -105.96923963363594, -76.46731700440685, -108.7942864982169, -118.97546429885242, -81.05416561234928, -77.83110057242152, -107.93812143102848], "episode_lengths": [82, 1600, 40, 1600, 1600, 75, 50, 126, 95, 76, 59, 1600, 51, 196, 73, 84, 65, 61, 1600, 119, 67, 120, 1600, 1600, 1600, 1600, 1600, 1600, 70, 1600, 63, 90, 102, 92, 69, 86, 67, 39, 94, 58, 83, 1600, 1600, 115, 114, 66, 1600, 78, 77, 1600, 85, 1600, 68, 1600, 1600, 103, 65, 69, 81, 103, 69, 79, 67, 79, 1600, 52, 1600, 75, 1600, 1600, 1600, 37, 53, 59, 1600, 62, 67, 1600, 131, 66, 1600, 58, 1600, 72, 1600, 62, 86, 1600, 1600, 58, 55, 73, 59, 133, 1600, 61, 84, 1600, 1600, 59]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3076175443685111, "mean_inference_ms": 1.044574106638453, "mean_action_processing_ms": 0.20362600284976928, "mean_env_wait_ms": 0.40636868087306816, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0062639713287353516, "StateBufferConnector_ms": 0.0049326419830322266, "ViewRequirementAgentConnector_ms": 0.12852263450622559}}, "episode_reward_max": -71.26529871672517, "episode_reward_min": -136.89249106894437, "episode_reward_mean": -103.25447859349146, "episode_len_mean": 595.32, "episodes_this_iter": 3, "episodes_timesteps_total": 59532, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-105.40242999805633, -100.1470335095278, -107.79713709658135, -104.30677952509944, -116.11250780874538, -101.90768641310558, -108.66597388942913, -125.12524251694916, -108.88658591585173, -116.69571974788109, -107.1742698835178, -99.63495288486214, -118.69715090308897, -130.03023884021053, -104.6548820117712, -116.4082717362071, -99.24241344694668, -98.65514017825015, -90.93072269391072, -136.89249106894437, -118.23056261533003, -103.09214078160127, -100.92204699906085, -106.44184091064581, -100.3721384089502, -103.88594947721595, -90.5452398339198, -93.63170284782423, -119.07315398854949, -89.7958205201688, -117.77096657386484, -110.35086590666324, -110.074788587749, -98.94205488882463, -104.82640339145436, -99.52744296496112, -103.51996069358661, -107.09019411591565, -104.10792801132301, -119.46049343325446, -98.7459925398839, -72.95007590135621, -134.7712770838048, -127.66224715956176, -104.9857301557685, -110.80928917799952, -87.3538787528114, -104.85344151977573, -99.76325685500974, -79.88006541617705, -119.70371850834601, -87.75503661708159, -120.62659280303244, -83.6883983541963, -90.2256437196166, -99.25224420742319, -118.43325836632464, -102.31106377680848, -123.18347500504491, -120.9416708599062, -117.027008278373, -105.91690294635544, -103.51381328664472, -97.39853612722705, -85.40954183656908, -112.98704526696602, -83.54776636303336, -104.72363158538441, -80.48650062157033, -91.15923745172165, -84.92183139163765, -107.85536147028891, -106.1092724044857, -108.01532635934836, -77.18308442212277, -99.5658217192913, -105.429144295703, -88.66844559451751, -105.25632432739872, -106.74717450599124, -93.24713787307978, -105.51860236068008, -80.85274682837306, -118.68856755295147, -84.24461424998856, -116.56000187537944, -101.98217067477044, -71.26529871672517, -78.78109041943605, -112.75633861562734, -109.43128755094236, -103.24994748049355, -112.99290804542849, -105.96923963363594, -76.46731700440685, -108.7942864982169, -118.97546429885242, -81.05416561234928, -77.83110057242152, -107.93812143102848], "episode_lengths": [82, 1600, 40, 1600, 1600, 75, 50, 126, 95, 76, 59, 1600, 51, 196, 73, 84, 65, 61, 1600, 119, 67, 120, 1600, 1600, 1600, 1600, 1600, 1600, 70, 1600, 63, 90, 102, 92, 69, 86, 67, 39, 94, 58, 83, 1600, 1600, 115, 114, 66, 1600, 78, 77, 1600, 85, 1600, 68, 1600, 1600, 103, 65, 69, 81, 103, 69, 79, 67, 79, 1600, 52, 1600, 75, 1600, 1600, 1600, 37, 53, 59, 1600, 62, 67, 1600, 131, 66, 1600, 58, 1600, 72, 1600, 62, 86, 1600, 1600, 58, 55, 73, 59, 133, 1600, 61, 84, 1600, 1600, 59]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3076175443685111, "mean_inference_ms": 1.044574106638453, "mean_action_processing_ms": 0.20362600284976928, "mean_env_wait_ms": 0.40636868087306816, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0062639713287353516, "StateBufferConnector_ms": 0.0049326419830322266, "ViewRequirementAgentConnector_ms": 0.12852263450622559}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 390.91793091622856, "num_env_steps_trained_throughput_per_sec": 390.91793091622856, "timesteps_total": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 10239.967, "restore_workers_time_ms": 0.014, "training_step_time_ms": 10239.927, "sample_time_ms": 4015.555, "load_time_ms": 0.428, "load_throughput": 9344556.088, "learn_time_ms": 6215.68, "learn_throughput": 643.534, "synch_weights_time_ms": 7.733}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "episodes_total": 129, "training_iteration": 20, "trial_id": "3adab_00000", "date": "2024-04-27_20-59-58", "timestamp": 1714276798, "time_this_iter_s": 10.237457275390625, "time_total_s": 206.13624143600464, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 206.13624143600464, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 27.571428571428573, "ram_util_percent": 65.11428571428573}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.965636940284442, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8817004116148167, "policy_loss": -0.0356338338585951, "vf_loss": 0.9125040647403527, "vf_explained_var": 0.23406432963186694, "kl": 0.010733733390138587, "entropy": 5.194262241035379, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 19065.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": -69.52141114787885, "episode_reward_min": -136.89249106894437, "episode_reward_mean": -102.17251198069724, "episode_len_mean": 611.05, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 61105, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-108.66597388942913, -125.12524251694916, -108.88658591585173, -116.69571974788109, -107.1742698835178, -99.63495288486214, -118.69715090308897, -130.03023884021053, -104.6548820117712, -116.4082717362071, -99.24241344694668, -98.65514017825015, -90.93072269391072, -136.89249106894437, -118.23056261533003, -103.09214078160127, -100.92204699906085, -106.44184091064581, -100.3721384089502, -103.88594947721595, -90.5452398339198, -93.63170284782423, -119.07315398854949, -89.7958205201688, -117.77096657386484, -110.35086590666324, -110.074788587749, -98.94205488882463, -104.82640339145436, -99.52744296496112, -103.51996069358661, -107.09019411591565, -104.10792801132301, -119.46049343325446, -98.7459925398839, -72.95007590135621, -134.7712770838048, -127.66224715956176, -104.9857301557685, -110.80928917799952, -87.3538787528114, -104.85344151977573, -99.76325685500974, -79.88006541617705, -119.70371850834601, -87.75503661708159, -120.62659280303244, -83.6883983541963, -90.2256437196166, -99.25224420742319, -118.43325836632464, -102.31106377680848, -123.18347500504491, -120.9416708599062, -117.027008278373, -105.91690294635544, -103.51381328664472, -97.39853612722705, -85.40954183656908, -112.98704526696602, -83.54776636303336, -104.72363158538441, -80.48650062157033, -91.15923745172165, -84.92183139163765, -107.85536147028891, -106.1092724044857, -108.01532635934836, -77.18308442212277, -99.5658217192913, -105.429144295703, -88.66844559451751, -105.25632432739872, -106.74717450599124, -93.24713787307978, -105.51860236068008, -80.85274682837306, -118.68856755295147, -84.24461424998856, -116.56000187537944, -101.98217067477044, -71.26529871672517, -78.78109041943605, -112.75633861562734, -109.43128755094236, -103.24994748049355, -112.99290804542849, -105.96923963363594, -76.46731700440685, -108.7942864982169, -118.97546429885242, -81.05416561234928, -77.83110057242152, -107.93812143102848, -82.89086930759667, -109.03681230851946, -69.52141114787885, -72.50737878015704, -112.08429406063321, -81.43614746691026], "episode_lengths": [50, 126, 95, 76, 59, 1600, 51, 196, 73, 84, 65, 61, 1600, 119, 67, 120, 1600, 1600, 1600, 1600, 1600, 1600, 70, 1600, 63, 90, 102, 92, 69, 86, 67, 39, 94, 58, 83, 1600, 1600, 115, 114, 66, 1600, 78, 77, 1600, 85, 1600, 68, 1600, 1600, 103, 65, 69, 81, 103, 69, 79, 67, 79, 1600, 52, 1600, 75, 1600, 1600, 1600, 37, 53, 59, 1600, 62, 67, 1600, 131, 66, 1600, 58, 1600, 72, 1600, 62, 86, 1600, 1600, 58, 55, 73, 59, 133, 1600, 61, 84, 1600, 1600, 59, 1600, 70, 1600, 1600, 100, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3081091512196756, "mean_inference_ms": 1.0453605329719045, "mean_action_processing_ms": 0.2038409762565845, "mean_env_wait_ms": 0.4069361426108226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00628662109375, "StateBufferConnector_ms": 0.0049555301666259766, "ViewRequirementAgentConnector_ms": 0.12940406799316406}}, "episode_reward_max": -69.52141114787885, "episode_reward_min": -136.89249106894437, "episode_reward_mean": -102.17251198069724, "episode_len_mean": 611.05, "episodes_this_iter": 6, "episodes_timesteps_total": 61105, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-108.66597388942913, -125.12524251694916, -108.88658591585173, -116.69571974788109, -107.1742698835178, -99.63495288486214, -118.69715090308897, -130.03023884021053, -104.6548820117712, -116.4082717362071, -99.24241344694668, -98.65514017825015, -90.93072269391072, -136.89249106894437, -118.23056261533003, -103.09214078160127, -100.92204699906085, -106.44184091064581, -100.3721384089502, -103.88594947721595, -90.5452398339198, -93.63170284782423, -119.07315398854949, -89.7958205201688, -117.77096657386484, -110.35086590666324, -110.074788587749, -98.94205488882463, -104.82640339145436, -99.52744296496112, -103.51996069358661, -107.09019411591565, -104.10792801132301, -119.46049343325446, -98.7459925398839, -72.95007590135621, -134.7712770838048, -127.66224715956176, -104.9857301557685, -110.80928917799952, -87.3538787528114, -104.85344151977573, -99.76325685500974, -79.88006541617705, -119.70371850834601, -87.75503661708159, -120.62659280303244, -83.6883983541963, -90.2256437196166, -99.25224420742319, -118.43325836632464, -102.31106377680848, -123.18347500504491, -120.9416708599062, -117.027008278373, -105.91690294635544, -103.51381328664472, -97.39853612722705, -85.40954183656908, -112.98704526696602, -83.54776636303336, -104.72363158538441, -80.48650062157033, -91.15923745172165, -84.92183139163765, -107.85536147028891, -106.1092724044857, -108.01532635934836, -77.18308442212277, -99.5658217192913, -105.429144295703, -88.66844559451751, -105.25632432739872, -106.74717450599124, -93.24713787307978, -105.51860236068008, -80.85274682837306, -118.68856755295147, -84.24461424998856, -116.56000187537944, -101.98217067477044, -71.26529871672517, -78.78109041943605, -112.75633861562734, -109.43128755094236, -103.24994748049355, -112.99290804542849, -105.96923963363594, -76.46731700440685, -108.7942864982169, -118.97546429885242, -81.05416561234928, -77.83110057242152, -107.93812143102848, -82.89086930759667, -109.03681230851946, -69.52141114787885, -72.50737878015704, -112.08429406063321, -81.43614746691026], "episode_lengths": [50, 126, 95, 76, 59, 1600, 51, 196, 73, 84, 65, 61, 1600, 119, 67, 120, 1600, 1600, 1600, 1600, 1600, 1600, 70, 1600, 63, 90, 102, 92, 69, 86, 67, 39, 94, 58, 83, 1600, 1600, 115, 114, 66, 1600, 78, 77, 1600, 85, 1600, 68, 1600, 1600, 103, 65, 69, 81, 103, 69, 79, 67, 79, 1600, 52, 1600, 75, 1600, 1600, 1600, 37, 53, 59, 1600, 62, 67, 1600, 131, 66, 1600, 58, 1600, 72, 1600, 62, 86, 1600, 1600, 58, 55, 73, 59, 133, 1600, 61, 84, 1600, 1600, 59, 1600, 70, 1600, 1600, 100, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3081091512196756, "mean_inference_ms": 1.0453605329719045, "mean_action_processing_ms": 0.2038409762565845, "mean_env_wait_ms": 0.4069361426108226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00628662109375, "StateBufferConnector_ms": 0.0049555301666259766, "ViewRequirementAgentConnector_ms": 0.12940406799316406}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 404.3063116470625, "num_env_steps_trained_throughput_per_sec": 404.3063116470625, "timesteps_total": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 10107.66, "restore_workers_time_ms": 0.014, "training_step_time_ms": 10107.621, "sample_time_ms": 3938.735, "load_time_ms": 0.446, "load_throughput": 8961230.638, "learn_time_ms": 6160.172, "learn_throughput": 649.333, "synch_weights_time_ms": 7.731}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 135, "training_iteration": 21, "trial_id": "3adab_00000", "date": "2024-04-27_21-00-08", "timestamp": 1714276808, "time_this_iter_s": 9.89734411239624, "time_total_s": 216.03358554840088, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 216.03358554840088, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 27.25714285714286, "ram_util_percent": 64.57142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.819271475461221, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4056035270217195, "policy_loss": -0.04132663413722028, "vf_loss": 1.4396833778148697, "vf_explained_var": 0.3685640234460113, "kl": 0.016103979945210223, "entropy": 5.3794743876303395, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 19995.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "sampler_results": {"episode_reward_max": -69.52141114787885, "episode_reward_min": -136.89249106894437, "episode_reward_mean": -101.71167240034362, "episode_len_mean": 641.71, "episode_media": {}, "episodes_this_iter": 5, "episodes_timesteps_total": 64171, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-99.63495288486214, -118.69715090308897, -130.03023884021053, -104.6548820117712, -116.4082717362071, -99.24241344694668, -98.65514017825015, -90.93072269391072, -136.89249106894437, -118.23056261533003, -103.09214078160127, -100.92204699906085, -106.44184091064581, -100.3721384089502, -103.88594947721595, -90.5452398339198, -93.63170284782423, -119.07315398854949, -89.7958205201688, -117.77096657386484, -110.35086590666324, -110.074788587749, -98.94205488882463, -104.82640339145436, -99.52744296496112, -103.51996069358661, -107.09019411591565, -104.10792801132301, -119.46049343325446, -98.7459925398839, -72.95007590135621, -134.7712770838048, -127.66224715956176, -104.9857301557685, -110.80928917799952, -87.3538787528114, -104.85344151977573, -99.76325685500974, -79.88006541617705, -119.70371850834601, -87.75503661708159, -120.62659280303244, -83.6883983541963, -90.2256437196166, -99.25224420742319, -118.43325836632464, -102.31106377680848, -123.18347500504491, -120.9416708599062, -117.027008278373, -105.91690294635544, -103.51381328664472, -97.39853612722705, -85.40954183656908, -112.98704526696602, -83.54776636303336, -104.72363158538441, -80.48650062157033, -91.15923745172165, -84.92183139163765, -107.85536147028891, -106.1092724044857, -108.01532635934836, -77.18308442212277, -99.5658217192913, -105.429144295703, -88.66844559451751, -105.25632432739872, -106.74717450599124, -93.24713787307978, -105.51860236068008, -80.85274682837306, -118.68856755295147, -84.24461424998856, -116.56000187537944, -101.98217067477044, -71.26529871672517, -78.78109041943605, -112.75633861562734, -109.43128755094236, -103.24994748049355, -112.99290804542849, -105.96923963363594, -76.46731700440685, -108.7942864982169, -118.97546429885242, -81.05416561234928, -77.83110057242152, -107.93812143102848, -82.89086930759667, -109.03681230851946, -69.52141114787885, -72.50737878015704, -112.08429406063321, -81.43614746691026, -118.8871700998017, -109.83777954607085, -128.94618830001167, -81.30066009587483, -81.49203587650628], "episode_lengths": [1600, 51, 196, 73, 84, 65, 61, 1600, 119, 67, 120, 1600, 1600, 1600, 1600, 1600, 1600, 70, 1600, 63, 90, 102, 92, 69, 86, 67, 39, 94, 58, 83, 1600, 1600, 115, 114, 66, 1600, 78, 77, 1600, 85, 1600, 68, 1600, 1600, 103, 65, 69, 81, 103, 69, 79, 67, 79, 1600, 52, 1600, 75, 1600, 1600, 1600, 37, 53, 59, 1600, 62, 67, 1600, 131, 66, 1600, 58, 1600, 72, 1600, 62, 86, 1600, 1600, 58, 55, 73, 59, 133, 1600, 61, 84, 1600, 1600, 59, 1600, 70, 1600, 1600, 100, 1600, 96, 67, 109, 1600, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30833626815054416, "mean_inference_ms": 1.046099454180923, "mean_action_processing_ms": 0.20397086113454446, "mean_env_wait_ms": 0.4073200056924955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00629734992980957, "StateBufferConnector_ms": 0.004941225051879883, "ViewRequirementAgentConnector_ms": 0.1296219825744629}}, "episode_reward_max": -69.52141114787885, "episode_reward_min": -136.89249106894437, "episode_reward_mean": -101.71167240034362, "episode_len_mean": 641.71, "episodes_this_iter": 5, "episodes_timesteps_total": 64171, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-99.63495288486214, -118.69715090308897, -130.03023884021053, -104.6548820117712, -116.4082717362071, -99.24241344694668, -98.65514017825015, -90.93072269391072, -136.89249106894437, -118.23056261533003, -103.09214078160127, -100.92204699906085, -106.44184091064581, -100.3721384089502, -103.88594947721595, -90.5452398339198, -93.63170284782423, -119.07315398854949, -89.7958205201688, -117.77096657386484, -110.35086590666324, -110.074788587749, -98.94205488882463, -104.82640339145436, -99.52744296496112, -103.51996069358661, -107.09019411591565, -104.10792801132301, -119.46049343325446, -98.7459925398839, -72.95007590135621, -134.7712770838048, -127.66224715956176, -104.9857301557685, -110.80928917799952, -87.3538787528114, -104.85344151977573, -99.76325685500974, -79.88006541617705, -119.70371850834601, -87.75503661708159, -120.62659280303244, -83.6883983541963, -90.2256437196166, -99.25224420742319, -118.43325836632464, -102.31106377680848, -123.18347500504491, -120.9416708599062, -117.027008278373, -105.91690294635544, -103.51381328664472, -97.39853612722705, -85.40954183656908, -112.98704526696602, -83.54776636303336, -104.72363158538441, -80.48650062157033, -91.15923745172165, -84.92183139163765, -107.85536147028891, -106.1092724044857, -108.01532635934836, -77.18308442212277, -99.5658217192913, -105.429144295703, -88.66844559451751, -105.25632432739872, -106.74717450599124, -93.24713787307978, -105.51860236068008, -80.85274682837306, -118.68856755295147, -84.24461424998856, -116.56000187537944, -101.98217067477044, -71.26529871672517, -78.78109041943605, -112.75633861562734, -109.43128755094236, -103.24994748049355, -112.99290804542849, -105.96923963363594, -76.46731700440685, -108.7942864982169, -118.97546429885242, -81.05416561234928, -77.83110057242152, -107.93812143102848, -82.89086930759667, -109.03681230851946, -69.52141114787885, -72.50737878015704, -112.08429406063321, -81.43614746691026, -118.8871700998017, -109.83777954607085, -128.94618830001167, -81.30066009587483, -81.49203587650628], "episode_lengths": [1600, 51, 196, 73, 84, 65, 61, 1600, 119, 67, 120, 1600, 1600, 1600, 1600, 1600, 1600, 70, 1600, 63, 90, 102, 92, 69, 86, 67, 39, 94, 58, 83, 1600, 1600, 115, 114, 66, 1600, 78, 77, 1600, 85, 1600, 68, 1600, 1600, 103, 65, 69, 81, 103, 69, 79, 67, 79, 1600, 52, 1600, 75, 1600, 1600, 1600, 37, 53, 59, 1600, 62, 67, 1600, 131, 66, 1600, 58, 1600, 72, 1600, 62, 86, 1600, 1600, 58, 55, 73, 59, 133, 1600, 61, 84, 1600, 1600, 59, 1600, 70, 1600, 1600, 100, 1600, 96, 67, 109, 1600, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30833626815054416, "mean_inference_ms": 1.046099454180923, "mean_action_processing_ms": 0.20397086113454446, "mean_env_wait_ms": 0.4073200056924955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00629734992980957, "StateBufferConnector_ms": 0.004941225051879883, "ViewRequirementAgentConnector_ms": 0.1296219825744629}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 409.08395098273246, "num_env_steps_trained_throughput_per_sec": 409.08395098273246, "timesteps_total": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 10119.058, "restore_workers_time_ms": 0.012, "training_step_time_ms": 10119.021, "sample_time_ms": 3942.935, "load_time_ms": 0.465, "load_throughput": 8609881.967, "learn_time_ms": 6167.356, "learn_throughput": 648.576, "synch_weights_time_ms": 7.721}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "episodes_total": 140, "training_iteration": 22, "trial_id": "3adab_00000", "date": "2024-04-27_21-00-18", "timestamp": 1714276818, "time_this_iter_s": 9.782972812652588, "time_total_s": 225.81655836105347, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 225.81655836105347, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 24.928571428571427, "ram_util_percent": 64.44285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.785233266891971, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8511883039220227, "policy_loss": -0.033922313169766495, "vf_loss": 1.8787008229122366, "vf_explained_var": 0.2544218450464228, "kl": 0.014244014901370077, "entropy": 5.535556568637971, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 20925.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "sampler_results": {"episode_reward_max": -69.52141114787885, "episode_reward_min": -134.7712770838048, "episode_reward_mean": -101.25048179752368, "episode_len_mean": 641.34, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 64134, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-118.23056261533003, -103.09214078160127, -100.92204699906085, -106.44184091064581, -100.3721384089502, -103.88594947721595, -90.5452398339198, -93.63170284782423, -119.07315398854949, -89.7958205201688, -117.77096657386484, -110.35086590666324, -110.074788587749, -98.94205488882463, -104.82640339145436, -99.52744296496112, -103.51996069358661, -107.09019411591565, -104.10792801132301, -119.46049343325446, -98.7459925398839, -72.95007590135621, -134.7712770838048, -127.66224715956176, -104.9857301557685, -110.80928917799952, -87.3538787528114, -104.85344151977573, -99.76325685500974, -79.88006541617705, -119.70371850834601, -87.75503661708159, -120.62659280303244, -83.6883983541963, -90.2256437196166, -99.25224420742319, -118.43325836632464, -102.31106377680848, -123.18347500504491, -120.9416708599062, -117.027008278373, -105.91690294635544, -103.51381328664472, -97.39853612722705, -85.40954183656908, -112.98704526696602, -83.54776636303336, -104.72363158538441, -80.48650062157033, -91.15923745172165, -84.92183139163765, -107.85536147028891, -106.1092724044857, -108.01532635934836, -77.18308442212277, -99.5658217192913, -105.429144295703, -88.66844559451751, -105.25632432739872, -106.74717450599124, -93.24713787307978, -105.51860236068008, -80.85274682837306, -118.68856755295147, -84.24461424998856, -116.56000187537944, -101.98217067477044, -71.26529871672517, -78.78109041943605, -112.75633861562734, -109.43128755094236, -103.24994748049355, -112.99290804542849, -105.96923963363594, -76.46731700440685, -108.7942864982169, -118.97546429885242, -81.05416561234928, -77.83110057242152, -107.93812143102848, -82.89086930759667, -109.03681230851946, -69.52141114787885, -72.50737878015704, -112.08429406063321, -81.43614746691026, -118.8871700998017, -109.83777954607085, -128.94618830001167, -81.30066009587483, -81.49203587650628, -81.62774269316093, -117.3166355107464, -108.00228525346517, -113.13156669907644, -114.00806307334143, -71.22929265460445, -107.73463703757275, -116.69740058917552, -119.27957997105395], "episode_lengths": [67, 120, 1600, 1600, 1600, 1600, 1600, 1600, 70, 1600, 63, 90, 102, 92, 69, 86, 67, 39, 94, 58, 83, 1600, 1600, 115, 114, 66, 1600, 78, 77, 1600, 85, 1600, 68, 1600, 1600, 103, 65, 69, 81, 103, 69, 79, 67, 79, 1600, 52, 1600, 75, 1600, 1600, 1600, 37, 53, 59, 1600, 62, 67, 1600, 131, 66, 1600, 58, 1600, 72, 1600, 62, 86, 1600, 1600, 58, 55, 73, 59, 133, 1600, 61, 84, 1600, 1600, 59, 1600, 70, 1600, 1600, 100, 1600, 96, 67, 109, 1600, 1600, 1600, 90, 93, 59, 126, 1600, 59, 64, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30892082982500063, "mean_inference_ms": 1.0467262710146497, "mean_action_processing_ms": 0.20422208576273104, "mean_env_wait_ms": 0.4081383334698476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0062618255615234375, "StateBufferConnector_ms": 0.0049591064453125, "ViewRequirementAgentConnector_ms": 0.12992572784423828}}, "episode_reward_max": -69.52141114787885, "episode_reward_min": -134.7712770838048, "episode_reward_mean": -101.25048179752368, "episode_len_mean": 641.34, "episodes_this_iter": 9, "episodes_timesteps_total": 64134, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-118.23056261533003, -103.09214078160127, -100.92204699906085, -106.44184091064581, -100.3721384089502, -103.88594947721595, -90.5452398339198, -93.63170284782423, -119.07315398854949, -89.7958205201688, -117.77096657386484, -110.35086590666324, -110.074788587749, -98.94205488882463, -104.82640339145436, -99.52744296496112, -103.51996069358661, -107.09019411591565, -104.10792801132301, -119.46049343325446, -98.7459925398839, -72.95007590135621, -134.7712770838048, -127.66224715956176, -104.9857301557685, -110.80928917799952, -87.3538787528114, -104.85344151977573, -99.76325685500974, -79.88006541617705, -119.70371850834601, -87.75503661708159, -120.62659280303244, -83.6883983541963, -90.2256437196166, -99.25224420742319, -118.43325836632464, -102.31106377680848, -123.18347500504491, -120.9416708599062, -117.027008278373, -105.91690294635544, -103.51381328664472, -97.39853612722705, -85.40954183656908, -112.98704526696602, -83.54776636303336, -104.72363158538441, -80.48650062157033, -91.15923745172165, -84.92183139163765, -107.85536147028891, -106.1092724044857, -108.01532635934836, -77.18308442212277, -99.5658217192913, -105.429144295703, -88.66844559451751, -105.25632432739872, -106.74717450599124, -93.24713787307978, -105.51860236068008, -80.85274682837306, -118.68856755295147, -84.24461424998856, -116.56000187537944, -101.98217067477044, -71.26529871672517, -78.78109041943605, -112.75633861562734, -109.43128755094236, -103.24994748049355, -112.99290804542849, -105.96923963363594, -76.46731700440685, -108.7942864982169, -118.97546429885242, -81.05416561234928, -77.83110057242152, -107.93812143102848, -82.89086930759667, -109.03681230851946, -69.52141114787885, -72.50737878015704, -112.08429406063321, -81.43614746691026, -118.8871700998017, -109.83777954607085, -128.94618830001167, -81.30066009587483, -81.49203587650628, -81.62774269316093, -117.3166355107464, -108.00228525346517, -113.13156669907644, -114.00806307334143, -71.22929265460445, -107.73463703757275, -116.69740058917552, -119.27957997105395], "episode_lengths": [67, 120, 1600, 1600, 1600, 1600, 1600, 1600, 70, 1600, 63, 90, 102, 92, 69, 86, 67, 39, 94, 58, 83, 1600, 1600, 115, 114, 66, 1600, 78, 77, 1600, 85, 1600, 68, 1600, 1600, 103, 65, 69, 81, 103, 69, 79, 67, 79, 1600, 52, 1600, 75, 1600, 1600, 1600, 37, 53, 59, 1600, 62, 67, 1600, 131, 66, 1600, 58, 1600, 72, 1600, 62, 86, 1600, 1600, 58, 55, 73, 59, 133, 1600, 61, 84, 1600, 1600, 59, 1600, 70, 1600, 1600, 100, 1600, 96, 67, 109, 1600, 1600, 1600, 90, 93, 59, 126, 1600, 59, 64, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30892082982500063, "mean_inference_ms": 1.0467262710146497, "mean_action_processing_ms": 0.20422208576273104, "mean_env_wait_ms": 0.4081383334698476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0062618255615234375, "StateBufferConnector_ms": 0.0049591064453125, "ViewRequirementAgentConnector_ms": 0.12992572784423828}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 419.4605277524058, "num_env_steps_trained_throughput_per_sec": 419.4605277524058, "timesteps_total": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 9874.708, "restore_workers_time_ms": 0.012, "training_step_time_ms": 9874.675, "sample_time_ms": 3810.781, "load_time_ms": 0.479, "load_throughput": 8347288.92, "learn_time_ms": 6055.292, "learn_throughput": 660.579, "synch_weights_time_ms": 7.563}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "episodes_total": 149, "training_iteration": 23, "trial_id": "3adab_00000", "date": "2024-04-27_21-00-28", "timestamp": 1714276828, "time_this_iter_s": 9.540010929107666, "time_total_s": 235.35656929016113, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 235.35656929016113, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 24.192857142857147, "ram_util_percent": 64.32857142857145}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.632018739465744, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5842497991022444, "policy_loss": -0.030417967219186087, "vf_loss": 0.6106702356449057, "vf_explained_var": 0.2936616696978128, "kl": 0.008883400590995228, "entropy": 5.086244280620288, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 21855.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "sampler_results": {"episode_reward_max": -69.52141114787885, "episode_reward_min": -134.7712770838048, "episode_reward_mean": -100.72717074513236, "episode_len_mean": 640.85, "episode_media": {}, "episodes_this_iter": 4, "episodes_timesteps_total": 64085, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-100.3721384089502, -103.88594947721595, -90.5452398339198, -93.63170284782423, -119.07315398854949, -89.7958205201688, -117.77096657386484, -110.35086590666324, -110.074788587749, -98.94205488882463, -104.82640339145436, -99.52744296496112, -103.51996069358661, -107.09019411591565, -104.10792801132301, -119.46049343325446, -98.7459925398839, -72.95007590135621, -134.7712770838048, -127.66224715956176, -104.9857301557685, -110.80928917799952, -87.3538787528114, -104.85344151977573, -99.76325685500974, -79.88006541617705, -119.70371850834601, -87.75503661708159, -120.62659280303244, -83.6883983541963, -90.2256437196166, -99.25224420742319, -118.43325836632464, -102.31106377680848, -123.18347500504491, -120.9416708599062, -117.027008278373, -105.91690294635544, -103.51381328664472, -97.39853612722705, -85.40954183656908, -112.98704526696602, -83.54776636303336, -104.72363158538441, -80.48650062157033, -91.15923745172165, -84.92183139163765, -107.85536147028891, -106.1092724044857, -108.01532635934836, -77.18308442212277, -99.5658217192913, -105.429144295703, -88.66844559451751, -105.25632432739872, -106.74717450599124, -93.24713787307978, -105.51860236068008, -80.85274682837306, -118.68856755295147, -84.24461424998856, -116.56000187537944, -101.98217067477044, -71.26529871672517, -78.78109041943605, -112.75633861562734, -109.43128755094236, -103.24994748049355, -112.99290804542849, -105.96923963363594, -76.46731700440685, -108.7942864982169, -118.97546429885242, -81.05416561234928, -77.83110057242152, -107.93812143102848, -82.89086930759667, -109.03681230851946, -69.52141114787885, -72.50737878015704, -112.08429406063321, -81.43614746691026, -118.8871700998017, -109.83777954607085, -128.94618830001167, -81.30066009587483, -81.49203587650628, -81.62774269316093, -117.3166355107464, -108.00228525346517, -113.13156669907644, -114.00806307334143, -71.22929265460445, -107.73463703757275, -116.69740058917552, -119.27957997105395, -79.98841153322657, -109.62537531947096, -76.06046804029931, -110.68123117450997], "episode_lengths": [1600, 1600, 1600, 1600, 70, 1600, 63, 90, 102, 92, 69, 86, 67, 39, 94, 58, 83, 1600, 1600, 115, 114, 66, 1600, 78, 77, 1600, 85, 1600, 68, 1600, 1600, 103, 65, 69, 81, 103, 69, 79, 67, 79, 1600, 52, 1600, 75, 1600, 1600, 1600, 37, 53, 59, 1600, 62, 67, 1600, 131, 66, 1600, 58, 1600, 72, 1600, 62, 86, 1600, 1600, 58, 55, 73, 59, 133, 1600, 61, 84, 1600, 1600, 59, 1600, 70, 1600, 1600, 100, 1600, 96, 67, 109, 1600, 1600, 1600, 90, 93, 59, 126, 1600, 59, 64, 121, 1600, 78, 1600, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30902040398618896, "mean_inference_ms": 1.046806805883807, "mean_action_processing_ms": 0.20425795617974868, "mean_env_wait_ms": 0.40836345103712013, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006249427795410156, "StateBufferConnector_ms": 0.004975080490112305, "ViewRequirementAgentConnector_ms": 0.12949490547180176}}, "episode_reward_max": -69.52141114787885, "episode_reward_min": -134.7712770838048, "episode_reward_mean": -100.72717074513236, "episode_len_mean": 640.85, "episodes_this_iter": 4, "episodes_timesteps_total": 64085, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-100.3721384089502, -103.88594947721595, -90.5452398339198, -93.63170284782423, -119.07315398854949, -89.7958205201688, -117.77096657386484, -110.35086590666324, -110.074788587749, -98.94205488882463, -104.82640339145436, -99.52744296496112, -103.51996069358661, -107.09019411591565, -104.10792801132301, -119.46049343325446, -98.7459925398839, -72.95007590135621, -134.7712770838048, -127.66224715956176, -104.9857301557685, -110.80928917799952, -87.3538787528114, -104.85344151977573, -99.76325685500974, -79.88006541617705, -119.70371850834601, -87.75503661708159, -120.62659280303244, -83.6883983541963, -90.2256437196166, -99.25224420742319, -118.43325836632464, -102.31106377680848, -123.18347500504491, -120.9416708599062, -117.027008278373, -105.91690294635544, -103.51381328664472, -97.39853612722705, -85.40954183656908, -112.98704526696602, -83.54776636303336, -104.72363158538441, -80.48650062157033, -91.15923745172165, -84.92183139163765, -107.85536147028891, -106.1092724044857, -108.01532635934836, -77.18308442212277, -99.5658217192913, -105.429144295703, -88.66844559451751, -105.25632432739872, -106.74717450599124, -93.24713787307978, -105.51860236068008, -80.85274682837306, -118.68856755295147, -84.24461424998856, -116.56000187537944, -101.98217067477044, -71.26529871672517, -78.78109041943605, -112.75633861562734, -109.43128755094236, -103.24994748049355, -112.99290804542849, -105.96923963363594, -76.46731700440685, -108.7942864982169, -118.97546429885242, -81.05416561234928, -77.83110057242152, -107.93812143102848, -82.89086930759667, -109.03681230851946, -69.52141114787885, -72.50737878015704, -112.08429406063321, -81.43614746691026, -118.8871700998017, -109.83777954607085, -128.94618830001167, -81.30066009587483, -81.49203587650628, -81.62774269316093, -117.3166355107464, -108.00228525346517, -113.13156669907644, -114.00806307334143, -71.22929265460445, -107.73463703757275, -116.69740058917552, -119.27957997105395, -79.98841153322657, -109.62537531947096, -76.06046804029931, -110.68123117450997], "episode_lengths": [1600, 1600, 1600, 1600, 70, 1600, 63, 90, 102, 92, 69, 86, 67, 39, 94, 58, 83, 1600, 1600, 115, 114, 66, 1600, 78, 77, 1600, 85, 1600, 68, 1600, 1600, 103, 65, 69, 81, 103, 69, 79, 67, 79, 1600, 52, 1600, 75, 1600, 1600, 1600, 37, 53, 59, 1600, 62, 67, 1600, 131, 66, 1600, 58, 1600, 72, 1600, 62, 86, 1600, 1600, 58, 55, 73, 59, 133, 1600, 61, 84, 1600, 1600, 59, 1600, 70, 1600, 1600, 100, 1600, 96, 67, 109, 1600, 1600, 1600, 90, 93, 59, 126, 1600, 59, 64, 121, 1600, 78, 1600, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30902040398618896, "mean_inference_ms": 1.046806805883807, "mean_action_processing_ms": 0.20425795617974868, "mean_env_wait_ms": 0.40836345103712013, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006249427795410156, "StateBufferConnector_ms": 0.004975080490112305, "ViewRequirementAgentConnector_ms": 0.12949490547180176}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 424.5507043839907, "num_env_steps_trained_throughput_per_sec": 424.5507043839907, "timesteps_total": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 9784.843, "restore_workers_time_ms": 0.012, "training_step_time_ms": 9784.811, "sample_time_ms": 3735.759, "load_time_ms": 0.471, "load_throughput": 8498665.721, "learn_time_ms": 6040.625, "learn_throughput": 662.183, "synch_weights_time_ms": 7.405}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 153, "training_iteration": 24, "trial_id": "3adab_00000", "date": "2024-04-27_21-00-37", "timestamp": 1714276837, "time_this_iter_s": 9.425745964050293, "time_total_s": 244.78231525421143, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 244.78231525421143, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 23.623076923076926, "ram_util_percent": 64.20000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.106201158928615, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3656943483578582, "policy_loss": -0.019663286563109166, "vf_loss": 0.38017842932253754, "vf_explained_var": 0.3638812693216467, "kl": 0.011509346089955535, "entropy": 4.74196973359713, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 22785.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "sampler_results": {"episode_reward_max": -69.52141114787885, "episode_reward_min": -134.7712770838048, "episode_reward_mean": -100.24451909779303, "episode_len_mean": 640.85, "episode_media": {}, "episodes_this_iter": 2, "episodes_timesteps_total": 64085, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-90.5452398339198, -93.63170284782423, -119.07315398854949, -89.7958205201688, -117.77096657386484, -110.35086590666324, -110.074788587749, -98.94205488882463, -104.82640339145436, -99.52744296496112, -103.51996069358661, -107.09019411591565, -104.10792801132301, -119.46049343325446, -98.7459925398839, -72.95007590135621, -134.7712770838048, -127.66224715956176, -104.9857301557685, -110.80928917799952, -87.3538787528114, -104.85344151977573, -99.76325685500974, -79.88006541617705, -119.70371850834601, -87.75503661708159, -120.62659280303244, -83.6883983541963, -90.2256437196166, -99.25224420742319, -118.43325836632464, -102.31106377680848, -123.18347500504491, -120.9416708599062, -117.027008278373, -105.91690294635544, -103.51381328664472, -97.39853612722705, -85.40954183656908, -112.98704526696602, -83.54776636303336, -104.72363158538441, -80.48650062157033, -91.15923745172165, -84.92183139163765, -107.85536147028891, -106.1092724044857, -108.01532635934836, -77.18308442212277, -99.5658217192913, -105.429144295703, -88.66844559451751, -105.25632432739872, -106.74717450599124, -93.24713787307978, -105.51860236068008, -80.85274682837306, -118.68856755295147, -84.24461424998856, -116.56000187537944, -101.98217067477044, -71.26529871672517, -78.78109041943605, -112.75633861562734, -109.43128755094236, -103.24994748049355, -112.99290804542849, -105.96923963363594, -76.46731700440685, -108.7942864982169, -118.97546429885242, -81.05416561234928, -77.83110057242152, -107.93812143102848, -82.89086930759667, -109.03681230851946, -69.52141114787885, -72.50737878015704, -112.08429406063321, -81.43614746691026, -118.8871700998017, -109.83777954607085, -128.94618830001167, -81.30066009587483, -81.49203587650628, -81.62774269316093, -117.3166355107464, -108.00228525346517, -113.13156669907644, -114.00806307334143, -71.22929265460445, -107.73463703757275, -116.69740058917552, -119.27957997105395, -79.98841153322657, -109.62537531947096, -76.06046804029931, -110.68123117450997, -76.71096933982342, -79.28195381240862], "episode_lengths": [1600, 1600, 70, 1600, 63, 90, 102, 92, 69, 86, 67, 39, 94, 58, 83, 1600, 1600, 115, 114, 66, 1600, 78, 77, 1600, 85, 1600, 68, 1600, 1600, 103, 65, 69, 81, 103, 69, 79, 67, 79, 1600, 52, 1600, 75, 1600, 1600, 1600, 37, 53, 59, 1600, 62, 67, 1600, 131, 66, 1600, 58, 1600, 72, 1600, 62, 86, 1600, 1600, 58, 55, 73, 59, 133, 1600, 61, 84, 1600, 1600, 59, 1600, 70, 1600, 1600, 100, 1600, 96, 67, 109, 1600, 1600, 1600, 90, 93, 59, 126, 1600, 59, 64, 121, 1600, 78, 1600, 60, 1600, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30910393453250956, "mean_inference_ms": 1.0468775899082687, "mean_action_processing_ms": 0.2042826646200646, "mean_env_wait_ms": 0.4084853666574151, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006203651428222656, "StateBufferConnector_ms": 0.004971027374267578, "ViewRequirementAgentConnector_ms": 0.1294689178466797}}, "episode_reward_max": -69.52141114787885, "episode_reward_min": -134.7712770838048, "episode_reward_mean": -100.24451909779303, "episode_len_mean": 640.85, "episodes_this_iter": 2, "episodes_timesteps_total": 64085, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-90.5452398339198, -93.63170284782423, -119.07315398854949, -89.7958205201688, -117.77096657386484, -110.35086590666324, -110.074788587749, -98.94205488882463, -104.82640339145436, -99.52744296496112, -103.51996069358661, -107.09019411591565, -104.10792801132301, -119.46049343325446, -98.7459925398839, -72.95007590135621, -134.7712770838048, -127.66224715956176, -104.9857301557685, -110.80928917799952, -87.3538787528114, -104.85344151977573, -99.76325685500974, -79.88006541617705, -119.70371850834601, -87.75503661708159, -120.62659280303244, -83.6883983541963, -90.2256437196166, -99.25224420742319, -118.43325836632464, -102.31106377680848, -123.18347500504491, -120.9416708599062, -117.027008278373, -105.91690294635544, -103.51381328664472, -97.39853612722705, -85.40954183656908, -112.98704526696602, -83.54776636303336, -104.72363158538441, -80.48650062157033, -91.15923745172165, -84.92183139163765, -107.85536147028891, -106.1092724044857, -108.01532635934836, -77.18308442212277, -99.5658217192913, -105.429144295703, -88.66844559451751, -105.25632432739872, -106.74717450599124, -93.24713787307978, -105.51860236068008, -80.85274682837306, -118.68856755295147, -84.24461424998856, -116.56000187537944, -101.98217067477044, -71.26529871672517, -78.78109041943605, -112.75633861562734, -109.43128755094236, -103.24994748049355, -112.99290804542849, -105.96923963363594, -76.46731700440685, -108.7942864982169, -118.97546429885242, -81.05416561234928, -77.83110057242152, -107.93812143102848, -82.89086930759667, -109.03681230851946, -69.52141114787885, -72.50737878015704, -112.08429406063321, -81.43614746691026, -118.8871700998017, -109.83777954607085, -128.94618830001167, -81.30066009587483, -81.49203587650628, -81.62774269316093, -117.3166355107464, -108.00228525346517, -113.13156669907644, -114.00806307334143, -71.22929265460445, -107.73463703757275, -116.69740058917552, -119.27957997105395, -79.98841153322657, -109.62537531947096, -76.06046804029931, -110.68123117450997, -76.71096933982342, -79.28195381240862], "episode_lengths": [1600, 1600, 70, 1600, 63, 90, 102, 92, 69, 86, 67, 39, 94, 58, 83, 1600, 1600, 115, 114, 66, 1600, 78, 77, 1600, 85, 1600, 68, 1600, 1600, 103, 65, 69, 81, 103, 69, 79, 67, 79, 1600, 52, 1600, 75, 1600, 1600, 1600, 37, 53, 59, 1600, 62, 67, 1600, 131, 66, 1600, 58, 1600, 72, 1600, 62, 86, 1600, 1600, 58, 55, 73, 59, 133, 1600, 61, 84, 1600, 1600, 59, 1600, 70, 1600, 1600, 100, 1600, 96, 67, 109, 1600, 1600, 1600, 90, 93, 59, 126, 1600, 59, 64, 121, 1600, 78, 1600, 60, 1600, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30910393453250956, "mean_inference_ms": 1.0468775899082687, "mean_action_processing_ms": 0.2042826646200646, "mean_env_wait_ms": 0.4084853666574151, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006203651428222656, "StateBufferConnector_ms": 0.004971027374267578, "ViewRequirementAgentConnector_ms": 0.1294689178466797}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 417.6794147992639, "num_env_steps_trained_throughput_per_sec": 417.6794147992639, "timesteps_total": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 9785.604, "restore_workers_time_ms": 0.012, "training_step_time_ms": 9785.571, "sample_time_ms": 3737.985, "load_time_ms": 0.483, "load_throughput": 8287500.494, "learn_time_ms": 6039.076, "learn_throughput": 662.353, "synch_weights_time_ms": 7.464}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "episodes_total": 155, "training_iteration": 25, "trial_id": "3adab_00000", "date": "2024-04-27_21-00-47", "timestamp": 1714276847, "time_this_iter_s": 9.580705165863037, "time_total_s": 254.36302042007446, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 254.36302042007446, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 24.02857142857143, "ram_util_percent": 64.25714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.196916450864526, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9085211259304166, "policy_loss": -0.035733667272393424, "vf_loss": 0.9386630372534837, "vf_explained_var": 0.3027740350974503, "kl": 0.012426118638322334, "entropy": 5.1548934208449495, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 23715.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "sampler_results": {"episode_reward_max": -69.52141114787885, "episode_reward_min": -134.7712770838048, "episode_reward_mean": -99.61376918356537, "episode_len_mean": 640.59, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 64059, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-110.074788587749, -98.94205488882463, -104.82640339145436, -99.52744296496112, -103.51996069358661, -107.09019411591565, -104.10792801132301, -119.46049343325446, -98.7459925398839, -72.95007590135621, -134.7712770838048, -127.66224715956176, -104.9857301557685, -110.80928917799952, -87.3538787528114, -104.85344151977573, -99.76325685500974, -79.88006541617705, -119.70371850834601, -87.75503661708159, -120.62659280303244, -83.6883983541963, -90.2256437196166, -99.25224420742319, -118.43325836632464, -102.31106377680848, -123.18347500504491, -120.9416708599062, -117.027008278373, -105.91690294635544, -103.51381328664472, -97.39853612722705, -85.40954183656908, -112.98704526696602, -83.54776636303336, -104.72363158538441, -80.48650062157033, -91.15923745172165, -84.92183139163765, -107.85536147028891, -106.1092724044857, -108.01532635934836, -77.18308442212277, -99.5658217192913, -105.429144295703, -88.66844559451751, -105.25632432739872, -106.74717450599124, -93.24713787307978, -105.51860236068008, -80.85274682837306, -118.68856755295147, -84.24461424998856, -116.56000187537944, -101.98217067477044, -71.26529871672517, -78.78109041943605, -112.75633861562734, -109.43128755094236, -103.24994748049355, -112.99290804542849, -105.96923963363594, -76.46731700440685, -108.7942864982169, -118.97546429885242, -81.05416561234928, -77.83110057242152, -107.93812143102848, -82.89086930759667, -109.03681230851946, -69.52141114787885, -72.50737878015704, -112.08429406063321, -81.43614746691026, -118.8871700998017, -109.83777954607085, -128.94618830001167, -81.30066009587483, -81.49203587650628, -81.62774269316093, -117.3166355107464, -108.00228525346517, -113.13156669907644, -114.00806307334143, -71.22929265460445, -107.73463703757275, -116.69740058917552, -119.27957997105395, -79.98841153322657, -109.62537531947096, -76.06046804029931, -110.68123117450997, -76.71096933982342, -79.28195381240862, -81.24318097893877, -116.55726958086217, -108.45080520448275, -71.5049330513043, -108.99817510498191, -71.33839432765485], "episode_lengths": [102, 92, 69, 86, 67, 39, 94, 58, 83, 1600, 1600, 115, 114, 66, 1600, 78, 77, 1600, 85, 1600, 68, 1600, 1600, 103, 65, 69, 81, 103, 69, 79, 67, 79, 1600, 52, 1600, 75, 1600, 1600, 1600, 37, 53, 59, 1600, 62, 67, 1600, 131, 66, 1600, 58, 1600, 72, 1600, 62, 86, 1600, 1600, 58, 55, 73, 59, 133, 1600, 61, 84, 1600, 1600, 59, 1600, 70, 1600, 1600, 100, 1600, 96, 67, 109, 1600, 1600, 1600, 90, 93, 59, 126, 1600, 59, 64, 121, 1600, 78, 1600, 60, 1600, 1600, 1600, 74, 59, 1600, 64, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30899586633612486, "mean_inference_ms": 1.045859676442926, "mean_action_processing_ms": 0.20413125488748918, "mean_env_wait_ms": 0.40849058334611493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0060977935791015625, "StateBufferConnector_ms": 0.004877805709838867, "ViewRequirementAgentConnector_ms": 0.12704181671142578}}, "episode_reward_max": -69.52141114787885, "episode_reward_min": -134.7712770838048, "episode_reward_mean": -99.61376918356537, "episode_len_mean": 640.59, "episodes_this_iter": 6, "episodes_timesteps_total": 64059, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-110.074788587749, -98.94205488882463, -104.82640339145436, -99.52744296496112, -103.51996069358661, -107.09019411591565, -104.10792801132301, -119.46049343325446, -98.7459925398839, -72.95007590135621, -134.7712770838048, -127.66224715956176, -104.9857301557685, -110.80928917799952, -87.3538787528114, -104.85344151977573, -99.76325685500974, -79.88006541617705, -119.70371850834601, -87.75503661708159, -120.62659280303244, -83.6883983541963, -90.2256437196166, -99.25224420742319, -118.43325836632464, -102.31106377680848, -123.18347500504491, -120.9416708599062, -117.027008278373, -105.91690294635544, -103.51381328664472, -97.39853612722705, -85.40954183656908, -112.98704526696602, -83.54776636303336, -104.72363158538441, -80.48650062157033, -91.15923745172165, -84.92183139163765, -107.85536147028891, -106.1092724044857, -108.01532635934836, -77.18308442212277, -99.5658217192913, -105.429144295703, -88.66844559451751, -105.25632432739872, -106.74717450599124, -93.24713787307978, -105.51860236068008, -80.85274682837306, -118.68856755295147, -84.24461424998856, -116.56000187537944, -101.98217067477044, -71.26529871672517, -78.78109041943605, -112.75633861562734, -109.43128755094236, -103.24994748049355, -112.99290804542849, -105.96923963363594, -76.46731700440685, -108.7942864982169, -118.97546429885242, -81.05416561234928, -77.83110057242152, -107.93812143102848, -82.89086930759667, -109.03681230851946, -69.52141114787885, -72.50737878015704, -112.08429406063321, -81.43614746691026, -118.8871700998017, -109.83777954607085, -128.94618830001167, -81.30066009587483, -81.49203587650628, -81.62774269316093, -117.3166355107464, -108.00228525346517, -113.13156669907644, -114.00806307334143, -71.22929265460445, -107.73463703757275, -116.69740058917552, -119.27957997105395, -79.98841153322657, -109.62537531947096, -76.06046804029931, -110.68123117450997, -76.71096933982342, -79.28195381240862, -81.24318097893877, -116.55726958086217, -108.45080520448275, -71.5049330513043, -108.99817510498191, -71.33839432765485], "episode_lengths": [102, 92, 69, 86, 67, 39, 94, 58, 83, 1600, 1600, 115, 114, 66, 1600, 78, 77, 1600, 85, 1600, 68, 1600, 1600, 103, 65, 69, 81, 103, 69, 79, 67, 79, 1600, 52, 1600, 75, 1600, 1600, 1600, 37, 53, 59, 1600, 62, 67, 1600, 131, 66, 1600, 58, 1600, 72, 1600, 62, 86, 1600, 1600, 58, 55, 73, 59, 133, 1600, 61, 84, 1600, 1600, 59, 1600, 70, 1600, 1600, 100, 1600, 96, 67, 109, 1600, 1600, 1600, 90, 93, 59, 126, 1600, 59, 64, 121, 1600, 78, 1600, 60, 1600, 1600, 1600, 74, 59, 1600, 64, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30899586633612486, "mean_inference_ms": 1.045859676442926, "mean_action_processing_ms": 0.20413125488748918, "mean_env_wait_ms": 0.40849058334611493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0060977935791015625, "StateBufferConnector_ms": 0.004877805709838867, "ViewRequirementAgentConnector_ms": 0.12704181671142578}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 413.66043671545265, "num_env_steps_trained_throughput_per_sec": 413.66043671545265, "timesteps_total": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 9764.415, "restore_workers_time_ms": 0.012, "training_step_time_ms": 9764.382, "sample_time_ms": 3697.092, "load_time_ms": 0.481, "load_throughput": 8307608.814, "learn_time_ms": 6058.772, "learn_throughput": 660.2, "synch_weights_time_ms": 7.466}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "episodes_total": 161, "training_iteration": 26, "trial_id": "3adab_00000", "date": "2024-04-27_21-00-56", "timestamp": 1714276856, "time_this_iter_s": 9.674978971481323, "time_total_s": 264.0379993915558, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 264.0379993915558, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 26.114285714285717, "ram_util_percent": 64.29285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.456795827099072, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9335480555069573, "policy_loss": -0.030089035728365503, "vf_loss": 0.9593725217125749, "vf_explained_var": 0.38687831823543833, "kl": 0.009476831545405153, "entropy": 5.252132803393948, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 24645.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": -69.52141114787885, "episode_reward_min": -134.7712770838048, "episode_reward_mean": -99.31737146854593, "episode_len_mean": 670.42, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 67042, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-104.10792801132301, -119.46049343325446, -98.7459925398839, -72.95007590135621, -134.7712770838048, -127.66224715956176, -104.9857301557685, -110.80928917799952, -87.3538787528114, -104.85344151977573, -99.76325685500974, -79.88006541617705, -119.70371850834601, -87.75503661708159, -120.62659280303244, -83.6883983541963, -90.2256437196166, -99.25224420742319, -118.43325836632464, -102.31106377680848, -123.18347500504491, -120.9416708599062, -117.027008278373, -105.91690294635544, -103.51381328664472, -97.39853612722705, -85.40954183656908, -112.98704526696602, -83.54776636303336, -104.72363158538441, -80.48650062157033, -91.15923745172165, -84.92183139163765, -107.85536147028891, -106.1092724044857, -108.01532635934836, -77.18308442212277, -99.5658217192913, -105.429144295703, -88.66844559451751, -105.25632432739872, -106.74717450599124, -93.24713787307978, -105.51860236068008, -80.85274682837306, -118.68856755295147, -84.24461424998856, -116.56000187537944, -101.98217067477044, -71.26529871672517, -78.78109041943605, -112.75633861562734, -109.43128755094236, -103.24994748049355, -112.99290804542849, -105.96923963363594, -76.46731700440685, -108.7942864982169, -118.97546429885242, -81.05416561234928, -77.83110057242152, -107.93812143102848, -82.89086930759667, -109.03681230851946, -69.52141114787885, -72.50737878015704, -112.08429406063321, -81.43614746691026, -118.8871700998017, -109.83777954607085, -128.94618830001167, -81.30066009587483, -81.49203587650628, -81.62774269316093, -117.3166355107464, -108.00228525346517, -113.13156669907644, -114.00806307334143, -71.22929265460445, -107.73463703757275, -116.69740058917552, -119.27957997105395, -79.98841153322657, -109.62537531947096, -76.06046804029931, -110.68123117450997, -76.71096933982342, -79.28195381240862, -81.24318097893877, -116.55726958086217, -108.45080520448275, -71.5049330513043, -108.99817510498191, -71.33839432765485, -76.4123175444683, -110.86886036306805, -105.7063995313781, -112.18790297305708, -114.27179599144993, -74.89379673712587], "episode_lengths": [94, 58, 83, 1600, 1600, 115, 114, 66, 1600, 78, 77, 1600, 85, 1600, 68, 1600, 1600, 103, 65, 69, 81, 103, 69, 79, 67, 79, 1600, 52, 1600, 75, 1600, 1600, 1600, 37, 53, 59, 1600, 62, 67, 1600, 131, 66, 1600, 58, 1600, 72, 1600, 62, 86, 1600, 1600, 58, 55, 73, 59, 133, 1600, 61, 84, 1600, 1600, 59, 1600, 70, 1600, 1600, 100, 1600, 96, 67, 109, 1600, 1600, 1600, 90, 93, 59, 126, 1600, 59, 64, 121, 1600, 78, 1600, 60, 1600, 1600, 1600, 74, 59, 1600, 64, 1600, 1600, 56, 40, 54, 88, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30875193755810854, "mean_inference_ms": 1.043974997250102, "mean_action_processing_ms": 0.20385985743324406, "mean_env_wait_ms": 0.40837813694636127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006082296371459961, "StateBufferConnector_ms": 0.004831790924072266, "ViewRequirementAgentConnector_ms": 0.12654709815979004}}, "episode_reward_max": -69.52141114787885, "episode_reward_min": -134.7712770838048, "episode_reward_mean": -99.31737146854593, "episode_len_mean": 670.42, "episodes_this_iter": 6, "episodes_timesteps_total": 67042, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-104.10792801132301, -119.46049343325446, -98.7459925398839, -72.95007590135621, -134.7712770838048, -127.66224715956176, -104.9857301557685, -110.80928917799952, -87.3538787528114, -104.85344151977573, -99.76325685500974, -79.88006541617705, -119.70371850834601, -87.75503661708159, -120.62659280303244, -83.6883983541963, -90.2256437196166, -99.25224420742319, -118.43325836632464, -102.31106377680848, -123.18347500504491, -120.9416708599062, -117.027008278373, -105.91690294635544, -103.51381328664472, -97.39853612722705, -85.40954183656908, -112.98704526696602, -83.54776636303336, -104.72363158538441, -80.48650062157033, -91.15923745172165, -84.92183139163765, -107.85536147028891, -106.1092724044857, -108.01532635934836, -77.18308442212277, -99.5658217192913, -105.429144295703, -88.66844559451751, -105.25632432739872, -106.74717450599124, -93.24713787307978, -105.51860236068008, -80.85274682837306, -118.68856755295147, -84.24461424998856, -116.56000187537944, -101.98217067477044, -71.26529871672517, -78.78109041943605, -112.75633861562734, -109.43128755094236, -103.24994748049355, -112.99290804542849, -105.96923963363594, -76.46731700440685, -108.7942864982169, -118.97546429885242, -81.05416561234928, -77.83110057242152, -107.93812143102848, -82.89086930759667, -109.03681230851946, -69.52141114787885, -72.50737878015704, -112.08429406063321, -81.43614746691026, -118.8871700998017, -109.83777954607085, -128.94618830001167, -81.30066009587483, -81.49203587650628, -81.62774269316093, -117.3166355107464, -108.00228525346517, -113.13156669907644, -114.00806307334143, -71.22929265460445, -107.73463703757275, -116.69740058917552, -119.27957997105395, -79.98841153322657, -109.62537531947096, -76.06046804029931, -110.68123117450997, -76.71096933982342, -79.28195381240862, -81.24318097893877, -116.55726958086217, -108.45080520448275, -71.5049330513043, -108.99817510498191, -71.33839432765485, -76.4123175444683, -110.86886036306805, -105.7063995313781, -112.18790297305708, -114.27179599144993, -74.89379673712587], "episode_lengths": [94, 58, 83, 1600, 1600, 115, 114, 66, 1600, 78, 77, 1600, 85, 1600, 68, 1600, 1600, 103, 65, 69, 81, 103, 69, 79, 67, 79, 1600, 52, 1600, 75, 1600, 1600, 1600, 37, 53, 59, 1600, 62, 67, 1600, 131, 66, 1600, 58, 1600, 72, 1600, 62, 86, 1600, 1600, 58, 55, 73, 59, 133, 1600, 61, 84, 1600, 1600, 59, 1600, 70, 1600, 1600, 100, 1600, 96, 67, 109, 1600, 1600, 1600, 90, 93, 59, 126, 1600, 59, 64, 121, 1600, 78, 1600, 60, 1600, 1600, 1600, 74, 59, 1600, 64, 1600, 1600, 56, 40, 54, 88, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30875193755810854, "mean_inference_ms": 1.043974997250102, "mean_action_processing_ms": 0.20385985743324406, "mean_env_wait_ms": 0.40837813694636127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006082296371459961, "StateBufferConnector_ms": 0.004831790924072266, "ViewRequirementAgentConnector_ms": 0.12654709815979004}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 406.97746937986983, "num_env_steps_trained_throughput_per_sec": 406.97746937986983, "timesteps_total": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 9787.554, "restore_workers_time_ms": 0.016, "training_step_time_ms": 9787.518, "sample_time_ms": 3716.91, "load_time_ms": 0.48, "load_throughput": 8333606.199, "learn_time_ms": 6062.037, "learn_throughput": 659.844, "synch_weights_time_ms": 7.518}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 167, "training_iteration": 27, "trial_id": "3adab_00000", "date": "2024-04-27_21-01-06", "timestamp": 1714276866, "time_this_iter_s": 9.832279920578003, "time_total_s": 273.8702793121338, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 273.8702793121338, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 33.47857142857143, "ram_util_percent": 64.62857142857145}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.745428505123302, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9631157806829139, "policy_loss": -0.030861445936945175, "vf_loss": 0.989579984980325, "vf_explained_var": 0.2538269100650664, "kl": 0.009771636750794838, "entropy": 5.241256456990396, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 25575.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "sampler_results": {"episode_reward_max": -60.135861900998854, "episode_reward_min": -128.94618830001167, "episode_reward_mean": -98.1850618752773, "episode_len_mean": 685.42, "episode_media": {}, "episodes_this_iter": 5, "episodes_timesteps_total": 68542, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-127.66224715956176, -104.9857301557685, -110.80928917799952, -87.3538787528114, -104.85344151977573, -99.76325685500974, -79.88006541617705, -119.70371850834601, -87.75503661708159, -120.62659280303244, -83.6883983541963, -90.2256437196166, -99.25224420742319, -118.43325836632464, -102.31106377680848, -123.18347500504491, -120.9416708599062, -117.027008278373, -105.91690294635544, -103.51381328664472, -97.39853612722705, -85.40954183656908, -112.98704526696602, -83.54776636303336, -104.72363158538441, -80.48650062157033, -91.15923745172165, -84.92183139163765, -107.85536147028891, -106.1092724044857, -108.01532635934836, -77.18308442212277, -99.5658217192913, -105.429144295703, -88.66844559451751, -105.25632432739872, -106.74717450599124, -93.24713787307978, -105.51860236068008, -80.85274682837306, -118.68856755295147, -84.24461424998856, -116.56000187537944, -101.98217067477044, -71.26529871672517, -78.78109041943605, -112.75633861562734, -109.43128755094236, -103.24994748049355, -112.99290804542849, -105.96923963363594, -76.46731700440685, -108.7942864982169, -118.97546429885242, -81.05416561234928, -77.83110057242152, -107.93812143102848, -82.89086930759667, -109.03681230851946, -69.52141114787885, -72.50737878015704, -112.08429406063321, -81.43614746691026, -118.8871700998017, -109.83777954607085, -128.94618830001167, -81.30066009587483, -81.49203587650628, -81.62774269316093, -117.3166355107464, -108.00228525346517, -113.13156669907644, -114.00806307334143, -71.22929265460445, -107.73463703757275, -116.69740058917552, -119.27957997105395, -79.98841153322657, -109.62537531947096, -76.06046804029931, -110.68123117450997, -76.71096933982342, -79.28195381240862, -81.24318097893877, -116.55726958086217, -108.45080520448275, -71.5049330513043, -108.99817510498191, -71.33839432765485, -76.4123175444683, -110.86886036306805, -105.7063995313781, -112.18790297305708, -114.27179599144993, -74.89379673712587, -82.537569420321, -60.84522014840885, -105.65046223647893, -107.63569393655285, -60.135861900998854], "episode_lengths": [115, 114, 66, 1600, 78, 77, 1600, 85, 1600, 68, 1600, 1600, 103, 65, 69, 81, 103, 69, 79, 67, 79, 1600, 52, 1600, 75, 1600, 1600, 1600, 37, 53, 59, 1600, 62, 67, 1600, 131, 66, 1600, 58, 1600, 72, 1600, 62, 86, 1600, 1600, 58, 55, 73, 59, 133, 1600, 61, 84, 1600, 1600, 59, 1600, 70, 1600, 1600, 100, 1600, 96, 67, 109, 1600, 1600, 1600, 90, 93, 59, 126, 1600, 59, 64, 121, 1600, 78, 1600, 60, 1600, 1600, 1600, 74, 59, 1600, 64, 1600, 1600, 56, 40, 54, 88, 1600, 1600, 1600, 54, 81, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3084130066488937, "mean_inference_ms": 1.0424935063368246, "mean_action_processing_ms": 0.2035503691794857, "mean_env_wait_ms": 0.4081430437350974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005966663360595703, "StateBufferConnector_ms": 0.00474858283996582, "ViewRequirementAgentConnector_ms": 0.12289142608642578}}, "episode_reward_max": -60.135861900998854, "episode_reward_min": -128.94618830001167, "episode_reward_mean": -98.1850618752773, "episode_len_mean": 685.42, "episodes_this_iter": 5, "episodes_timesteps_total": 68542, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-127.66224715956176, -104.9857301557685, -110.80928917799952, -87.3538787528114, -104.85344151977573, -99.76325685500974, -79.88006541617705, -119.70371850834601, -87.75503661708159, -120.62659280303244, -83.6883983541963, -90.2256437196166, -99.25224420742319, -118.43325836632464, -102.31106377680848, -123.18347500504491, -120.9416708599062, -117.027008278373, -105.91690294635544, -103.51381328664472, -97.39853612722705, -85.40954183656908, -112.98704526696602, -83.54776636303336, -104.72363158538441, -80.48650062157033, -91.15923745172165, -84.92183139163765, -107.85536147028891, -106.1092724044857, -108.01532635934836, -77.18308442212277, -99.5658217192913, -105.429144295703, -88.66844559451751, -105.25632432739872, -106.74717450599124, -93.24713787307978, -105.51860236068008, -80.85274682837306, -118.68856755295147, -84.24461424998856, -116.56000187537944, -101.98217067477044, -71.26529871672517, -78.78109041943605, -112.75633861562734, -109.43128755094236, -103.24994748049355, -112.99290804542849, -105.96923963363594, -76.46731700440685, -108.7942864982169, -118.97546429885242, -81.05416561234928, -77.83110057242152, -107.93812143102848, -82.89086930759667, -109.03681230851946, -69.52141114787885, -72.50737878015704, -112.08429406063321, -81.43614746691026, -118.8871700998017, -109.83777954607085, -128.94618830001167, -81.30066009587483, -81.49203587650628, -81.62774269316093, -117.3166355107464, -108.00228525346517, -113.13156669907644, -114.00806307334143, -71.22929265460445, -107.73463703757275, -116.69740058917552, -119.27957997105395, -79.98841153322657, -109.62537531947096, -76.06046804029931, -110.68123117450997, -76.71096933982342, -79.28195381240862, -81.24318097893877, -116.55726958086217, -108.45080520448275, -71.5049330513043, -108.99817510498191, -71.33839432765485, -76.4123175444683, -110.86886036306805, -105.7063995313781, -112.18790297305708, -114.27179599144993, -74.89379673712587, -82.537569420321, -60.84522014840885, -105.65046223647893, -107.63569393655285, -60.135861900998854], "episode_lengths": [115, 114, 66, 1600, 78, 77, 1600, 85, 1600, 68, 1600, 1600, 103, 65, 69, 81, 103, 69, 79, 67, 79, 1600, 52, 1600, 75, 1600, 1600, 1600, 37, 53, 59, 1600, 62, 67, 1600, 131, 66, 1600, 58, 1600, 72, 1600, 62, 86, 1600, 1600, 58, 55, 73, 59, 133, 1600, 61, 84, 1600, 1600, 59, 1600, 70, 1600, 1600, 100, 1600, 96, 67, 109, 1600, 1600, 1600, 90, 93, 59, 126, 1600, 59, 64, 121, 1600, 78, 1600, 60, 1600, 1600, 1600, 74, 59, 1600, 64, 1600, 1600, 56, 40, 54, 88, 1600, 1600, 1600, 54, 81, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3084130066488937, "mean_inference_ms": 1.0424935063368246, "mean_action_processing_ms": 0.2035503691794857, "mean_env_wait_ms": 0.4081430437350974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005966663360595703, "StateBufferConnector_ms": 0.00474858283996582, "ViewRequirementAgentConnector_ms": 0.12289142608642578}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 415.0217074065616, "num_env_steps_trained_throughput_per_sec": 415.0217074065616, "timesteps_total": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 9777.745, "restore_workers_time_ms": 0.016, "training_step_time_ms": 9777.709, "sample_time_ms": 3712.515, "load_time_ms": 0.495, "load_throughput": 8081121.333, "learn_time_ms": 6056.637, "learn_throughput": 660.432, "synch_weights_time_ms": 7.495}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "episodes_total": 172, "training_iteration": 28, "trial_id": "3adab_00000", "date": "2024-04-27_21-01-16", "timestamp": 1714276876, "time_this_iter_s": 9.64206600189209, "time_total_s": 283.5123453140259, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 283.5123453140259, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 26.030769230769234, "ram_util_percent": 64.76923076923075}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.263828665210355, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.877029912487819, "policy_loss": -0.035272594517277135, "vf_loss": 0.905627591767779, "vf_explained_var": 0.1996972740978323, "kl": 0.014833170560982588, "entropy": 5.281661697100567, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 26505.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "sampler_results": {"episode_reward_max": -56.58436483275952, "episode_reward_min": -128.94618830001167, "episode_reward_mean": -97.47220637418604, "episode_len_mean": 699.86, "episode_media": {}, "episodes_this_iter": 5, "episodes_timesteps_total": 69986, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-99.76325685500974, -79.88006541617705, -119.70371850834601, -87.75503661708159, -120.62659280303244, -83.6883983541963, -90.2256437196166, -99.25224420742319, -118.43325836632464, -102.31106377680848, -123.18347500504491, -120.9416708599062, -117.027008278373, -105.91690294635544, -103.51381328664472, -97.39853612722705, -85.40954183656908, -112.98704526696602, -83.54776636303336, -104.72363158538441, -80.48650062157033, -91.15923745172165, -84.92183139163765, -107.85536147028891, -106.1092724044857, -108.01532635934836, -77.18308442212277, -99.5658217192913, -105.429144295703, -88.66844559451751, -105.25632432739872, -106.74717450599124, -93.24713787307978, -105.51860236068008, -80.85274682837306, -118.68856755295147, -84.24461424998856, -116.56000187537944, -101.98217067477044, -71.26529871672517, -78.78109041943605, -112.75633861562734, -109.43128755094236, -103.24994748049355, -112.99290804542849, -105.96923963363594, -76.46731700440685, -108.7942864982169, -118.97546429885242, -81.05416561234928, -77.83110057242152, -107.93812143102848, -82.89086930759667, -109.03681230851946, -69.52141114787885, -72.50737878015704, -112.08429406063321, -81.43614746691026, -118.8871700998017, -109.83777954607085, -128.94618830001167, -81.30066009587483, -81.49203587650628, -81.62774269316093, -117.3166355107464, -108.00228525346517, -113.13156669907644, -114.00806307334143, -71.22929265460445, -107.73463703757275, -116.69740058917552, -119.27957997105395, -79.98841153322657, -109.62537531947096, -76.06046804029931, -110.68123117450997, -76.71096933982342, -79.28195381240862, -81.24318097893877, -116.55726958086217, -108.45080520448275, -71.5049330513043, -108.99817510498191, -71.33839432765485, -76.4123175444683, -110.86886036306805, -105.7063995313781, -112.18790297305708, -114.27179599144993, -74.89379673712587, -82.537569420321, -60.84522014840885, -105.65046223647893, -107.63569393655285, -60.135861900998854, -56.58436483275952, -112.37795295593205, -110.06555559477458, -112.289329881814, -73.0618333915094], "episode_lengths": [77, 1600, 85, 1600, 68, 1600, 1600, 103, 65, 69, 81, 103, 69, 79, 67, 79, 1600, 52, 1600, 75, 1600, 1600, 1600, 37, 53, 59, 1600, 62, 67, 1600, 131, 66, 1600, 58, 1600, 72, 1600, 62, 86, 1600, 1600, 58, 55, 73, 59, 133, 1600, 61, 84, 1600, 1600, 59, 1600, 70, 1600, 1600, 100, 1600, 96, 67, 109, 1600, 1600, 1600, 90, 93, 59, 126, 1600, 59, 64, 121, 1600, 78, 1600, 60, 1600, 1600, 1600, 74, 59, 1600, 64, 1600, 1600, 56, 40, 54, 88, 1600, 1600, 1600, 54, 81, 1600, 1600, 43, 97, 77, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3080458640068758, "mean_inference_ms": 1.0410863110555992, "mean_action_processing_ms": 0.20322555589091998, "mean_env_wait_ms": 0.40789000050986735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005984783172607422, "StateBufferConnector_ms": 0.004745006561279297, "ViewRequirementAgentConnector_ms": 0.12249231338500977}}, "episode_reward_max": -56.58436483275952, "episode_reward_min": -128.94618830001167, "episode_reward_mean": -97.47220637418604, "episode_len_mean": 699.86, "episodes_this_iter": 5, "episodes_timesteps_total": 69986, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-99.76325685500974, -79.88006541617705, -119.70371850834601, -87.75503661708159, -120.62659280303244, -83.6883983541963, -90.2256437196166, -99.25224420742319, -118.43325836632464, -102.31106377680848, -123.18347500504491, -120.9416708599062, -117.027008278373, -105.91690294635544, -103.51381328664472, -97.39853612722705, -85.40954183656908, -112.98704526696602, -83.54776636303336, -104.72363158538441, -80.48650062157033, -91.15923745172165, -84.92183139163765, -107.85536147028891, -106.1092724044857, -108.01532635934836, -77.18308442212277, -99.5658217192913, -105.429144295703, -88.66844559451751, -105.25632432739872, -106.74717450599124, -93.24713787307978, -105.51860236068008, -80.85274682837306, -118.68856755295147, -84.24461424998856, -116.56000187537944, -101.98217067477044, -71.26529871672517, -78.78109041943605, -112.75633861562734, -109.43128755094236, -103.24994748049355, -112.99290804542849, -105.96923963363594, -76.46731700440685, -108.7942864982169, -118.97546429885242, -81.05416561234928, -77.83110057242152, -107.93812143102848, -82.89086930759667, -109.03681230851946, -69.52141114787885, -72.50737878015704, -112.08429406063321, -81.43614746691026, -118.8871700998017, -109.83777954607085, -128.94618830001167, -81.30066009587483, -81.49203587650628, -81.62774269316093, -117.3166355107464, -108.00228525346517, -113.13156669907644, -114.00806307334143, -71.22929265460445, -107.73463703757275, -116.69740058917552, -119.27957997105395, -79.98841153322657, -109.62537531947096, -76.06046804029931, -110.68123117450997, -76.71096933982342, -79.28195381240862, -81.24318097893877, -116.55726958086217, -108.45080520448275, -71.5049330513043, -108.99817510498191, -71.33839432765485, -76.4123175444683, -110.86886036306805, -105.7063995313781, -112.18790297305708, -114.27179599144993, -74.89379673712587, -82.537569420321, -60.84522014840885, -105.65046223647893, -107.63569393655285, -60.135861900998854, -56.58436483275952, -112.37795295593205, -110.06555559477458, -112.289329881814, -73.0618333915094], "episode_lengths": [77, 1600, 85, 1600, 68, 1600, 1600, 103, 65, 69, 81, 103, 69, 79, 67, 79, 1600, 52, 1600, 75, 1600, 1600, 1600, 37, 53, 59, 1600, 62, 67, 1600, 131, 66, 1600, 58, 1600, 72, 1600, 62, 86, 1600, 1600, 58, 55, 73, 59, 133, 1600, 61, 84, 1600, 1600, 59, 1600, 70, 1600, 1600, 100, 1600, 96, 67, 109, 1600, 1600, 1600, 90, 93, 59, 126, 1600, 59, 64, 121, 1600, 78, 1600, 60, 1600, 1600, 1600, 74, 59, 1600, 64, 1600, 1600, 56, 40, 54, 88, 1600, 1600, 1600, 54, 81, 1600, 1600, 43, 97, 77, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3080458640068758, "mean_inference_ms": 1.0410863110555992, "mean_action_processing_ms": 0.20322555589091998, "mean_env_wait_ms": 0.40789000050986735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005984783172607422, "StateBufferConnector_ms": 0.004745006561279297, "ViewRequirementAgentConnector_ms": 0.12249231338500977}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 425.52788480514704, "num_env_steps_trained_throughput_per_sec": 425.52788480514704, "timesteps_total": 116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 9697.481, "restore_workers_time_ms": 0.015, "training_step_time_ms": 9697.445, "sample_time_ms": 3663.516, "load_time_ms": 0.467, "load_throughput": 8558057.539, "learn_time_ms": 6025.312, "learn_throughput": 663.866, "synch_weights_time_ms": 7.596}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "done": false, "episodes_total": 177, "training_iteration": 29, "trial_id": "3adab_00000", "date": "2024-04-27_21-01-25", "timestamp": 1714276885, "time_this_iter_s": 9.40407681465149, "time_total_s": 292.91642212867737, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 292.91642212867737, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 23.78571428571428, "ram_util_percent": 64.75000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.304530356007238, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5275778941356988, "policy_loss": -0.02299380527348608, "vf_loss": 0.5451855786985929, "vf_explained_var": 0.31688946556019526, "kl": 0.011969148969658491, "entropy": 4.853410416264688, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 27435.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "sampler_results": {"episode_reward_max": -56.58436483275952, "episode_reward_min": -128.94618830001167, "episode_reward_mean": -96.96644148074463, "episode_len_mean": 715.09, "episode_media": {}, "episodes_this_iter": 2, "episodes_timesteps_total": 71509, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-119.70371850834601, -87.75503661708159, -120.62659280303244, -83.6883983541963, -90.2256437196166, -99.25224420742319, -118.43325836632464, -102.31106377680848, -123.18347500504491, -120.9416708599062, -117.027008278373, -105.91690294635544, -103.51381328664472, -97.39853612722705, -85.40954183656908, -112.98704526696602, -83.54776636303336, -104.72363158538441, -80.48650062157033, -91.15923745172165, -84.92183139163765, -107.85536147028891, -106.1092724044857, -108.01532635934836, -77.18308442212277, -99.5658217192913, -105.429144295703, -88.66844559451751, -105.25632432739872, -106.74717450599124, -93.24713787307978, -105.51860236068008, -80.85274682837306, -118.68856755295147, -84.24461424998856, -116.56000187537944, -101.98217067477044, -71.26529871672517, -78.78109041943605, -112.75633861562734, -109.43128755094236, -103.24994748049355, -112.99290804542849, -105.96923963363594, -76.46731700440685, -108.7942864982169, -118.97546429885242, -81.05416561234928, -77.83110057242152, -107.93812143102848, -82.89086930759667, -109.03681230851946, -69.52141114787885, -72.50737878015704, -112.08429406063321, -81.43614746691026, -118.8871700998017, -109.83777954607085, -128.94618830001167, -81.30066009587483, -81.49203587650628, -81.62774269316093, -117.3166355107464, -108.00228525346517, -113.13156669907644, -114.00806307334143, -71.22929265460445, -107.73463703757275, -116.69740058917552, -119.27957997105395, -79.98841153322657, -109.62537531947096, -76.06046804029931, -110.68123117450997, -76.71096933982342, -79.28195381240862, -81.24318097893877, -116.55726958086217, -108.45080520448275, -71.5049330513043, -108.99817510498191, -71.33839432765485, -76.4123175444683, -110.86886036306805, -105.7063995313781, -112.18790297305708, -114.27179599144993, -74.89379673712587, -82.537569420321, -60.84522014840885, -105.65046223647893, -107.63569393655285, -60.135861900998854, -56.58436483275952, -112.37795295593205, -110.06555559477458, -112.289329881814, -73.0618333915094, -65.93139194233902, -63.1354409847054], "episode_lengths": [85, 1600, 68, 1600, 1600, 103, 65, 69, 81, 103, 69, 79, 67, 79, 1600, 52, 1600, 75, 1600, 1600, 1600, 37, 53, 59, 1600, 62, 67, 1600, 131, 66, 1600, 58, 1600, 72, 1600, 62, 86, 1600, 1600, 58, 55, 73, 59, 133, 1600, 61, 84, 1600, 1600, 59, 1600, 70, 1600, 1600, 100, 1600, 96, 67, 109, 1600, 1600, 1600, 90, 93, 59, 126, 1600, 59, 64, 121, 1600, 78, 1600, 60, 1600, 1600, 1600, 74, 59, 1600, 64, 1600, 1600, 56, 40, 54, 88, 1600, 1600, 1600, 54, 81, 1600, 1600, 43, 97, 77, 1600, 1600, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30792929009909764, "mean_inference_ms": 1.0405490835260074, "mean_action_processing_ms": 0.2031158498557015, "mean_env_wait_ms": 0.40781905894293635, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005949497222900391, "StateBufferConnector_ms": 0.00462651252746582, "ViewRequirementAgentConnector_ms": 0.12210893630981445}}, "episode_reward_max": -56.58436483275952, "episode_reward_min": -128.94618830001167, "episode_reward_mean": -96.96644148074463, "episode_len_mean": 715.09, "episodes_this_iter": 2, "episodes_timesteps_total": 71509, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-119.70371850834601, -87.75503661708159, -120.62659280303244, -83.6883983541963, -90.2256437196166, -99.25224420742319, -118.43325836632464, -102.31106377680848, -123.18347500504491, -120.9416708599062, -117.027008278373, -105.91690294635544, -103.51381328664472, -97.39853612722705, -85.40954183656908, -112.98704526696602, -83.54776636303336, -104.72363158538441, -80.48650062157033, -91.15923745172165, -84.92183139163765, -107.85536147028891, -106.1092724044857, -108.01532635934836, -77.18308442212277, -99.5658217192913, -105.429144295703, -88.66844559451751, -105.25632432739872, -106.74717450599124, -93.24713787307978, -105.51860236068008, -80.85274682837306, -118.68856755295147, -84.24461424998856, -116.56000187537944, -101.98217067477044, -71.26529871672517, -78.78109041943605, -112.75633861562734, -109.43128755094236, -103.24994748049355, -112.99290804542849, -105.96923963363594, -76.46731700440685, -108.7942864982169, -118.97546429885242, -81.05416561234928, -77.83110057242152, -107.93812143102848, -82.89086930759667, -109.03681230851946, -69.52141114787885, -72.50737878015704, -112.08429406063321, -81.43614746691026, -118.8871700998017, -109.83777954607085, -128.94618830001167, -81.30066009587483, -81.49203587650628, -81.62774269316093, -117.3166355107464, -108.00228525346517, -113.13156669907644, -114.00806307334143, -71.22929265460445, -107.73463703757275, -116.69740058917552, -119.27957997105395, -79.98841153322657, -109.62537531947096, -76.06046804029931, -110.68123117450997, -76.71096933982342, -79.28195381240862, -81.24318097893877, -116.55726958086217, -108.45080520448275, -71.5049330513043, -108.99817510498191, -71.33839432765485, -76.4123175444683, -110.86886036306805, -105.7063995313781, -112.18790297305708, -114.27179599144993, -74.89379673712587, -82.537569420321, -60.84522014840885, -105.65046223647893, -107.63569393655285, -60.135861900998854, -56.58436483275952, -112.37795295593205, -110.06555559477458, -112.289329881814, -73.0618333915094, -65.93139194233902, -63.1354409847054], "episode_lengths": [85, 1600, 68, 1600, 1600, 103, 65, 69, 81, 103, 69, 79, 67, 79, 1600, 52, 1600, 75, 1600, 1600, 1600, 37, 53, 59, 1600, 62, 67, 1600, 131, 66, 1600, 58, 1600, 72, 1600, 62, 86, 1600, 1600, 58, 55, 73, 59, 133, 1600, 61, 84, 1600, 1600, 59, 1600, 70, 1600, 1600, 100, 1600, 96, 67, 109, 1600, 1600, 1600, 90, 93, 59, 126, 1600, 59, 64, 121, 1600, 78, 1600, 60, 1600, 1600, 1600, 74, 59, 1600, 64, 1600, 1600, 56, 40, 54, 88, 1600, 1600, 1600, 54, 81, 1600, 1600, 43, 97, 77, 1600, 1600, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30792929009909764, "mean_inference_ms": 1.0405490835260074, "mean_action_processing_ms": 0.2031158498557015, "mean_env_wait_ms": 0.40781905894293635, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005949497222900391, "StateBufferConnector_ms": 0.00462651252746582, "ViewRequirementAgentConnector_ms": 0.12210893630981445}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 403.59656999534246, "num_env_steps_trained_throughput_per_sec": 403.59656999534246, "timesteps_total": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 9665.337, "restore_workers_time_ms": 0.016, "training_step_time_ms": 9665.301, "sample_time_ms": 3665.725, "load_time_ms": 0.473, "load_throughput": 8449018.482, "learn_time_ms": 5990.745, "learn_throughput": 667.697, "synch_weights_time_ms": 7.798}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "episodes_total": 179, "training_iteration": 30, "trial_id": "3adab_00000", "date": "2024-04-27_21-01-35", "timestamp": 1714276895, "time_this_iter_s": 9.914673089981079, "time_total_s": 302.83109521865845, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 302.83109521865845, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 25.607142857142858, "ram_util_percent": 64.71428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.915195272430298, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0468159120309577, "policy_loss": -0.027786701945688136, "vf_loss": 1.0717187843175344, "vf_explained_var": 0.231817546262536, "kl": 0.00640852417288634, "entropy": 5.171095507632019, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 28365.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "sampler_results": {"episode_reward_max": -54.410035980275644, "episode_reward_min": -128.94618830001167, "episode_reward_mean": -96.00899177968411, "episode_len_mean": 714.68, "episode_media": {}, "episodes_this_iter": 5, "episodes_timesteps_total": 71468, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-99.25224420742319, -118.43325836632464, -102.31106377680848, -123.18347500504491, -120.9416708599062, -117.027008278373, -105.91690294635544, -103.51381328664472, -97.39853612722705, -85.40954183656908, -112.98704526696602, -83.54776636303336, -104.72363158538441, -80.48650062157033, -91.15923745172165, -84.92183139163765, -107.85536147028891, -106.1092724044857, -108.01532635934836, -77.18308442212277, -99.5658217192913, -105.429144295703, -88.66844559451751, -105.25632432739872, -106.74717450599124, -93.24713787307978, -105.51860236068008, -80.85274682837306, -118.68856755295147, -84.24461424998856, -116.56000187537944, -101.98217067477044, -71.26529871672517, -78.78109041943605, -112.75633861562734, -109.43128755094236, -103.24994748049355, -112.99290804542849, -105.96923963363594, -76.46731700440685, -108.7942864982169, -118.97546429885242, -81.05416561234928, -77.83110057242152, -107.93812143102848, -82.89086930759667, -109.03681230851946, -69.52141114787885, -72.50737878015704, -112.08429406063321, -81.43614746691026, -118.8871700998017, -109.83777954607085, -128.94618830001167, -81.30066009587483, -81.49203587650628, -81.62774269316093, -117.3166355107464, -108.00228525346517, -113.13156669907644, -114.00806307334143, -71.22929265460445, -107.73463703757275, -116.69740058917552, -119.27957997105395, -79.98841153322657, -109.62537531947096, -76.06046804029931, -110.68123117450997, -76.71096933982342, -79.28195381240862, -81.24318097893877, -116.55726958086217, -108.45080520448275, -71.5049330513043, -108.99817510498191, -71.33839432765485, -76.4123175444683, -110.86886036306805, -105.7063995313781, -112.18790297305708, -114.27179599144993, -74.89379673712587, -82.537569420321, -60.84522014840885, -105.65046223647893, -107.63569393655285, -60.135861900998854, -56.58436483275952, -112.37795295593205, -110.06555559477458, -112.289329881814, -73.0618333915094, -65.93139194233902, -63.1354409847054, -70.33504340337228, -110.54845221489606, -110.56351098318957, -60.39737731448942, -54.410035980275644], "episode_lengths": [103, 65, 69, 81, 103, 69, 79, 67, 79, 1600, 52, 1600, 75, 1600, 1600, 1600, 37, 53, 59, 1600, 62, 67, 1600, 131, 66, 1600, 58, 1600, 72, 1600, 62, 86, 1600, 1600, 58, 55, 73, 59, 133, 1600, 61, 84, 1600, 1600, 59, 1600, 70, 1600, 1600, 100, 1600, 96, 67, 109, 1600, 1600, 1600, 90, 93, 59, 126, 1600, 59, 64, 121, 1600, 78, 1600, 60, 1600, 1600, 1600, 74, 59, 1600, 64, 1600, 1600, 56, 40, 54, 88, 1600, 1600, 1600, 54, 81, 1600, 1600, 43, 97, 77, 1600, 1600, 1600, 1600, 69, 43, 1600, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30735615600085353, "mean_inference_ms": 1.0382629666437813, "mean_action_processing_ms": 0.20268490909000847, "mean_env_wait_ms": 0.4073294303644896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0059163570404052734, "StateBufferConnector_ms": 0.004584789276123047, "ViewRequirementAgentConnector_ms": 0.12004542350769043}}, "episode_reward_max": -54.410035980275644, "episode_reward_min": -128.94618830001167, "episode_reward_mean": -96.00899177968411, "episode_len_mean": 714.68, "episodes_this_iter": 5, "episodes_timesteps_total": 71468, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-99.25224420742319, -118.43325836632464, -102.31106377680848, -123.18347500504491, -120.9416708599062, -117.027008278373, -105.91690294635544, -103.51381328664472, -97.39853612722705, -85.40954183656908, -112.98704526696602, -83.54776636303336, -104.72363158538441, -80.48650062157033, -91.15923745172165, -84.92183139163765, -107.85536147028891, -106.1092724044857, -108.01532635934836, -77.18308442212277, -99.5658217192913, -105.429144295703, -88.66844559451751, -105.25632432739872, -106.74717450599124, -93.24713787307978, -105.51860236068008, -80.85274682837306, -118.68856755295147, -84.24461424998856, -116.56000187537944, -101.98217067477044, -71.26529871672517, -78.78109041943605, -112.75633861562734, -109.43128755094236, -103.24994748049355, -112.99290804542849, -105.96923963363594, -76.46731700440685, -108.7942864982169, -118.97546429885242, -81.05416561234928, -77.83110057242152, -107.93812143102848, -82.89086930759667, -109.03681230851946, -69.52141114787885, -72.50737878015704, -112.08429406063321, -81.43614746691026, -118.8871700998017, -109.83777954607085, -128.94618830001167, -81.30066009587483, -81.49203587650628, -81.62774269316093, -117.3166355107464, -108.00228525346517, -113.13156669907644, -114.00806307334143, -71.22929265460445, -107.73463703757275, -116.69740058917552, -119.27957997105395, -79.98841153322657, -109.62537531947096, -76.06046804029931, -110.68123117450997, -76.71096933982342, -79.28195381240862, -81.24318097893877, -116.55726958086217, -108.45080520448275, -71.5049330513043, -108.99817510498191, -71.33839432765485, -76.4123175444683, -110.86886036306805, -105.7063995313781, -112.18790297305708, -114.27179599144993, -74.89379673712587, -82.537569420321, -60.84522014840885, -105.65046223647893, -107.63569393655285, -60.135861900998854, -56.58436483275952, -112.37795295593205, -110.06555559477458, -112.289329881814, -73.0618333915094, -65.93139194233902, -63.1354409847054, -70.33504340337228, -110.54845221489606, -110.56351098318957, -60.39737731448942, -54.410035980275644], "episode_lengths": [103, 65, 69, 81, 103, 69, 79, 67, 79, 1600, 52, 1600, 75, 1600, 1600, 1600, 37, 53, 59, 1600, 62, 67, 1600, 131, 66, 1600, 58, 1600, 72, 1600, 62, 86, 1600, 1600, 58, 55, 73, 59, 133, 1600, 61, 84, 1600, 1600, 59, 1600, 70, 1600, 1600, 100, 1600, 96, 67, 109, 1600, 1600, 1600, 90, 93, 59, 126, 1600, 59, 64, 121, 1600, 78, 1600, 60, 1600, 1600, 1600, 74, 59, 1600, 64, 1600, 1600, 56, 40, 54, 88, 1600, 1600, 1600, 54, 81, 1600, 1600, 43, 97, 77, 1600, 1600, 1600, 1600, 69, 43, 1600, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30735615600085353, "mean_inference_ms": 1.0382629666437813, "mean_action_processing_ms": 0.20268490909000847, "mean_env_wait_ms": 0.4073294303644896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0059163570404052734, "StateBufferConnector_ms": 0.004584789276123047, "ViewRequirementAgentConnector_ms": 0.12004542350769043}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 404.6787370509959, "num_env_steps_trained_throughput_per_sec": 404.6787370509959, "timesteps_total": 124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 9664.426, "restore_workers_time_ms": 0.016, "training_step_time_ms": 9664.391, "sample_time_ms": 3652.445, "load_time_ms": 0.461, "load_throughput": 8676224.854, "learn_time_ms": 6003.273, "learn_throughput": 666.303, "synch_weights_time_ms": 7.67}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "done": false, "episodes_total": 184, "training_iteration": 31, "trial_id": "3adab_00000", "date": "2024-04-27_21-01-45", "timestamp": 1714276905, "time_this_iter_s": 9.888631105422974, "time_total_s": 312.7197263240814, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 312.7197263240814, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 25.514285714285712, "ram_util_percent": 64.77142857142859}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.31469491053653, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3533117414562292, "policy_loss": -0.020545101750602004, "vf_loss": 0.3680786703583053, "vf_explained_var": 0.4138169066880339, "kl": 0.01284039139271012, "entropy": 4.823316381310904, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "sampler_results": {"episode_reward_max": -54.410035980275644, "episode_reward_min": -128.94618830001167, "episode_reward_mean": -95.05140727260225, "episode_len_mean": 745.0, "episode_media": {}, "episodes_this_iter": 2, "episodes_timesteps_total": 74500, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-102.31106377680848, -123.18347500504491, -120.9416708599062, -117.027008278373, -105.91690294635544, -103.51381328664472, -97.39853612722705, -85.40954183656908, -112.98704526696602, -83.54776636303336, -104.72363158538441, -80.48650062157033, -91.15923745172165, -84.92183139163765, -107.85536147028891, -106.1092724044857, -108.01532635934836, -77.18308442212277, -99.5658217192913, -105.429144295703, -88.66844559451751, -105.25632432739872, -106.74717450599124, -93.24713787307978, -105.51860236068008, -80.85274682837306, -118.68856755295147, -84.24461424998856, -116.56000187537944, -101.98217067477044, -71.26529871672517, -78.78109041943605, -112.75633861562734, -109.43128755094236, -103.24994748049355, -112.99290804542849, -105.96923963363594, -76.46731700440685, -108.7942864982169, -118.97546429885242, -81.05416561234928, -77.83110057242152, -107.93812143102848, -82.89086930759667, -109.03681230851946, -69.52141114787885, -72.50737878015704, -112.08429406063321, -81.43614746691026, -118.8871700998017, -109.83777954607085, -128.94618830001167, -81.30066009587483, -81.49203587650628, -81.62774269316093, -117.3166355107464, -108.00228525346517, -113.13156669907644, -114.00806307334143, -71.22929265460445, -107.73463703757275, -116.69740058917552, -119.27957997105395, -79.98841153322657, -109.62537531947096, -76.06046804029931, -110.68123117450997, -76.71096933982342, -79.28195381240862, -81.24318097893877, -116.55726958086217, -108.45080520448275, -71.5049330513043, -108.99817510498191, -71.33839432765485, -76.4123175444683, -110.86886036306805, -105.7063995313781, -112.18790297305708, -114.27179599144993, -74.89379673712587, -82.537569420321, -60.84522014840885, -105.65046223647893, -107.63569393655285, -60.135861900998854, -56.58436483275952, -112.37795295593205, -110.06555559477458, -112.289329881814, -73.0618333915094, -65.93139194233902, -63.1354409847054, -70.33504340337228, -110.54845221489606, -110.56351098318957, -60.39737731448942, -54.410035980275644, -56.27884201064765, -65.64820985491396], "episode_lengths": [69, 81, 103, 69, 79, 67, 79, 1600, 52, 1600, 75, 1600, 1600, 1600, 37, 53, 59, 1600, 62, 67, 1600, 131, 66, 1600, 58, 1600, 72, 1600, 62, 86, 1600, 1600, 58, 55, 73, 59, 133, 1600, 61, 84, 1600, 1600, 59, 1600, 70, 1600, 1600, 100, 1600, 96, 67, 109, 1600, 1600, 1600, 90, 93, 59, 126, 1600, 59, 64, 121, 1600, 78, 1600, 60, 1600, 1600, 1600, 74, 59, 1600, 64, 1600, 1600, 56, 40, 54, 88, 1600, 1600, 1600, 54, 81, 1600, 1600, 43, 97, 77, 1600, 1600, 1600, 1600, 69, 43, 1600, 1600, 1600, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30705754184983697, "mean_inference_ms": 1.0371300667840146, "mean_action_processing_ms": 0.2024968085389119, "mean_env_wait_ms": 0.40709863281650227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005865812301635742, "StateBufferConnector_ms": 0.0045163631439208984, "ViewRequirementAgentConnector_ms": 0.11900615692138672}}, "episode_reward_max": -54.410035980275644, "episode_reward_min": -128.94618830001167, "episode_reward_mean": -95.05140727260225, "episode_len_mean": 745.0, "episodes_this_iter": 2, "episodes_timesteps_total": 74500, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-102.31106377680848, -123.18347500504491, -120.9416708599062, -117.027008278373, -105.91690294635544, -103.51381328664472, -97.39853612722705, -85.40954183656908, -112.98704526696602, -83.54776636303336, -104.72363158538441, -80.48650062157033, -91.15923745172165, -84.92183139163765, -107.85536147028891, -106.1092724044857, -108.01532635934836, -77.18308442212277, -99.5658217192913, -105.429144295703, -88.66844559451751, -105.25632432739872, -106.74717450599124, -93.24713787307978, -105.51860236068008, -80.85274682837306, -118.68856755295147, -84.24461424998856, -116.56000187537944, -101.98217067477044, -71.26529871672517, -78.78109041943605, -112.75633861562734, -109.43128755094236, -103.24994748049355, -112.99290804542849, -105.96923963363594, -76.46731700440685, -108.7942864982169, -118.97546429885242, -81.05416561234928, -77.83110057242152, -107.93812143102848, -82.89086930759667, -109.03681230851946, -69.52141114787885, -72.50737878015704, -112.08429406063321, -81.43614746691026, -118.8871700998017, -109.83777954607085, -128.94618830001167, -81.30066009587483, -81.49203587650628, -81.62774269316093, -117.3166355107464, -108.00228525346517, -113.13156669907644, -114.00806307334143, -71.22929265460445, -107.73463703757275, -116.69740058917552, -119.27957997105395, -79.98841153322657, -109.62537531947096, -76.06046804029931, -110.68123117450997, -76.71096933982342, -79.28195381240862, -81.24318097893877, -116.55726958086217, -108.45080520448275, -71.5049330513043, -108.99817510498191, -71.33839432765485, -76.4123175444683, -110.86886036306805, -105.7063995313781, -112.18790297305708, -114.27179599144993, -74.89379673712587, -82.537569420321, -60.84522014840885, -105.65046223647893, -107.63569393655285, -60.135861900998854, -56.58436483275952, -112.37795295593205, -110.06555559477458, -112.289329881814, -73.0618333915094, -65.93139194233902, -63.1354409847054, -70.33504340337228, -110.54845221489606, -110.56351098318957, -60.39737731448942, -54.410035980275644, -56.27884201064765, -65.64820985491396], "episode_lengths": [69, 81, 103, 69, 79, 67, 79, 1600, 52, 1600, 75, 1600, 1600, 1600, 37, 53, 59, 1600, 62, 67, 1600, 131, 66, 1600, 58, 1600, 72, 1600, 62, 86, 1600, 1600, 58, 55, 73, 59, 133, 1600, 61, 84, 1600, 1600, 59, 1600, 70, 1600, 1600, 100, 1600, 96, 67, 109, 1600, 1600, 1600, 90, 93, 59, 126, 1600, 59, 64, 121, 1600, 78, 1600, 60, 1600, 1600, 1600, 74, 59, 1600, 64, 1600, 1600, 56, 40, 54, 88, 1600, 1600, 1600, 54, 81, 1600, 1600, 43, 97, 77, 1600, 1600, 1600, 1600, 69, 43, 1600, 1600, 1600, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30705754184983697, "mean_inference_ms": 1.0371300667840146, "mean_action_processing_ms": 0.2024968085389119, "mean_env_wait_ms": 0.40709863281650227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005865812301635742, "StateBufferConnector_ms": 0.0045163631439208984, "ViewRequirementAgentConnector_ms": 0.11900615692138672}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 391.3897144377904, "num_env_steps_trained_throughput_per_sec": 391.3897144377904, "timesteps_total": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 9708.631, "restore_workers_time_ms": 0.016, "training_step_time_ms": 9708.596, "sample_time_ms": 3662.377, "load_time_ms": 0.45, "load_throughput": 8898491.567, "learn_time_ms": 6037.542, "learn_throughput": 662.521, "synch_weights_time_ms": 7.688}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "episodes_total": 186, "training_iteration": 32, "trial_id": "3adab_00000", "date": "2024-04-27_21-01-56", "timestamp": 1714276916, "time_this_iter_s": 10.224499940872192, "time_total_s": 322.9442262649536, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 322.9442262649536, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 28.913333333333334, "ram_util_percent": 64.70666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.777544605026963, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2711849786536467, "policy_loss": -0.024691731058141236, "vf_loss": 1.2923722841726837, "vf_explained_var": 0.33341380146241956, "kl": 0.007787615415802659, "entropy": 5.223179066053, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 30225.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "sampler_results": {"episode_reward_max": -54.410035980275644, "episode_reward_min": -128.94618830001167, "episode_reward_mean": -93.35805675646694, "episode_len_mean": 790.6, "episode_media": {}, "episodes_this_iter": 5, "episodes_timesteps_total": 79060, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-103.51381328664472, -97.39853612722705, -85.40954183656908, -112.98704526696602, -83.54776636303336, -104.72363158538441, -80.48650062157033, -91.15923745172165, -84.92183139163765, -107.85536147028891, -106.1092724044857, -108.01532635934836, -77.18308442212277, -99.5658217192913, -105.429144295703, -88.66844559451751, -105.25632432739872, -106.74717450599124, -93.24713787307978, -105.51860236068008, -80.85274682837306, -118.68856755295147, -84.24461424998856, -116.56000187537944, -101.98217067477044, -71.26529871672517, -78.78109041943605, -112.75633861562734, -109.43128755094236, -103.24994748049355, -112.99290804542849, -105.96923963363594, -76.46731700440685, -108.7942864982169, -118.97546429885242, -81.05416561234928, -77.83110057242152, -107.93812143102848, -82.89086930759667, -109.03681230851946, -69.52141114787885, -72.50737878015704, -112.08429406063321, -81.43614746691026, -118.8871700998017, -109.83777954607085, -128.94618830001167, -81.30066009587483, -81.49203587650628, -81.62774269316093, -117.3166355107464, -108.00228525346517, -113.13156669907644, -114.00806307334143, -71.22929265460445, -107.73463703757275, -116.69740058917552, -119.27957997105395, -79.98841153322657, -109.62537531947096, -76.06046804029931, -110.68123117450997, -76.71096933982342, -79.28195381240862, -81.24318097893877, -116.55726958086217, -108.45080520448275, -71.5049330513043, -108.99817510498191, -71.33839432765485, -76.4123175444683, -110.86886036306805, -105.7063995313781, -112.18790297305708, -114.27179599144993, -74.89379673712587, -82.537569420321, -60.84522014840885, -105.65046223647893, -107.63569393655285, -60.135861900998854, -56.58436483275952, -112.37795295593205, -110.06555559477458, -112.289329881814, -73.0618333915094, -65.93139194233902, -63.1354409847054, -70.33504340337228, -110.54845221489606, -110.56351098318957, -60.39737731448942, -54.410035980275644, -56.27884201064765, -65.64820985491396, -56.355943061126375, -107.41686162152824, -62.766830404554355, -58.01629541821664, -115.48913874753316], "episode_lengths": [67, 79, 1600, 52, 1600, 75, 1600, 1600, 1600, 37, 53, 59, 1600, 62, 67, 1600, 131, 66, 1600, 58, 1600, 72, 1600, 62, 86, 1600, 1600, 58, 55, 73, 59, 133, 1600, 61, 84, 1600, 1600, 59, 1600, 70, 1600, 1600, 100, 1600, 96, 67, 109, 1600, 1600, 1600, 90, 93, 59, 126, 1600, 59, 64, 121, 1600, 78, 1600, 60, 1600, 1600, 1600, 74, 59, 1600, 64, 1600, 1600, 56, 40, 54, 88, 1600, 1600, 1600, 54, 81, 1600, 1600, 43, 97, 77, 1600, 1600, 1600, 1600, 69, 43, 1600, 1600, 1600, 1600, 1600, 94, 1600, 1600, 67]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3062825197824632, "mean_inference_ms": 1.034209854473812, "mean_action_processing_ms": 0.202005595983213, "mean_env_wait_ms": 0.4064727492482199, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005843400955200195, "StateBufferConnector_ms": 0.004431486129760742, "ViewRequirementAgentConnector_ms": 0.11840295791625977}}, "episode_reward_max": -54.410035980275644, "episode_reward_min": -128.94618830001167, "episode_reward_mean": -93.35805675646694, "episode_len_mean": 790.6, "episodes_this_iter": 5, "episodes_timesteps_total": 79060, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-103.51381328664472, -97.39853612722705, -85.40954183656908, -112.98704526696602, -83.54776636303336, -104.72363158538441, -80.48650062157033, -91.15923745172165, -84.92183139163765, -107.85536147028891, -106.1092724044857, -108.01532635934836, -77.18308442212277, -99.5658217192913, -105.429144295703, -88.66844559451751, -105.25632432739872, -106.74717450599124, -93.24713787307978, -105.51860236068008, -80.85274682837306, -118.68856755295147, -84.24461424998856, -116.56000187537944, -101.98217067477044, -71.26529871672517, -78.78109041943605, -112.75633861562734, -109.43128755094236, -103.24994748049355, -112.99290804542849, -105.96923963363594, -76.46731700440685, -108.7942864982169, -118.97546429885242, -81.05416561234928, -77.83110057242152, -107.93812143102848, -82.89086930759667, -109.03681230851946, -69.52141114787885, -72.50737878015704, -112.08429406063321, -81.43614746691026, -118.8871700998017, -109.83777954607085, -128.94618830001167, -81.30066009587483, -81.49203587650628, -81.62774269316093, -117.3166355107464, -108.00228525346517, -113.13156669907644, -114.00806307334143, -71.22929265460445, -107.73463703757275, -116.69740058917552, -119.27957997105395, -79.98841153322657, -109.62537531947096, -76.06046804029931, -110.68123117450997, -76.71096933982342, -79.28195381240862, -81.24318097893877, -116.55726958086217, -108.45080520448275, -71.5049330513043, -108.99817510498191, -71.33839432765485, -76.4123175444683, -110.86886036306805, -105.7063995313781, -112.18790297305708, -114.27179599144993, -74.89379673712587, -82.537569420321, -60.84522014840885, -105.65046223647893, -107.63569393655285, -60.135861900998854, -56.58436483275952, -112.37795295593205, -110.06555559477458, -112.289329881814, -73.0618333915094, -65.93139194233902, -63.1354409847054, -70.33504340337228, -110.54845221489606, -110.56351098318957, -60.39737731448942, -54.410035980275644, -56.27884201064765, -65.64820985491396, -56.355943061126375, -107.41686162152824, -62.766830404554355, -58.01629541821664, -115.48913874753316], "episode_lengths": [67, 79, 1600, 52, 1600, 75, 1600, 1600, 1600, 37, 53, 59, 1600, 62, 67, 1600, 131, 66, 1600, 58, 1600, 72, 1600, 62, 86, 1600, 1600, 58, 55, 73, 59, 133, 1600, 61, 84, 1600, 1600, 59, 1600, 70, 1600, 1600, 100, 1600, 96, 67, 109, 1600, 1600, 1600, 90, 93, 59, 126, 1600, 59, 64, 121, 1600, 78, 1600, 60, 1600, 1600, 1600, 74, 59, 1600, 64, 1600, 1600, 56, 40, 54, 88, 1600, 1600, 1600, 54, 81, 1600, 1600, 43, 97, 77, 1600, 1600, 1600, 1600, 69, 43, 1600, 1600, 1600, 1600, 1600, 94, 1600, 1600, 67]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3062825197824632, "mean_inference_ms": 1.034209854473812, "mean_action_processing_ms": 0.202005595983213, "mean_env_wait_ms": 0.4064727492482199, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005843400955200195, "StateBufferConnector_ms": 0.004431486129760742, "ViewRequirementAgentConnector_ms": 0.11840295791625977}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 419.58927747991777, "num_env_steps_trained_throughput_per_sec": 419.58927747991777, "timesteps_total": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 9708.339, "restore_workers_time_ms": 0.015, "training_step_time_ms": 9708.303, "sample_time_ms": 3657.47, "load_time_ms": 0.442, "load_throughput": 9047735.534, "learn_time_ms": 6041.931, "learn_throughput": 662.04, "synch_weights_time_ms": 7.929}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "episodes_total": 191, "training_iteration": 33, "trial_id": "3adab_00000", "date": "2024-04-27_21-02-05", "timestamp": 1714276925, "time_this_iter_s": 9.53686785697937, "time_total_s": 332.481094121933, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 332.481094121933, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 23.96153846153846, "ram_util_percent": 64.67692307692309}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.979575919015433, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6159973550512786, "policy_loss": -0.02600351880875326, "vf_loss": 0.6384420666002458, "vf_explained_var": 0.24908749018946003, "kl": 0.00790847840715548, "entropy": 4.999854437510172, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 31155.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "sampler_results": {"episode_reward_max": -54.410035980275644, "episode_reward_min": -128.94618830001167, "episode_reward_mean": -92.78659034915789, "episode_len_mean": 805.75, "episode_media": {}, "episodes_this_iter": 3, "episodes_timesteps_total": 80575, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-112.98704526696602, -83.54776636303336, -104.72363158538441, -80.48650062157033, -91.15923745172165, -84.92183139163765, -107.85536147028891, -106.1092724044857, -108.01532635934836, -77.18308442212277, -99.5658217192913, -105.429144295703, -88.66844559451751, -105.25632432739872, -106.74717450599124, -93.24713787307978, -105.51860236068008, -80.85274682837306, -118.68856755295147, -84.24461424998856, -116.56000187537944, -101.98217067477044, -71.26529871672517, -78.78109041943605, -112.75633861562734, -109.43128755094236, -103.24994748049355, -112.99290804542849, -105.96923963363594, -76.46731700440685, -108.7942864982169, -118.97546429885242, -81.05416561234928, -77.83110057242152, -107.93812143102848, -82.89086930759667, -109.03681230851946, -69.52141114787885, -72.50737878015704, -112.08429406063321, -81.43614746691026, -118.8871700998017, -109.83777954607085, -128.94618830001167, -81.30066009587483, -81.49203587650628, -81.62774269316093, -117.3166355107464, -108.00228525346517, -113.13156669907644, -114.00806307334143, -71.22929265460445, -107.73463703757275, -116.69740058917552, -119.27957997105395, -79.98841153322657, -109.62537531947096, -76.06046804029931, -110.68123117450997, -76.71096933982342, -79.28195381240862, -81.24318097893877, -116.55726958086217, -108.45080520448275, -71.5049330513043, -108.99817510498191, -71.33839432765485, -76.4123175444683, -110.86886036306805, -105.7063995313781, -112.18790297305708, -114.27179599144993, -74.89379673712587, -82.537569420321, -60.84522014840885, -105.65046223647893, -107.63569393655285, -60.135861900998854, -56.58436483275952, -112.37795295593205, -110.06555559477458, -112.289329881814, -73.0618333915094, -65.93139194233902, -63.1354409847054, -70.33504340337228, -110.54845221489606, -110.56351098318957, -60.39737731448942, -54.410035980275644, -56.27884201064765, -65.64820985491396, -56.355943061126375, -107.41686162152824, -62.766830404554355, -58.01629541821664, -115.48913874753316, -55.826794609086555, -117.97611289821131, -55.37234301223421], "episode_lengths": [52, 1600, 75, 1600, 1600, 1600, 37, 53, 59, 1600, 62, 67, 1600, 131, 66, 1600, 58, 1600, 72, 1600, 62, 86, 1600, 1600, 58, 55, 73, 59, 133, 1600, 61, 84, 1600, 1600, 59, 1600, 70, 1600, 1600, 100, 1600, 96, 67, 109, 1600, 1600, 1600, 90, 93, 59, 126, 1600, 59, 64, 121, 1600, 78, 1600, 60, 1600, 1600, 1600, 74, 59, 1600, 64, 1600, 1600, 56, 40, 54, 88, 1600, 1600, 1600, 54, 81, 1600, 1600, 43, 97, 77, 1600, 1600, 1600, 1600, 69, 43, 1600, 1600, 1600, 1600, 1600, 94, 1600, 1600, 67, 1600, 61, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30578077482608884, "mean_inference_ms": 1.032436548413539, "mean_action_processing_ms": 0.20167919936843842, "mean_env_wait_ms": 0.4060391575684696, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0058078765869140625, "StateBufferConnector_ms": 0.0044155120849609375, "ViewRequirementAgentConnector_ms": 0.11756277084350586}}, "episode_reward_max": -54.410035980275644, "episode_reward_min": -128.94618830001167, "episode_reward_mean": -92.78659034915789, "episode_len_mean": 805.75, "episodes_this_iter": 3, "episodes_timesteps_total": 80575, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-112.98704526696602, -83.54776636303336, -104.72363158538441, -80.48650062157033, -91.15923745172165, -84.92183139163765, -107.85536147028891, -106.1092724044857, -108.01532635934836, -77.18308442212277, -99.5658217192913, -105.429144295703, -88.66844559451751, -105.25632432739872, -106.74717450599124, -93.24713787307978, -105.51860236068008, -80.85274682837306, -118.68856755295147, -84.24461424998856, -116.56000187537944, -101.98217067477044, -71.26529871672517, -78.78109041943605, -112.75633861562734, -109.43128755094236, -103.24994748049355, -112.99290804542849, -105.96923963363594, -76.46731700440685, -108.7942864982169, -118.97546429885242, -81.05416561234928, -77.83110057242152, -107.93812143102848, -82.89086930759667, -109.03681230851946, -69.52141114787885, -72.50737878015704, -112.08429406063321, -81.43614746691026, -118.8871700998017, -109.83777954607085, -128.94618830001167, -81.30066009587483, -81.49203587650628, -81.62774269316093, -117.3166355107464, -108.00228525346517, -113.13156669907644, -114.00806307334143, -71.22929265460445, -107.73463703757275, -116.69740058917552, -119.27957997105395, -79.98841153322657, -109.62537531947096, -76.06046804029931, -110.68123117450997, -76.71096933982342, -79.28195381240862, -81.24318097893877, -116.55726958086217, -108.45080520448275, -71.5049330513043, -108.99817510498191, -71.33839432765485, -76.4123175444683, -110.86886036306805, -105.7063995313781, -112.18790297305708, -114.27179599144993, -74.89379673712587, -82.537569420321, -60.84522014840885, -105.65046223647893, -107.63569393655285, -60.135861900998854, -56.58436483275952, -112.37795295593205, -110.06555559477458, -112.289329881814, -73.0618333915094, -65.93139194233902, -63.1354409847054, -70.33504340337228, -110.54845221489606, -110.56351098318957, -60.39737731448942, -54.410035980275644, -56.27884201064765, -65.64820985491396, -56.355943061126375, -107.41686162152824, -62.766830404554355, -58.01629541821664, -115.48913874753316, -55.826794609086555, -117.97611289821131, -55.37234301223421], "episode_lengths": [52, 1600, 75, 1600, 1600, 1600, 37, 53, 59, 1600, 62, 67, 1600, 131, 66, 1600, 58, 1600, 72, 1600, 62, 86, 1600, 1600, 58, 55, 73, 59, 133, 1600, 61, 84, 1600, 1600, 59, 1600, 70, 1600, 1600, 100, 1600, 96, 67, 109, 1600, 1600, 1600, 90, 93, 59, 126, 1600, 59, 64, 121, 1600, 78, 1600, 60, 1600, 1600, 1600, 74, 59, 1600, 64, 1600, 1600, 56, 40, 54, 88, 1600, 1600, 1600, 54, 81, 1600, 1600, 43, 97, 77, 1600, 1600, 1600, 1600, 69, 43, 1600, 1600, 1600, 1600, 1600, 94, 1600, 1600, 67, 1600, 61, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30578077482608884, "mean_inference_ms": 1.032436548413539, "mean_action_processing_ms": 0.20167919936843842, "mean_env_wait_ms": 0.4060391575684696, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0058078765869140625, "StateBufferConnector_ms": 0.0044155120849609375, "ViewRequirementAgentConnector_ms": 0.11756277084350586}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 421.67857934578205, "num_env_steps_trained_throughput_per_sec": 421.67857934578205, "timesteps_total": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 9714.756, "restore_workers_time_ms": 0.015, "training_step_time_ms": 9714.721, "sample_time_ms": 3657.682, "load_time_ms": 0.46, "load_throughput": 8689706.324, "learn_time_ms": 6048.145, "learn_throughput": 661.36, "synch_weights_time_ms": 7.911}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "episodes_total": 194, "training_iteration": 34, "trial_id": "3adab_00000", "date": "2024-04-27_21-02-15", "timestamp": 1714276935, "time_this_iter_s": 9.49006986618042, "time_total_s": 341.9711639881134, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 341.9711639881134, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 24.00714285714286, "ram_util_percent": 64.77142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.104479641619548, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9662534949695347, "policy_loss": -0.02745071085149883, "vf_loss": 1.9884567047158876, "vf_explained_var": 0.32377405903672657, "kl": 0.011661116983964104, "entropy": 5.8285205097608666, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 32085.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "sampler_results": {"episode_reward_max": -46.322522700885386, "episode_reward_min": -128.94618830001167, "episode_reward_mean": -92.66106685985591, "episode_len_mean": 775.84, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 77584, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-106.1092724044857, -108.01532635934836, -77.18308442212277, -99.5658217192913, -105.429144295703, -88.66844559451751, -105.25632432739872, -106.74717450599124, -93.24713787307978, -105.51860236068008, -80.85274682837306, -118.68856755295147, -84.24461424998856, -116.56000187537944, -101.98217067477044, -71.26529871672517, -78.78109041943605, -112.75633861562734, -109.43128755094236, -103.24994748049355, -112.99290804542849, -105.96923963363594, -76.46731700440685, -108.7942864982169, -118.97546429885242, -81.05416561234928, -77.83110057242152, -107.93812143102848, -82.89086930759667, -109.03681230851946, -69.52141114787885, -72.50737878015704, -112.08429406063321, -81.43614746691026, -118.8871700998017, -109.83777954607085, -128.94618830001167, -81.30066009587483, -81.49203587650628, -81.62774269316093, -117.3166355107464, -108.00228525346517, -113.13156669907644, -114.00806307334143, -71.22929265460445, -107.73463703757275, -116.69740058917552, -119.27957997105395, -79.98841153322657, -109.62537531947096, -76.06046804029931, -110.68123117450997, -76.71096933982342, -79.28195381240862, -81.24318097893877, -116.55726958086217, -108.45080520448275, -71.5049330513043, -108.99817510498191, -71.33839432765485, -76.4123175444683, -110.86886036306805, -105.7063995313781, -112.18790297305708, -114.27179599144993, -74.89379673712587, -82.537569420321, -60.84522014840885, -105.65046223647893, -107.63569393655285, -60.135861900998854, -56.58436483275952, -112.37795295593205, -110.06555559477458, -112.289329881814, -73.0618333915094, -65.93139194233902, -63.1354409847054, -70.33504340337228, -110.54845221489606, -110.56351098318957, -60.39737731448942, -54.410035980275644, -56.27884201064765, -65.64820985491396, -56.355943061126375, -107.41686162152824, -62.766830404554355, -58.01629541821664, -115.48913874753316, -55.826794609086555, -117.97611289821131, -55.37234301223421, -48.93070490887509, -109.97531712717439, -119.5571604381986, -46.322522700885386, -110.84828170241664, -108.85827739811565, -108.63676094473898], "episode_lengths": [53, 59, 1600, 62, 67, 1600, 131, 66, 1600, 58, 1600, 72, 1600, 62, 86, 1600, 1600, 58, 55, 73, 59, 133, 1600, 61, 84, 1600, 1600, 59, 1600, 70, 1600, 1600, 100, 1600, 96, 67, 109, 1600, 1600, 1600, 90, 93, 59, 126, 1600, 59, 64, 121, 1600, 78, 1600, 60, 1600, 1600, 1600, 74, 59, 1600, 64, 1600, 1600, 56, 40, 54, 88, 1600, 1600, 1600, 54, 81, 1600, 1600, 43, 97, 77, 1600, 1600, 1600, 1600, 69, 43, 1600, 1600, 1600, 1600, 1600, 94, 1600, 1600, 67, 1600, 61, 1600, 1600, 61, 69, 1600, 86, 73, 84]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3047350268071374, "mean_inference_ms": 1.028580116147073, "mean_action_processing_ms": 0.20099660310038586, "mean_env_wait_ms": 0.4051280654545993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005852222442626953, "StateBufferConnector_ms": 0.0043981075286865234, "ViewRequirementAgentConnector_ms": 0.11762261390686035}}, "episode_reward_max": -46.322522700885386, "episode_reward_min": -128.94618830001167, "episode_reward_mean": -92.66106685985591, "episode_len_mean": 775.84, "episodes_this_iter": 7, "episodes_timesteps_total": 77584, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-106.1092724044857, -108.01532635934836, -77.18308442212277, -99.5658217192913, -105.429144295703, -88.66844559451751, -105.25632432739872, -106.74717450599124, -93.24713787307978, -105.51860236068008, -80.85274682837306, -118.68856755295147, -84.24461424998856, -116.56000187537944, -101.98217067477044, -71.26529871672517, -78.78109041943605, -112.75633861562734, -109.43128755094236, -103.24994748049355, -112.99290804542849, -105.96923963363594, -76.46731700440685, -108.7942864982169, -118.97546429885242, -81.05416561234928, -77.83110057242152, -107.93812143102848, -82.89086930759667, -109.03681230851946, -69.52141114787885, -72.50737878015704, -112.08429406063321, -81.43614746691026, -118.8871700998017, -109.83777954607085, -128.94618830001167, -81.30066009587483, -81.49203587650628, -81.62774269316093, -117.3166355107464, -108.00228525346517, -113.13156669907644, -114.00806307334143, -71.22929265460445, -107.73463703757275, -116.69740058917552, -119.27957997105395, -79.98841153322657, -109.62537531947096, -76.06046804029931, -110.68123117450997, -76.71096933982342, -79.28195381240862, -81.24318097893877, -116.55726958086217, -108.45080520448275, -71.5049330513043, -108.99817510498191, -71.33839432765485, -76.4123175444683, -110.86886036306805, -105.7063995313781, -112.18790297305708, -114.27179599144993, -74.89379673712587, -82.537569420321, -60.84522014840885, -105.65046223647893, -107.63569393655285, -60.135861900998854, -56.58436483275952, -112.37795295593205, -110.06555559477458, -112.289329881814, -73.0618333915094, -65.93139194233902, -63.1354409847054, -70.33504340337228, -110.54845221489606, -110.56351098318957, -60.39737731448942, -54.410035980275644, -56.27884201064765, -65.64820985491396, -56.355943061126375, -107.41686162152824, -62.766830404554355, -58.01629541821664, -115.48913874753316, -55.826794609086555, -117.97611289821131, -55.37234301223421, -48.93070490887509, -109.97531712717439, -119.5571604381986, -46.322522700885386, -110.84828170241664, -108.85827739811565, -108.63676094473898], "episode_lengths": [53, 59, 1600, 62, 67, 1600, 131, 66, 1600, 58, 1600, 72, 1600, 62, 86, 1600, 1600, 58, 55, 73, 59, 133, 1600, 61, 84, 1600, 1600, 59, 1600, 70, 1600, 1600, 100, 1600, 96, 67, 109, 1600, 1600, 1600, 90, 93, 59, 126, 1600, 59, 64, 121, 1600, 78, 1600, 60, 1600, 1600, 1600, 74, 59, 1600, 64, 1600, 1600, 56, 40, 54, 88, 1600, 1600, 1600, 54, 81, 1600, 1600, 43, 97, 77, 1600, 1600, 1600, 1600, 69, 43, 1600, 1600, 1600, 1600, 1600, 94, 1600, 1600, 67, 1600, 61, 1600, 1600, 61, 69, 1600, 86, 73, 84]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3047350268071374, "mean_inference_ms": 1.028580116147073, "mean_action_processing_ms": 0.20099660310038586, "mean_env_wait_ms": 0.4051280654545993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005852222442626953, "StateBufferConnector_ms": 0.0043981075286865234, "ViewRequirementAgentConnector_ms": 0.11762261390686035}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 420.5784951761318, "num_env_steps_trained_throughput_per_sec": 420.5784951761318, "timesteps_total": 140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 9708.155, "restore_workers_time_ms": 0.015, "training_step_time_ms": 9708.119, "sample_time_ms": 3651.139, "load_time_ms": 0.453, "load_throughput": 8825932.979, "learn_time_ms": 6048.138, "learn_throughput": 661.361, "synch_weights_time_ms": 7.883}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "episodes_total": 201, "training_iteration": 35, "trial_id": "3adab_00000", "date": "2024-04-27_21-02-24", "timestamp": 1714276944, "time_this_iter_s": 9.516381978988647, "time_total_s": 351.48754596710205, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 351.48754596710205, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 24.069230769230767, "ram_util_percent": 64.86153846153844}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.130847152074178, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9867654815912047, "policy_loss": -0.020818411035873795, "vf_loss": 1.002083727905667, "vf_explained_var": 0.4334897634803608, "kl": 0.012222593648578936, "entropy": 5.0455457210540775, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 33015.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": -44.40145913048837, "episode_reward_min": -128.94618830001167, "episode_reward_mean": -91.28219755932254, "episode_len_mean": 806.72, "episode_media": {}, "episodes_this_iter": 3, "episodes_timesteps_total": 80672, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-99.5658217192913, -105.429144295703, -88.66844559451751, -105.25632432739872, -106.74717450599124, -93.24713787307978, -105.51860236068008, -80.85274682837306, -118.68856755295147, -84.24461424998856, -116.56000187537944, -101.98217067477044, -71.26529871672517, -78.78109041943605, -112.75633861562734, -109.43128755094236, -103.24994748049355, -112.99290804542849, -105.96923963363594, -76.46731700440685, -108.7942864982169, -118.97546429885242, -81.05416561234928, -77.83110057242152, -107.93812143102848, -82.89086930759667, -109.03681230851946, -69.52141114787885, -72.50737878015704, -112.08429406063321, -81.43614746691026, -118.8871700998017, -109.83777954607085, -128.94618830001167, -81.30066009587483, -81.49203587650628, -81.62774269316093, -117.3166355107464, -108.00228525346517, -113.13156669907644, -114.00806307334143, -71.22929265460445, -107.73463703757275, -116.69740058917552, -119.27957997105395, -79.98841153322657, -109.62537531947096, -76.06046804029931, -110.68123117450997, -76.71096933982342, -79.28195381240862, -81.24318097893877, -116.55726958086217, -108.45080520448275, -71.5049330513043, -108.99817510498191, -71.33839432765485, -76.4123175444683, -110.86886036306805, -105.7063995313781, -112.18790297305708, -114.27179599144993, -74.89379673712587, -82.537569420321, -60.84522014840885, -105.65046223647893, -107.63569393655285, -60.135861900998854, -56.58436483275952, -112.37795295593205, -110.06555559477458, -112.289329881814, -73.0618333915094, -65.93139194233902, -63.1354409847054, -70.33504340337228, -110.54845221489606, -110.56351098318957, -60.39737731448942, -54.410035980275644, -56.27884201064765, -65.64820985491396, -56.355943061126375, -107.41686162152824, -62.766830404554355, -58.01629541821664, -115.48913874753316, -55.826794609086555, -117.97611289821131, -55.37234301223421, -48.93070490887509, -109.97531712717439, -119.5571604381986, -46.322522700885386, -110.84828170241664, -108.85827739811565, -108.63676094473898, -44.40145913048837, -54.49304067087913, -54.526253331254544], "episode_lengths": [62, 67, 1600, 131, 66, 1600, 58, 1600, 72, 1600, 62, 86, 1600, 1600, 58, 55, 73, 59, 133, 1600, 61, 84, 1600, 1600, 59, 1600, 70, 1600, 1600, 100, 1600, 96, 67, 109, 1600, 1600, 1600, 90, 93, 59, 126, 1600, 59, 64, 121, 1600, 78, 1600, 60, 1600, 1600, 1600, 74, 59, 1600, 64, 1600, 1600, 56, 40, 54, 88, 1600, 1600, 1600, 54, 81, 1600, 1600, 43, 97, 77, 1600, 1600, 1600, 1600, 69, 43, 1600, 1600, 1600, 1600, 1600, 94, 1600, 1600, 67, 1600, 61, 1600, 1600, 61, 69, 1600, 86, 73, 84, 1600, 1600, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30427962728455776, "mean_inference_ms": 1.0268990105038813, "mean_action_processing_ms": 0.20069754835470607, "mean_env_wait_ms": 0.4047240488002327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005930662155151367, "StateBufferConnector_ms": 0.004400730133056641, "ViewRequirementAgentConnector_ms": 0.11754703521728516}}, "episode_reward_max": -44.40145913048837, "episode_reward_min": -128.94618830001167, "episode_reward_mean": -91.28219755932254, "episode_len_mean": 806.72, "episodes_this_iter": 3, "episodes_timesteps_total": 80672, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-99.5658217192913, -105.429144295703, -88.66844559451751, -105.25632432739872, -106.74717450599124, -93.24713787307978, -105.51860236068008, -80.85274682837306, -118.68856755295147, -84.24461424998856, -116.56000187537944, -101.98217067477044, -71.26529871672517, -78.78109041943605, -112.75633861562734, -109.43128755094236, -103.24994748049355, -112.99290804542849, -105.96923963363594, -76.46731700440685, -108.7942864982169, -118.97546429885242, -81.05416561234928, -77.83110057242152, -107.93812143102848, -82.89086930759667, -109.03681230851946, -69.52141114787885, -72.50737878015704, -112.08429406063321, -81.43614746691026, -118.8871700998017, -109.83777954607085, -128.94618830001167, -81.30066009587483, -81.49203587650628, -81.62774269316093, -117.3166355107464, -108.00228525346517, -113.13156669907644, -114.00806307334143, -71.22929265460445, -107.73463703757275, -116.69740058917552, -119.27957997105395, -79.98841153322657, -109.62537531947096, -76.06046804029931, -110.68123117450997, -76.71096933982342, -79.28195381240862, -81.24318097893877, -116.55726958086217, -108.45080520448275, -71.5049330513043, -108.99817510498191, -71.33839432765485, -76.4123175444683, -110.86886036306805, -105.7063995313781, -112.18790297305708, -114.27179599144993, -74.89379673712587, -82.537569420321, -60.84522014840885, -105.65046223647893, -107.63569393655285, -60.135861900998854, -56.58436483275952, -112.37795295593205, -110.06555559477458, -112.289329881814, -73.0618333915094, -65.93139194233902, -63.1354409847054, -70.33504340337228, -110.54845221489606, -110.56351098318957, -60.39737731448942, -54.410035980275644, -56.27884201064765, -65.64820985491396, -56.355943061126375, -107.41686162152824, -62.766830404554355, -58.01629541821664, -115.48913874753316, -55.826794609086555, -117.97611289821131, -55.37234301223421, -48.93070490887509, -109.97531712717439, -119.5571604381986, -46.322522700885386, -110.84828170241664, -108.85827739811565, -108.63676094473898, -44.40145913048837, -54.49304067087913, -54.526253331254544], "episode_lengths": [62, 67, 1600, 131, 66, 1600, 58, 1600, 72, 1600, 62, 86, 1600, 1600, 58, 55, 73, 59, 133, 1600, 61, 84, 1600, 1600, 59, 1600, 70, 1600, 1600, 100, 1600, 96, 67, 109, 1600, 1600, 1600, 90, 93, 59, 126, 1600, 59, 64, 121, 1600, 78, 1600, 60, 1600, 1600, 1600, 74, 59, 1600, 64, 1600, 1600, 56, 40, 54, 88, 1600, 1600, 1600, 54, 81, 1600, 1600, 43, 97, 77, 1600, 1600, 1600, 1600, 69, 43, 1600, 1600, 1600, 1600, 1600, 94, 1600, 1600, 67, 1600, 61, 1600, 1600, 61, 69, 1600, 86, 73, 84, 1600, 1600, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30427962728455776, "mean_inference_ms": 1.0268990105038813, "mean_action_processing_ms": 0.20069754835470607, "mean_env_wait_ms": 0.4047240488002327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005930662155151367, "StateBufferConnector_ms": 0.004400730133056641, "ViewRequirementAgentConnector_ms": 0.11754703521728516}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 420.9581518486429, "num_env_steps_trained_throughput_per_sec": 420.9581518486429, "timesteps_total": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 9691.391, "restore_workers_time_ms": 0.015, "training_step_time_ms": 9691.356, "sample_time_ms": 3645.484, "load_time_ms": 0.475, "load_throughput": 8429914.581, "learn_time_ms": 6037.128, "learn_throughput": 662.567, "synch_weights_time_ms": 7.762}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 204, "training_iteration": 36, "trial_id": "3adab_00000", "date": "2024-04-27_21-02-34", "timestamp": 1714276954, "time_this_iter_s": 9.506685018539429, "time_total_s": 360.9942309856415, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 360.9942309856415, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 23.87142857142857, "ram_util_percent": 64.79285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.48480153827257, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7864062832548253, "policy_loss": -0.022691362256044022, "vf_loss": 0.8042182107966753, "vf_explained_var": 0.2805212224683454, "kl": 0.010843194445952921, "entropy": 5.110052408710603, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 33945.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "sampler_results": {"episode_reward_max": -44.40145913048837, "episode_reward_min": -128.94618830001167, "episode_reward_mean": -90.22158918700859, "episode_len_mean": 837.43, "episode_media": {}, "episodes_this_iter": 3, "episodes_timesteps_total": 83743, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-105.25632432739872, -106.74717450599124, -93.24713787307978, -105.51860236068008, -80.85274682837306, -118.68856755295147, -84.24461424998856, -116.56000187537944, -101.98217067477044, -71.26529871672517, -78.78109041943605, -112.75633861562734, -109.43128755094236, -103.24994748049355, -112.99290804542849, -105.96923963363594, -76.46731700440685, -108.7942864982169, -118.97546429885242, -81.05416561234928, -77.83110057242152, -107.93812143102848, -82.89086930759667, -109.03681230851946, -69.52141114787885, -72.50737878015704, -112.08429406063321, -81.43614746691026, -118.8871700998017, -109.83777954607085, -128.94618830001167, -81.30066009587483, -81.49203587650628, -81.62774269316093, -117.3166355107464, -108.00228525346517, -113.13156669907644, -114.00806307334143, -71.22929265460445, -107.73463703757275, -116.69740058917552, -119.27957997105395, -79.98841153322657, -109.62537531947096, -76.06046804029931, -110.68123117450997, -76.71096933982342, -79.28195381240862, -81.24318097893877, -116.55726958086217, -108.45080520448275, -71.5049330513043, -108.99817510498191, -71.33839432765485, -76.4123175444683, -110.86886036306805, -105.7063995313781, -112.18790297305708, -114.27179599144993, -74.89379673712587, -82.537569420321, -60.84522014840885, -105.65046223647893, -107.63569393655285, -60.135861900998854, -56.58436483275952, -112.37795295593205, -110.06555559477458, -112.289329881814, -73.0618333915094, -65.93139194233902, -63.1354409847054, -70.33504340337228, -110.54845221489606, -110.56351098318957, -60.39737731448942, -54.410035980275644, -56.27884201064765, -65.64820985491396, -56.355943061126375, -107.41686162152824, -62.766830404554355, -58.01629541821664, -115.48913874753316, -55.826794609086555, -117.97611289821131, -55.37234301223421, -48.93070490887509, -109.97531712717439, -119.5571604381986, -46.322522700885386, -110.84828170241664, -108.85827739811565, -108.63676094473898, -44.40145913048837, -54.49304067087913, -54.526253331254544, -69.00947375598727, -65.69459862832969, -52.898501993800835], "episode_lengths": [131, 66, 1600, 58, 1600, 72, 1600, 62, 86, 1600, 1600, 58, 55, 73, 59, 133, 1600, 61, 84, 1600, 1600, 59, 1600, 70, 1600, 1600, 100, 1600, 96, 67, 109, 1600, 1600, 1600, 90, 93, 59, 126, 1600, 59, 64, 121, 1600, 78, 1600, 60, 1600, 1600, 1600, 74, 59, 1600, 64, 1600, 1600, 56, 40, 54, 88, 1600, 1600, 1600, 54, 81, 1600, 1600, 43, 97, 77, 1600, 1600, 1600, 1600, 69, 43, 1600, 1600, 1600, 1600, 1600, 94, 1600, 1600, 67, 1600, 61, 1600, 1600, 61, 69, 1600, 86, 73, 84, 1600, 1600, 1600, 1600, 1600, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30376524230623847, "mean_inference_ms": 1.0252787410561253, "mean_action_processing_ms": 0.2003553517885403, "mean_env_wait_ms": 0.4042208216062429, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005877256393432617, "StateBufferConnector_ms": 0.0043773651123046875, "ViewRequirementAgentConnector_ms": 0.11722326278686523}}, "episode_reward_max": -44.40145913048837, "episode_reward_min": -128.94618830001167, "episode_reward_mean": -90.22158918700859, "episode_len_mean": 837.43, "episodes_this_iter": 3, "episodes_timesteps_total": 83743, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-105.25632432739872, -106.74717450599124, -93.24713787307978, -105.51860236068008, -80.85274682837306, -118.68856755295147, -84.24461424998856, -116.56000187537944, -101.98217067477044, -71.26529871672517, -78.78109041943605, -112.75633861562734, -109.43128755094236, -103.24994748049355, -112.99290804542849, -105.96923963363594, -76.46731700440685, -108.7942864982169, -118.97546429885242, -81.05416561234928, -77.83110057242152, -107.93812143102848, -82.89086930759667, -109.03681230851946, -69.52141114787885, -72.50737878015704, -112.08429406063321, -81.43614746691026, -118.8871700998017, -109.83777954607085, -128.94618830001167, -81.30066009587483, -81.49203587650628, -81.62774269316093, -117.3166355107464, -108.00228525346517, -113.13156669907644, -114.00806307334143, -71.22929265460445, -107.73463703757275, -116.69740058917552, -119.27957997105395, -79.98841153322657, -109.62537531947096, -76.06046804029931, -110.68123117450997, -76.71096933982342, -79.28195381240862, -81.24318097893877, -116.55726958086217, -108.45080520448275, -71.5049330513043, -108.99817510498191, -71.33839432765485, -76.4123175444683, -110.86886036306805, -105.7063995313781, -112.18790297305708, -114.27179599144993, -74.89379673712587, -82.537569420321, -60.84522014840885, -105.65046223647893, -107.63569393655285, -60.135861900998854, -56.58436483275952, -112.37795295593205, -110.06555559477458, -112.289329881814, -73.0618333915094, -65.93139194233902, -63.1354409847054, -70.33504340337228, -110.54845221489606, -110.56351098318957, -60.39737731448942, -54.410035980275644, -56.27884201064765, -65.64820985491396, -56.355943061126375, -107.41686162152824, -62.766830404554355, -58.01629541821664, -115.48913874753316, -55.826794609086555, -117.97611289821131, -55.37234301223421, -48.93070490887509, -109.97531712717439, -119.5571604381986, -46.322522700885386, -110.84828170241664, -108.85827739811565, -108.63676094473898, -44.40145913048837, -54.49304067087913, -54.526253331254544, -69.00947375598727, -65.69459862832969, -52.898501993800835], "episode_lengths": [131, 66, 1600, 58, 1600, 72, 1600, 62, 86, 1600, 1600, 58, 55, 73, 59, 133, 1600, 61, 84, 1600, 1600, 59, 1600, 70, 1600, 1600, 100, 1600, 96, 67, 109, 1600, 1600, 1600, 90, 93, 59, 126, 1600, 59, 64, 121, 1600, 78, 1600, 60, 1600, 1600, 1600, 74, 59, 1600, 64, 1600, 1600, 56, 40, 54, 88, 1600, 1600, 1600, 54, 81, 1600, 1600, 43, 97, 77, 1600, 1600, 1600, 1600, 69, 43, 1600, 1600, 1600, 1600, 1600, 94, 1600, 1600, 67, 1600, 61, 1600, 1600, 61, 69, 1600, 86, 73, 84, 1600, 1600, 1600, 1600, 1600, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30376524230623847, "mean_inference_ms": 1.0252787410561253, "mean_action_processing_ms": 0.2003553517885403, "mean_env_wait_ms": 0.4042208216062429, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005877256393432617, "StateBufferConnector_ms": 0.0043773651123046875, "ViewRequirementAgentConnector_ms": 0.11722326278686523}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 425.1503192514187, "num_env_steps_trained_throughput_per_sec": 425.1503192514187, "timesteps_total": 148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 9649.38, "restore_workers_time_ms": 0.012, "training_step_time_ms": 9649.348, "sample_time_ms": 3624.132, "load_time_ms": 0.463, "load_throughput": 8630255.144, "learn_time_ms": 6016.522, "learn_throughput": 664.836, "synch_weights_time_ms": 7.717}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "done": false, "episodes_total": 207, "training_iteration": 37, "trial_id": "3adab_00000", "date": "2024-04-27_21-02-43", "timestamp": 1714276963, "time_this_iter_s": 9.412726163864136, "time_total_s": 370.4069571495056, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 370.4069571495056, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 24.207692307692305, "ram_util_percent": 64.70000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.112005306956588, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6141554654911361, "policy_loss": -0.018964940347077866, "vf_loss": 0.6285588485979906, "vf_explained_var": 0.3699344535668691, "kl": 0.010136797016042838, "entropy": 4.67492084323719, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 34875.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "sampler_results": {"episode_reward_max": -44.40145913048837, "episode_reward_min": -128.94618830001167, "episode_reward_mean": -89.17636687703987, "episode_len_mean": 867.46, "episode_media": {}, "episodes_this_iter": 2, "episodes_timesteps_total": 86746, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-93.24713787307978, -105.51860236068008, -80.85274682837306, -118.68856755295147, -84.24461424998856, -116.56000187537944, -101.98217067477044, -71.26529871672517, -78.78109041943605, -112.75633861562734, -109.43128755094236, -103.24994748049355, -112.99290804542849, -105.96923963363594, -76.46731700440685, -108.7942864982169, -118.97546429885242, -81.05416561234928, -77.83110057242152, -107.93812143102848, -82.89086930759667, -109.03681230851946, -69.52141114787885, -72.50737878015704, -112.08429406063321, -81.43614746691026, -118.8871700998017, -109.83777954607085, -128.94618830001167, -81.30066009587483, -81.49203587650628, -81.62774269316093, -117.3166355107464, -108.00228525346517, -113.13156669907644, -114.00806307334143, -71.22929265460445, -107.73463703757275, -116.69740058917552, -119.27957997105395, -79.98841153322657, -109.62537531947096, -76.06046804029931, -110.68123117450997, -76.71096933982342, -79.28195381240862, -81.24318097893877, -116.55726958086217, -108.45080520448275, -71.5049330513043, -108.99817510498191, -71.33839432765485, -76.4123175444683, -110.86886036306805, -105.7063995313781, -112.18790297305708, -114.27179599144993, -74.89379673712587, -82.537569420321, -60.84522014840885, -105.65046223647893, -107.63569393655285, -60.135861900998854, -56.58436483275952, -112.37795295593205, -110.06555559477458, -112.289329881814, -73.0618333915094, -65.93139194233902, -63.1354409847054, -70.33504340337228, -110.54845221489606, -110.56351098318957, -60.39737731448942, -54.410035980275644, -56.27884201064765, -65.64820985491396, -56.355943061126375, -107.41686162152824, -62.766830404554355, -58.01629541821664, -115.48913874753316, -55.826794609086555, -117.97611289821131, -55.37234301223421, -48.93070490887509, -109.97531712717439, -119.5571604381986, -46.322522700885386, -110.84828170241664, -108.85827739811565, -108.63676094473898, -44.40145913048837, -54.49304067087913, -54.526253331254544, -69.00947375598727, -65.69459862832969, -52.898501993800835, -44.80714526034458, -62.67412257617163], "episode_lengths": [1600, 58, 1600, 72, 1600, 62, 86, 1600, 1600, 58, 55, 73, 59, 133, 1600, 61, 84, 1600, 1600, 59, 1600, 70, 1600, 1600, 100, 1600, 96, 67, 109, 1600, 1600, 1600, 90, 93, 59, 126, 1600, 59, 64, 121, 1600, 78, 1600, 60, 1600, 1600, 1600, 74, 59, 1600, 64, 1600, 1600, 56, 40, 54, 88, 1600, 1600, 1600, 54, 81, 1600, 1600, 43, 97, 77, 1600, 1600, 1600, 1600, 69, 43, 1600, 1600, 1600, 1600, 1600, 94, 1600, 1600, 67, 1600, 61, 1600, 1600, 61, 69, 1600, 86, 73, 84, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30341263111224837, "mean_inference_ms": 1.0241554966785238, "mean_action_processing_ms": 0.20012192234106976, "mean_env_wait_ms": 0.40388157598627616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005905628204345703, "StateBufferConnector_ms": 0.004364490509033203, "ViewRequirementAgentConnector_ms": 0.11707162857055664}}, "episode_reward_max": -44.40145913048837, "episode_reward_min": -128.94618830001167, "episode_reward_mean": -89.17636687703987, "episode_len_mean": 867.46, "episodes_this_iter": 2, "episodes_timesteps_total": 86746, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-93.24713787307978, -105.51860236068008, -80.85274682837306, -118.68856755295147, -84.24461424998856, -116.56000187537944, -101.98217067477044, -71.26529871672517, -78.78109041943605, -112.75633861562734, -109.43128755094236, -103.24994748049355, -112.99290804542849, -105.96923963363594, -76.46731700440685, -108.7942864982169, -118.97546429885242, -81.05416561234928, -77.83110057242152, -107.93812143102848, -82.89086930759667, -109.03681230851946, -69.52141114787885, -72.50737878015704, -112.08429406063321, -81.43614746691026, -118.8871700998017, -109.83777954607085, -128.94618830001167, -81.30066009587483, -81.49203587650628, -81.62774269316093, -117.3166355107464, -108.00228525346517, -113.13156669907644, -114.00806307334143, -71.22929265460445, -107.73463703757275, -116.69740058917552, -119.27957997105395, -79.98841153322657, -109.62537531947096, -76.06046804029931, -110.68123117450997, -76.71096933982342, -79.28195381240862, -81.24318097893877, -116.55726958086217, -108.45080520448275, -71.5049330513043, -108.99817510498191, -71.33839432765485, -76.4123175444683, -110.86886036306805, -105.7063995313781, -112.18790297305708, -114.27179599144993, -74.89379673712587, -82.537569420321, -60.84522014840885, -105.65046223647893, -107.63569393655285, -60.135861900998854, -56.58436483275952, -112.37795295593205, -110.06555559477458, -112.289329881814, -73.0618333915094, -65.93139194233902, -63.1354409847054, -70.33504340337228, -110.54845221489606, -110.56351098318957, -60.39737731448942, -54.410035980275644, -56.27884201064765, -65.64820985491396, -56.355943061126375, -107.41686162152824, -62.766830404554355, -58.01629541821664, -115.48913874753316, -55.826794609086555, -117.97611289821131, -55.37234301223421, -48.93070490887509, -109.97531712717439, -119.5571604381986, -46.322522700885386, -110.84828170241664, -108.85827739811565, -108.63676094473898, -44.40145913048837, -54.49304067087913, -54.526253331254544, -69.00947375598727, -65.69459862832969, -52.898501993800835, -44.80714526034458, -62.67412257617163], "episode_lengths": [1600, 58, 1600, 72, 1600, 62, 86, 1600, 1600, 58, 55, 73, 59, 133, 1600, 61, 84, 1600, 1600, 59, 1600, 70, 1600, 1600, 100, 1600, 96, 67, 109, 1600, 1600, 1600, 90, 93, 59, 126, 1600, 59, 64, 121, 1600, 78, 1600, 60, 1600, 1600, 1600, 74, 59, 1600, 64, 1600, 1600, 56, 40, 54, 88, 1600, 1600, 1600, 54, 81, 1600, 1600, 43, 97, 77, 1600, 1600, 1600, 1600, 69, 43, 1600, 1600, 1600, 1600, 1600, 94, 1600, 1600, 67, 1600, 61, 1600, 1600, 61, 69, 1600, 86, 73, 84, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30341263111224837, "mean_inference_ms": 1.0241554966785238, "mean_action_processing_ms": 0.20012192234106976, "mean_env_wait_ms": 0.40388157598627616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005905628204345703, "StateBufferConnector_ms": 0.004364490509033203, "ViewRequirementAgentConnector_ms": 0.11707162857055664}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 422.37215872972877, "num_env_steps_trained_throughput_per_sec": 422.37215872972877, "timesteps_total": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 9632.607, "restore_workers_time_ms": 0.012, "training_step_time_ms": 9632.575, "sample_time_ms": 3614.446, "load_time_ms": 0.452, "load_throughput": 8845943.267, "learn_time_ms": 6009.443, "learn_throughput": 665.619, "synch_weights_time_ms": 7.724}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "episodes_total": 209, "training_iteration": 38, "trial_id": "3adab_00000", "date": "2024-04-27_21-02-53", "timestamp": 1714276973, "time_this_iter_s": 9.474351644515991, "time_total_s": 379.8813087940216, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 379.8813087940216, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 23.935714285714287, "ram_util_percent": 64.70000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.216996049368253, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3509334352579698, "policy_loss": -0.03200008968512217, "vf_loss": 1.3773088775655276, "vf_explained_var": 0.24994380967591398, "kl": 0.012499228444248419, "entropy": 5.441213017638011, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 35805.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "sampler_results": {"episode_reward_max": -37.018664170824586, "episode_reward_min": -131.1858862363187, "episode_reward_mean": -88.88234971757187, "episode_len_mean": 853.63, "episode_media": {}, "episodes_this_iter": 5, "episodes_timesteps_total": 85363, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-116.56000187537944, -101.98217067477044, -71.26529871672517, -78.78109041943605, -112.75633861562734, -109.43128755094236, -103.24994748049355, -112.99290804542849, -105.96923963363594, -76.46731700440685, -108.7942864982169, -118.97546429885242, -81.05416561234928, -77.83110057242152, -107.93812143102848, -82.89086930759667, -109.03681230851946, -69.52141114787885, -72.50737878015704, -112.08429406063321, -81.43614746691026, -118.8871700998017, -109.83777954607085, -128.94618830001167, -81.30066009587483, -81.49203587650628, -81.62774269316093, -117.3166355107464, -108.00228525346517, -113.13156669907644, -114.00806307334143, -71.22929265460445, -107.73463703757275, -116.69740058917552, -119.27957997105395, -79.98841153322657, -109.62537531947096, -76.06046804029931, -110.68123117450997, -76.71096933982342, -79.28195381240862, -81.24318097893877, -116.55726958086217, -108.45080520448275, -71.5049330513043, -108.99817510498191, -71.33839432765485, -76.4123175444683, -110.86886036306805, -105.7063995313781, -112.18790297305708, -114.27179599144993, -74.89379673712587, -82.537569420321, -60.84522014840885, -105.65046223647893, -107.63569393655285, -60.135861900998854, -56.58436483275952, -112.37795295593205, -110.06555559477458, -112.289329881814, -73.0618333915094, -65.93139194233902, -63.1354409847054, -70.33504340337228, -110.54845221489606, -110.56351098318957, -60.39737731448942, -54.410035980275644, -56.27884201064765, -65.64820985491396, -56.355943061126375, -107.41686162152824, -62.766830404554355, -58.01629541821664, -115.48913874753316, -55.826794609086555, -117.97611289821131, -55.37234301223421, -48.93070490887509, -109.97531712717439, -119.5571604381986, -46.322522700885386, -110.84828170241664, -108.85827739811565, -108.63676094473898, -44.40145913048837, -54.49304067087913, -54.526253331254544, -69.00947375598727, -65.69459862832969, -52.898501993800835, -44.80714526034458, -62.67412257617163, -37.018664170824586, -119.58076097634682, -53.88912565674515, -131.1858862363187, -111.47551587803724], "episode_lengths": [62, 86, 1600, 1600, 58, 55, 73, 59, 133, 1600, 61, 84, 1600, 1600, 59, 1600, 70, 1600, 1600, 100, 1600, 96, 67, 109, 1600, 1600, 1600, 90, 93, 59, 126, 1600, 59, 64, 121, 1600, 78, 1600, 60, 1600, 1600, 1600, 74, 59, 1600, 64, 1600, 1600, 56, 40, 54, 88, 1600, 1600, 1600, 54, 81, 1600, 1600, 43, 97, 77, 1600, 1600, 1600, 1600, 69, 43, 1600, 1600, 1600, 1600, 1600, 94, 1600, 1600, 67, 1600, 61, 1600, 1600, 61, 69, 1600, 86, 73, 84, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 102, 1600, 128, 117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3026658076772943, "mean_inference_ms": 1.0215946661387303, "mean_action_processing_ms": 0.19963853328274467, "mean_env_wait_ms": 0.4031824797016628, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005913972854614258, "StateBufferConnector_ms": 0.004378557205200195, "ViewRequirementAgentConnector_ms": 0.11789584159851074}}, "episode_reward_max": -37.018664170824586, "episode_reward_min": -131.1858862363187, "episode_reward_mean": -88.88234971757187, "episode_len_mean": 853.63, "episodes_this_iter": 5, "episodes_timesteps_total": 85363, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-116.56000187537944, -101.98217067477044, -71.26529871672517, -78.78109041943605, -112.75633861562734, -109.43128755094236, -103.24994748049355, -112.99290804542849, -105.96923963363594, -76.46731700440685, -108.7942864982169, -118.97546429885242, -81.05416561234928, -77.83110057242152, -107.93812143102848, -82.89086930759667, -109.03681230851946, -69.52141114787885, -72.50737878015704, -112.08429406063321, -81.43614746691026, -118.8871700998017, -109.83777954607085, -128.94618830001167, -81.30066009587483, -81.49203587650628, -81.62774269316093, -117.3166355107464, -108.00228525346517, -113.13156669907644, -114.00806307334143, -71.22929265460445, -107.73463703757275, -116.69740058917552, -119.27957997105395, -79.98841153322657, -109.62537531947096, -76.06046804029931, -110.68123117450997, -76.71096933982342, -79.28195381240862, -81.24318097893877, -116.55726958086217, -108.45080520448275, -71.5049330513043, -108.99817510498191, -71.33839432765485, -76.4123175444683, -110.86886036306805, -105.7063995313781, -112.18790297305708, -114.27179599144993, -74.89379673712587, -82.537569420321, -60.84522014840885, -105.65046223647893, -107.63569393655285, -60.135861900998854, -56.58436483275952, -112.37795295593205, -110.06555559477458, -112.289329881814, -73.0618333915094, -65.93139194233902, -63.1354409847054, -70.33504340337228, -110.54845221489606, -110.56351098318957, -60.39737731448942, -54.410035980275644, -56.27884201064765, -65.64820985491396, -56.355943061126375, -107.41686162152824, -62.766830404554355, -58.01629541821664, -115.48913874753316, -55.826794609086555, -117.97611289821131, -55.37234301223421, -48.93070490887509, -109.97531712717439, -119.5571604381986, -46.322522700885386, -110.84828170241664, -108.85827739811565, -108.63676094473898, -44.40145913048837, -54.49304067087913, -54.526253331254544, -69.00947375598727, -65.69459862832969, -52.898501993800835, -44.80714526034458, -62.67412257617163, -37.018664170824586, -119.58076097634682, -53.88912565674515, -131.1858862363187, -111.47551587803724], "episode_lengths": [62, 86, 1600, 1600, 58, 55, 73, 59, 133, 1600, 61, 84, 1600, 1600, 59, 1600, 70, 1600, 1600, 100, 1600, 96, 67, 109, 1600, 1600, 1600, 90, 93, 59, 126, 1600, 59, 64, 121, 1600, 78, 1600, 60, 1600, 1600, 1600, 74, 59, 1600, 64, 1600, 1600, 56, 40, 54, 88, 1600, 1600, 1600, 54, 81, 1600, 1600, 43, 97, 77, 1600, 1600, 1600, 1600, 69, 43, 1600, 1600, 1600, 1600, 1600, 94, 1600, 1600, 67, 1600, 61, 1600, 1600, 61, 69, 1600, 86, 73, 84, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 102, 1600, 128, 117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3026658076772943, "mean_inference_ms": 1.0215946661387303, "mean_action_processing_ms": 0.19963853328274467, "mean_env_wait_ms": 0.4031824797016628, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005913972854614258, "StateBufferConnector_ms": 0.004378557205200195, "ViewRequirementAgentConnector_ms": 0.11789584159851074}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 412.37185163417047, "num_env_steps_trained_throughput_per_sec": 412.37185163417047, "timesteps_total": 156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 9662.596, "restore_workers_time_ms": 0.012, "training_step_time_ms": 9662.564, "sample_time_ms": 3618.477, "load_time_ms": 0.447, "load_throughput": 8949280.418, "learn_time_ms": 6035.541, "learn_throughput": 662.741, "synch_weights_time_ms": 7.593}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "episodes_total": 214, "training_iteration": 39, "trial_id": "3adab_00000", "date": "2024-04-27_21-03-02", "timestamp": 1714276982, "time_this_iter_s": 9.704906940460205, "time_total_s": 389.5862157344818, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 389.5862157344818, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 25.142857142857142, "ram_util_percent": 64.7642857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.614307740683197, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5463036629526565, "policy_loss": -0.038114524424396536, "vf_loss": 0.5791927953080465, "vf_explained_var": 0.3469703197479248, "kl": 0.011611989478001634, "entropy": 4.8285287498145975, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 36735.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "sampler_results": {"episode_reward_max": -37.018664170824586, "episode_reward_min": -131.1858862363187, "episode_reward_mean": -87.43219233396282, "episode_len_mean": 884.15, "episode_media": {}, "episodes_this_iter": 3, "episodes_timesteps_total": 88415, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-78.78109041943605, -112.75633861562734, -109.43128755094236, -103.24994748049355, -112.99290804542849, -105.96923963363594, -76.46731700440685, -108.7942864982169, -118.97546429885242, -81.05416561234928, -77.83110057242152, -107.93812143102848, -82.89086930759667, -109.03681230851946, -69.52141114787885, -72.50737878015704, -112.08429406063321, -81.43614746691026, -118.8871700998017, -109.83777954607085, -128.94618830001167, -81.30066009587483, -81.49203587650628, -81.62774269316093, -117.3166355107464, -108.00228525346517, -113.13156669907644, -114.00806307334143, -71.22929265460445, -107.73463703757275, -116.69740058917552, -119.27957997105395, -79.98841153322657, -109.62537531947096, -76.06046804029931, -110.68123117450997, -76.71096933982342, -79.28195381240862, -81.24318097893877, -116.55726958086217, -108.45080520448275, -71.5049330513043, -108.99817510498191, -71.33839432765485, -76.4123175444683, -110.86886036306805, -105.7063995313781, -112.18790297305708, -114.27179599144993, -74.89379673712587, -82.537569420321, -60.84522014840885, -105.65046223647893, -107.63569393655285, -60.135861900998854, -56.58436483275952, -112.37795295593205, -110.06555559477458, -112.289329881814, -73.0618333915094, -65.93139194233902, -63.1354409847054, -70.33504340337228, -110.54845221489606, -110.56351098318957, -60.39737731448942, -54.410035980275644, -56.27884201064765, -65.64820985491396, -56.355943061126375, -107.41686162152824, -62.766830404554355, -58.01629541821664, -115.48913874753316, -55.826794609086555, -117.97611289821131, -55.37234301223421, -48.93070490887509, -109.97531712717439, -119.5571604381986, -46.322522700885386, -110.84828170241664, -108.85827739811565, -108.63676094473898, -44.40145913048837, -54.49304067087913, -54.526253331254544, -69.00947375598727, -65.69459862832969, -52.898501993800835, -44.80714526034458, -62.67412257617163, -37.018664170824586, -119.58076097634682, -53.88912565674515, -131.1858862363187, -111.47551587803724, -42.82743967373426, -53.455906241053015, -48.508386991182924], "episode_lengths": [1600, 58, 55, 73, 59, 133, 1600, 61, 84, 1600, 1600, 59, 1600, 70, 1600, 1600, 100, 1600, 96, 67, 109, 1600, 1600, 1600, 90, 93, 59, 126, 1600, 59, 64, 121, 1600, 78, 1600, 60, 1600, 1600, 1600, 74, 59, 1600, 64, 1600, 1600, 56, 40, 54, 88, 1600, 1600, 1600, 54, 81, 1600, 1600, 43, 97, 77, 1600, 1600, 1600, 1600, 69, 43, 1600, 1600, 1600, 1600, 1600, 94, 1600, 1600, 67, 1600, 61, 1600, 1600, 61, 69, 1600, 86, 73, 84, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 102, 1600, 128, 117, 1600, 1600, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30227314695418067, "mean_inference_ms": 1.0201590315443518, "mean_action_processing_ms": 0.1993853707042809, "mean_env_wait_ms": 0.4028174006621726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005850553512573242, "StateBufferConnector_ms": 0.004361867904663086, "ViewRequirementAgentConnector_ms": 0.11673426628112793}}, "episode_reward_max": -37.018664170824586, "episode_reward_min": -131.1858862363187, "episode_reward_mean": -87.43219233396282, "episode_len_mean": 884.15, "episodes_this_iter": 3, "episodes_timesteps_total": 88415, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-78.78109041943605, -112.75633861562734, -109.43128755094236, -103.24994748049355, -112.99290804542849, -105.96923963363594, -76.46731700440685, -108.7942864982169, -118.97546429885242, -81.05416561234928, -77.83110057242152, -107.93812143102848, -82.89086930759667, -109.03681230851946, -69.52141114787885, -72.50737878015704, -112.08429406063321, -81.43614746691026, -118.8871700998017, -109.83777954607085, -128.94618830001167, -81.30066009587483, -81.49203587650628, -81.62774269316093, -117.3166355107464, -108.00228525346517, -113.13156669907644, -114.00806307334143, -71.22929265460445, -107.73463703757275, -116.69740058917552, -119.27957997105395, -79.98841153322657, -109.62537531947096, -76.06046804029931, -110.68123117450997, -76.71096933982342, -79.28195381240862, -81.24318097893877, -116.55726958086217, -108.45080520448275, -71.5049330513043, -108.99817510498191, -71.33839432765485, -76.4123175444683, -110.86886036306805, -105.7063995313781, -112.18790297305708, -114.27179599144993, -74.89379673712587, -82.537569420321, -60.84522014840885, -105.65046223647893, -107.63569393655285, -60.135861900998854, -56.58436483275952, -112.37795295593205, -110.06555559477458, -112.289329881814, -73.0618333915094, -65.93139194233902, -63.1354409847054, -70.33504340337228, -110.54845221489606, -110.56351098318957, -60.39737731448942, -54.410035980275644, -56.27884201064765, -65.64820985491396, -56.355943061126375, -107.41686162152824, -62.766830404554355, -58.01629541821664, -115.48913874753316, -55.826794609086555, -117.97611289821131, -55.37234301223421, -48.93070490887509, -109.97531712717439, -119.5571604381986, -46.322522700885386, -110.84828170241664, -108.85827739811565, -108.63676094473898, -44.40145913048837, -54.49304067087913, -54.526253331254544, -69.00947375598727, -65.69459862832969, -52.898501993800835, -44.80714526034458, -62.67412257617163, -37.018664170824586, -119.58076097634682, -53.88912565674515, -131.1858862363187, -111.47551587803724, -42.82743967373426, -53.455906241053015, -48.508386991182924], "episode_lengths": [1600, 58, 55, 73, 59, 133, 1600, 61, 84, 1600, 1600, 59, 1600, 70, 1600, 1600, 100, 1600, 96, 67, 109, 1600, 1600, 1600, 90, 93, 59, 126, 1600, 59, 64, 121, 1600, 78, 1600, 60, 1600, 1600, 1600, 74, 59, 1600, 64, 1600, 1600, 56, 40, 54, 88, 1600, 1600, 1600, 54, 81, 1600, 1600, 43, 97, 77, 1600, 1600, 1600, 1600, 69, 43, 1600, 1600, 1600, 1600, 1600, 94, 1600, 1600, 67, 1600, 61, 1600, 1600, 61, 69, 1600, 86, 73, 84, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 102, 1600, 128, 117, 1600, 1600, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30227314695418067, "mean_inference_ms": 1.0201590315443518, "mean_action_processing_ms": 0.1993853707042809, "mean_env_wait_ms": 0.4028174006621726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005850553512573242, "StateBufferConnector_ms": 0.004361867904663086, "ViewRequirementAgentConnector_ms": 0.11673426628112793}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 407.584249108632, "num_env_steps_trained_throughput_per_sec": 407.584249108632, "timesteps_total": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 9652.9, "restore_workers_time_ms": 0.012, "training_step_time_ms": 9652.867, "sample_time_ms": 3651.287, "load_time_ms": 0.444, "load_throughput": 9004033.704, "learn_time_ms": 5993.145, "learn_throughput": 667.429, "synch_weights_time_ms": 7.493}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "episodes_total": 217, "training_iteration": 40, "trial_id": "3adab_00000", "date": "2024-04-27_21-03-12", "timestamp": 1714276992, "time_this_iter_s": 9.81828784942627, "time_total_s": 399.4045035839081, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 399.4045035839081, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 26.371428571428574, "ram_util_percent": 65.06428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.57447702365537, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9498173132767871, "policy_loss": -0.03554553897470556, "vf_loss": 0.9806953010379628, "vf_explained_var": 0.2551027338350973, "kl": 0.01037234713086992, "entropy": 5.240894938027987, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 37665.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "sampler_results": {"episode_reward_max": -36.38964792697386, "episode_reward_min": -131.1858862363187, "episode_reward_mean": -86.42384862025888, "episode_len_mean": 899.79, "episode_media": {}, "episodes_this_iter": 4, "episodes_timesteps_total": 89979, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-112.99290804542849, -105.96923963363594, -76.46731700440685, -108.7942864982169, -118.97546429885242, -81.05416561234928, -77.83110057242152, -107.93812143102848, -82.89086930759667, -109.03681230851946, -69.52141114787885, -72.50737878015704, -112.08429406063321, -81.43614746691026, -118.8871700998017, -109.83777954607085, -128.94618830001167, -81.30066009587483, -81.49203587650628, -81.62774269316093, -117.3166355107464, -108.00228525346517, -113.13156669907644, -114.00806307334143, -71.22929265460445, -107.73463703757275, -116.69740058917552, -119.27957997105395, -79.98841153322657, -109.62537531947096, -76.06046804029931, -110.68123117450997, -76.71096933982342, -79.28195381240862, -81.24318097893877, -116.55726958086217, -108.45080520448275, -71.5049330513043, -108.99817510498191, -71.33839432765485, -76.4123175444683, -110.86886036306805, -105.7063995313781, -112.18790297305708, -114.27179599144993, -74.89379673712587, -82.537569420321, -60.84522014840885, -105.65046223647893, -107.63569393655285, -60.135861900998854, -56.58436483275952, -112.37795295593205, -110.06555559477458, -112.289329881814, -73.0618333915094, -65.93139194233902, -63.1354409847054, -70.33504340337228, -110.54845221489606, -110.56351098318957, -60.39737731448942, -54.410035980275644, -56.27884201064765, -65.64820985491396, -56.355943061126375, -107.41686162152824, -62.766830404554355, -58.01629541821664, -115.48913874753316, -55.826794609086555, -117.97611289821131, -55.37234301223421, -48.93070490887509, -109.97531712717439, -119.5571604381986, -46.322522700885386, -110.84828170241664, -108.85827739811565, -108.63676094473898, -44.40145913048837, -54.49304067087913, -54.526253331254544, -69.00947375598727, -65.69459862832969, -52.898501993800835, -44.80714526034458, -62.67412257617163, -37.018664170824586, -119.58076097634682, -53.88912565674515, -131.1858862363187, -111.47551587803724, -42.82743967373426, -53.455906241053015, -48.508386991182924, -42.07935003574508, -108.6692933649936, -116.2460013683966, -36.38964792697386], "episode_lengths": [59, 133, 1600, 61, 84, 1600, 1600, 59, 1600, 70, 1600, 1600, 100, 1600, 96, 67, 109, 1600, 1600, 1600, 90, 93, 59, 126, 1600, 59, 64, 121, 1600, 78, 1600, 60, 1600, 1600, 1600, 74, 59, 1600, 64, 1600, 1600, 56, 40, 54, 88, 1600, 1600, 1600, 54, 81, 1600, 1600, 43, 97, 77, 1600, 1600, 1600, 1600, 69, 43, 1600, 1600, 1600, 1600, 1600, 94, 1600, 1600, 67, 1600, 61, 1600, 1600, 61, 69, 1600, 86, 73, 84, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 102, 1600, 128, 117, 1600, 1600, 1600, 1600, 66, 84, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30173039889979886, "mean_inference_ms": 1.0181002559284729, "mean_action_processing_ms": 0.19904953547269277, "mean_env_wait_ms": 0.40233549790312345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005826711654663086, "StateBufferConnector_ms": 0.00432586669921875, "ViewRequirementAgentConnector_ms": 0.1158137321472168}}, "episode_reward_max": -36.38964792697386, "episode_reward_min": -131.1858862363187, "episode_reward_mean": -86.42384862025888, "episode_len_mean": 899.79, "episodes_this_iter": 4, "episodes_timesteps_total": 89979, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-112.99290804542849, -105.96923963363594, -76.46731700440685, -108.7942864982169, -118.97546429885242, -81.05416561234928, -77.83110057242152, -107.93812143102848, -82.89086930759667, -109.03681230851946, -69.52141114787885, -72.50737878015704, -112.08429406063321, -81.43614746691026, -118.8871700998017, -109.83777954607085, -128.94618830001167, -81.30066009587483, -81.49203587650628, -81.62774269316093, -117.3166355107464, -108.00228525346517, -113.13156669907644, -114.00806307334143, -71.22929265460445, -107.73463703757275, -116.69740058917552, -119.27957997105395, -79.98841153322657, -109.62537531947096, -76.06046804029931, -110.68123117450997, -76.71096933982342, -79.28195381240862, -81.24318097893877, -116.55726958086217, -108.45080520448275, -71.5049330513043, -108.99817510498191, -71.33839432765485, -76.4123175444683, -110.86886036306805, -105.7063995313781, -112.18790297305708, -114.27179599144993, -74.89379673712587, -82.537569420321, -60.84522014840885, -105.65046223647893, -107.63569393655285, -60.135861900998854, -56.58436483275952, -112.37795295593205, -110.06555559477458, -112.289329881814, -73.0618333915094, -65.93139194233902, -63.1354409847054, -70.33504340337228, -110.54845221489606, -110.56351098318957, -60.39737731448942, -54.410035980275644, -56.27884201064765, -65.64820985491396, -56.355943061126375, -107.41686162152824, -62.766830404554355, -58.01629541821664, -115.48913874753316, -55.826794609086555, -117.97611289821131, -55.37234301223421, -48.93070490887509, -109.97531712717439, -119.5571604381986, -46.322522700885386, -110.84828170241664, -108.85827739811565, -108.63676094473898, -44.40145913048837, -54.49304067087913, -54.526253331254544, -69.00947375598727, -65.69459862832969, -52.898501993800835, -44.80714526034458, -62.67412257617163, -37.018664170824586, -119.58076097634682, -53.88912565674515, -131.1858862363187, -111.47551587803724, -42.82743967373426, -53.455906241053015, -48.508386991182924, -42.07935003574508, -108.6692933649936, -116.2460013683966, -36.38964792697386], "episode_lengths": [59, 133, 1600, 61, 84, 1600, 1600, 59, 1600, 70, 1600, 1600, 100, 1600, 96, 67, 109, 1600, 1600, 1600, 90, 93, 59, 126, 1600, 59, 64, 121, 1600, 78, 1600, 60, 1600, 1600, 1600, 74, 59, 1600, 64, 1600, 1600, 56, 40, 54, 88, 1600, 1600, 1600, 54, 81, 1600, 1600, 43, 97, 77, 1600, 1600, 1600, 1600, 69, 43, 1600, 1600, 1600, 1600, 1600, 94, 1600, 1600, 67, 1600, 61, 1600, 1600, 61, 69, 1600, 86, 73, 84, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 102, 1600, 128, 117, 1600, 1600, 1600, 1600, 66, 84, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30173039889979886, "mean_inference_ms": 1.0181002559284729, "mean_action_processing_ms": 0.19904953547269277, "mean_env_wait_ms": 0.40233549790312345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005826711654663086, "StateBufferConnector_ms": 0.00432586669921875, "ViewRequirementAgentConnector_ms": 0.1158137321472168}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 384.66539906257213, "num_env_steps_trained_throughput_per_sec": 384.66539906257213, "timesteps_total": 164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 164000, "timers": {"training_iteration_time_ms": 9704.326, "restore_workers_time_ms": 0.012, "training_step_time_ms": 9704.293, "sample_time_ms": 3627.787, "load_time_ms": 0.445, "load_throughput": 8995826.273, "learn_time_ms": 6067.884, "learn_throughput": 659.208, "synch_weights_time_ms": 7.643}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "done": false, "episodes_total": 221, "training_iteration": 41, "trial_id": "3adab_00000", "date": "2024-04-27_21-03-23", "timestamp": 1714277003, "time_this_iter_s": 10.403212785720825, "time_total_s": 409.8077163696289, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 409.8077163696289, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 32.01428571428572, "ram_util_percent": 65.22142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.839071764484528, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3943017535237097, "policy_loss": -0.043286818956896185, "vf_loss": 2.4290484483644206, "vf_explained_var": 0.2680396794631917, "kl": 0.018978073491856727, "entropy": 6.858037942455661, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 38595.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "sampler_results": {"episode_reward_max": -32.85346420755551, "episode_reward_min": -131.1858862363187, "episode_reward_mean": -86.97134319380922, "episode_len_mean": 854.01, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 85401, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-72.50737878015704, -112.08429406063321, -81.43614746691026, -118.8871700998017, -109.83777954607085, -128.94618830001167, -81.30066009587483, -81.49203587650628, -81.62774269316093, -117.3166355107464, -108.00228525346517, -113.13156669907644, -114.00806307334143, -71.22929265460445, -107.73463703757275, -116.69740058917552, -119.27957997105395, -79.98841153322657, -109.62537531947096, -76.06046804029931, -110.68123117450997, -76.71096933982342, -79.28195381240862, -81.24318097893877, -116.55726958086217, -108.45080520448275, -71.5049330513043, -108.99817510498191, -71.33839432765485, -76.4123175444683, -110.86886036306805, -105.7063995313781, -112.18790297305708, -114.27179599144993, -74.89379673712587, -82.537569420321, -60.84522014840885, -105.65046223647893, -107.63569393655285, -60.135861900998854, -56.58436483275952, -112.37795295593205, -110.06555559477458, -112.289329881814, -73.0618333915094, -65.93139194233902, -63.1354409847054, -70.33504340337228, -110.54845221489606, -110.56351098318957, -60.39737731448942, -54.410035980275644, -56.27884201064765, -65.64820985491396, -56.355943061126375, -107.41686162152824, -62.766830404554355, -58.01629541821664, -115.48913874753316, -55.826794609086555, -117.97611289821131, -55.37234301223421, -48.93070490887509, -109.97531712717439, -119.5571604381986, -46.322522700885386, -110.84828170241664, -108.85827739811565, -108.63676094473898, -44.40145913048837, -54.49304067087913, -54.526253331254544, -69.00947375598727, -65.69459862832969, -52.898501993800835, -44.80714526034458, -62.67412257617163, -37.018664170824586, -119.58076097634682, -53.88912565674515, -131.1858862363187, -111.47551587803724, -42.82743967373426, -53.455906241053015, -48.508386991182924, -42.07935003574508, -108.6692933649936, -116.2460013683966, -36.38964792697386, -32.85346420755551, -115.03632864363368, -110.88993607502059, -116.46049116161839, -121.33477026235747, -115.26672389787375, -119.10003350916195, -37.6444486595249, -110.39974471087443, -107.51318571950185, -119.72202636824487], "episode_lengths": [1600, 100, 1600, 96, 67, 109, 1600, 1600, 1600, 90, 93, 59, 126, 1600, 59, 64, 121, 1600, 78, 1600, 60, 1600, 1600, 1600, 74, 59, 1600, 64, 1600, 1600, 56, 40, 54, 88, 1600, 1600, 1600, 54, 81, 1600, 1600, 43, 97, 77, 1600, 1600, 1600, 1600, 69, 43, 1600, 1600, 1600, 1600, 1600, 94, 1600, 1600, 67, 1600, 61, 1600, 1600, 61, 69, 1600, 86, 73, 84, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 102, 1600, 128, 117, 1600, 1600, 1600, 1600, 66, 84, 1600, 1600, 70, 49, 62, 74, 169, 60, 1600, 77, 64, 63]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3002644969361037, "mean_inference_ms": 1.0130645082007876, "mean_action_processing_ms": 0.19810670053434726, "mean_env_wait_ms": 0.40082827887387906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0057506561279296875, "StateBufferConnector_ms": 0.004172325134277344, "ViewRequirementAgentConnector_ms": 0.11490678787231445}}, "episode_reward_max": -32.85346420755551, "episode_reward_min": -131.1858862363187, "episode_reward_mean": -86.97134319380922, "episode_len_mean": 854.01, "episodes_this_iter": 11, "episodes_timesteps_total": 85401, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-72.50737878015704, -112.08429406063321, -81.43614746691026, -118.8871700998017, -109.83777954607085, -128.94618830001167, -81.30066009587483, -81.49203587650628, -81.62774269316093, -117.3166355107464, -108.00228525346517, -113.13156669907644, -114.00806307334143, -71.22929265460445, -107.73463703757275, -116.69740058917552, -119.27957997105395, -79.98841153322657, -109.62537531947096, -76.06046804029931, -110.68123117450997, -76.71096933982342, -79.28195381240862, -81.24318097893877, -116.55726958086217, -108.45080520448275, -71.5049330513043, -108.99817510498191, -71.33839432765485, -76.4123175444683, -110.86886036306805, -105.7063995313781, -112.18790297305708, -114.27179599144993, -74.89379673712587, -82.537569420321, -60.84522014840885, -105.65046223647893, -107.63569393655285, -60.135861900998854, -56.58436483275952, -112.37795295593205, -110.06555559477458, -112.289329881814, -73.0618333915094, -65.93139194233902, -63.1354409847054, -70.33504340337228, -110.54845221489606, -110.56351098318957, -60.39737731448942, -54.410035980275644, -56.27884201064765, -65.64820985491396, -56.355943061126375, -107.41686162152824, -62.766830404554355, -58.01629541821664, -115.48913874753316, -55.826794609086555, -117.97611289821131, -55.37234301223421, -48.93070490887509, -109.97531712717439, -119.5571604381986, -46.322522700885386, -110.84828170241664, -108.85827739811565, -108.63676094473898, -44.40145913048837, -54.49304067087913, -54.526253331254544, -69.00947375598727, -65.69459862832969, -52.898501993800835, -44.80714526034458, -62.67412257617163, -37.018664170824586, -119.58076097634682, -53.88912565674515, -131.1858862363187, -111.47551587803724, -42.82743967373426, -53.455906241053015, -48.508386991182924, -42.07935003574508, -108.6692933649936, -116.2460013683966, -36.38964792697386, -32.85346420755551, -115.03632864363368, -110.88993607502059, -116.46049116161839, -121.33477026235747, -115.26672389787375, -119.10003350916195, -37.6444486595249, -110.39974471087443, -107.51318571950185, -119.72202636824487], "episode_lengths": [1600, 100, 1600, 96, 67, 109, 1600, 1600, 1600, 90, 93, 59, 126, 1600, 59, 64, 121, 1600, 78, 1600, 60, 1600, 1600, 1600, 74, 59, 1600, 64, 1600, 1600, 56, 40, 54, 88, 1600, 1600, 1600, 54, 81, 1600, 1600, 43, 97, 77, 1600, 1600, 1600, 1600, 69, 43, 1600, 1600, 1600, 1600, 1600, 94, 1600, 1600, 67, 1600, 61, 1600, 1600, 61, 69, 1600, 86, 73, 84, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 102, 1600, 128, 117, 1600, 1600, 1600, 1600, 66, 84, 1600, 1600, 70, 49, 62, 74, 169, 60, 1600, 77, 64, 63]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3002644969361037, "mean_inference_ms": 1.0130645082007876, "mean_action_processing_ms": 0.19810670053434726, "mean_env_wait_ms": 0.40082827887387906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0057506561279296875, "StateBufferConnector_ms": 0.004172325134277344, "ViewRequirementAgentConnector_ms": 0.11490678787231445}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 410.8856628440612, "num_env_steps_trained_throughput_per_sec": 410.8856628440612, "timesteps_total": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 9655.834, "restore_workers_time_ms": 0.012, "training_step_time_ms": 9655.801, "sample_time_ms": 3633.425, "load_time_ms": 0.464, "load_throughput": 8616072.309, "learn_time_ms": 6013.75, "learn_throughput": 665.142, "synch_weights_time_ms": 7.636}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "episodes_total": 232, "training_iteration": 42, "trial_id": "3adab_00000", "date": "2024-04-27_21-03-32", "timestamp": 1714277012, "time_this_iter_s": 9.739583969116211, "time_total_s": 419.5473003387451, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 419.5473003387451, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 27.15, "ram_util_percent": 64.82142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.068532807788543, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9692774754100209, "policy_loss": -0.036763308397544325, "vf_loss": 1.9995487228196154, "vf_explained_var": 0.3262978764631415, "kl": 0.014426789279393993, "entropy": 6.101428159077963, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 39525.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "sampler_results": {"episode_reward_max": -31.232718334318484, "episode_reward_min": -132.96352189190813, "episode_reward_mean": -85.68195305241198, "episode_len_mean": 853.33, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 85333, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-81.49203587650628, -81.62774269316093, -117.3166355107464, -108.00228525346517, -113.13156669907644, -114.00806307334143, -71.22929265460445, -107.73463703757275, -116.69740058917552, -119.27957997105395, -79.98841153322657, -109.62537531947096, -76.06046804029931, -110.68123117450997, -76.71096933982342, -79.28195381240862, -81.24318097893877, -116.55726958086217, -108.45080520448275, -71.5049330513043, -108.99817510498191, -71.33839432765485, -76.4123175444683, -110.86886036306805, -105.7063995313781, -112.18790297305708, -114.27179599144993, -74.89379673712587, -82.537569420321, -60.84522014840885, -105.65046223647893, -107.63569393655285, -60.135861900998854, -56.58436483275952, -112.37795295593205, -110.06555559477458, -112.289329881814, -73.0618333915094, -65.93139194233902, -63.1354409847054, -70.33504340337228, -110.54845221489606, -110.56351098318957, -60.39737731448942, -54.410035980275644, -56.27884201064765, -65.64820985491396, -56.355943061126375, -107.41686162152824, -62.766830404554355, -58.01629541821664, -115.48913874753316, -55.826794609086555, -117.97611289821131, -55.37234301223421, -48.93070490887509, -109.97531712717439, -119.5571604381986, -46.322522700885386, -110.84828170241664, -108.85827739811565, -108.63676094473898, -44.40145913048837, -54.49304067087913, -54.526253331254544, -69.00947375598727, -65.69459862832969, -52.898501993800835, -44.80714526034458, -62.67412257617163, -37.018664170824586, -119.58076097634682, -53.88912565674515, -131.1858862363187, -111.47551587803724, -42.82743967373426, -53.455906241053015, -48.508386991182924, -42.07935003574508, -108.6692933649936, -116.2460013683966, -36.38964792697386, -32.85346420755551, -115.03632864363368, -110.88993607502059, -116.46049116161839, -121.33477026235747, -115.26672389787375, -119.10003350916195, -37.6444486595249, -110.39974471087443, -107.51318571950185, -119.72202636824487, -37.44913765496755, -110.27272578047216, -31.232718334318484, -105.76328540924005, -52.119061673338834, -106.26015346548893, -132.96352189190813], "episode_lengths": [1600, 1600, 90, 93, 59, 126, 1600, 59, 64, 121, 1600, 78, 1600, 60, 1600, 1600, 1600, 74, 59, 1600, 64, 1600, 1600, 56, 40, 54, 88, 1600, 1600, 1600, 54, 81, 1600, 1600, 43, 97, 77, 1600, 1600, 1600, 1600, 69, 43, 1600, 1600, 1600, 1600, 1600, 94, 1600, 1600, 67, 1600, 61, 1600, 1600, 61, 69, 1600, 86, 73, 84, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 102, 1600, 128, 117, 1600, 1600, 1600, 1600, 66, 84, 1600, 1600, 70, 49, 62, 74, 169, 60, 1600, 77, 64, 63, 1600, 62, 1600, 53, 1600, 71, 118]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2994095311692763, "mean_inference_ms": 1.0100716060569874, "mean_action_processing_ms": 0.19754642389714105, "mean_env_wait_ms": 0.39990721171970844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005757808685302734, "StateBufferConnector_ms": 0.004189491271972656, "ViewRequirementAgentConnector_ms": 0.11432409286499023}}, "episode_reward_max": -31.232718334318484, "episode_reward_min": -132.96352189190813, "episode_reward_mean": -85.68195305241198, "episode_len_mean": 853.33, "episodes_this_iter": 7, "episodes_timesteps_total": 85333, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-81.49203587650628, -81.62774269316093, -117.3166355107464, -108.00228525346517, -113.13156669907644, -114.00806307334143, -71.22929265460445, -107.73463703757275, -116.69740058917552, -119.27957997105395, -79.98841153322657, -109.62537531947096, -76.06046804029931, -110.68123117450997, -76.71096933982342, -79.28195381240862, -81.24318097893877, -116.55726958086217, -108.45080520448275, -71.5049330513043, -108.99817510498191, -71.33839432765485, -76.4123175444683, -110.86886036306805, -105.7063995313781, -112.18790297305708, -114.27179599144993, -74.89379673712587, -82.537569420321, -60.84522014840885, -105.65046223647893, -107.63569393655285, -60.135861900998854, -56.58436483275952, -112.37795295593205, -110.06555559477458, -112.289329881814, -73.0618333915094, -65.93139194233902, -63.1354409847054, -70.33504340337228, -110.54845221489606, -110.56351098318957, -60.39737731448942, -54.410035980275644, -56.27884201064765, -65.64820985491396, -56.355943061126375, -107.41686162152824, -62.766830404554355, -58.01629541821664, -115.48913874753316, -55.826794609086555, -117.97611289821131, -55.37234301223421, -48.93070490887509, -109.97531712717439, -119.5571604381986, -46.322522700885386, -110.84828170241664, -108.85827739811565, -108.63676094473898, -44.40145913048837, -54.49304067087913, -54.526253331254544, -69.00947375598727, -65.69459862832969, -52.898501993800835, -44.80714526034458, -62.67412257617163, -37.018664170824586, -119.58076097634682, -53.88912565674515, -131.1858862363187, -111.47551587803724, -42.82743967373426, -53.455906241053015, -48.508386991182924, -42.07935003574508, -108.6692933649936, -116.2460013683966, -36.38964792697386, -32.85346420755551, -115.03632864363368, -110.88993607502059, -116.46049116161839, -121.33477026235747, -115.26672389787375, -119.10003350916195, -37.6444486595249, -110.39974471087443, -107.51318571950185, -119.72202636824487, -37.44913765496755, -110.27272578047216, -31.232718334318484, -105.76328540924005, -52.119061673338834, -106.26015346548893, -132.96352189190813], "episode_lengths": [1600, 1600, 90, 93, 59, 126, 1600, 59, 64, 121, 1600, 78, 1600, 60, 1600, 1600, 1600, 74, 59, 1600, 64, 1600, 1600, 56, 40, 54, 88, 1600, 1600, 1600, 54, 81, 1600, 1600, 43, 97, 77, 1600, 1600, 1600, 1600, 69, 43, 1600, 1600, 1600, 1600, 1600, 94, 1600, 1600, 67, 1600, 61, 1600, 1600, 61, 69, 1600, 86, 73, 84, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 102, 1600, 128, 117, 1600, 1600, 1600, 1600, 66, 84, 1600, 1600, 70, 49, 62, 74, 169, 60, 1600, 77, 64, 63, 1600, 62, 1600, 53, 1600, 71, 118]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2994095311692763, "mean_inference_ms": 1.0100716060569874, "mean_action_processing_ms": 0.19754642389714105, "mean_env_wait_ms": 0.39990721171970844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005757808685302734, "StateBufferConnector_ms": 0.004189491271972656, "ViewRequirementAgentConnector_ms": 0.11432409286499023}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 413.2717622088001, "num_env_steps_trained_throughput_per_sec": 413.2717622088001, "timesteps_total": 172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 172000, "timers": {"training_iteration_time_ms": 9670.407, "restore_workers_time_ms": 0.012, "training_step_time_ms": 9670.373, "sample_time_ms": 3625.985, "load_time_ms": 0.456, "load_throughput": 8771483.244, "learn_time_ms": 6035.977, "learn_throughput": 662.693, "synch_weights_time_ms": 7.423}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "done": false, "episodes_total": 239, "training_iteration": 43, "trial_id": "3adab_00000", "date": "2024-04-27_21-03-42", "timestamp": 1714277022, "time_this_iter_s": 9.683130025863647, "time_total_s": 429.23043036460876, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 429.23043036460876, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 25.48571428571429, "ram_util_percent": 62.77857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.585830527479931, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6715461847040631, "policy_loss": -0.03526706729204424, "vf_loss": 1.7011250505604412, "vf_explained_var": 0.2799555831698961, "kl": 0.012640449671065338, "entropy": 6.436379092226746, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 40455.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "sampler_results": {"episode_reward_max": -31.232718334318484, "episode_reward_min": -157.449891636911, "episode_reward_mean": -85.47821053486007, "episode_len_mean": 855.68, "episode_media": {}, "episodes_this_iter": 4, "episodes_timesteps_total": 85568, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113.13156669907644, -114.00806307334143, -71.22929265460445, -107.73463703757275, -116.69740058917552, -119.27957997105395, -79.98841153322657, -109.62537531947096, -76.06046804029931, -110.68123117450997, -76.71096933982342, -79.28195381240862, -81.24318097893877, -116.55726958086217, -108.45080520448275, -71.5049330513043, -108.99817510498191, -71.33839432765485, -76.4123175444683, -110.86886036306805, -105.7063995313781, -112.18790297305708, -114.27179599144993, -74.89379673712587, -82.537569420321, -60.84522014840885, -105.65046223647893, -107.63569393655285, -60.135861900998854, -56.58436483275952, -112.37795295593205, -110.06555559477458, -112.289329881814, -73.0618333915094, -65.93139194233902, -63.1354409847054, -70.33504340337228, -110.54845221489606, -110.56351098318957, -60.39737731448942, -54.410035980275644, -56.27884201064765, -65.64820985491396, -56.355943061126375, -107.41686162152824, -62.766830404554355, -58.01629541821664, -115.48913874753316, -55.826794609086555, -117.97611289821131, -55.37234301223421, -48.93070490887509, -109.97531712717439, -119.5571604381986, -46.322522700885386, -110.84828170241664, -108.85827739811565, -108.63676094473898, -44.40145913048837, -54.49304067087913, -54.526253331254544, -69.00947375598727, -65.69459862832969, -52.898501993800835, -44.80714526034458, -62.67412257617163, -37.018664170824586, -119.58076097634682, -53.88912565674515, -131.1858862363187, -111.47551587803724, -42.82743967373426, -53.455906241053015, -48.508386991182924, -42.07935003574508, -108.6692933649936, -116.2460013683966, -36.38964792697386, -32.85346420755551, -115.03632864363368, -110.88993607502059, -116.46049116161839, -121.33477026235747, -115.26672389787375, -119.10003350916195, -37.6444486595249, -110.39974471087443, -107.51318571950185, -119.72202636824487, -37.44913765496755, -110.27272578047216, -31.232718334318484, -105.76328540924005, -52.119061673338834, -106.26015346548893, -132.96352189190813, -50.76540416267518, -157.449891636911, -105.46398930313624, -54.38516247596705], "episode_lengths": [59, 126, 1600, 59, 64, 121, 1600, 78, 1600, 60, 1600, 1600, 1600, 74, 59, 1600, 64, 1600, 1600, 56, 40, 54, 88, 1600, 1600, 1600, 54, 81, 1600, 1600, 43, 97, 77, 1600, 1600, 1600, 1600, 69, 43, 1600, 1600, 1600, 1600, 1600, 94, 1600, 1600, 67, 1600, 61, 1600, 1600, 61, 69, 1600, 86, 73, 84, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 102, 1600, 128, 117, 1600, 1600, 1600, 1600, 66, 84, 1600, 1600, 70, 49, 62, 74, 169, 60, 1600, 77, 64, 63, 1600, 62, 1600, 53, 1600, 71, 118, 1600, 338, 80, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2989556802312827, "mean_inference_ms": 1.0084891582684015, "mean_action_processing_ms": 0.1972520358888704, "mean_env_wait_ms": 0.3994058485583378, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005741596221923828, "StateBufferConnector_ms": 0.004179954528808594, "ViewRequirementAgentConnector_ms": 0.11433863639831543}}, "episode_reward_max": -31.232718334318484, "episode_reward_min": -157.449891636911, "episode_reward_mean": -85.47821053486007, "episode_len_mean": 855.68, "episodes_this_iter": 4, "episodes_timesteps_total": 85568, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113.13156669907644, -114.00806307334143, -71.22929265460445, -107.73463703757275, -116.69740058917552, -119.27957997105395, -79.98841153322657, -109.62537531947096, -76.06046804029931, -110.68123117450997, -76.71096933982342, -79.28195381240862, -81.24318097893877, -116.55726958086217, -108.45080520448275, -71.5049330513043, -108.99817510498191, -71.33839432765485, -76.4123175444683, -110.86886036306805, -105.7063995313781, -112.18790297305708, -114.27179599144993, -74.89379673712587, -82.537569420321, -60.84522014840885, -105.65046223647893, -107.63569393655285, -60.135861900998854, -56.58436483275952, -112.37795295593205, -110.06555559477458, -112.289329881814, -73.0618333915094, -65.93139194233902, -63.1354409847054, -70.33504340337228, -110.54845221489606, -110.56351098318957, -60.39737731448942, -54.410035980275644, -56.27884201064765, -65.64820985491396, -56.355943061126375, -107.41686162152824, -62.766830404554355, -58.01629541821664, -115.48913874753316, -55.826794609086555, -117.97611289821131, -55.37234301223421, -48.93070490887509, -109.97531712717439, -119.5571604381986, -46.322522700885386, -110.84828170241664, -108.85827739811565, -108.63676094473898, -44.40145913048837, -54.49304067087913, -54.526253331254544, -69.00947375598727, -65.69459862832969, -52.898501993800835, -44.80714526034458, -62.67412257617163, -37.018664170824586, -119.58076097634682, -53.88912565674515, -131.1858862363187, -111.47551587803724, -42.82743967373426, -53.455906241053015, -48.508386991182924, -42.07935003574508, -108.6692933649936, -116.2460013683966, -36.38964792697386, -32.85346420755551, -115.03632864363368, -110.88993607502059, -116.46049116161839, -121.33477026235747, -115.26672389787375, -119.10003350916195, -37.6444486595249, -110.39974471087443, -107.51318571950185, -119.72202636824487, -37.44913765496755, -110.27272578047216, -31.232718334318484, -105.76328540924005, -52.119061673338834, -106.26015346548893, -132.96352189190813, -50.76540416267518, -157.449891636911, -105.46398930313624, -54.38516247596705], "episode_lengths": [59, 126, 1600, 59, 64, 121, 1600, 78, 1600, 60, 1600, 1600, 1600, 74, 59, 1600, 64, 1600, 1600, 56, 40, 54, 88, 1600, 1600, 1600, 54, 81, 1600, 1600, 43, 97, 77, 1600, 1600, 1600, 1600, 69, 43, 1600, 1600, 1600, 1600, 1600, 94, 1600, 1600, 67, 1600, 61, 1600, 1600, 61, 69, 1600, 86, 73, 84, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 102, 1600, 128, 117, 1600, 1600, 1600, 1600, 66, 84, 1600, 1600, 70, 49, 62, 74, 169, 60, 1600, 77, 64, 63, 1600, 62, 1600, 53, 1600, 71, 118, 1600, 338, 80, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2989556802312827, "mean_inference_ms": 1.0084891582684015, "mean_action_processing_ms": 0.1972520358888704, "mean_env_wait_ms": 0.3994058485583378, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005741596221923828, "StateBufferConnector_ms": 0.004179954528808594, "ViewRequirementAgentConnector_ms": 0.11433863639831543}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 414.78820448219153, "num_env_steps_trained_throughput_per_sec": 414.78820448219153, "timesteps_total": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 9686.165, "restore_workers_time_ms": 0.012, "training_step_time_ms": 9686.131, "sample_time_ms": 3632.787, "load_time_ms": 0.438, "load_throughput": 9133937.282, "learn_time_ms": 6044.807, "learn_throughput": 661.725, "synch_weights_time_ms": 7.546}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "episodes_total": 243, "training_iteration": 44, "trial_id": "3adab_00000", "date": "2024-04-27_21-03-52", "timestamp": 1714277032, "time_this_iter_s": 9.649363994598389, "time_total_s": 438.87979435920715, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 438.87979435920715, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 24.38571428571429, "ram_util_percent": 61.39999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.15359127277969, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7643728442843103, "policy_loss": -0.03891308663352843, "vf_loss": 1.7941984449823698, "vf_explained_var": 0.20454490101465614, "kl": 0.02019441599630785, "entropy": 6.761937464693541, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 41385.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": -31.232718334318484, "episode_reward_min": -157.449891636911, "episode_reward_mean": -85.30769040127649, "episode_len_mean": 823.55, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 82355, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-79.28195381240862, -81.24318097893877, -116.55726958086217, -108.45080520448275, -71.5049330513043, -108.99817510498191, -71.33839432765485, -76.4123175444683, -110.86886036306805, -105.7063995313781, -112.18790297305708, -114.27179599144993, -74.89379673712587, -82.537569420321, -60.84522014840885, -105.65046223647893, -107.63569393655285, -60.135861900998854, -56.58436483275952, -112.37795295593205, -110.06555559477458, -112.289329881814, -73.0618333915094, -65.93139194233902, -63.1354409847054, -70.33504340337228, -110.54845221489606, -110.56351098318957, -60.39737731448942, -54.410035980275644, -56.27884201064765, -65.64820985491396, -56.355943061126375, -107.41686162152824, -62.766830404554355, -58.01629541821664, -115.48913874753316, -55.826794609086555, -117.97611289821131, -55.37234301223421, -48.93070490887509, -109.97531712717439, -119.5571604381986, -46.322522700885386, -110.84828170241664, -108.85827739811565, -108.63676094473898, -44.40145913048837, -54.49304067087913, -54.526253331254544, -69.00947375598727, -65.69459862832969, -52.898501993800835, -44.80714526034458, -62.67412257617163, -37.018664170824586, -119.58076097634682, -53.88912565674515, -131.1858862363187, -111.47551587803724, -42.82743967373426, -53.455906241053015, -48.508386991182924, -42.07935003574508, -108.6692933649936, -116.2460013683966, -36.38964792697386, -32.85346420755551, -115.03632864363368, -110.88993607502059, -116.46049116161839, -121.33477026235747, -115.26672389787375, -119.10003350916195, -37.6444486595249, -110.39974471087443, -107.51318571950185, -119.72202636824487, -37.44913765496755, -110.27272578047216, -31.232718334318484, -105.76328540924005, -52.119061673338834, -106.26015346548893, -132.96352189190813, -50.76540416267518, -157.449891636911, -105.46398930313624, -54.38516247596705, -42.27966167254495, -104.5895469317014, -109.85384242724318, -107.73828605723754, -110.13326585740845, -110.6554148913448, -113.3701160882463, -114.81866837032015, -109.33972107810527, -42.52626484415454, -112.79019385548557], "episode_lengths": [1600, 1600, 74, 59, 1600, 64, 1600, 1600, 56, 40, 54, 88, 1600, 1600, 1600, 54, 81, 1600, 1600, 43, 97, 77, 1600, 1600, 1600, 1600, 69, 43, 1600, 1600, 1600, 1600, 1600, 94, 1600, 1600, 67, 1600, 61, 1600, 1600, 61, 69, 1600, 86, 73, 84, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 102, 1600, 128, 117, 1600, 1600, 1600, 1600, 66, 84, 1600, 1600, 70, 49, 62, 74, 169, 60, 1600, 77, 64, 63, 1600, 62, 1600, 53, 1600, 71, 118, 1600, 338, 80, 1600, 1600, 67, 87, 80, 57, 48, 44, 68, 43, 1600, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2977576695182957, "mean_inference_ms": 1.004448558071023, "mean_action_processing_ms": 0.19644461626700085, "mean_env_wait_ms": 0.3979381981172639, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005831480026245117, "StateBufferConnector_ms": 0.0041103363037109375, "ViewRequirementAgentConnector_ms": 0.11430549621582031}}, "episode_reward_max": -31.232718334318484, "episode_reward_min": -157.449891636911, "episode_reward_mean": -85.30769040127649, "episode_len_mean": 823.55, "episodes_this_iter": 11, "episodes_timesteps_total": 82355, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-79.28195381240862, -81.24318097893877, -116.55726958086217, -108.45080520448275, -71.5049330513043, -108.99817510498191, -71.33839432765485, -76.4123175444683, -110.86886036306805, -105.7063995313781, -112.18790297305708, -114.27179599144993, -74.89379673712587, -82.537569420321, -60.84522014840885, -105.65046223647893, -107.63569393655285, -60.135861900998854, -56.58436483275952, -112.37795295593205, -110.06555559477458, -112.289329881814, -73.0618333915094, -65.93139194233902, -63.1354409847054, -70.33504340337228, -110.54845221489606, -110.56351098318957, -60.39737731448942, -54.410035980275644, -56.27884201064765, -65.64820985491396, -56.355943061126375, -107.41686162152824, -62.766830404554355, -58.01629541821664, -115.48913874753316, -55.826794609086555, -117.97611289821131, -55.37234301223421, -48.93070490887509, -109.97531712717439, -119.5571604381986, -46.322522700885386, -110.84828170241664, -108.85827739811565, -108.63676094473898, -44.40145913048837, -54.49304067087913, -54.526253331254544, -69.00947375598727, -65.69459862832969, -52.898501993800835, -44.80714526034458, -62.67412257617163, -37.018664170824586, -119.58076097634682, -53.88912565674515, -131.1858862363187, -111.47551587803724, -42.82743967373426, -53.455906241053015, -48.508386991182924, -42.07935003574508, -108.6692933649936, -116.2460013683966, -36.38964792697386, -32.85346420755551, -115.03632864363368, -110.88993607502059, -116.46049116161839, -121.33477026235747, -115.26672389787375, -119.10003350916195, -37.6444486595249, -110.39974471087443, -107.51318571950185, -119.72202636824487, -37.44913765496755, -110.27272578047216, -31.232718334318484, -105.76328540924005, -52.119061673338834, -106.26015346548893, -132.96352189190813, -50.76540416267518, -157.449891636911, -105.46398930313624, -54.38516247596705, -42.27966167254495, -104.5895469317014, -109.85384242724318, -107.73828605723754, -110.13326585740845, -110.6554148913448, -113.3701160882463, -114.81866837032015, -109.33972107810527, -42.52626484415454, -112.79019385548557], "episode_lengths": [1600, 1600, 74, 59, 1600, 64, 1600, 1600, 56, 40, 54, 88, 1600, 1600, 1600, 54, 81, 1600, 1600, 43, 97, 77, 1600, 1600, 1600, 1600, 69, 43, 1600, 1600, 1600, 1600, 1600, 94, 1600, 1600, 67, 1600, 61, 1600, 1600, 61, 69, 1600, 86, 73, 84, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 102, 1600, 128, 117, 1600, 1600, 1600, 1600, 66, 84, 1600, 1600, 70, 49, 62, 74, 169, 60, 1600, 77, 64, 63, 1600, 62, 1600, 53, 1600, 71, 118, 1600, 338, 80, 1600, 1600, 67, 87, 80, 57, 48, 44, 68, 43, 1600, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2977576695182957, "mean_inference_ms": 1.004448558071023, "mean_action_processing_ms": 0.19644461626700085, "mean_env_wait_ms": 0.3979381981172639, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005831480026245117, "StateBufferConnector_ms": 0.0041103363037109375, "ViewRequirementAgentConnector_ms": 0.11430549621582031}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 422.4381384236696, "num_env_steps_trained_throughput_per_sec": 422.4381384236696, "timesteps_total": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 9681.978, "restore_workers_time_ms": 0.012, "training_step_time_ms": 9681.944, "sample_time_ms": 3627.675, "load_time_ms": 0.435, "load_throughput": 9197026.642, "learn_time_ms": 6045.757, "learn_throughput": 661.621, "synch_weights_time_ms": 7.515}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 254, "training_iteration": 45, "trial_id": "3adab_00000", "date": "2024-04-27_21-04-01", "timestamp": 1714277041, "time_this_iter_s": 9.47350811958313, "time_total_s": 448.3533024787903, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 448.3533024787903, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 25.023076923076925, "ram_util_percent": 61.48461538461539}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.53639219601949, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.302744230753066, "policy_loss": -0.03020363476487898, "vf_loss": 2.3271285907755934, "vf_explained_var": 0.20777399514311104, "kl": 0.008621146957684591, "entropy": 7.721319364732311, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 42315.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "sampler_results": {"episode_reward_max": -31.232718334318484, "episode_reward_min": -167.48863911369872, "episode_reward_mean": -86.35679371795727, "episode_len_mean": 781.64, "episode_media": {}, "episodes_this_iter": 8, "episodes_timesteps_total": 78164, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-110.86886036306805, -105.7063995313781, -112.18790297305708, -114.27179599144993, -74.89379673712587, -82.537569420321, -60.84522014840885, -105.65046223647893, -107.63569393655285, -60.135861900998854, -56.58436483275952, -112.37795295593205, -110.06555559477458, -112.289329881814, -73.0618333915094, -65.93139194233902, -63.1354409847054, -70.33504340337228, -110.54845221489606, -110.56351098318957, -60.39737731448942, -54.410035980275644, -56.27884201064765, -65.64820985491396, -56.355943061126375, -107.41686162152824, -62.766830404554355, -58.01629541821664, -115.48913874753316, -55.826794609086555, -117.97611289821131, -55.37234301223421, -48.93070490887509, -109.97531712717439, -119.5571604381986, -46.322522700885386, -110.84828170241664, -108.85827739811565, -108.63676094473898, -44.40145913048837, -54.49304067087913, -54.526253331254544, -69.00947375598727, -65.69459862832969, -52.898501993800835, -44.80714526034458, -62.67412257617163, -37.018664170824586, -119.58076097634682, -53.88912565674515, -131.1858862363187, -111.47551587803724, -42.82743967373426, -53.455906241053015, -48.508386991182924, -42.07935003574508, -108.6692933649936, -116.2460013683966, -36.38964792697386, -32.85346420755551, -115.03632864363368, -110.88993607502059, -116.46049116161839, -121.33477026235747, -115.26672389787375, -119.10003350916195, -37.6444486595249, -110.39974471087443, -107.51318571950185, -119.72202636824487, -37.44913765496755, -110.27272578047216, -31.232718334318484, -105.76328540924005, -52.119061673338834, -106.26015346548893, -132.96352189190813, -50.76540416267518, -157.449891636911, -105.46398930313624, -54.38516247596705, -42.27966167254495, -104.5895469317014, -109.85384242724318, -107.73828605723754, -110.13326585740845, -110.6554148913448, -113.3701160882463, -114.81866837032015, -109.33972107810527, -42.52626484415454, -112.79019385548557, -109.81333471944866, -118.47274951819269, -114.89993498931267, -167.48863911369872, -110.19801508765482, -104.9151365764942, -51.75086707815223, -41.1586841902304], "episode_lengths": [56, 40, 54, 88, 1600, 1600, 1600, 54, 81, 1600, 1600, 43, 97, 77, 1600, 1600, 1600, 1600, 69, 43, 1600, 1600, 1600, 1600, 1600, 94, 1600, 1600, 67, 1600, 61, 1600, 1600, 61, 69, 1600, 86, 73, 84, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 102, 1600, 128, 117, 1600, 1600, 1600, 1600, 66, 84, 1600, 1600, 70, 49, 62, 74, 169, 60, 1600, 77, 64, 63, 1600, 62, 1600, 53, 1600, 71, 118, 1600, 338, 80, 1600, 1600, 67, 87, 80, 57, 48, 44, 68, 43, 1600, 60, 42, 61, 52, 556, 44, 51, 1600, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29707505552733066, "mean_inference_ms": 1.002036964364602, "mean_action_processing_ms": 0.19596906135927, "mean_env_wait_ms": 0.3970214817827758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0059244632720947266, "StateBufferConnector_ms": 0.0042536258697509766, "ViewRequirementAgentConnector_ms": 0.11703324317932129}}, "episode_reward_max": -31.232718334318484, "episode_reward_min": -167.48863911369872, "episode_reward_mean": -86.35679371795727, "episode_len_mean": 781.64, "episodes_this_iter": 8, "episodes_timesteps_total": 78164, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-110.86886036306805, -105.7063995313781, -112.18790297305708, -114.27179599144993, -74.89379673712587, -82.537569420321, -60.84522014840885, -105.65046223647893, -107.63569393655285, -60.135861900998854, -56.58436483275952, -112.37795295593205, -110.06555559477458, -112.289329881814, -73.0618333915094, -65.93139194233902, -63.1354409847054, -70.33504340337228, -110.54845221489606, -110.56351098318957, -60.39737731448942, -54.410035980275644, -56.27884201064765, -65.64820985491396, -56.355943061126375, -107.41686162152824, -62.766830404554355, -58.01629541821664, -115.48913874753316, -55.826794609086555, -117.97611289821131, -55.37234301223421, -48.93070490887509, -109.97531712717439, -119.5571604381986, -46.322522700885386, -110.84828170241664, -108.85827739811565, -108.63676094473898, -44.40145913048837, -54.49304067087913, -54.526253331254544, -69.00947375598727, -65.69459862832969, -52.898501993800835, -44.80714526034458, -62.67412257617163, -37.018664170824586, -119.58076097634682, -53.88912565674515, -131.1858862363187, -111.47551587803724, -42.82743967373426, -53.455906241053015, -48.508386991182924, -42.07935003574508, -108.6692933649936, -116.2460013683966, -36.38964792697386, -32.85346420755551, -115.03632864363368, -110.88993607502059, -116.46049116161839, -121.33477026235747, -115.26672389787375, -119.10003350916195, -37.6444486595249, -110.39974471087443, -107.51318571950185, -119.72202636824487, -37.44913765496755, -110.27272578047216, -31.232718334318484, -105.76328540924005, -52.119061673338834, -106.26015346548893, -132.96352189190813, -50.76540416267518, -157.449891636911, -105.46398930313624, -54.38516247596705, -42.27966167254495, -104.5895469317014, -109.85384242724318, -107.73828605723754, -110.13326585740845, -110.6554148913448, -113.3701160882463, -114.81866837032015, -109.33972107810527, -42.52626484415454, -112.79019385548557, -109.81333471944866, -118.47274951819269, -114.89993498931267, -167.48863911369872, -110.19801508765482, -104.9151365764942, -51.75086707815223, -41.1586841902304], "episode_lengths": [56, 40, 54, 88, 1600, 1600, 1600, 54, 81, 1600, 1600, 43, 97, 77, 1600, 1600, 1600, 1600, 69, 43, 1600, 1600, 1600, 1600, 1600, 94, 1600, 1600, 67, 1600, 61, 1600, 1600, 61, 69, 1600, 86, 73, 84, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 102, 1600, 128, 117, 1600, 1600, 1600, 1600, 66, 84, 1600, 1600, 70, 49, 62, 74, 169, 60, 1600, 77, 64, 63, 1600, 62, 1600, 53, 1600, 71, 118, 1600, 338, 80, 1600, 1600, 67, 87, 80, 57, 48, 44, 68, 43, 1600, 60, 42, 61, 52, 556, 44, 51, 1600, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29707505552733066, "mean_inference_ms": 1.002036964364602, "mean_action_processing_ms": 0.19596906135927, "mean_env_wait_ms": 0.3970214817827758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0059244632720947266, "StateBufferConnector_ms": 0.0042536258697509766, "ViewRequirementAgentConnector_ms": 0.11703324317932129}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 422.10564224470056, "num_env_steps_trained_throughput_per_sec": 422.10564224470056, "timesteps_total": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 9679.395, "restore_workers_time_ms": 0.012, "training_step_time_ms": 9679.361, "sample_time_ms": 3629.061, "load_time_ms": 0.422, "load_throughput": 9487229.134, "learn_time_ms": 6041.739, "learn_throughput": 662.061, "synch_weights_time_ms": 7.586}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "episodes_total": 262, "training_iteration": 46, "trial_id": "3adab_00000", "date": "2024-04-27_21-04-11", "timestamp": 1714277051, "time_this_iter_s": 9.481014013290405, "time_total_s": 457.8343164920807, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 457.8343164920807, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 23.835714285714285, "ram_util_percent": 61.60000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.89743532596096, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5989635296851917, "policy_loss": -0.021192694160967102, "vf_loss": 0.6151671369069366, "vf_explained_var": 0.33261705463932406, "kl": 0.007391242270301026, "entropy": 5.212516883624497, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 43245.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "sampler_results": {"episode_reward_max": -31.232718334318484, "episode_reward_min": -167.48863911369872, "episode_reward_mean": -84.45832759490011, "episode_len_mean": 828.14, "episode_media": {}, "episodes_this_iter": 3, "episodes_timesteps_total": 82814, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114.27179599144993, -74.89379673712587, -82.537569420321, -60.84522014840885, -105.65046223647893, -107.63569393655285, -60.135861900998854, -56.58436483275952, -112.37795295593205, -110.06555559477458, -112.289329881814, -73.0618333915094, -65.93139194233902, -63.1354409847054, -70.33504340337228, -110.54845221489606, -110.56351098318957, -60.39737731448942, -54.410035980275644, -56.27884201064765, -65.64820985491396, -56.355943061126375, -107.41686162152824, -62.766830404554355, -58.01629541821664, -115.48913874753316, -55.826794609086555, -117.97611289821131, -55.37234301223421, -48.93070490887509, -109.97531712717439, -119.5571604381986, -46.322522700885386, -110.84828170241664, -108.85827739811565, -108.63676094473898, -44.40145913048837, -54.49304067087913, -54.526253331254544, -69.00947375598727, -65.69459862832969, -52.898501993800835, -44.80714526034458, -62.67412257617163, -37.018664170824586, -119.58076097634682, -53.88912565674515, -131.1858862363187, -111.47551587803724, -42.82743967373426, -53.455906241053015, -48.508386991182924, -42.07935003574508, -108.6692933649936, -116.2460013683966, -36.38964792697386, -32.85346420755551, -115.03632864363368, -110.88993607502059, -116.46049116161839, -121.33477026235747, -115.26672389787375, -119.10003350916195, -37.6444486595249, -110.39974471087443, -107.51318571950185, -119.72202636824487, -37.44913765496755, -110.27272578047216, -31.232718334318484, -105.76328540924005, -52.119061673338834, -106.26015346548893, -132.96352189190813, -50.76540416267518, -157.449891636911, -105.46398930313624, -54.38516247596705, -42.27966167254495, -104.5895469317014, -109.85384242724318, -107.73828605723754, -110.13326585740845, -110.6554148913448, -113.3701160882463, -114.81866837032015, -109.33972107810527, -42.52626484415454, -112.79019385548557, -109.81333471944866, -118.47274951819269, -114.89993498931267, -167.48863911369872, -110.19801508765482, -104.9151365764942, -51.75086707815223, -41.1586841902304, -49.34461472789012, -48.68372135606529, -40.888214477828406], "episode_lengths": [88, 1600, 1600, 1600, 54, 81, 1600, 1600, 43, 97, 77, 1600, 1600, 1600, 1600, 69, 43, 1600, 1600, 1600, 1600, 1600, 94, 1600, 1600, 67, 1600, 61, 1600, 1600, 61, 69, 1600, 86, 73, 84, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 102, 1600, 128, 117, 1600, 1600, 1600, 1600, 66, 84, 1600, 1600, 70, 49, 62, 74, 169, 60, 1600, 77, 64, 63, 1600, 62, 1600, 53, 1600, 71, 118, 1600, 338, 80, 1600, 1600, 67, 87, 80, 57, 48, 44, 68, 43, 1600, 60, 42, 61, 52, 556, 44, 51, 1600, 1600, 1600, 1600, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2968484755340872, "mean_inference_ms": 1.0013685445551421, "mean_action_processing_ms": 0.19581634875290682, "mean_env_wait_ms": 0.39670527151103113, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0059435367584228516, "StateBufferConnector_ms": 0.004267692565917969, "ViewRequirementAgentConnector_ms": 0.1177358627319336}}, "episode_reward_max": -31.232718334318484, "episode_reward_min": -167.48863911369872, "episode_reward_mean": -84.45832759490011, "episode_len_mean": 828.14, "episodes_this_iter": 3, "episodes_timesteps_total": 82814, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114.27179599144993, -74.89379673712587, -82.537569420321, -60.84522014840885, -105.65046223647893, -107.63569393655285, -60.135861900998854, -56.58436483275952, -112.37795295593205, -110.06555559477458, -112.289329881814, -73.0618333915094, -65.93139194233902, -63.1354409847054, -70.33504340337228, -110.54845221489606, -110.56351098318957, -60.39737731448942, -54.410035980275644, -56.27884201064765, -65.64820985491396, -56.355943061126375, -107.41686162152824, -62.766830404554355, -58.01629541821664, -115.48913874753316, -55.826794609086555, -117.97611289821131, -55.37234301223421, -48.93070490887509, -109.97531712717439, -119.5571604381986, -46.322522700885386, -110.84828170241664, -108.85827739811565, -108.63676094473898, -44.40145913048837, -54.49304067087913, -54.526253331254544, -69.00947375598727, -65.69459862832969, -52.898501993800835, -44.80714526034458, -62.67412257617163, -37.018664170824586, -119.58076097634682, -53.88912565674515, -131.1858862363187, -111.47551587803724, -42.82743967373426, -53.455906241053015, -48.508386991182924, -42.07935003574508, -108.6692933649936, -116.2460013683966, -36.38964792697386, -32.85346420755551, -115.03632864363368, -110.88993607502059, -116.46049116161839, -121.33477026235747, -115.26672389787375, -119.10003350916195, -37.6444486595249, -110.39974471087443, -107.51318571950185, -119.72202636824487, -37.44913765496755, -110.27272578047216, -31.232718334318484, -105.76328540924005, -52.119061673338834, -106.26015346548893, -132.96352189190813, -50.76540416267518, -157.449891636911, -105.46398930313624, -54.38516247596705, -42.27966167254495, -104.5895469317014, -109.85384242724318, -107.73828605723754, -110.13326585740845, -110.6554148913448, -113.3701160882463, -114.81866837032015, -109.33972107810527, -42.52626484415454, -112.79019385548557, -109.81333471944866, -118.47274951819269, -114.89993498931267, -167.48863911369872, -110.19801508765482, -104.9151365764942, -51.75086707815223, -41.1586841902304, -49.34461472789012, -48.68372135606529, -40.888214477828406], "episode_lengths": [88, 1600, 1600, 1600, 54, 81, 1600, 1600, 43, 97, 77, 1600, 1600, 1600, 1600, 69, 43, 1600, 1600, 1600, 1600, 1600, 94, 1600, 1600, 67, 1600, 61, 1600, 1600, 61, 69, 1600, 86, 73, 84, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 102, 1600, 128, 117, 1600, 1600, 1600, 1600, 66, 84, 1600, 1600, 70, 49, 62, 74, 169, 60, 1600, 77, 64, 63, 1600, 62, 1600, 53, 1600, 71, 118, 1600, 338, 80, 1600, 1600, 67, 87, 80, 57, 48, 44, 68, 43, 1600, 60, 42, 61, 52, 556, 44, 51, 1600, 1600, 1600, 1600, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2968484755340872, "mean_inference_ms": 1.0013685445551421, "mean_action_processing_ms": 0.19581634875290682, "mean_env_wait_ms": 0.39670527151103113, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0059435367584228516, "StateBufferConnector_ms": 0.004267692565917969, "ViewRequirementAgentConnector_ms": 0.1177358627319336}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 344.8303602194579, "num_env_steps_trained_throughput_per_sec": 344.8303602194579, "timesteps_total": 188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 188000, "timers": {"training_iteration_time_ms": 9898.542, "restore_workers_time_ms": 0.012, "training_step_time_ms": 9898.507, "sample_time_ms": 3729.72, "load_time_ms": 0.423, "load_throughput": 9453017.805, "learn_time_ms": 6160.182, "learn_throughput": 649.331, "synch_weights_time_ms": 7.607}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "done": false, "episodes_total": 265, "training_iteration": 47, "trial_id": "3adab_00000", "date": "2024-04-27_21-04-23", "timestamp": 1714277063, "time_this_iter_s": 11.60388994216919, "time_total_s": 469.4382064342499, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 469.4382064342499, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 35.2, "ram_util_percent": 63.0875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.916112002377869, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.1010455781178328, "policy_loss": -0.029190841301154066, "vf_loss": 3.1217763551861366, "vf_explained_var": 0.20611593864297353, "kl": 0.012533455531949143, "entropy": 8.226546917166761, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 44175.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "sampler_results": {"episode_reward_max": -31.232718334318484, "episode_reward_min": -167.48863911369872, "episode_reward_mean": -87.65353448026501, "episode_len_mean": 722.21, "episode_media": {}, "episodes_this_iter": 16, "episodes_timesteps_total": 72221, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-110.56351098318957, -60.39737731448942, -54.410035980275644, -56.27884201064765, -65.64820985491396, -56.355943061126375, -107.41686162152824, -62.766830404554355, -58.01629541821664, -115.48913874753316, -55.826794609086555, -117.97611289821131, -55.37234301223421, -48.93070490887509, -109.97531712717439, -119.5571604381986, -46.322522700885386, -110.84828170241664, -108.85827739811565, -108.63676094473898, -44.40145913048837, -54.49304067087913, -54.526253331254544, -69.00947375598727, -65.69459862832969, -52.898501993800835, -44.80714526034458, -62.67412257617163, -37.018664170824586, -119.58076097634682, -53.88912565674515, -131.1858862363187, -111.47551587803724, -42.82743967373426, -53.455906241053015, -48.508386991182924, -42.07935003574508, -108.6692933649936, -116.2460013683966, -36.38964792697386, -32.85346420755551, -115.03632864363368, -110.88993607502059, -116.46049116161839, -121.33477026235747, -115.26672389787375, -119.10003350916195, -37.6444486595249, -110.39974471087443, -107.51318571950185, -119.72202636824487, -37.44913765496755, -110.27272578047216, -31.232718334318484, -105.76328540924005, -52.119061673338834, -106.26015346548893, -132.96352189190813, -50.76540416267518, -157.449891636911, -105.46398930313624, -54.38516247596705, -42.27966167254495, -104.5895469317014, -109.85384242724318, -107.73828605723754, -110.13326585740845, -110.6554148913448, -113.3701160882463, -114.81866837032015, -109.33972107810527, -42.52626484415454, -112.79019385548557, -109.81333471944866, -118.47274951819269, -114.89993498931267, -167.48863911369872, -110.19801508765482, -104.9151365764942, -51.75086707815223, -41.1586841902304, -49.34461472789012, -48.68372135606529, -40.888214477828406, -111.1725548055352, -44.78405137420019, -109.55734942572502, -129.83228251712399, -106.84283522121919, -109.37463094562665, -110.6659164208801, -38.202839458334495, -107.55230839786057, -132.1100932731274, -121.01934004531863, -121.65136217843929, -106.66544314674475, -106.48982656791124, -110.53737394000466, -133.3622463918794], "episode_lengths": [43, 1600, 1600, 1600, 1600, 1600, 94, 1600, 1600, 67, 1600, 61, 1600, 1600, 61, 69, 1600, 86, 73, 84, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 102, 1600, 128, 117, 1600, 1600, 1600, 1600, 66, 84, 1600, 1600, 70, 49, 62, 74, 169, 60, 1600, 77, 64, 63, 1600, 62, 1600, 53, 1600, 71, 118, 1600, 338, 80, 1600, 1600, 67, 87, 80, 57, 48, 44, 68, 43, 1600, 60, 42, 61, 52, 556, 44, 51, 1600, 1600, 1600, 1600, 1600, 41, 1600, 78, 127, 97, 38, 50, 1600, 47, 183, 81, 61, 68, 77, 51, 117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2960579825867646, "mean_inference_ms": 0.9981340353138964, "mean_action_processing_ms": 0.19525011835037795, "mean_env_wait_ms": 0.3955206137425499, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005898475646972656, "StateBufferConnector_ms": 0.004327535629272461, "ViewRequirementAgentConnector_ms": 0.11890482902526855}}, "episode_reward_max": -31.232718334318484, "episode_reward_min": -167.48863911369872, "episode_reward_mean": -87.65353448026501, "episode_len_mean": 722.21, "episodes_this_iter": 16, "episodes_timesteps_total": 72221, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-110.56351098318957, -60.39737731448942, -54.410035980275644, -56.27884201064765, -65.64820985491396, -56.355943061126375, -107.41686162152824, -62.766830404554355, -58.01629541821664, -115.48913874753316, -55.826794609086555, -117.97611289821131, -55.37234301223421, -48.93070490887509, -109.97531712717439, -119.5571604381986, -46.322522700885386, -110.84828170241664, -108.85827739811565, -108.63676094473898, -44.40145913048837, -54.49304067087913, -54.526253331254544, -69.00947375598727, -65.69459862832969, -52.898501993800835, -44.80714526034458, -62.67412257617163, -37.018664170824586, -119.58076097634682, -53.88912565674515, -131.1858862363187, -111.47551587803724, -42.82743967373426, -53.455906241053015, -48.508386991182924, -42.07935003574508, -108.6692933649936, -116.2460013683966, -36.38964792697386, -32.85346420755551, -115.03632864363368, -110.88993607502059, -116.46049116161839, -121.33477026235747, -115.26672389787375, -119.10003350916195, -37.6444486595249, -110.39974471087443, -107.51318571950185, -119.72202636824487, -37.44913765496755, -110.27272578047216, -31.232718334318484, -105.76328540924005, -52.119061673338834, -106.26015346548893, -132.96352189190813, -50.76540416267518, -157.449891636911, -105.46398930313624, -54.38516247596705, -42.27966167254495, -104.5895469317014, -109.85384242724318, -107.73828605723754, -110.13326585740845, -110.6554148913448, -113.3701160882463, -114.81866837032015, -109.33972107810527, -42.52626484415454, -112.79019385548557, -109.81333471944866, -118.47274951819269, -114.89993498931267, -167.48863911369872, -110.19801508765482, -104.9151365764942, -51.75086707815223, -41.1586841902304, -49.34461472789012, -48.68372135606529, -40.888214477828406, -111.1725548055352, -44.78405137420019, -109.55734942572502, -129.83228251712399, -106.84283522121919, -109.37463094562665, -110.6659164208801, -38.202839458334495, -107.55230839786057, -132.1100932731274, -121.01934004531863, -121.65136217843929, -106.66544314674475, -106.48982656791124, -110.53737394000466, -133.3622463918794], "episode_lengths": [43, 1600, 1600, 1600, 1600, 1600, 94, 1600, 1600, 67, 1600, 61, 1600, 1600, 61, 69, 1600, 86, 73, 84, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 102, 1600, 128, 117, 1600, 1600, 1600, 1600, 66, 84, 1600, 1600, 70, 49, 62, 74, 169, 60, 1600, 77, 64, 63, 1600, 62, 1600, 53, 1600, 71, 118, 1600, 338, 80, 1600, 1600, 67, 87, 80, 57, 48, 44, 68, 43, 1600, 60, 42, 61, 52, 556, 44, 51, 1600, 1600, 1600, 1600, 1600, 41, 1600, 78, 127, 97, 38, 50, 1600, 47, 183, 81, 61, 68, 77, 51, 117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2960579825867646, "mean_inference_ms": 0.9981340353138964, "mean_action_processing_ms": 0.19525011835037795, "mean_env_wait_ms": 0.3955206137425499, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005898475646972656, "StateBufferConnector_ms": 0.004327535629272461, "ViewRequirementAgentConnector_ms": 0.11890482902526855}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 399.57368558811976, "num_env_steps_trained_throughput_per_sec": 399.57368558811976, "timesteps_total": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 9952.577, "restore_workers_time_ms": 0.012, "training_step_time_ms": 9952.542, "sample_time_ms": 3761.089, "load_time_ms": 0.42, "load_throughput": 9534134.227, "learn_time_ms": 6182.797, "learn_throughput": 646.956, "synch_weights_time_ms": 7.654}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "episodes_total": 281, "training_iteration": 48, "trial_id": "3adab_00000", "date": "2024-04-27_21-04-33", "timestamp": 1714277073, "time_this_iter_s": 10.01536512374878, "time_total_s": 479.45357155799866, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 479.45357155799866, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 27.164285714285715, "ram_util_percent": 62.21428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.97953516103888, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8578883533906791, "policy_loss": -0.03503841299523589, "vf_loss": 1.8853155924748348, "vf_explained_var": 0.3124097091536368, "kl": 0.011275801848081246, "entropy": 6.306779229256414, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 45105.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "sampler_results": {"episode_reward_max": -31.232718334318484, "episode_reward_min": -167.48863911369872, "episode_reward_mean": -89.85456488922996, "episode_len_mean": 662.87, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 66287, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-107.41686162152824, -62.766830404554355, -58.01629541821664, -115.48913874753316, -55.826794609086555, -117.97611289821131, -55.37234301223421, -48.93070490887509, -109.97531712717439, -119.5571604381986, -46.322522700885386, -110.84828170241664, -108.85827739811565, -108.63676094473898, -44.40145913048837, -54.49304067087913, -54.526253331254544, -69.00947375598727, -65.69459862832969, -52.898501993800835, -44.80714526034458, -62.67412257617163, -37.018664170824586, -119.58076097634682, -53.88912565674515, -131.1858862363187, -111.47551587803724, -42.82743967373426, -53.455906241053015, -48.508386991182924, -42.07935003574508, -108.6692933649936, -116.2460013683966, -36.38964792697386, -32.85346420755551, -115.03632864363368, -110.88993607502059, -116.46049116161839, -121.33477026235747, -115.26672389787375, -119.10003350916195, -37.6444486595249, -110.39974471087443, -107.51318571950185, -119.72202636824487, -37.44913765496755, -110.27272578047216, -31.232718334318484, -105.76328540924005, -52.119061673338834, -106.26015346548893, -132.96352189190813, -50.76540416267518, -157.449891636911, -105.46398930313624, -54.38516247596705, -42.27966167254495, -104.5895469317014, -109.85384242724318, -107.73828605723754, -110.13326585740845, -110.6554148913448, -113.3701160882463, -114.81866837032015, -109.33972107810527, -42.52626484415454, -112.79019385548557, -109.81333471944866, -118.47274951819269, -114.89993498931267, -167.48863911369872, -110.19801508765482, -104.9151365764942, -51.75086707815223, -41.1586841902304, -49.34461472789012, -48.68372135606529, -40.888214477828406, -111.1725548055352, -44.78405137420019, -109.55734942572502, -129.83228251712399, -106.84283522121919, -109.37463094562665, -110.6659164208801, -38.202839458334495, -107.55230839786057, -132.1100932731274, -121.01934004531863, -121.65136217843929, -106.66544314674475, -106.48982656791124, -110.53737394000466, -133.3622463918794, -128.48691687297386, -103.14561739230591, -109.79722223208037, -126.2489125257147, -110.56739755802975, -45.5108935200336], "episode_lengths": [94, 1600, 1600, 67, 1600, 61, 1600, 1600, 61, 69, 1600, 86, 73, 84, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 102, 1600, 128, 117, 1600, 1600, 1600, 1600, 66, 84, 1600, 1600, 70, 49, 62, 74, 169, 60, 1600, 77, 64, 63, 1600, 62, 1600, 53, 1600, 71, 118, 1600, 338, 80, 1600, 1600, 67, 87, 80, 57, 48, 44, 68, 43, 1600, 60, 42, 61, 52, 556, 44, 51, 1600, 1600, 1600, 1600, 1600, 41, 1600, 78, 127, 97, 38, 50, 1600, 47, 183, 81, 61, 68, 77, 51, 117, 82, 100, 60, 160, 107, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29581717506294586, "mean_inference_ms": 0.9972595907676183, "mean_action_processing_ms": 0.19506622219781963, "mean_env_wait_ms": 0.3950386840911611, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005934953689575195, "StateBufferConnector_ms": 0.0043370723724365234, "ViewRequirementAgentConnector_ms": 0.11918401718139648}}, "episode_reward_max": -31.232718334318484, "episode_reward_min": -167.48863911369872, "episode_reward_mean": -89.85456488922996, "episode_len_mean": 662.87, "episodes_this_iter": 6, "episodes_timesteps_total": 66287, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-107.41686162152824, -62.766830404554355, -58.01629541821664, -115.48913874753316, -55.826794609086555, -117.97611289821131, -55.37234301223421, -48.93070490887509, -109.97531712717439, -119.5571604381986, -46.322522700885386, -110.84828170241664, -108.85827739811565, -108.63676094473898, -44.40145913048837, -54.49304067087913, -54.526253331254544, -69.00947375598727, -65.69459862832969, -52.898501993800835, -44.80714526034458, -62.67412257617163, -37.018664170824586, -119.58076097634682, -53.88912565674515, -131.1858862363187, -111.47551587803724, -42.82743967373426, -53.455906241053015, -48.508386991182924, -42.07935003574508, -108.6692933649936, -116.2460013683966, -36.38964792697386, -32.85346420755551, -115.03632864363368, -110.88993607502059, -116.46049116161839, -121.33477026235747, -115.26672389787375, -119.10003350916195, -37.6444486595249, -110.39974471087443, -107.51318571950185, -119.72202636824487, -37.44913765496755, -110.27272578047216, -31.232718334318484, -105.76328540924005, -52.119061673338834, -106.26015346548893, -132.96352189190813, -50.76540416267518, -157.449891636911, -105.46398930313624, -54.38516247596705, -42.27966167254495, -104.5895469317014, -109.85384242724318, -107.73828605723754, -110.13326585740845, -110.6554148913448, -113.3701160882463, -114.81866837032015, -109.33972107810527, -42.52626484415454, -112.79019385548557, -109.81333471944866, -118.47274951819269, -114.89993498931267, -167.48863911369872, -110.19801508765482, -104.9151365764942, -51.75086707815223, -41.1586841902304, -49.34461472789012, -48.68372135606529, -40.888214477828406, -111.1725548055352, -44.78405137420019, -109.55734942572502, -129.83228251712399, -106.84283522121919, -109.37463094562665, -110.6659164208801, -38.202839458334495, -107.55230839786057, -132.1100932731274, -121.01934004531863, -121.65136217843929, -106.66544314674475, -106.48982656791124, -110.53737394000466, -133.3622463918794, -128.48691687297386, -103.14561739230591, -109.79722223208037, -126.2489125257147, -110.56739755802975, -45.5108935200336], "episode_lengths": [94, 1600, 1600, 67, 1600, 61, 1600, 1600, 61, 69, 1600, 86, 73, 84, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 102, 1600, 128, 117, 1600, 1600, 1600, 1600, 66, 84, 1600, 1600, 70, 49, 62, 74, 169, 60, 1600, 77, 64, 63, 1600, 62, 1600, 53, 1600, 71, 118, 1600, 338, 80, 1600, 1600, 67, 87, 80, 57, 48, 44, 68, 43, 1600, 60, 42, 61, 52, 556, 44, 51, 1600, 1600, 1600, 1600, 1600, 41, 1600, 78, 127, 97, 38, 50, 1600, 47, 183, 81, 61, 68, 77, 51, 117, 82, 100, 60, 160, 107, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29581717506294586, "mean_inference_ms": 0.9972595907676183, "mean_action_processing_ms": 0.19506622219781963, "mean_env_wait_ms": 0.3950386840911611, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005934953689575195, "StateBufferConnector_ms": 0.0043370723724365234, "ViewRequirementAgentConnector_ms": 0.11918401718139648}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 412.2875693961577, "num_env_steps_trained_throughput_per_sec": 412.2875693961577, "timesteps_total": 196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 196000, "timers": {"training_iteration_time_ms": 9952.775, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9952.74, "sample_time_ms": 3770.194, "load_time_ms": 0.435, "load_throughput": 9200557.17, "learn_time_ms": 6173.757, "learn_throughput": 647.904, "synch_weights_time_ms": 7.78}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "done": false, "episodes_total": 287, "training_iteration": 49, "trial_id": "3adab_00000", "date": "2024-04-27_21-04-42", "timestamp": 1714277082, "time_this_iter_s": 9.706511974334717, "time_total_s": 489.1600835323334, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 489.1600835323334, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 24.542857142857144, "ram_util_percent": 61.935714285714276}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.153710189621936, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3266367370474292, "policy_loss": -0.032384566113513, "vf_loss": 1.3531759877558998, "vf_explained_var": 0.4048283410969601, "kl": 0.008659707138725532, "entropy": 6.660041749605568, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 46035.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "sampler_results": {"episode_reward_max": -31.232718334318484, "episode_reward_min": -167.48863911369872, "episode_reward_mean": -90.57550068488466, "episode_len_mean": 631.79, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 63179, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-119.5571604381986, -46.322522700885386, -110.84828170241664, -108.85827739811565, -108.63676094473898, -44.40145913048837, -54.49304067087913, -54.526253331254544, -69.00947375598727, -65.69459862832969, -52.898501993800835, -44.80714526034458, -62.67412257617163, -37.018664170824586, -119.58076097634682, -53.88912565674515, -131.1858862363187, -111.47551587803724, -42.82743967373426, -53.455906241053015, -48.508386991182924, -42.07935003574508, -108.6692933649936, -116.2460013683966, -36.38964792697386, -32.85346420755551, -115.03632864363368, -110.88993607502059, -116.46049116161839, -121.33477026235747, -115.26672389787375, -119.10003350916195, -37.6444486595249, -110.39974471087443, -107.51318571950185, -119.72202636824487, -37.44913765496755, -110.27272578047216, -31.232718334318484, -105.76328540924005, -52.119061673338834, -106.26015346548893, -132.96352189190813, -50.76540416267518, -157.449891636911, -105.46398930313624, -54.38516247596705, -42.27966167254495, -104.5895469317014, -109.85384242724318, -107.73828605723754, -110.13326585740845, -110.6554148913448, -113.3701160882463, -114.81866837032015, -109.33972107810527, -42.52626484415454, -112.79019385548557, -109.81333471944866, -118.47274951819269, -114.89993498931267, -167.48863911369872, -110.19801508765482, -104.9151365764942, -51.75086707815223, -41.1586841902304, -49.34461472789012, -48.68372135606529, -40.888214477828406, -111.1725548055352, -44.78405137420019, -109.55734942572502, -129.83228251712399, -106.84283522121919, -109.37463094562665, -110.6659164208801, -38.202839458334495, -107.55230839786057, -132.1100932731274, -121.01934004531863, -121.65136217843929, -106.66544314674475, -106.48982656791124, -110.53737394000466, -133.3622463918794, -128.48691687297386, -103.14561739230591, -109.79722223208037, -126.2489125257147, -110.56739755802975, -45.5108935200336, -45.16360647359183, -51.709247200138286, -108.14889314686818, -41.931938188068486, -112.50698269766445, -107.13883769350127, -103.87035525517601, -115.77835467432627, -117.61576298354815], "episode_lengths": [69, 1600, 86, 73, 84, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 102, 1600, 128, 117, 1600, 1600, 1600, 1600, 66, 84, 1600, 1600, 70, 49, 62, 74, 169, 60, 1600, 77, 64, 63, 1600, 62, 1600, 53, 1600, 71, 118, 1600, 338, 80, 1600, 1600, 67, 87, 80, 57, 48, 44, 68, 43, 1600, 60, 42, 61, 52, 556, 44, 51, 1600, 1600, 1600, 1600, 1600, 41, 1600, 78, 127, 97, 38, 50, 1600, 47, 183, 81, 61, 68, 77, 51, 117, 82, 100, 60, 160, 107, 1600, 1600, 1600, 42, 1600, 91, 43, 62, 73, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2955754386522656, "mean_inference_ms": 0.996056859236861, "mean_action_processing_ms": 0.19486623513359735, "mean_env_wait_ms": 0.39454398118802125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00593113899230957, "StateBufferConnector_ms": 0.004392147064208984, "ViewRequirementAgentConnector_ms": 0.11971092224121094}}, "episode_reward_max": -31.232718334318484, "episode_reward_min": -167.48863911369872, "episode_reward_mean": -90.57550068488466, "episode_len_mean": 631.79, "episodes_this_iter": 9, "episodes_timesteps_total": 63179, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-119.5571604381986, -46.322522700885386, -110.84828170241664, -108.85827739811565, -108.63676094473898, -44.40145913048837, -54.49304067087913, -54.526253331254544, -69.00947375598727, -65.69459862832969, -52.898501993800835, -44.80714526034458, -62.67412257617163, -37.018664170824586, -119.58076097634682, -53.88912565674515, -131.1858862363187, -111.47551587803724, -42.82743967373426, -53.455906241053015, -48.508386991182924, -42.07935003574508, -108.6692933649936, -116.2460013683966, -36.38964792697386, -32.85346420755551, -115.03632864363368, -110.88993607502059, -116.46049116161839, -121.33477026235747, -115.26672389787375, -119.10003350916195, -37.6444486595249, -110.39974471087443, -107.51318571950185, -119.72202636824487, -37.44913765496755, -110.27272578047216, -31.232718334318484, -105.76328540924005, -52.119061673338834, -106.26015346548893, -132.96352189190813, -50.76540416267518, -157.449891636911, -105.46398930313624, -54.38516247596705, -42.27966167254495, -104.5895469317014, -109.85384242724318, -107.73828605723754, -110.13326585740845, -110.6554148913448, -113.3701160882463, -114.81866837032015, -109.33972107810527, -42.52626484415454, -112.79019385548557, -109.81333471944866, -118.47274951819269, -114.89993498931267, -167.48863911369872, -110.19801508765482, -104.9151365764942, -51.75086707815223, -41.1586841902304, -49.34461472789012, -48.68372135606529, -40.888214477828406, -111.1725548055352, -44.78405137420019, -109.55734942572502, -129.83228251712399, -106.84283522121919, -109.37463094562665, -110.6659164208801, -38.202839458334495, -107.55230839786057, -132.1100932731274, -121.01934004531863, -121.65136217843929, -106.66544314674475, -106.48982656791124, -110.53737394000466, -133.3622463918794, -128.48691687297386, -103.14561739230591, -109.79722223208037, -126.2489125257147, -110.56739755802975, -45.5108935200336, -45.16360647359183, -51.709247200138286, -108.14889314686818, -41.931938188068486, -112.50698269766445, -107.13883769350127, -103.87035525517601, -115.77835467432627, -117.61576298354815], "episode_lengths": [69, 1600, 86, 73, 84, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 102, 1600, 128, 117, 1600, 1600, 1600, 1600, 66, 84, 1600, 1600, 70, 49, 62, 74, 169, 60, 1600, 77, 64, 63, 1600, 62, 1600, 53, 1600, 71, 118, 1600, 338, 80, 1600, 1600, 67, 87, 80, 57, 48, 44, 68, 43, 1600, 60, 42, 61, 52, 556, 44, 51, 1600, 1600, 1600, 1600, 1600, 41, 1600, 78, 127, 97, 38, 50, 1600, 47, 183, 81, 61, 68, 77, 51, 117, 82, 100, 60, 160, 107, 1600, 1600, 1600, 42, 1600, 91, 43, 62, 73, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2955754386522656, "mean_inference_ms": 0.996056859236861, "mean_action_processing_ms": 0.19486623513359735, "mean_env_wait_ms": 0.39454398118802125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00593113899230957, "StateBufferConnector_ms": 0.004392147064208984, "ViewRequirementAgentConnector_ms": 0.11971092224121094}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 417.1914897214735, "num_env_steps_trained_throughput_per_sec": 417.1914897214735, "timesteps_total": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 9930.176, "restore_workers_time_ms": 0.012, "training_step_time_ms": 9930.141, "sample_time_ms": 3735.78, "load_time_ms": 0.431, "load_throughput": 9277894.155, "learn_time_ms": 6185.609, "learn_throughput": 646.662, "synch_weights_time_ms": 7.745}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "episodes_total": 296, "training_iteration": 50, "trial_id": "3adab_00000", "date": "2024-04-27_21-04-52", "timestamp": 1714277092, "time_this_iter_s": 9.592525959014893, "time_total_s": 498.75260949134827, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 498.75260949134827, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 24.507142857142856, "ram_util_percent": 61.89999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.78909887306152, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3426570576137453, "policy_loss": -0.03571388601695979, "vf_loss": 1.3727276477842563, "vf_explained_var": 0.21012903054555257, "kl": 0.008360456005914787, "entropy": 6.782481278142622, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 46965.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "sampler_results": {"episode_reward_max": -31.232718334318484, "episode_reward_min": -167.48863911369872, "episode_reward_mean": -90.02359578475301, "episode_len_mean": 650.54, "episode_media": {}, "episodes_this_iter": 5, "episodes_timesteps_total": 65054, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-44.40145913048837, -54.49304067087913, -54.526253331254544, -69.00947375598727, -65.69459862832969, -52.898501993800835, -44.80714526034458, -62.67412257617163, -37.018664170824586, -119.58076097634682, -53.88912565674515, -131.1858862363187, -111.47551587803724, -42.82743967373426, -53.455906241053015, -48.508386991182924, -42.07935003574508, -108.6692933649936, -116.2460013683966, -36.38964792697386, -32.85346420755551, -115.03632864363368, -110.88993607502059, -116.46049116161839, -121.33477026235747, -115.26672389787375, -119.10003350916195, -37.6444486595249, -110.39974471087443, -107.51318571950185, -119.72202636824487, -37.44913765496755, -110.27272578047216, -31.232718334318484, -105.76328540924005, -52.119061673338834, -106.26015346548893, -132.96352189190813, -50.76540416267518, -157.449891636911, -105.46398930313624, -54.38516247596705, -42.27966167254495, -104.5895469317014, -109.85384242724318, -107.73828605723754, -110.13326585740845, -110.6554148913448, -113.3701160882463, -114.81866837032015, -109.33972107810527, -42.52626484415454, -112.79019385548557, -109.81333471944866, -118.47274951819269, -114.89993498931267, -167.48863911369872, -110.19801508765482, -104.9151365764942, -51.75086707815223, -41.1586841902304, -49.34461472789012, -48.68372135606529, -40.888214477828406, -111.1725548055352, -44.78405137420019, -109.55734942572502, -129.83228251712399, -106.84283522121919, -109.37463094562665, -110.6659164208801, -38.202839458334495, -107.55230839786057, -132.1100932731274, -121.01934004531863, -121.65136217843929, -106.66544314674475, -106.48982656791124, -110.53737394000466, -133.3622463918794, -128.48691687297386, -103.14561739230591, -109.79722223208037, -126.2489125257147, -110.56739755802975, -45.5108935200336, -45.16360647359183, -51.709247200138286, -108.14889314686818, -41.931938188068486, -112.50698269766445, -107.13883769350127, -103.87035525517601, -115.77835467432627, -117.61576298354815, -109.55061502788402, -39.4566132901069, -110.47364988147841, -132.6863165245192, -46.865318447202306], "episode_lengths": [1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 102, 1600, 128, 117, 1600, 1600, 1600, 1600, 66, 84, 1600, 1600, 70, 49, 62, 74, 169, 60, 1600, 77, 64, 63, 1600, 62, 1600, 53, 1600, 71, 118, 1600, 338, 80, 1600, 1600, 67, 87, 80, 57, 48, 44, 68, 43, 1600, 60, 42, 61, 52, 556, 44, 51, 1600, 1600, 1600, 1600, 1600, 41, 1600, 78, 127, 97, 38, 50, 1600, 47, 183, 81, 61, 68, 77, 51, 117, 82, 100, 60, 160, 107, 1600, 1600, 1600, 42, 1600, 91, 43, 62, 73, 64, 299, 1600, 72, 216, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2954342033528103, "mean_inference_ms": 0.9956153396328041, "mean_action_processing_ms": 0.19475083623421216, "mean_env_wait_ms": 0.3941862549858811, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0060002803802490234, "StateBufferConnector_ms": 0.004423379898071289, "ViewRequirementAgentConnector_ms": 0.12036418914794922}}, "episode_reward_max": -31.232718334318484, "episode_reward_min": -167.48863911369872, "episode_reward_mean": -90.02359578475301, "episode_len_mean": 650.54, "episodes_this_iter": 5, "episodes_timesteps_total": 65054, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-44.40145913048837, -54.49304067087913, -54.526253331254544, -69.00947375598727, -65.69459862832969, -52.898501993800835, -44.80714526034458, -62.67412257617163, -37.018664170824586, -119.58076097634682, -53.88912565674515, -131.1858862363187, -111.47551587803724, -42.82743967373426, -53.455906241053015, -48.508386991182924, -42.07935003574508, -108.6692933649936, -116.2460013683966, -36.38964792697386, -32.85346420755551, -115.03632864363368, -110.88993607502059, -116.46049116161839, -121.33477026235747, -115.26672389787375, -119.10003350916195, -37.6444486595249, -110.39974471087443, -107.51318571950185, -119.72202636824487, -37.44913765496755, -110.27272578047216, -31.232718334318484, -105.76328540924005, -52.119061673338834, -106.26015346548893, -132.96352189190813, -50.76540416267518, -157.449891636911, -105.46398930313624, -54.38516247596705, -42.27966167254495, -104.5895469317014, -109.85384242724318, -107.73828605723754, -110.13326585740845, -110.6554148913448, -113.3701160882463, -114.81866837032015, -109.33972107810527, -42.52626484415454, -112.79019385548557, -109.81333471944866, -118.47274951819269, -114.89993498931267, -167.48863911369872, -110.19801508765482, -104.9151365764942, -51.75086707815223, -41.1586841902304, -49.34461472789012, -48.68372135606529, -40.888214477828406, -111.1725548055352, -44.78405137420019, -109.55734942572502, -129.83228251712399, -106.84283522121919, -109.37463094562665, -110.6659164208801, -38.202839458334495, -107.55230839786057, -132.1100932731274, -121.01934004531863, -121.65136217843929, -106.66544314674475, -106.48982656791124, -110.53737394000466, -133.3622463918794, -128.48691687297386, -103.14561739230591, -109.79722223208037, -126.2489125257147, -110.56739755802975, -45.5108935200336, -45.16360647359183, -51.709247200138286, -108.14889314686818, -41.931938188068486, -112.50698269766445, -107.13883769350127, -103.87035525517601, -115.77835467432627, -117.61576298354815, -109.55061502788402, -39.4566132901069, -110.47364988147841, -132.6863165245192, -46.865318447202306], "episode_lengths": [1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 102, 1600, 128, 117, 1600, 1600, 1600, 1600, 66, 84, 1600, 1600, 70, 49, 62, 74, 169, 60, 1600, 77, 64, 63, 1600, 62, 1600, 53, 1600, 71, 118, 1600, 338, 80, 1600, 1600, 67, 87, 80, 57, 48, 44, 68, 43, 1600, 60, 42, 61, 52, 556, 44, 51, 1600, 1600, 1600, 1600, 1600, 41, 1600, 78, 127, 97, 38, 50, 1600, 47, 183, 81, 61, 68, 77, 51, 117, 82, 100, 60, 160, 107, 1600, 1600, 1600, 42, 1600, 91, 43, 62, 73, 64, 299, 1600, 72, 216, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2954342033528103, "mean_inference_ms": 0.9956153396328041, "mean_action_processing_ms": 0.19475083623421216, "mean_env_wait_ms": 0.3941862549858811, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0060002803802490234, "StateBufferConnector_ms": 0.004423379898071289, "ViewRequirementAgentConnector_ms": 0.12036418914794922}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 414.35882409557047, "num_env_steps_trained_throughput_per_sec": 414.35882409557047, "timesteps_total": 204000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 204000, "timers": {"training_iteration_time_ms": 9855.657, "restore_workers_time_ms": 0.012, "training_step_time_ms": 9855.624, "sample_time_ms": 3743.064, "load_time_ms": 0.437, "load_throughput": 9150875.968, "learn_time_ms": 6103.751, "learn_throughput": 655.335, "synch_weights_time_ms": 7.812}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "done": false, "episodes_total": 301, "training_iteration": 51, "trial_id": "3adab_00000", "date": "2024-04-27_21-05-02", "timestamp": 1714277102, "time_this_iter_s": 9.657481908798218, "time_total_s": 508.4100914001465, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 508.4100914001465, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 24.857142857142854, "ram_util_percent": 61.89999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.72219382434763, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8702689988856573, "policy_loss": -0.028727133195566874, "vf_loss": 1.8932447812329698, "vf_explained_var": 0.13555384515434182, "kl": 0.008520509246258832, "entropy": 5.57131992360597, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 47895.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "sampler_results": {"episode_reward_max": -31.232718334318484, "episode_reward_min": -167.48863911369872, "episode_reward_mean": -91.1593719530499, "episode_len_mean": 631.69, "episode_media": {}, "episodes_this_iter": 4, "episodes_timesteps_total": 63169, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-65.69459862832969, -52.898501993800835, -44.80714526034458, -62.67412257617163, -37.018664170824586, -119.58076097634682, -53.88912565674515, -131.1858862363187, -111.47551587803724, -42.82743967373426, -53.455906241053015, -48.508386991182924, -42.07935003574508, -108.6692933649936, -116.2460013683966, -36.38964792697386, -32.85346420755551, -115.03632864363368, -110.88993607502059, -116.46049116161839, -121.33477026235747, -115.26672389787375, -119.10003350916195, -37.6444486595249, -110.39974471087443, -107.51318571950185, -119.72202636824487, -37.44913765496755, -110.27272578047216, -31.232718334318484, -105.76328540924005, -52.119061673338834, -106.26015346548893, -132.96352189190813, -50.76540416267518, -157.449891636911, -105.46398930313624, -54.38516247596705, -42.27966167254495, -104.5895469317014, -109.85384242724318, -107.73828605723754, -110.13326585740845, -110.6554148913448, -113.3701160882463, -114.81866837032015, -109.33972107810527, -42.52626484415454, -112.79019385548557, -109.81333471944866, -118.47274951819269, -114.89993498931267, -167.48863911369872, -110.19801508765482, -104.9151365764942, -51.75086707815223, -41.1586841902304, -49.34461472789012, -48.68372135606529, -40.888214477828406, -111.1725548055352, -44.78405137420019, -109.55734942572502, -129.83228251712399, -106.84283522121919, -109.37463094562665, -110.6659164208801, -38.202839458334495, -107.55230839786057, -132.1100932731274, -121.01934004531863, -121.65136217843929, -106.66544314674475, -106.48982656791124, -110.53737394000466, -133.3622463918794, -128.48691687297386, -103.14561739230591, -109.79722223208037, -126.2489125257147, -110.56739755802975, -45.5108935200336, -45.16360647359183, -51.709247200138286, -108.14889314686818, -41.931938188068486, -112.50698269766445, -107.13883769350127, -103.87035525517601, -115.77835467432627, -117.61576298354815, -109.55061502788402, -39.4566132901069, -110.47364988147841, -132.6863165245192, -46.865318447202306, -105.46540259215733, -136.6536987534576, -45.23290894703313, -48.65583342564916], "episode_lengths": [1600, 1600, 1600, 1600, 1600, 102, 1600, 128, 117, 1600, 1600, 1600, 1600, 66, 84, 1600, 1600, 70, 49, 62, 74, 169, 60, 1600, 77, 64, 63, 1600, 62, 1600, 53, 1600, 71, 118, 1600, 338, 80, 1600, 1600, 67, 87, 80, 57, 48, 44, 68, 43, 1600, 60, 42, 61, 52, 556, 44, 51, 1600, 1600, 1600, 1600, 1600, 41, 1600, 78, 127, 97, 38, 50, 1600, 47, 183, 81, 61, 68, 77, 51, 117, 82, 100, 60, 160, 107, 1600, 1600, 1600, 42, 1600, 91, 43, 62, 73, 64, 299, 1600, 72, 216, 1600, 81, 1234, 1600, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2954097052606503, "mean_inference_ms": 0.9954810128388908, "mean_action_processing_ms": 0.19472542516368851, "mean_env_wait_ms": 0.39404512835014577, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005962371826171875, "StateBufferConnector_ms": 0.004477500915527344, "ViewRequirementAgentConnector_ms": 0.1215815544128418}}, "episode_reward_max": -31.232718334318484, "episode_reward_min": -167.48863911369872, "episode_reward_mean": -91.1593719530499, "episode_len_mean": 631.69, "episodes_this_iter": 4, "episodes_timesteps_total": 63169, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-65.69459862832969, -52.898501993800835, -44.80714526034458, -62.67412257617163, -37.018664170824586, -119.58076097634682, -53.88912565674515, -131.1858862363187, -111.47551587803724, -42.82743967373426, -53.455906241053015, -48.508386991182924, -42.07935003574508, -108.6692933649936, -116.2460013683966, -36.38964792697386, -32.85346420755551, -115.03632864363368, -110.88993607502059, -116.46049116161839, -121.33477026235747, -115.26672389787375, -119.10003350916195, -37.6444486595249, -110.39974471087443, -107.51318571950185, -119.72202636824487, -37.44913765496755, -110.27272578047216, -31.232718334318484, -105.76328540924005, -52.119061673338834, -106.26015346548893, -132.96352189190813, -50.76540416267518, -157.449891636911, -105.46398930313624, -54.38516247596705, -42.27966167254495, -104.5895469317014, -109.85384242724318, -107.73828605723754, -110.13326585740845, -110.6554148913448, -113.3701160882463, -114.81866837032015, -109.33972107810527, -42.52626484415454, -112.79019385548557, -109.81333471944866, -118.47274951819269, -114.89993498931267, -167.48863911369872, -110.19801508765482, -104.9151365764942, -51.75086707815223, -41.1586841902304, -49.34461472789012, -48.68372135606529, -40.888214477828406, -111.1725548055352, -44.78405137420019, -109.55734942572502, -129.83228251712399, -106.84283522121919, -109.37463094562665, -110.6659164208801, -38.202839458334495, -107.55230839786057, -132.1100932731274, -121.01934004531863, -121.65136217843929, -106.66544314674475, -106.48982656791124, -110.53737394000466, -133.3622463918794, -128.48691687297386, -103.14561739230591, -109.79722223208037, -126.2489125257147, -110.56739755802975, -45.5108935200336, -45.16360647359183, -51.709247200138286, -108.14889314686818, -41.931938188068486, -112.50698269766445, -107.13883769350127, -103.87035525517601, -115.77835467432627, -117.61576298354815, -109.55061502788402, -39.4566132901069, -110.47364988147841, -132.6863165245192, -46.865318447202306, -105.46540259215733, -136.6536987534576, -45.23290894703313, -48.65583342564916], "episode_lengths": [1600, 1600, 1600, 1600, 1600, 102, 1600, 128, 117, 1600, 1600, 1600, 1600, 66, 84, 1600, 1600, 70, 49, 62, 74, 169, 60, 1600, 77, 64, 63, 1600, 62, 1600, 53, 1600, 71, 118, 1600, 338, 80, 1600, 1600, 67, 87, 80, 57, 48, 44, 68, 43, 1600, 60, 42, 61, 52, 556, 44, 51, 1600, 1600, 1600, 1600, 1600, 41, 1600, 78, 127, 97, 38, 50, 1600, 47, 183, 81, 61, 68, 77, 51, 117, 82, 100, 60, 160, 107, 1600, 1600, 1600, 42, 1600, 91, 43, 62, 73, 64, 299, 1600, 72, 216, 1600, 81, 1234, 1600, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2954097052606503, "mean_inference_ms": 0.9954810128388908, "mean_action_processing_ms": 0.19472542516368851, "mean_env_wait_ms": 0.39404512835014577, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005962371826171875, "StateBufferConnector_ms": 0.004477500915527344, "ViewRequirementAgentConnector_ms": 0.1215815544128418}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 352.1736276546422, "num_env_steps_trained_throughput_per_sec": 352.1736276546422, "timesteps_total": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 10017.955, "restore_workers_time_ms": 0.012, "training_step_time_ms": 10017.919, "sample_time_ms": 3822.149, "load_time_ms": 0.43, "load_throughput": 9304134.871, "learn_time_ms": 6186.605, "learn_throughput": 646.558, "synch_weights_time_ms": 8.16}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "episodes_total": 305, "training_iteration": 52, "trial_id": "3adab_00000", "date": "2024-04-27_21-05-13", "timestamp": 1714277113, "time_this_iter_s": 11.363684177398682, "time_total_s": 519.7737755775452, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 519.7737755775452, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 33.275000000000006, "ram_util_percent": 62.95625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.929494124971411, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2566359690515705, "policy_loss": -0.01847681309827553, "vf_loss": 1.2681727216208494, "vf_explained_var": 0.3340529465547172, "kl": 0.01028159960339019, "entropy": 5.288702935557212, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 48825.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "sampler_results": {"episode_reward_max": -31.232718334318484, "episode_reward_min": -167.48863911369872, "episode_reward_mean": -91.00676641127271, "episode_len_mean": 631.69, "episode_media": {}, "episodes_this_iter": 2, "episodes_timesteps_total": 63169, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-44.80714526034458, -62.67412257617163, -37.018664170824586, -119.58076097634682, -53.88912565674515, -131.1858862363187, -111.47551587803724, -42.82743967373426, -53.455906241053015, -48.508386991182924, -42.07935003574508, -108.6692933649936, -116.2460013683966, -36.38964792697386, -32.85346420755551, -115.03632864363368, -110.88993607502059, -116.46049116161839, -121.33477026235747, -115.26672389787375, -119.10003350916195, -37.6444486595249, -110.39974471087443, -107.51318571950185, -119.72202636824487, -37.44913765496755, -110.27272578047216, -31.232718334318484, -105.76328540924005, -52.119061673338834, -106.26015346548893, -132.96352189190813, -50.76540416267518, -157.449891636911, -105.46398930313624, -54.38516247596705, -42.27966167254495, -104.5895469317014, -109.85384242724318, -107.73828605723754, -110.13326585740845, -110.6554148913448, -113.3701160882463, -114.81866837032015, -109.33972107810527, -42.52626484415454, -112.79019385548557, -109.81333471944866, -118.47274951819269, -114.89993498931267, -167.48863911369872, -110.19801508765482, -104.9151365764942, -51.75086707815223, -41.1586841902304, -49.34461472789012, -48.68372135606529, -40.888214477828406, -111.1725548055352, -44.78405137420019, -109.55734942572502, -129.83228251712399, -106.84283522121919, -109.37463094562665, -110.6659164208801, -38.202839458334495, -107.55230839786057, -132.1100932731274, -121.01934004531863, -121.65136217843929, -106.66544314674475, -106.48982656791124, -110.53737394000466, -133.3622463918794, -128.48691687297386, -103.14561739230591, -109.79722223208037, -126.2489125257147, -110.56739755802975, -45.5108935200336, -45.16360647359183, -51.709247200138286, -108.14889314686818, -41.931938188068486, -112.50698269766445, -107.13883769350127, -103.87035525517601, -115.77835467432627, -117.61576298354815, -109.55061502788402, -39.4566132901069, -110.47364988147841, -132.6863165245192, -46.865318447202306, -105.46540259215733, -136.6536987534576, -45.23290894703313, -48.65583342564916, -59.0216904875929, -44.31085595682138], "episode_lengths": [1600, 1600, 1600, 102, 1600, 128, 117, 1600, 1600, 1600, 1600, 66, 84, 1600, 1600, 70, 49, 62, 74, 169, 60, 1600, 77, 64, 63, 1600, 62, 1600, 53, 1600, 71, 118, 1600, 338, 80, 1600, 1600, 67, 87, 80, 57, 48, 44, 68, 43, 1600, 60, 42, 61, 52, 556, 44, 51, 1600, 1600, 1600, 1600, 1600, 41, 1600, 78, 127, 97, 38, 50, 1600, 47, 183, 81, 61, 68, 77, 51, 117, 82, 100, 60, 160, 107, 1600, 1600, 1600, 42, 1600, 91, 43, 62, 73, 64, 299, 1600, 72, 216, 1600, 81, 1234, 1600, 1600, 1600, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29542181947941004, "mean_inference_ms": 0.9955155003391155, "mean_action_processing_ms": 0.19473126448078865, "mean_env_wait_ms": 0.39400387422310906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005966901779174805, "StateBufferConnector_ms": 0.00448155403137207, "ViewRequirementAgentConnector_ms": 0.12172985076904297}}, "episode_reward_max": -31.232718334318484, "episode_reward_min": -167.48863911369872, "episode_reward_mean": -91.00676641127271, "episode_len_mean": 631.69, "episodes_this_iter": 2, "episodes_timesteps_total": 63169, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-44.80714526034458, -62.67412257617163, -37.018664170824586, -119.58076097634682, -53.88912565674515, -131.1858862363187, -111.47551587803724, -42.82743967373426, -53.455906241053015, -48.508386991182924, -42.07935003574508, -108.6692933649936, -116.2460013683966, -36.38964792697386, -32.85346420755551, -115.03632864363368, -110.88993607502059, -116.46049116161839, -121.33477026235747, -115.26672389787375, -119.10003350916195, -37.6444486595249, -110.39974471087443, -107.51318571950185, -119.72202636824487, -37.44913765496755, -110.27272578047216, -31.232718334318484, -105.76328540924005, -52.119061673338834, -106.26015346548893, -132.96352189190813, -50.76540416267518, -157.449891636911, -105.46398930313624, -54.38516247596705, -42.27966167254495, -104.5895469317014, -109.85384242724318, -107.73828605723754, -110.13326585740845, -110.6554148913448, -113.3701160882463, -114.81866837032015, -109.33972107810527, -42.52626484415454, -112.79019385548557, -109.81333471944866, -118.47274951819269, -114.89993498931267, -167.48863911369872, -110.19801508765482, -104.9151365764942, -51.75086707815223, -41.1586841902304, -49.34461472789012, -48.68372135606529, -40.888214477828406, -111.1725548055352, -44.78405137420019, -109.55734942572502, -129.83228251712399, -106.84283522121919, -109.37463094562665, -110.6659164208801, -38.202839458334495, -107.55230839786057, -132.1100932731274, -121.01934004531863, -121.65136217843929, -106.66544314674475, -106.48982656791124, -110.53737394000466, -133.3622463918794, -128.48691687297386, -103.14561739230591, -109.79722223208037, -126.2489125257147, -110.56739755802975, -45.5108935200336, -45.16360647359183, -51.709247200138286, -108.14889314686818, -41.931938188068486, -112.50698269766445, -107.13883769350127, -103.87035525517601, -115.77835467432627, -117.61576298354815, -109.55061502788402, -39.4566132901069, -110.47364988147841, -132.6863165245192, -46.865318447202306, -105.46540259215733, -136.6536987534576, -45.23290894703313, -48.65583342564916, -59.0216904875929, -44.31085595682138], "episode_lengths": [1600, 1600, 1600, 102, 1600, 128, 117, 1600, 1600, 1600, 1600, 66, 84, 1600, 1600, 70, 49, 62, 74, 169, 60, 1600, 77, 64, 63, 1600, 62, 1600, 53, 1600, 71, 118, 1600, 338, 80, 1600, 1600, 67, 87, 80, 57, 48, 44, 68, 43, 1600, 60, 42, 61, 52, 556, 44, 51, 1600, 1600, 1600, 1600, 1600, 41, 1600, 78, 127, 97, 38, 50, 1600, 47, 183, 81, 61, 68, 77, 51, 117, 82, 100, 60, 160, 107, 1600, 1600, 1600, 42, 1600, 91, 43, 62, 73, 64, 299, 1600, 72, 216, 1600, 81, 1234, 1600, 1600, 1600, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29542181947941004, "mean_inference_ms": 0.9955155003391155, "mean_action_processing_ms": 0.19473126448078865, "mean_env_wait_ms": 0.39400387422310906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005966901779174805, "StateBufferConnector_ms": 0.00448155403137207, "ViewRequirementAgentConnector_ms": 0.12172985076904297}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 383.0521656586933, "num_env_steps_trained_throughput_per_sec": 383.0521656586933, "timesteps_total": 212000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 212000, "timers": {"training_iteration_time_ms": 10094.313, "restore_workers_time_ms": 0.013, "training_step_time_ms": 10094.275, "sample_time_ms": 3911.932, "load_time_ms": 0.442, "load_throughput": 9046759.774, "learn_time_ms": 6173.108, "learn_throughput": 647.972, "synch_weights_time_ms": 8.219}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "done": false, "episodes_total": 307, "training_iteration": 53, "trial_id": "3adab_00000", "date": "2024-04-27_21-05-24", "timestamp": 1714277124, "time_this_iter_s": 10.447399139404297, "time_total_s": 530.2211747169495, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 530.2211747169495, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 31.906666666666663, "ram_util_percent": 62.95333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.52130993412387, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.375134152183885, "policy_loss": -0.03579360180965034, "vf_loss": 1.4059828704883974, "vf_explained_var": 0.32806254426638287, "kl": 0.007325753625717934, "entropy": 5.83902774062208, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 49755.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "sampler_results": {"episode_reward_max": -31.232718334318484, "episode_reward_min": -167.48863911369872, "episode_reward_mean": -92.3428946882355, "episode_len_mean": 601.06, "episode_media": {}, "episodes_this_iter": 5, "episodes_timesteps_total": 60106, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-131.1858862363187, -111.47551587803724, -42.82743967373426, -53.455906241053015, -48.508386991182924, -42.07935003574508, -108.6692933649936, -116.2460013683966, -36.38964792697386, -32.85346420755551, -115.03632864363368, -110.88993607502059, -116.46049116161839, -121.33477026235747, -115.26672389787375, -119.10003350916195, -37.6444486595249, -110.39974471087443, -107.51318571950185, -119.72202636824487, -37.44913765496755, -110.27272578047216, -31.232718334318484, -105.76328540924005, -52.119061673338834, -106.26015346548893, -132.96352189190813, -50.76540416267518, -157.449891636911, -105.46398930313624, -54.38516247596705, -42.27966167254495, -104.5895469317014, -109.85384242724318, -107.73828605723754, -110.13326585740845, -110.6554148913448, -113.3701160882463, -114.81866837032015, -109.33972107810527, -42.52626484415454, -112.79019385548557, -109.81333471944866, -118.47274951819269, -114.89993498931267, -167.48863911369872, -110.19801508765482, -104.9151365764942, -51.75086707815223, -41.1586841902304, -49.34461472789012, -48.68372135606529, -40.888214477828406, -111.1725548055352, -44.78405137420019, -109.55734942572502, -129.83228251712399, -106.84283522121919, -109.37463094562665, -110.6659164208801, -38.202839458334495, -107.55230839786057, -132.1100932731274, -121.01934004531863, -121.65136217843929, -106.66544314674475, -106.48982656791124, -110.53737394000466, -133.3622463918794, -128.48691687297386, -103.14561739230591, -109.79722223208037, -126.2489125257147, -110.56739755802975, -45.5108935200336, -45.16360647359183, -51.709247200138286, -108.14889314686818, -41.931938188068486, -112.50698269766445, -107.13883769350127, -103.87035525517601, -115.77835467432627, -117.61576298354815, -109.55061502788402, -39.4566132901069, -110.47364988147841, -132.6863165245192, -46.865318447202306, -105.46540259215733, -136.6536987534576, -45.23290894703313, -48.65583342564916, -59.0216904875929, -44.31085595682138, -43.74589045116623, -118.11041362082648, -114.33997741754787, -129.76464484349015, -45.621720003678185], "episode_lengths": [128, 117, 1600, 1600, 1600, 1600, 66, 84, 1600, 1600, 70, 49, 62, 74, 169, 60, 1600, 77, 64, 63, 1600, 62, 1600, 53, 1600, 71, 118, 1600, 338, 80, 1600, 1600, 67, 87, 80, 57, 48, 44, 68, 43, 1600, 60, 42, 61, 52, 556, 44, 51, 1600, 1600, 1600, 1600, 1600, 41, 1600, 78, 127, 97, 38, 50, 1600, 47, 183, 81, 61, 68, 77, 51, 117, 82, 100, 60, 160, 107, 1600, 1600, 1600, 42, 1600, 91, 43, 62, 73, 64, 299, 1600, 72, 216, 1600, 81, 1234, 1600, 1600, 1600, 1600, 1600, 75, 50, 114, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2954941192340319, "mean_inference_ms": 0.9957693108250096, "mean_action_processing_ms": 0.19477015352520868, "mean_env_wait_ms": 0.3939122183560568, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005948066711425781, "StateBufferConnector_ms": 0.004487276077270508, "ViewRequirementAgentConnector_ms": 0.12193894386291504}}, "episode_reward_max": -31.232718334318484, "episode_reward_min": -167.48863911369872, "episode_reward_mean": -92.3428946882355, "episode_len_mean": 601.06, "episodes_this_iter": 5, "episodes_timesteps_total": 60106, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-131.1858862363187, -111.47551587803724, -42.82743967373426, -53.455906241053015, -48.508386991182924, -42.07935003574508, -108.6692933649936, -116.2460013683966, -36.38964792697386, -32.85346420755551, -115.03632864363368, -110.88993607502059, -116.46049116161839, -121.33477026235747, -115.26672389787375, -119.10003350916195, -37.6444486595249, -110.39974471087443, -107.51318571950185, -119.72202636824487, -37.44913765496755, -110.27272578047216, -31.232718334318484, -105.76328540924005, -52.119061673338834, -106.26015346548893, -132.96352189190813, -50.76540416267518, -157.449891636911, -105.46398930313624, -54.38516247596705, -42.27966167254495, -104.5895469317014, -109.85384242724318, -107.73828605723754, -110.13326585740845, -110.6554148913448, -113.3701160882463, -114.81866837032015, -109.33972107810527, -42.52626484415454, -112.79019385548557, -109.81333471944866, -118.47274951819269, -114.89993498931267, -167.48863911369872, -110.19801508765482, -104.9151365764942, -51.75086707815223, -41.1586841902304, -49.34461472789012, -48.68372135606529, -40.888214477828406, -111.1725548055352, -44.78405137420019, -109.55734942572502, -129.83228251712399, -106.84283522121919, -109.37463094562665, -110.6659164208801, -38.202839458334495, -107.55230839786057, -132.1100932731274, -121.01934004531863, -121.65136217843929, -106.66544314674475, -106.48982656791124, -110.53737394000466, -133.3622463918794, -128.48691687297386, -103.14561739230591, -109.79722223208037, -126.2489125257147, -110.56739755802975, -45.5108935200336, -45.16360647359183, -51.709247200138286, -108.14889314686818, -41.931938188068486, -112.50698269766445, -107.13883769350127, -103.87035525517601, -115.77835467432627, -117.61576298354815, -109.55061502788402, -39.4566132901069, -110.47364988147841, -132.6863165245192, -46.865318447202306, -105.46540259215733, -136.6536987534576, -45.23290894703313, -48.65583342564916, -59.0216904875929, -44.31085595682138, -43.74589045116623, -118.11041362082648, -114.33997741754787, -129.76464484349015, -45.621720003678185], "episode_lengths": [128, 117, 1600, 1600, 1600, 1600, 66, 84, 1600, 1600, 70, 49, 62, 74, 169, 60, 1600, 77, 64, 63, 1600, 62, 1600, 53, 1600, 71, 118, 1600, 338, 80, 1600, 1600, 67, 87, 80, 57, 48, 44, 68, 43, 1600, 60, 42, 61, 52, 556, 44, 51, 1600, 1600, 1600, 1600, 1600, 41, 1600, 78, 127, 97, 38, 50, 1600, 47, 183, 81, 61, 68, 77, 51, 117, 82, 100, 60, 160, 107, 1600, 1600, 1600, 42, 1600, 91, 43, 62, 73, 64, 299, 1600, 72, 216, 1600, 81, 1234, 1600, 1600, 1600, 1600, 1600, 75, 50, 114, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2954941192340319, "mean_inference_ms": 0.9957693108250096, "mean_action_processing_ms": 0.19477015352520868, "mean_env_wait_ms": 0.3939122183560568, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005948066711425781, "StateBufferConnector_ms": 0.004487276077270508, "ViewRequirementAgentConnector_ms": 0.12193894386291504}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 368.237223455529, "num_env_steps_trained_throughput_per_sec": 368.237223455529, "timesteps_total": 216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 10216.221, "restore_workers_time_ms": 0.013, "training_step_time_ms": 10216.183, "sample_time_ms": 3932.824, "load_time_ms": 0.453, "load_throughput": 8823148.041, "learn_time_ms": 6274.105, "learn_throughput": 637.541, "synch_weights_time_ms": 8.236}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "episodes_total": 312, "training_iteration": 54, "trial_id": "3adab_00000", "date": "2024-04-27_21-05-34", "timestamp": 1714277134, "time_this_iter_s": 10.867193937301636, "time_total_s": 541.0883686542511, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 541.0883686542511, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 30.53333333333334, "ram_util_percent": 62.88666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.482742880781492, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.071744735771915, "policy_loss": -0.03963097162664898, "vf_loss": 4.101924244466648, "vf_explained_var": 0.2537149016575147, "kl": 0.014002166954447524, "entropy": 10.853706354223272, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 50685.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "sampler_results": {"episode_reward_max": -31.232718334318484, "episode_reward_min": -226.27534340332718, "episode_reward_mean": -96.21977389444781, "episode_len_mean": 555.61, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 55561, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115.03632864363368, -110.88993607502059, -116.46049116161839, -121.33477026235747, -115.26672389787375, -119.10003350916195, -37.6444486595249, -110.39974471087443, -107.51318571950185, -119.72202636824487, -37.44913765496755, -110.27272578047216, -31.232718334318484, -105.76328540924005, -52.119061673338834, -106.26015346548893, -132.96352189190813, -50.76540416267518, -157.449891636911, -105.46398930313624, -54.38516247596705, -42.27966167254495, -104.5895469317014, -109.85384242724318, -107.73828605723754, -110.13326585740845, -110.6554148913448, -113.3701160882463, -114.81866837032015, -109.33972107810527, -42.52626484415454, -112.79019385548557, -109.81333471944866, -118.47274951819269, -114.89993498931267, -167.48863911369872, -110.19801508765482, -104.9151365764942, -51.75086707815223, -41.1586841902304, -49.34461472789012, -48.68372135606529, -40.888214477828406, -111.1725548055352, -44.78405137420019, -109.55734942572502, -129.83228251712399, -106.84283522121919, -109.37463094562665, -110.6659164208801, -38.202839458334495, -107.55230839786057, -132.1100932731274, -121.01934004531863, -121.65136217843929, -106.66544314674475, -106.48982656791124, -110.53737394000466, -133.3622463918794, -128.48691687297386, -103.14561739230591, -109.79722223208037, -126.2489125257147, -110.56739755802975, -45.5108935200336, -45.16360647359183, -51.709247200138286, -108.14889314686818, -41.931938188068486, -112.50698269766445, -107.13883769350127, -103.87035525517601, -115.77835467432627, -117.61576298354815, -109.55061502788402, -39.4566132901069, -110.47364988147841, -132.6863165245192, -46.865318447202306, -105.46540259215733, -136.6536987534576, -45.23290894703313, -48.65583342564916, -59.0216904875929, -44.31085595682138, -43.74589045116623, -118.11041362082648, -114.33997741754787, -129.76464484349015, -45.621720003678185, -43.11279635486127, -226.27534340332718, -110.51492038701724, -104.26563396884936, -131.8870327002269, -47.7832500013213, -106.90834782281021, -109.9734789232798, -116.44278589757593, -114.21522308595542], "episode_lengths": [70, 49, 62, 74, 169, 60, 1600, 77, 64, 63, 1600, 62, 1600, 53, 1600, 71, 118, 1600, 338, 80, 1600, 1600, 67, 87, 80, 57, 48, 44, 68, 43, 1600, 60, 42, 61, 52, 556, 44, 51, 1600, 1600, 1600, 1600, 1600, 41, 1600, 78, 127, 97, 38, 50, 1600, 47, 183, 81, 61, 68, 77, 51, 117, 82, 100, 60, 160, 107, 1600, 1600, 1600, 42, 1600, 91, 43, 62, 73, 64, 299, 1600, 72, 216, 1600, 81, 1234, 1600, 1600, 1600, 1600, 1600, 75, 50, 114, 1600, 1600, 988, 51, 48, 874, 1600, 65, 52, 118, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.295624241045992, "mean_inference_ms": 0.9961622453134393, "mean_action_processing_ms": 0.19483082082794845, "mean_env_wait_ms": 0.39375404673634634, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005968809127807617, "StateBufferConnector_ms": 0.004481077194213867, "ViewRequirementAgentConnector_ms": 0.12088274955749512}}, "episode_reward_max": -31.232718334318484, "episode_reward_min": -226.27534340332718, "episode_reward_mean": -96.21977389444781, "episode_len_mean": 555.61, "episodes_this_iter": 10, "episodes_timesteps_total": 55561, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-115.03632864363368, -110.88993607502059, -116.46049116161839, -121.33477026235747, -115.26672389787375, -119.10003350916195, -37.6444486595249, -110.39974471087443, -107.51318571950185, -119.72202636824487, -37.44913765496755, -110.27272578047216, -31.232718334318484, -105.76328540924005, -52.119061673338834, -106.26015346548893, -132.96352189190813, -50.76540416267518, -157.449891636911, -105.46398930313624, -54.38516247596705, -42.27966167254495, -104.5895469317014, -109.85384242724318, -107.73828605723754, -110.13326585740845, -110.6554148913448, -113.3701160882463, -114.81866837032015, -109.33972107810527, -42.52626484415454, -112.79019385548557, -109.81333471944866, -118.47274951819269, -114.89993498931267, -167.48863911369872, -110.19801508765482, -104.9151365764942, -51.75086707815223, -41.1586841902304, -49.34461472789012, -48.68372135606529, -40.888214477828406, -111.1725548055352, -44.78405137420019, -109.55734942572502, -129.83228251712399, -106.84283522121919, -109.37463094562665, -110.6659164208801, -38.202839458334495, -107.55230839786057, -132.1100932731274, -121.01934004531863, -121.65136217843929, -106.66544314674475, -106.48982656791124, -110.53737394000466, -133.3622463918794, -128.48691687297386, -103.14561739230591, -109.79722223208037, -126.2489125257147, -110.56739755802975, -45.5108935200336, -45.16360647359183, -51.709247200138286, -108.14889314686818, -41.931938188068486, -112.50698269766445, -107.13883769350127, -103.87035525517601, -115.77835467432627, -117.61576298354815, -109.55061502788402, -39.4566132901069, -110.47364988147841, -132.6863165245192, -46.865318447202306, -105.46540259215733, -136.6536987534576, -45.23290894703313, -48.65583342564916, -59.0216904875929, -44.31085595682138, -43.74589045116623, -118.11041362082648, -114.33997741754787, -129.76464484349015, -45.621720003678185, -43.11279635486127, -226.27534340332718, -110.51492038701724, -104.26563396884936, -131.8870327002269, -47.7832500013213, -106.90834782281021, -109.9734789232798, -116.44278589757593, -114.21522308595542], "episode_lengths": [70, 49, 62, 74, 169, 60, 1600, 77, 64, 63, 1600, 62, 1600, 53, 1600, 71, 118, 1600, 338, 80, 1600, 1600, 67, 87, 80, 57, 48, 44, 68, 43, 1600, 60, 42, 61, 52, 556, 44, 51, 1600, 1600, 1600, 1600, 1600, 41, 1600, 78, 127, 97, 38, 50, 1600, 47, 183, 81, 61, 68, 77, 51, 117, 82, 100, 60, 160, 107, 1600, 1600, 1600, 42, 1600, 91, 43, 62, 73, 64, 299, 1600, 72, 216, 1600, 81, 1234, 1600, 1600, 1600, 1600, 1600, 75, 50, 114, 1600, 1600, 988, 51, 48, 874, 1600, 65, 52, 118, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.295624241045992, "mean_inference_ms": 0.9961622453134393, "mean_action_processing_ms": 0.19483082082794845, "mean_env_wait_ms": 0.39375404673634634, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005968809127807617, "StateBufferConnector_ms": 0.004481077194213867, "ViewRequirementAgentConnector_ms": 0.12088274955749512}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 414.6742419477006, "num_env_steps_trained_throughput_per_sec": 414.6742419477006, "timesteps_total": 220000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 220000, "timers": {"training_iteration_time_ms": 10233.95, "restore_workers_time_ms": 0.014, "training_step_time_ms": 10233.908, "sample_time_ms": 3939.048, "load_time_ms": 0.461, "load_throughput": 8672188.566, "learn_time_ms": 6285.559, "learn_throughput": 636.379, "synch_weights_time_ms": 8.276}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "done": false, "episodes_total": 322, "training_iteration": 55, "trial_id": "3adab_00000", "date": "2024-04-27_21-05-44", "timestamp": 1714277144, "time_this_iter_s": 9.650745153427124, "time_total_s": 550.7391138076782, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 550.7391138076782, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 24.52142857142857, "ram_util_percent": 62.35714285714284}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.152758161098726, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6890824773877118, "policy_loss": -0.02579348300413419, "vf_loss": 0.7119899614363588, "vf_explained_var": 0.29837953871296297, "kl": 0.004275555894300286, "entropy": 5.356931024469355, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 51615.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "sampler_results": {"episode_reward_max": -31.232718334318484, "episode_reward_min": -226.27534340332718, "episode_reward_mean": -94.85283884138018, "episode_len_mean": 586.59, "episode_media": {}, "episodes_this_iter": 3, "episodes_timesteps_total": 58659, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-121.33477026235747, -115.26672389787375, -119.10003350916195, -37.6444486595249, -110.39974471087443, -107.51318571950185, -119.72202636824487, -37.44913765496755, -110.27272578047216, -31.232718334318484, -105.76328540924005, -52.119061673338834, -106.26015346548893, -132.96352189190813, -50.76540416267518, -157.449891636911, -105.46398930313624, -54.38516247596705, -42.27966167254495, -104.5895469317014, -109.85384242724318, -107.73828605723754, -110.13326585740845, -110.6554148913448, -113.3701160882463, -114.81866837032015, -109.33972107810527, -42.52626484415454, -112.79019385548557, -109.81333471944866, -118.47274951819269, -114.89993498931267, -167.48863911369872, -110.19801508765482, -104.9151365764942, -51.75086707815223, -41.1586841902304, -49.34461472789012, -48.68372135606529, -40.888214477828406, -111.1725548055352, -44.78405137420019, -109.55734942572502, -129.83228251712399, -106.84283522121919, -109.37463094562665, -110.6659164208801, -38.202839458334495, -107.55230839786057, -132.1100932731274, -121.01934004531863, -121.65136217843929, -106.66544314674475, -106.48982656791124, -110.53737394000466, -133.3622463918794, -128.48691687297386, -103.14561739230591, -109.79722223208037, -126.2489125257147, -110.56739755802975, -45.5108935200336, -45.16360647359183, -51.709247200138286, -108.14889314686818, -41.931938188068486, -112.50698269766445, -107.13883769350127, -103.87035525517601, -115.77835467432627, -117.61576298354815, -109.55061502788402, -39.4566132901069, -110.47364988147841, -132.6863165245192, -46.865318447202306, -105.46540259215733, -136.6536987534576, -45.23290894703313, -48.65583342564916, -59.0216904875929, -44.31085595682138, -43.74589045116623, -118.11041362082648, -114.33997741754787, -129.76464484349015, -45.621720003678185, -43.11279635486127, -226.27534340332718, -110.51492038701724, -104.26563396884936, -131.8870327002269, -47.7832500013213, -106.90834782281021, -109.9734789232798, -116.44278589757593, -114.21522308595542, -42.62320690124544, -50.25534256394082, -112.81470110831845], "episode_lengths": [74, 169, 60, 1600, 77, 64, 63, 1600, 62, 1600, 53, 1600, 71, 118, 1600, 338, 80, 1600, 1600, 67, 87, 80, 57, 48, 44, 68, 43, 1600, 60, 42, 61, 52, 556, 44, 51, 1600, 1600, 1600, 1600, 1600, 41, 1600, 78, 127, 97, 38, 50, 1600, 47, 183, 81, 61, 68, 77, 51, 117, 82, 100, 60, 160, 107, 1600, 1600, 1600, 42, 1600, 91, 43, 62, 73, 64, 299, 1600, 72, 216, 1600, 81, 1234, 1600, 1600, 1600, 1600, 1600, 75, 50, 114, 1600, 1600, 988, 51, 48, 874, 1600, 65, 52, 118, 54, 1600, 1600, 79]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29566871227074853, "mean_inference_ms": 0.99621796204166, "mean_action_processing_ms": 0.1948603126397342, "mean_env_wait_ms": 0.3937615065347517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0059642791748046875, "StateBufferConnector_ms": 0.004468679428100586, "ViewRequirementAgentConnector_ms": 0.12043499946594238}}, "episode_reward_max": -31.232718334318484, "episode_reward_min": -226.27534340332718, "episode_reward_mean": -94.85283884138018, "episode_len_mean": 586.59, "episodes_this_iter": 3, "episodes_timesteps_total": 58659, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-121.33477026235747, -115.26672389787375, -119.10003350916195, -37.6444486595249, -110.39974471087443, -107.51318571950185, -119.72202636824487, -37.44913765496755, -110.27272578047216, -31.232718334318484, -105.76328540924005, -52.119061673338834, -106.26015346548893, -132.96352189190813, -50.76540416267518, -157.449891636911, -105.46398930313624, -54.38516247596705, -42.27966167254495, -104.5895469317014, -109.85384242724318, -107.73828605723754, -110.13326585740845, -110.6554148913448, -113.3701160882463, -114.81866837032015, -109.33972107810527, -42.52626484415454, -112.79019385548557, -109.81333471944866, -118.47274951819269, -114.89993498931267, -167.48863911369872, -110.19801508765482, -104.9151365764942, -51.75086707815223, -41.1586841902304, -49.34461472789012, -48.68372135606529, -40.888214477828406, -111.1725548055352, -44.78405137420019, -109.55734942572502, -129.83228251712399, -106.84283522121919, -109.37463094562665, -110.6659164208801, -38.202839458334495, -107.55230839786057, -132.1100932731274, -121.01934004531863, -121.65136217843929, -106.66544314674475, -106.48982656791124, -110.53737394000466, -133.3622463918794, -128.48691687297386, -103.14561739230591, -109.79722223208037, -126.2489125257147, -110.56739755802975, -45.5108935200336, -45.16360647359183, -51.709247200138286, -108.14889314686818, -41.931938188068486, -112.50698269766445, -107.13883769350127, -103.87035525517601, -115.77835467432627, -117.61576298354815, -109.55061502788402, -39.4566132901069, -110.47364988147841, -132.6863165245192, -46.865318447202306, -105.46540259215733, -136.6536987534576, -45.23290894703313, -48.65583342564916, -59.0216904875929, -44.31085595682138, -43.74589045116623, -118.11041362082648, -114.33997741754787, -129.76464484349015, -45.621720003678185, -43.11279635486127, -226.27534340332718, -110.51492038701724, -104.26563396884936, -131.8870327002269, -47.7832500013213, -106.90834782281021, -109.9734789232798, -116.44278589757593, -114.21522308595542, -42.62320690124544, -50.25534256394082, -112.81470110831845], "episode_lengths": [74, 169, 60, 1600, 77, 64, 63, 1600, 62, 1600, 53, 1600, 71, 118, 1600, 338, 80, 1600, 1600, 67, 87, 80, 57, 48, 44, 68, 43, 1600, 60, 42, 61, 52, 556, 44, 51, 1600, 1600, 1600, 1600, 1600, 41, 1600, 78, 127, 97, 38, 50, 1600, 47, 183, 81, 61, 68, 77, 51, 117, 82, 100, 60, 160, 107, 1600, 1600, 1600, 42, 1600, 91, 43, 62, 73, 64, 299, 1600, 72, 216, 1600, 81, 1234, 1600, 1600, 1600, 1600, 1600, 75, 50, 114, 1600, 1600, 988, 51, 48, 874, 1600, 65, 52, 118, 54, 1600, 1600, 79]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29566871227074853, "mean_inference_ms": 0.99621796204166, "mean_action_processing_ms": 0.1948603126397342, "mean_env_wait_ms": 0.3937615065347517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0059642791748046875, "StateBufferConnector_ms": 0.004468679428100586, "ViewRequirementAgentConnector_ms": 0.12043499946594238}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 412.4825845933678, "num_env_steps_trained_throughput_per_sec": 412.4825845933678, "timesteps_total": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 10256.057, "restore_workers_time_ms": 0.014, "training_step_time_ms": 10256.016, "sample_time_ms": 3940.636, "load_time_ms": 0.466, "load_throughput": 8575555.101, "learn_time_ms": 6305.928, "learn_throughput": 634.324, "synch_weights_time_ms": 8.418}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "episodes_total": 325, "training_iteration": 56, "trial_id": "3adab_00000", "date": "2024-04-27_21-05-54", "timestamp": 1714277154, "time_this_iter_s": 9.702763080596924, "time_total_s": 560.4418768882751, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 560.4418768882751, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 25.5, "ram_util_percent": 62.34285714285712}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.16655219684365, "cur_kl_coeff": 0.3375000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1855545237940806, "policy_loss": -0.02843396883728283, "vf_loss": 1.2114959416690694, "vf_explained_var": 0.25132639337611457, "kl": 0.007385328477001833, "entropy": 5.406223279173656, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 52545.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "sampler_results": {"episode_reward_max": -31.232718334318484, "episode_reward_min": -226.27534340332718, "episode_reward_mean": -93.35954332074374, "episode_len_mean": 616.34, "episode_media": {}, "episodes_this_iter": 3, "episodes_timesteps_total": 61634, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-37.6444486595249, -110.39974471087443, -107.51318571950185, -119.72202636824487, -37.44913765496755, -110.27272578047216, -31.232718334318484, -105.76328540924005, -52.119061673338834, -106.26015346548893, -132.96352189190813, -50.76540416267518, -157.449891636911, -105.46398930313624, -54.38516247596705, -42.27966167254495, -104.5895469317014, -109.85384242724318, -107.73828605723754, -110.13326585740845, -110.6554148913448, -113.3701160882463, -114.81866837032015, -109.33972107810527, -42.52626484415454, -112.79019385548557, -109.81333471944866, -118.47274951819269, -114.89993498931267, -167.48863911369872, -110.19801508765482, -104.9151365764942, -51.75086707815223, -41.1586841902304, -49.34461472789012, -48.68372135606529, -40.888214477828406, -111.1725548055352, -44.78405137420019, -109.55734942572502, -129.83228251712399, -106.84283522121919, -109.37463094562665, -110.6659164208801, -38.202839458334495, -107.55230839786057, -132.1100932731274, -121.01934004531863, -121.65136217843929, -106.66544314674475, -106.48982656791124, -110.53737394000466, -133.3622463918794, -128.48691687297386, -103.14561739230591, -109.79722223208037, -126.2489125257147, -110.56739755802975, -45.5108935200336, -45.16360647359183, -51.709247200138286, -108.14889314686818, -41.931938188068486, -112.50698269766445, -107.13883769350127, -103.87035525517601, -115.77835467432627, -117.61576298354815, -109.55061502788402, -39.4566132901069, -110.47364988147841, -132.6863165245192, -46.865318447202306, -105.46540259215733, -136.6536987534576, -45.23290894703313, -48.65583342564916, -59.0216904875929, -44.31085595682138, -43.74589045116623, -118.11041362082648, -114.33997741754787, -129.76464484349015, -45.621720003678185, -43.11279635486127, -226.27534340332718, -110.51492038701724, -104.26563396884936, -131.8870327002269, -47.7832500013213, -106.90834782281021, -109.9734789232798, -116.44278589757593, -114.21522308595542, -42.62320690124544, -50.25534256394082, -112.81470110831845, -42.87594693415867, -46.564535504661464, -116.93149316692974], "episode_lengths": [1600, 77, 64, 63, 1600, 62, 1600, 53, 1600, 71, 118, 1600, 338, 80, 1600, 1600, 67, 87, 80, 57, 48, 44, 68, 43, 1600, 60, 42, 61, 52, 556, 44, 51, 1600, 1600, 1600, 1600, 1600, 41, 1600, 78, 127, 97, 38, 50, 1600, 47, 183, 81, 61, 68, 77, 51, 117, 82, 100, 60, 160, 107, 1600, 1600, 1600, 42, 1600, 91, 43, 62, 73, 64, 299, 1600, 72, 216, 1600, 81, 1234, 1600, 1600, 1600, 1600, 1600, 75, 50, 114, 1600, 1600, 988, 51, 48, 874, 1600, 65, 52, 118, 54, 1600, 1600, 79, 1600, 1600, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2957079561537711, "mean_inference_ms": 0.9962604989087985, "mean_action_processing_ms": 0.19488729588494158, "mean_env_wait_ms": 0.3937596271423911, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005960702896118164, "StateBufferConnector_ms": 0.004465818405151367, "ViewRequirementAgentConnector_ms": 0.1205601692199707}}, "episode_reward_max": -31.232718334318484, "episode_reward_min": -226.27534340332718, "episode_reward_mean": -93.35954332074374, "episode_len_mean": 616.34, "episodes_this_iter": 3, "episodes_timesteps_total": 61634, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-37.6444486595249, -110.39974471087443, -107.51318571950185, -119.72202636824487, -37.44913765496755, -110.27272578047216, -31.232718334318484, -105.76328540924005, -52.119061673338834, -106.26015346548893, -132.96352189190813, -50.76540416267518, -157.449891636911, -105.46398930313624, -54.38516247596705, -42.27966167254495, -104.5895469317014, -109.85384242724318, -107.73828605723754, -110.13326585740845, -110.6554148913448, -113.3701160882463, -114.81866837032015, -109.33972107810527, -42.52626484415454, -112.79019385548557, -109.81333471944866, -118.47274951819269, -114.89993498931267, -167.48863911369872, -110.19801508765482, -104.9151365764942, -51.75086707815223, -41.1586841902304, -49.34461472789012, -48.68372135606529, -40.888214477828406, -111.1725548055352, -44.78405137420019, -109.55734942572502, -129.83228251712399, -106.84283522121919, -109.37463094562665, -110.6659164208801, -38.202839458334495, -107.55230839786057, -132.1100932731274, -121.01934004531863, -121.65136217843929, -106.66544314674475, -106.48982656791124, -110.53737394000466, -133.3622463918794, -128.48691687297386, -103.14561739230591, -109.79722223208037, -126.2489125257147, -110.56739755802975, -45.5108935200336, -45.16360647359183, -51.709247200138286, -108.14889314686818, -41.931938188068486, -112.50698269766445, -107.13883769350127, -103.87035525517601, -115.77835467432627, -117.61576298354815, -109.55061502788402, -39.4566132901069, -110.47364988147841, -132.6863165245192, -46.865318447202306, -105.46540259215733, -136.6536987534576, -45.23290894703313, -48.65583342564916, -59.0216904875929, -44.31085595682138, -43.74589045116623, -118.11041362082648, -114.33997741754787, -129.76464484349015, -45.621720003678185, -43.11279635486127, -226.27534340332718, -110.51492038701724, -104.26563396884936, -131.8870327002269, -47.7832500013213, -106.90834782281021, -109.9734789232798, -116.44278589757593, -114.21522308595542, -42.62320690124544, -50.25534256394082, -112.81470110831845, -42.87594693415867, -46.564535504661464, -116.93149316692974], "episode_lengths": [1600, 77, 64, 63, 1600, 62, 1600, 53, 1600, 71, 118, 1600, 338, 80, 1600, 1600, 67, 87, 80, 57, 48, 44, 68, 43, 1600, 60, 42, 61, 52, 556, 44, 51, 1600, 1600, 1600, 1600, 1600, 41, 1600, 78, 127, 97, 38, 50, 1600, 47, 183, 81, 61, 68, 77, 51, 117, 82, 100, 60, 160, 107, 1600, 1600, 1600, 42, 1600, 91, 43, 62, 73, 64, 299, 1600, 72, 216, 1600, 81, 1234, 1600, 1600, 1600, 1600, 1600, 75, 50, 114, 1600, 1600, 988, 51, 48, 874, 1600, 65, 52, 118, 54, 1600, 1600, 79, 1600, 1600, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2957079561537711, "mean_inference_ms": 0.9962604989087985, "mean_action_processing_ms": 0.19488729588494158, "mean_env_wait_ms": 0.3937596271423911, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005960702896118164, "StateBufferConnector_ms": 0.004465818405151367, "ViewRequirementAgentConnector_ms": 0.1205601692199707}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 404.2425622687448, "num_env_steps_trained_throughput_per_sec": 404.2425622687448, "timesteps_total": 228000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 228000, "timers": {"training_iteration_time_ms": 10085.571, "restore_workers_time_ms": 0.014, "training_step_time_ms": 10085.531, "sample_time_ms": 3854.866, "load_time_ms": 0.469, "load_throughput": 8527608.011, "learn_time_ms": 6221.318, "learn_throughput": 642.951, "synch_weights_time_ms": 8.335}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "done": false, "episodes_total": 328, "training_iteration": 57, "trial_id": "3adab_00000", "date": "2024-04-27_21-06-04", "timestamp": 1714277164, "time_this_iter_s": 9.89953088760376, "time_total_s": 570.3414077758789, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 570.3414077758789, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 26.235714285714288, "ram_util_percent": 62.449999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.841669727397221, "cur_kl_coeff": 0.3375000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4123417824997457, "policy_loss": -0.03516165222371778, "vf_loss": 1.442398727621122, "vf_explained_var": 0.250533030815022, "kl": 0.015125076446018793, "entropy": 6.83069479491121, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 53475.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "sampler_results": {"episode_reward_max": -31.232718334318484, "episode_reward_min": -226.27534340332718, "episode_reward_mean": -92.73937885620848, "episode_len_mean": 632.04, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 63204, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-31.232718334318484, -105.76328540924005, -52.119061673338834, -106.26015346548893, -132.96352189190813, -50.76540416267518, -157.449891636911, -105.46398930313624, -54.38516247596705, -42.27966167254495, -104.5895469317014, -109.85384242724318, -107.73828605723754, -110.13326585740845, -110.6554148913448, -113.3701160882463, -114.81866837032015, -109.33972107810527, -42.52626484415454, -112.79019385548557, -109.81333471944866, -118.47274951819269, -114.89993498931267, -167.48863911369872, -110.19801508765482, -104.9151365764942, -51.75086707815223, -41.1586841902304, -49.34461472789012, -48.68372135606529, -40.888214477828406, -111.1725548055352, -44.78405137420019, -109.55734942572502, -129.83228251712399, -106.84283522121919, -109.37463094562665, -110.6659164208801, -38.202839458334495, -107.55230839786057, -132.1100932731274, -121.01934004531863, -121.65136217843929, -106.66544314674475, -106.48982656791124, -110.53737394000466, -133.3622463918794, -128.48691687297386, -103.14561739230591, -109.79722223208037, -126.2489125257147, -110.56739755802975, -45.5108935200336, -45.16360647359183, -51.709247200138286, -108.14889314686818, -41.931938188068486, -112.50698269766445, -107.13883769350127, -103.87035525517601, -115.77835467432627, -117.61576298354815, -109.55061502788402, -39.4566132901069, -110.47364988147841, -132.6863165245192, -46.865318447202306, -105.46540259215733, -136.6536987534576, -45.23290894703313, -48.65583342564916, -59.0216904875929, -44.31085595682138, -43.74589045116623, -118.11041362082648, -114.33997741754787, -129.76464484349015, -45.621720003678185, -43.11279635486127, -226.27534340332718, -110.51492038701724, -104.26563396884936, -131.8870327002269, -47.7832500013213, -106.90834782281021, -109.9734789232798, -116.44278589757593, -114.21522308595542, -42.62320690124544, -50.25534256394082, -112.81470110831845, -42.87594693415867, -46.564535504661464, -116.93149316692974, -49.691149577184824, -38.450620935976545, -107.34578243715565, -37.80543074111144, -108.2977852633577, -119.39405348527305], "episode_lengths": [1600, 53, 1600, 71, 118, 1600, 338, 80, 1600, 1600, 67, 87, 80, 57, 48, 44, 68, 43, 1600, 60, 42, 61, 52, 556, 44, 51, 1600, 1600, 1600, 1600, 1600, 41, 1600, 78, 127, 97, 38, 50, 1600, 47, 183, 81, 61, 68, 77, 51, 117, 82, 100, 60, 160, 107, 1600, 1600, 1600, 42, 1600, 91, 43, 62, 73, 64, 299, 1600, 72, 216, 1600, 81, 1234, 1600, 1600, 1600, 1600, 1600, 75, 50, 114, 1600, 1600, 988, 51, 48, 874, 1600, 65, 52, 118, 54, 1600, 1600, 79, 1600, 1600, 78, 1600, 1600, 38, 1600, 62, 136]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2957477686038166, "mean_inference_ms": 0.996453257532799, "mean_action_processing_ms": 0.1949066795063319, "mean_env_wait_ms": 0.39362359727993074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006028413772583008, "StateBufferConnector_ms": 0.0044286251068115234, "ViewRequirementAgentConnector_ms": 0.12022852897644043}}, "episode_reward_max": -31.232718334318484, "episode_reward_min": -226.27534340332718, "episode_reward_mean": -92.73937885620848, "episode_len_mean": 632.04, "episodes_this_iter": 6, "episodes_timesteps_total": 63204, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-31.232718334318484, -105.76328540924005, -52.119061673338834, -106.26015346548893, -132.96352189190813, -50.76540416267518, -157.449891636911, -105.46398930313624, -54.38516247596705, -42.27966167254495, -104.5895469317014, -109.85384242724318, -107.73828605723754, -110.13326585740845, -110.6554148913448, -113.3701160882463, -114.81866837032015, -109.33972107810527, -42.52626484415454, -112.79019385548557, -109.81333471944866, -118.47274951819269, -114.89993498931267, -167.48863911369872, -110.19801508765482, -104.9151365764942, -51.75086707815223, -41.1586841902304, -49.34461472789012, -48.68372135606529, -40.888214477828406, -111.1725548055352, -44.78405137420019, -109.55734942572502, -129.83228251712399, -106.84283522121919, -109.37463094562665, -110.6659164208801, -38.202839458334495, -107.55230839786057, -132.1100932731274, -121.01934004531863, -121.65136217843929, -106.66544314674475, -106.48982656791124, -110.53737394000466, -133.3622463918794, -128.48691687297386, -103.14561739230591, -109.79722223208037, -126.2489125257147, -110.56739755802975, -45.5108935200336, -45.16360647359183, -51.709247200138286, -108.14889314686818, -41.931938188068486, -112.50698269766445, -107.13883769350127, -103.87035525517601, -115.77835467432627, -117.61576298354815, -109.55061502788402, -39.4566132901069, -110.47364988147841, -132.6863165245192, -46.865318447202306, -105.46540259215733, -136.6536987534576, -45.23290894703313, -48.65583342564916, -59.0216904875929, -44.31085595682138, -43.74589045116623, -118.11041362082648, -114.33997741754787, -129.76464484349015, -45.621720003678185, -43.11279635486127, -226.27534340332718, -110.51492038701724, -104.26563396884936, -131.8870327002269, -47.7832500013213, -106.90834782281021, -109.9734789232798, -116.44278589757593, -114.21522308595542, -42.62320690124544, -50.25534256394082, -112.81470110831845, -42.87594693415867, -46.564535504661464, -116.93149316692974, -49.691149577184824, -38.450620935976545, -107.34578243715565, -37.80543074111144, -108.2977852633577, -119.39405348527305], "episode_lengths": [1600, 53, 1600, 71, 118, 1600, 338, 80, 1600, 1600, 67, 87, 80, 57, 48, 44, 68, 43, 1600, 60, 42, 61, 52, 556, 44, 51, 1600, 1600, 1600, 1600, 1600, 41, 1600, 78, 127, 97, 38, 50, 1600, 47, 183, 81, 61, 68, 77, 51, 117, 82, 100, 60, 160, 107, 1600, 1600, 1600, 42, 1600, 91, 43, 62, 73, 64, 299, 1600, 72, 216, 1600, 81, 1234, 1600, 1600, 1600, 1600, 1600, 75, 50, 114, 1600, 1600, 988, 51, 48, 874, 1600, 65, 52, 118, 54, 1600, 1600, 79, 1600, 1600, 78, 1600, 1600, 38, 1600, 62, 136]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2957477686038166, "mean_inference_ms": 0.996453257532799, "mean_action_processing_ms": 0.1949066795063319, "mean_env_wait_ms": 0.39362359727993074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006028413772583008, "StateBufferConnector_ms": 0.0044286251068115234, "ViewRequirementAgentConnector_ms": 0.12022852897644043}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 413.9785713020237, "num_env_steps_trained_throughput_per_sec": 413.9785713020237, "timesteps_total": 232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 232000, "timers": {"training_iteration_time_ms": 10050.738, "restore_workers_time_ms": 0.014, "training_step_time_ms": 10050.697, "sample_time_ms": 3834.338, "load_time_ms": 0.462, "load_throughput": 8652955.8, "learn_time_ms": 6207.159, "learn_throughput": 644.417, "synch_weights_time_ms": 8.191}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "done": false, "episodes_total": 334, "training_iteration": 58, "trial_id": "3adab_00000", "date": "2024-04-27_21-06-13", "timestamp": 1714277173, "time_this_iter_s": 9.666126728057861, "time_total_s": 580.0075345039368, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 580.0075345039368, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 24.592857142857145, "ram_util_percent": 62.535714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.245642528899255, "cur_kl_coeff": 0.3375000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.835693337302655, "policy_loss": -0.04255304436940419, "vf_loss": 2.8702171506820826, "vf_explained_var": 0.10480696712770769, "kl": 0.02379032726588347, "entropy": 8.345697998744185, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 54405.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000}, "sampler_results": {"episode_reward_max": -37.80543074111144, "episode_reward_min": -226.27534340332718, "episode_reward_mean": -94.73751308587876, "episode_len_mean": 607.48, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 60748, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157.449891636911, -105.46398930313624, -54.38516247596705, -42.27966167254495, -104.5895469317014, -109.85384242724318, -107.73828605723754, -110.13326585740845, -110.6554148913448, -113.3701160882463, -114.81866837032015, -109.33972107810527, -42.52626484415454, -112.79019385548557, -109.81333471944866, -118.47274951819269, -114.89993498931267, -167.48863911369872, -110.19801508765482, -104.9151365764942, -51.75086707815223, -41.1586841902304, -49.34461472789012, -48.68372135606529, -40.888214477828406, -111.1725548055352, -44.78405137420019, -109.55734942572502, -129.83228251712399, -106.84283522121919, -109.37463094562665, -110.6659164208801, -38.202839458334495, -107.55230839786057, -132.1100932731274, -121.01934004531863, -121.65136217843929, -106.66544314674475, -106.48982656791124, -110.53737394000466, -133.3622463918794, -128.48691687297386, -103.14561739230591, -109.79722223208037, -126.2489125257147, -110.56739755802975, -45.5108935200336, -45.16360647359183, -51.709247200138286, -108.14889314686818, -41.931938188068486, -112.50698269766445, -107.13883769350127, -103.87035525517601, -115.77835467432627, -117.61576298354815, -109.55061502788402, -39.4566132901069, -110.47364988147841, -132.6863165245192, -46.865318447202306, -105.46540259215733, -136.6536987534576, -45.23290894703313, -48.65583342564916, -59.0216904875929, -44.31085595682138, -43.74589045116623, -118.11041362082648, -114.33997741754787, -129.76464484349015, -45.621720003678185, -43.11279635486127, -226.27534340332718, -110.51492038701724, -104.26563396884936, -131.8870327002269, -47.7832500013213, -106.90834782281021, -109.9734789232798, -116.44278589757593, -114.21522308595542, -42.62320690124544, -50.25534256394082, -112.81470110831845, -42.87594693415867, -46.564535504661464, -116.93149316692974, -49.691149577184824, -38.450620935976545, -107.34578243715565, -37.80543074111144, -108.2977852633577, -119.39405348527305, -170.5108973302504, -115.86091524636994, -107.2147554962126, -116.8684270284983, -122.95839870536886, -45.50417409730018], "episode_lengths": [338, 80, 1600, 1600, 67, 87, 80, 57, 48, 44, 68, 43, 1600, 60, 42, 61, 52, 556, 44, 51, 1600, 1600, 1600, 1600, 1600, 41, 1600, 78, 127, 97, 38, 50, 1600, 47, 183, 81, 61, 68, 77, 51, 117, 82, 100, 60, 160, 107, 1600, 1600, 1600, 42, 1600, 91, 43, 62, 73, 64, 299, 1600, 72, 216, 1600, 81, 1234, 1600, 1600, 1600, 1600, 1600, 75, 50, 114, 1600, 1600, 988, 51, 48, 874, 1600, 65, 52, 118, 54, 1600, 1600, 79, 1600, 1600, 78, 1600, 1600, 38, 1600, 62, 136, 754, 46, 44, 51, 91, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29579749994148075, "mean_inference_ms": 0.9967164717410324, "mean_action_processing_ms": 0.19493333558365739, "mean_env_wait_ms": 0.39347134226814867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006206512451171875, "StateBufferConnector_ms": 0.004446506500244141, "ViewRequirementAgentConnector_ms": 0.12007427215576172}}, "episode_reward_max": -37.80543074111144, "episode_reward_min": -226.27534340332718, "episode_reward_mean": -94.73751308587876, "episode_len_mean": 607.48, "episodes_this_iter": 6, "episodes_timesteps_total": 60748, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157.449891636911, -105.46398930313624, -54.38516247596705, -42.27966167254495, -104.5895469317014, -109.85384242724318, -107.73828605723754, -110.13326585740845, -110.6554148913448, -113.3701160882463, -114.81866837032015, -109.33972107810527, -42.52626484415454, -112.79019385548557, -109.81333471944866, -118.47274951819269, -114.89993498931267, -167.48863911369872, -110.19801508765482, -104.9151365764942, -51.75086707815223, -41.1586841902304, -49.34461472789012, -48.68372135606529, -40.888214477828406, -111.1725548055352, -44.78405137420019, -109.55734942572502, -129.83228251712399, -106.84283522121919, -109.37463094562665, -110.6659164208801, -38.202839458334495, -107.55230839786057, -132.1100932731274, -121.01934004531863, -121.65136217843929, -106.66544314674475, -106.48982656791124, -110.53737394000466, -133.3622463918794, -128.48691687297386, -103.14561739230591, -109.79722223208037, -126.2489125257147, -110.56739755802975, -45.5108935200336, -45.16360647359183, -51.709247200138286, -108.14889314686818, -41.931938188068486, -112.50698269766445, -107.13883769350127, -103.87035525517601, -115.77835467432627, -117.61576298354815, -109.55061502788402, -39.4566132901069, -110.47364988147841, -132.6863165245192, -46.865318447202306, -105.46540259215733, -136.6536987534576, -45.23290894703313, -48.65583342564916, -59.0216904875929, -44.31085595682138, -43.74589045116623, -118.11041362082648, -114.33997741754787, -129.76464484349015, -45.621720003678185, -43.11279635486127, -226.27534340332718, -110.51492038701724, -104.26563396884936, -131.8870327002269, -47.7832500013213, -106.90834782281021, -109.9734789232798, -116.44278589757593, -114.21522308595542, -42.62320690124544, -50.25534256394082, -112.81470110831845, -42.87594693415867, -46.564535504661464, -116.93149316692974, -49.691149577184824, -38.450620935976545, -107.34578243715565, -37.80543074111144, -108.2977852633577, -119.39405348527305, -170.5108973302504, -115.86091524636994, -107.2147554962126, -116.8684270284983, -122.95839870536886, -45.50417409730018], "episode_lengths": [338, 80, 1600, 1600, 67, 87, 80, 57, 48, 44, 68, 43, 1600, 60, 42, 61, 52, 556, 44, 51, 1600, 1600, 1600, 1600, 1600, 41, 1600, 78, 127, 97, 38, 50, 1600, 47, 183, 81, 61, 68, 77, 51, 117, 82, 100, 60, 160, 107, 1600, 1600, 1600, 42, 1600, 91, 43, 62, 73, 64, 299, 1600, 72, 216, 1600, 81, 1234, 1600, 1600, 1600, 1600, 1600, 75, 50, 114, 1600, 1600, 988, 51, 48, 874, 1600, 65, 52, 118, 54, 1600, 1600, 79, 1600, 1600, 78, 1600, 1600, 38, 1600, 62, 136, 754, 46, 44, 51, 91, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29579749994148075, "mean_inference_ms": 0.9967164717410324, "mean_action_processing_ms": 0.19493333558365739, "mean_env_wait_ms": 0.39347134226814867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006206512451171875, "StateBufferConnector_ms": 0.004446506500244141, "ViewRequirementAgentConnector_ms": 0.12007427215576172}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 399.7706108262359, "num_env_steps_trained_throughput_per_sec": 399.7706108262359, "timesteps_total": 236000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 236000, "timers": {"training_iteration_time_ms": 10081.115, "restore_workers_time_ms": 0.014, "training_step_time_ms": 10081.075, "sample_time_ms": 3833.502, "load_time_ms": 0.448, "load_throughput": 8925000.532, "learn_time_ms": 6238.365, "learn_throughput": 641.194, "synch_weights_time_ms": 8.202}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000}, "done": false, "episodes_total": 340, "training_iteration": 59, "trial_id": "3adab_00000", "date": "2024-04-27_21-06-23", "timestamp": 1714277183, "time_this_iter_s": 10.010243892669678, "time_total_s": 590.0177783966064, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 590.0177783966064, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 26.657142857142855, "ram_util_percent": 62.85714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.069372175201293, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.211026321901434, "policy_loss": -0.030449144750513055, "vf_loss": 1.2374266727236651, "vf_explained_var": 0.31522767870656904, "kl": 0.007997593627503543, "entropy": 5.954846855645538, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 55335.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "sampler_results": {"episode_reward_max": -37.80543074111144, "episode_reward_min": -226.27534340332718, "episode_reward_mean": -93.8202941613804, "episode_len_mean": 619.67, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 61967, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-107.73828605723754, -110.13326585740845, -110.6554148913448, -113.3701160882463, -114.81866837032015, -109.33972107810527, -42.52626484415454, -112.79019385548557, -109.81333471944866, -118.47274951819269, -114.89993498931267, -167.48863911369872, -110.19801508765482, -104.9151365764942, -51.75086707815223, -41.1586841902304, -49.34461472789012, -48.68372135606529, -40.888214477828406, -111.1725548055352, -44.78405137420019, -109.55734942572502, -129.83228251712399, -106.84283522121919, -109.37463094562665, -110.6659164208801, -38.202839458334495, -107.55230839786057, -132.1100932731274, -121.01934004531863, -121.65136217843929, -106.66544314674475, -106.48982656791124, -110.53737394000466, -133.3622463918794, -128.48691687297386, -103.14561739230591, -109.79722223208037, -126.2489125257147, -110.56739755802975, -45.5108935200336, -45.16360647359183, -51.709247200138286, -108.14889314686818, -41.931938188068486, -112.50698269766445, -107.13883769350127, -103.87035525517601, -115.77835467432627, -117.61576298354815, -109.55061502788402, -39.4566132901069, -110.47364988147841, -132.6863165245192, -46.865318447202306, -105.46540259215733, -136.6536987534576, -45.23290894703313, -48.65583342564916, -59.0216904875929, -44.31085595682138, -43.74589045116623, -118.11041362082648, -114.33997741754787, -129.76464484349015, -45.621720003678185, -43.11279635486127, -226.27534340332718, -110.51492038701724, -104.26563396884936, -131.8870327002269, -47.7832500013213, -106.90834782281021, -109.9734789232798, -116.44278589757593, -114.21522308595542, -42.62320690124544, -50.25534256394082, -112.81470110831845, -42.87594693415867, -46.564535504661464, -116.93149316692974, -49.691149577184824, -38.450620935976545, -107.34578243715565, -37.80543074111144, -108.2977852633577, -119.39405348527305, -170.5108973302504, -115.86091524636994, -107.2147554962126, -116.8684270284983, -122.95839870536886, -45.50417409730018, -55.22738663798694, -114.17630567635224, -114.9250432772264, -107.28855771225815, -45.35923587964283, -45.32367281420102], "episode_lengths": [80, 57, 48, 44, 68, 43, 1600, 60, 42, 61, 52, 556, 44, 51, 1600, 1600, 1600, 1600, 1600, 41, 1600, 78, 127, 97, 38, 50, 1600, 47, 183, 81, 61, 68, 77, 51, 117, 82, 100, 60, 160, 107, 1600, 1600, 1600, 42, 1600, 91, 43, 62, 73, 64, 299, 1600, 72, 216, 1600, 81, 1234, 1600, 1600, 1600, 1600, 1600, 75, 50, 114, 1600, 1600, 988, 51, 48, 874, 1600, 65, 52, 118, 54, 1600, 1600, 79, 1600, 1600, 78, 1600, 1600, 38, 1600, 62, 136, 754, 46, 44, 51, 91, 1600, 1600, 66, 53, 72, 1600, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29590254782431885, "mean_inference_ms": 0.9970725732964141, "mean_action_processing_ms": 0.19500976399325062, "mean_env_wait_ms": 0.3934582899570778, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006190776824951172, "StateBufferConnector_ms": 0.004431009292602539, "ViewRequirementAgentConnector_ms": 0.11999177932739258}}, "episode_reward_max": -37.80543074111144, "episode_reward_min": -226.27534340332718, "episode_reward_mean": -93.8202941613804, "episode_len_mean": 619.67, "episodes_this_iter": 6, "episodes_timesteps_total": 61967, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-107.73828605723754, -110.13326585740845, -110.6554148913448, -113.3701160882463, -114.81866837032015, -109.33972107810527, -42.52626484415454, -112.79019385548557, -109.81333471944866, -118.47274951819269, -114.89993498931267, -167.48863911369872, -110.19801508765482, -104.9151365764942, -51.75086707815223, -41.1586841902304, -49.34461472789012, -48.68372135606529, -40.888214477828406, -111.1725548055352, -44.78405137420019, -109.55734942572502, -129.83228251712399, -106.84283522121919, -109.37463094562665, -110.6659164208801, -38.202839458334495, -107.55230839786057, -132.1100932731274, -121.01934004531863, -121.65136217843929, -106.66544314674475, -106.48982656791124, -110.53737394000466, -133.3622463918794, -128.48691687297386, -103.14561739230591, -109.79722223208037, -126.2489125257147, -110.56739755802975, -45.5108935200336, -45.16360647359183, -51.709247200138286, -108.14889314686818, -41.931938188068486, -112.50698269766445, -107.13883769350127, -103.87035525517601, -115.77835467432627, -117.61576298354815, -109.55061502788402, -39.4566132901069, -110.47364988147841, -132.6863165245192, -46.865318447202306, -105.46540259215733, -136.6536987534576, -45.23290894703313, -48.65583342564916, -59.0216904875929, -44.31085595682138, -43.74589045116623, -118.11041362082648, -114.33997741754787, -129.76464484349015, -45.621720003678185, -43.11279635486127, -226.27534340332718, -110.51492038701724, -104.26563396884936, -131.8870327002269, -47.7832500013213, -106.90834782281021, -109.9734789232798, -116.44278589757593, -114.21522308595542, -42.62320690124544, -50.25534256394082, -112.81470110831845, -42.87594693415867, -46.564535504661464, -116.93149316692974, -49.691149577184824, -38.450620935976545, -107.34578243715565, -37.80543074111144, -108.2977852633577, -119.39405348527305, -170.5108973302504, -115.86091524636994, -107.2147554962126, -116.8684270284983, -122.95839870536886, -45.50417409730018, -55.22738663798694, -114.17630567635224, -114.9250432772264, -107.28855771225815, -45.35923587964283, -45.32367281420102], "episode_lengths": [80, 57, 48, 44, 68, 43, 1600, 60, 42, 61, 52, 556, 44, 51, 1600, 1600, 1600, 1600, 1600, 41, 1600, 78, 127, 97, 38, 50, 1600, 47, 183, 81, 61, 68, 77, 51, 117, 82, 100, 60, 160, 107, 1600, 1600, 1600, 42, 1600, 91, 43, 62, 73, 64, 299, 1600, 72, 216, 1600, 81, 1234, 1600, 1600, 1600, 1600, 1600, 75, 50, 114, 1600, 1600, 988, 51, 48, 874, 1600, 65, 52, 118, 54, 1600, 1600, 79, 1600, 1600, 78, 1600, 1600, 38, 1600, 62, 136, 754, 46, 44, 51, 91, 1600, 1600, 66, 53, 72, 1600, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29590254782431885, "mean_inference_ms": 0.9970725732964141, "mean_action_processing_ms": 0.19500976399325062, "mean_env_wait_ms": 0.3934582899570778, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006190776824951172, "StateBufferConnector_ms": 0.004431009292602539, "ViewRequirementAgentConnector_ms": 0.11999177932739258}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 388.6645228500731, "num_env_steps_trained_throughput_per_sec": 388.6645228500731, "timesteps_total": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 10151.488, "restore_workers_time_ms": 0.014, "training_step_time_ms": 10151.448, "sample_time_ms": 3876.598, "load_time_ms": 0.444, "load_throughput": 9002584.246, "learn_time_ms": 6265.559, "learn_throughput": 638.411, "synch_weights_time_ms": 8.271}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "episodes_total": 346, "training_iteration": 60, "trial_id": "3adab_00000", "date": "2024-04-27_21-06-34", "timestamp": 1714277194, "time_this_iter_s": 10.296876907348633, "time_total_s": 600.3146553039551, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 600.3146553039551, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 28.500000000000004, "ram_util_percent": 62.97333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.646544335862641, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3960899290340822, "policy_loss": -0.04232721623554025, "vf_loss": 1.4312145491120636, "vf_explained_var": 0.21851272679144337, "kl": 0.014227365069163472, "entropy": 6.570853304350248, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 56265.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000}, "sampler_results": {"episode_reward_max": -37.80543074111144, "episode_reward_min": -226.27534340332718, "episode_reward_mean": -92.79866444745265, "episode_len_mean": 652.68, "episode_media": {}, "episodes_this_iter": 8, "episodes_timesteps_total": 65268, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-109.81333471944866, -118.47274951819269, -114.89993498931267, -167.48863911369872, -110.19801508765482, -104.9151365764942, -51.75086707815223, -41.1586841902304, -49.34461472789012, -48.68372135606529, -40.888214477828406, -111.1725548055352, -44.78405137420019, -109.55734942572502, -129.83228251712399, -106.84283522121919, -109.37463094562665, -110.6659164208801, -38.202839458334495, -107.55230839786057, -132.1100932731274, -121.01934004531863, -121.65136217843929, -106.66544314674475, -106.48982656791124, -110.53737394000466, -133.3622463918794, -128.48691687297386, -103.14561739230591, -109.79722223208037, -126.2489125257147, -110.56739755802975, -45.5108935200336, -45.16360647359183, -51.709247200138286, -108.14889314686818, -41.931938188068486, -112.50698269766445, -107.13883769350127, -103.87035525517601, -115.77835467432627, -117.61576298354815, -109.55061502788402, -39.4566132901069, -110.47364988147841, -132.6863165245192, -46.865318447202306, -105.46540259215733, -136.6536987534576, -45.23290894703313, -48.65583342564916, -59.0216904875929, -44.31085595682138, -43.74589045116623, -118.11041362082648, -114.33997741754787, -129.76464484349015, -45.621720003678185, -43.11279635486127, -226.27534340332718, -110.51492038701724, -104.26563396884936, -131.8870327002269, -47.7832500013213, -106.90834782281021, -109.9734789232798, -116.44278589757593, -114.21522308595542, -42.62320690124544, -50.25534256394082, -112.81470110831845, -42.87594693415867, -46.564535504661464, -116.93149316692974, -49.691149577184824, -38.450620935976545, -107.34578243715565, -37.80543074111144, -108.2977852633577, -119.39405348527305, -170.5108973302504, -115.86091524636994, -107.2147554962126, -116.8684270284983, -122.95839870536886, -45.50417409730018, -55.22738663798694, -114.17630567635224, -114.9250432772264, -107.28855771225815, -45.35923587964283, -45.32367281420102, -51.678164660633776, -46.73691846846173, -129.31263490978313, -105.34884912771359, -107.4006865157659, -112.32702260404888, -119.25023556967639, -47.154447793442735], "episode_lengths": [42, 61, 52, 556, 44, 51, 1600, 1600, 1600, 1600, 1600, 41, 1600, 78, 127, 97, 38, 50, 1600, 47, 183, 81, 61, 68, 77, 51, 117, 82, 100, 60, 160, 107, 1600, 1600, 1600, 42, 1600, 91, 43, 62, 73, 64, 299, 1600, 72, 216, 1600, 81, 1234, 1600, 1600, 1600, 1600, 1600, 75, 50, 114, 1600, 1600, 988, 51, 48, 874, 1600, 65, 52, 118, 54, 1600, 1600, 79, 1600, 1600, 78, 1600, 1600, 38, 1600, 62, 136, 754, 46, 44, 51, 91, 1600, 1600, 66, 53, 72, 1600, 1600, 1600, 1600, 240, 74, 62, 42, 83, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2960605705530399, "mean_inference_ms": 0.9974913172891782, "mean_action_processing_ms": 0.19512643626070436, "mean_env_wait_ms": 0.3935138484409459, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006147623062133789, "StateBufferConnector_ms": 0.004465818405151367, "ViewRequirementAgentConnector_ms": 0.12044715881347656}}, "episode_reward_max": -37.80543074111144, "episode_reward_min": -226.27534340332718, "episode_reward_mean": -92.79866444745265, "episode_len_mean": 652.68, "episodes_this_iter": 8, "episodes_timesteps_total": 65268, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-109.81333471944866, -118.47274951819269, -114.89993498931267, -167.48863911369872, -110.19801508765482, -104.9151365764942, -51.75086707815223, -41.1586841902304, -49.34461472789012, -48.68372135606529, -40.888214477828406, -111.1725548055352, -44.78405137420019, -109.55734942572502, -129.83228251712399, -106.84283522121919, -109.37463094562665, -110.6659164208801, -38.202839458334495, -107.55230839786057, -132.1100932731274, -121.01934004531863, -121.65136217843929, -106.66544314674475, -106.48982656791124, -110.53737394000466, -133.3622463918794, -128.48691687297386, -103.14561739230591, -109.79722223208037, -126.2489125257147, -110.56739755802975, -45.5108935200336, -45.16360647359183, -51.709247200138286, -108.14889314686818, -41.931938188068486, -112.50698269766445, -107.13883769350127, -103.87035525517601, -115.77835467432627, -117.61576298354815, -109.55061502788402, -39.4566132901069, -110.47364988147841, -132.6863165245192, -46.865318447202306, -105.46540259215733, -136.6536987534576, -45.23290894703313, -48.65583342564916, -59.0216904875929, -44.31085595682138, -43.74589045116623, -118.11041362082648, -114.33997741754787, -129.76464484349015, -45.621720003678185, -43.11279635486127, -226.27534340332718, -110.51492038701724, -104.26563396884936, -131.8870327002269, -47.7832500013213, -106.90834782281021, -109.9734789232798, -116.44278589757593, -114.21522308595542, -42.62320690124544, -50.25534256394082, -112.81470110831845, -42.87594693415867, -46.564535504661464, -116.93149316692974, -49.691149577184824, -38.450620935976545, -107.34578243715565, -37.80543074111144, -108.2977852633577, -119.39405348527305, -170.5108973302504, -115.86091524636994, -107.2147554962126, -116.8684270284983, -122.95839870536886, -45.50417409730018, -55.22738663798694, -114.17630567635224, -114.9250432772264, -107.28855771225815, -45.35923587964283, -45.32367281420102, -51.678164660633776, -46.73691846846173, -129.31263490978313, -105.34884912771359, -107.4006865157659, -112.32702260404888, -119.25023556967639, -47.154447793442735], "episode_lengths": [42, 61, 52, 556, 44, 51, 1600, 1600, 1600, 1600, 1600, 41, 1600, 78, 127, 97, 38, 50, 1600, 47, 183, 81, 61, 68, 77, 51, 117, 82, 100, 60, 160, 107, 1600, 1600, 1600, 42, 1600, 91, 43, 62, 73, 64, 299, 1600, 72, 216, 1600, 81, 1234, 1600, 1600, 1600, 1600, 1600, 75, 50, 114, 1600, 1600, 988, 51, 48, 874, 1600, 65, 52, 118, 54, 1600, 1600, 79, 1600, 1600, 78, 1600, 1600, 38, 1600, 62, 136, 754, 46, 44, 51, 91, 1600, 1600, 66, 53, 72, 1600, 1600, 1600, 1600, 240, 74, 62, 42, 83, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2960605705530399, "mean_inference_ms": 0.9974913172891782, "mean_action_processing_ms": 0.19512643626070436, "mean_env_wait_ms": 0.3935138484409459, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006147623062133789, "StateBufferConnector_ms": 0.004465818405151367, "ViewRequirementAgentConnector_ms": 0.12044715881347656}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 413.3896201585472, "num_env_steps_trained_throughput_per_sec": 413.3896201585472, "timesteps_total": 244000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 244000, "timers": {"training_iteration_time_ms": 10153.751, "restore_workers_time_ms": 0.014, "training_step_time_ms": 10153.711, "sample_time_ms": 3874.754, "load_time_ms": 0.438, "load_throughput": 9140406.429, "learn_time_ms": 6269.973, "learn_throughput": 637.961, "synch_weights_time_ms": 7.992}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000}, "done": false, "episodes_total": 354, "training_iteration": 61, "trial_id": "3adab_00000", "date": "2024-04-27_21-06-44", "timestamp": 1714277204, "time_this_iter_s": 9.6804678440094, "time_total_s": 609.9951231479645, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 609.9951231479645, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 25.369230769230764, "ram_util_percent": 62.72307692307694}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.939035540050076, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0173080409618511, "policy_loss": -0.03741231035160762, "vf_loss": 1.0483365262868585, "vf_explained_var": 0.059544611874447075, "kl": 0.012610028223262222, "entropy": 6.3432813634154614, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 57195.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "sampler_results": {"episode_reward_max": -37.80543074111144, "episode_reward_min": -226.27534340332718, "episode_reward_mean": -90.96309247411531, "episode_len_mean": 679.49, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 67949, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-51.75086707815223, -41.1586841902304, -49.34461472789012, -48.68372135606529, -40.888214477828406, -111.1725548055352, -44.78405137420019, -109.55734942572502, -129.83228251712399, -106.84283522121919, -109.37463094562665, -110.6659164208801, -38.202839458334495, -107.55230839786057, -132.1100932731274, -121.01934004531863, -121.65136217843929, -106.66544314674475, -106.48982656791124, -110.53737394000466, -133.3622463918794, -128.48691687297386, -103.14561739230591, -109.79722223208037, -126.2489125257147, -110.56739755802975, -45.5108935200336, -45.16360647359183, -51.709247200138286, -108.14889314686818, -41.931938188068486, -112.50698269766445, -107.13883769350127, -103.87035525517601, -115.77835467432627, -117.61576298354815, -109.55061502788402, -39.4566132901069, -110.47364988147841, -132.6863165245192, -46.865318447202306, -105.46540259215733, -136.6536987534576, -45.23290894703313, -48.65583342564916, -59.0216904875929, -44.31085595682138, -43.74589045116623, -118.11041362082648, -114.33997741754787, -129.76464484349015, -45.621720003678185, -43.11279635486127, -226.27534340332718, -110.51492038701724, -104.26563396884936, -131.8870327002269, -47.7832500013213, -106.90834782281021, -109.9734789232798, -116.44278589757593, -114.21522308595542, -42.62320690124544, -50.25534256394082, -112.81470110831845, -42.87594693415867, -46.564535504661464, -116.93149316692974, -49.691149577184824, -38.450620935976545, -107.34578243715565, -37.80543074111144, -108.2977852633577, -119.39405348527305, -170.5108973302504, -115.86091524636994, -107.2147554962126, -116.8684270284983, -122.95839870536886, -45.50417409730018, -55.22738663798694, -114.17630567635224, -114.9250432772264, -107.28855771225815, -45.35923587964283, -45.32367281420102, -51.678164660633776, -46.73691846846173, -129.31263490978313, -105.34884912771359, -107.4006865157659, -112.32702260404888, -119.25023556967639, -47.154447793442735, -57.29043465219078, -107.02065075497765, -104.64139201256695, -106.14207767795958, -116.22948460667209, -50.906572966702356], "episode_lengths": [1600, 1600, 1600, 1600, 1600, 41, 1600, 78, 127, 97, 38, 50, 1600, 47, 183, 81, 61, 68, 77, 51, 117, 82, 100, 60, 160, 107, 1600, 1600, 1600, 42, 1600, 91, 43, 62, 73, 64, 299, 1600, 72, 216, 1600, 81, 1234, 1600, 1600, 1600, 1600, 1600, 75, 50, 114, 1600, 1600, 988, 51, 48, 874, 1600, 65, 52, 118, 54, 1600, 1600, 79, 1600, 1600, 78, 1600, 1600, 38, 1600, 62, 136, 754, 46, 44, 51, 91, 1600, 1600, 66, 53, 72, 1600, 1600, 1600, 1600, 240, 74, 62, 42, 83, 1600, 1600, 79, 76, 70, 62, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29619583316118214, "mean_inference_ms": 0.9978078572984852, "mean_action_processing_ms": 0.19523435508108253, "mean_env_wait_ms": 0.3936273326386333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006106138229370117, "StateBufferConnector_ms": 0.004505157470703125, "ViewRequirementAgentConnector_ms": 0.1212761402130127}}, "episode_reward_max": -37.80543074111144, "episode_reward_min": -226.27534340332718, "episode_reward_mean": -90.96309247411531, "episode_len_mean": 679.49, "episodes_this_iter": 6, "episodes_timesteps_total": 67949, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-51.75086707815223, -41.1586841902304, -49.34461472789012, -48.68372135606529, -40.888214477828406, -111.1725548055352, -44.78405137420019, -109.55734942572502, -129.83228251712399, -106.84283522121919, -109.37463094562665, -110.6659164208801, -38.202839458334495, -107.55230839786057, -132.1100932731274, -121.01934004531863, -121.65136217843929, -106.66544314674475, -106.48982656791124, -110.53737394000466, -133.3622463918794, -128.48691687297386, -103.14561739230591, -109.79722223208037, -126.2489125257147, -110.56739755802975, -45.5108935200336, -45.16360647359183, -51.709247200138286, -108.14889314686818, -41.931938188068486, -112.50698269766445, -107.13883769350127, -103.87035525517601, -115.77835467432627, -117.61576298354815, -109.55061502788402, -39.4566132901069, -110.47364988147841, -132.6863165245192, -46.865318447202306, -105.46540259215733, -136.6536987534576, -45.23290894703313, -48.65583342564916, -59.0216904875929, -44.31085595682138, -43.74589045116623, -118.11041362082648, -114.33997741754787, -129.76464484349015, -45.621720003678185, -43.11279635486127, -226.27534340332718, -110.51492038701724, -104.26563396884936, -131.8870327002269, -47.7832500013213, -106.90834782281021, -109.9734789232798, -116.44278589757593, -114.21522308595542, -42.62320690124544, -50.25534256394082, -112.81470110831845, -42.87594693415867, -46.564535504661464, -116.93149316692974, -49.691149577184824, -38.450620935976545, -107.34578243715565, -37.80543074111144, -108.2977852633577, -119.39405348527305, -170.5108973302504, -115.86091524636994, -107.2147554962126, -116.8684270284983, -122.95839870536886, -45.50417409730018, -55.22738663798694, -114.17630567635224, -114.9250432772264, -107.28855771225815, -45.35923587964283, -45.32367281420102, -51.678164660633776, -46.73691846846173, -129.31263490978313, -105.34884912771359, -107.4006865157659, -112.32702260404888, -119.25023556967639, -47.154447793442735, -57.29043465219078, -107.02065075497765, -104.64139201256695, -106.14207767795958, -116.22948460667209, -50.906572966702356], "episode_lengths": [1600, 1600, 1600, 1600, 1600, 41, 1600, 78, 127, 97, 38, 50, 1600, 47, 183, 81, 61, 68, 77, 51, 117, 82, 100, 60, 160, 107, 1600, 1600, 1600, 42, 1600, 91, 43, 62, 73, 64, 299, 1600, 72, 216, 1600, 81, 1234, 1600, 1600, 1600, 1600, 1600, 75, 50, 114, 1600, 1600, 988, 51, 48, 874, 1600, 65, 52, 118, 54, 1600, 1600, 79, 1600, 1600, 78, 1600, 1600, 38, 1600, 62, 136, 754, 46, 44, 51, 91, 1600, 1600, 66, 53, 72, 1600, 1600, 1600, 1600, 240, 74, 62, 42, 83, 1600, 1600, 79, 76, 70, 62, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29619583316118214, "mean_inference_ms": 0.9978078572984852, "mean_action_processing_ms": 0.19523435508108253, "mean_env_wait_ms": 0.3936273326386333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006106138229370117, "StateBufferConnector_ms": 0.004505157470703125, "ViewRequirementAgentConnector_ms": 0.1212761402130127}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 409.03082202726836, "num_env_steps_trained_throughput_per_sec": 409.03082202726836, "timesteps_total": 248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 248000, "timers": {"training_iteration_time_ms": 9995.869, "restore_workers_time_ms": 0.014, "training_step_time_ms": 9995.83, "sample_time_ms": 3786.059, "load_time_ms": 0.429, "load_throughput": 9334158.229, "learn_time_ms": 6201.166, "learn_throughput": 645.04, "synch_weights_time_ms": 7.624}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "done": false, "episodes_total": 360, "training_iteration": 62, "trial_id": "3adab_00000", "date": "2024-04-27_21-06-53", "timestamp": 1714277213, "time_this_iter_s": 9.78311824798584, "time_total_s": 619.7782413959503, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 619.7782413959503, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 26.207142857142856, "ram_util_percent": 62.692857142857164}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.524674320140834, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.3799964708461356, "policy_loss": -0.0341086944655305, "vf_loss": 3.406981219102939, "vf_explained_var": 0.2566301616289282, "kl": 0.014071973798776618, "entropy": 11.41126291726225, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 58125.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "sampler_results": {"episode_reward_max": -37.80543074111144, "episode_reward_min": -272.2014183453091, "episode_reward_mean": -93.2033846267871, "episode_len_mean": 678.2, "episode_media": {}, "episodes_this_iter": 2, "episodes_timesteps_total": 67820, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-49.34461472789012, -48.68372135606529, -40.888214477828406, -111.1725548055352, -44.78405137420019, -109.55734942572502, -129.83228251712399, -106.84283522121919, -109.37463094562665, -110.6659164208801, -38.202839458334495, -107.55230839786057, -132.1100932731274, -121.01934004531863, -121.65136217843929, -106.66544314674475, -106.48982656791124, -110.53737394000466, -133.3622463918794, -128.48691687297386, -103.14561739230591, -109.79722223208037, -126.2489125257147, -110.56739755802975, -45.5108935200336, -45.16360647359183, -51.709247200138286, -108.14889314686818, -41.931938188068486, -112.50698269766445, -107.13883769350127, -103.87035525517601, -115.77835467432627, -117.61576298354815, -109.55061502788402, -39.4566132901069, -110.47364988147841, -132.6863165245192, -46.865318447202306, -105.46540259215733, -136.6536987534576, -45.23290894703313, -48.65583342564916, -59.0216904875929, -44.31085595682138, -43.74589045116623, -118.11041362082648, -114.33997741754787, -129.76464484349015, -45.621720003678185, -43.11279635486127, -226.27534340332718, -110.51492038701724, -104.26563396884936, -131.8870327002269, -47.7832500013213, -106.90834782281021, -109.9734789232798, -116.44278589757593, -114.21522308595542, -42.62320690124544, -50.25534256394082, -112.81470110831845, -42.87594693415867, -46.564535504661464, -116.93149316692974, -49.691149577184824, -38.450620935976545, -107.34578243715565, -37.80543074111144, -108.2977852633577, -119.39405348527305, -170.5108973302504, -115.86091524636994, -107.2147554962126, -116.8684270284983, -122.95839870536886, -45.50417409730018, -55.22738663798694, -114.17630567635224, -114.9250432772264, -107.28855771225815, -45.35923587964283, -45.32367281420102, -51.678164660633776, -46.73691846846173, -129.31263490978313, -105.34884912771359, -107.4006865157659, -112.32702260404888, -119.25023556967639, -47.154447793442735, -57.29043465219078, -107.02065075497765, -104.64139201256695, -106.14207767795958, -116.22948460667209, -50.906572966702356, -44.7373481902536, -272.2014183453091], "episode_lengths": [1600, 1600, 1600, 41, 1600, 78, 127, 97, 38, 50, 1600, 47, 183, 81, 61, 68, 77, 51, 117, 82, 100, 60, 160, 107, 1600, 1600, 1600, 42, 1600, 91, 43, 62, 73, 64, 299, 1600, 72, 216, 1600, 81, 1234, 1600, 1600, 1600, 1600, 1600, 75, 50, 114, 1600, 1600, 988, 51, 48, 874, 1600, 65, 52, 118, 54, 1600, 1600, 79, 1600, 1600, 78, 1600, 1600, 38, 1600, 62, 136, 754, 46, 44, 51, 91, 1600, 1600, 66, 53, 72, 1600, 1600, 1600, 1600, 240, 74, 62, 42, 83, 1600, 1600, 79, 76, 70, 62, 1600, 1600, 1471]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2962341796706708, "mean_inference_ms": 0.9979795068333521, "mean_action_processing_ms": 0.1952538590297133, "mean_env_wait_ms": 0.3935905520513404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006119728088378906, "StateBufferConnector_ms": 0.004445075988769531, "ViewRequirementAgentConnector_ms": 0.11861729621887207}}, "episode_reward_max": -37.80543074111144, "episode_reward_min": -272.2014183453091, "episode_reward_mean": -93.2033846267871, "episode_len_mean": 678.2, "episodes_this_iter": 2, "episodes_timesteps_total": 67820, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-49.34461472789012, -48.68372135606529, -40.888214477828406, -111.1725548055352, -44.78405137420019, -109.55734942572502, -129.83228251712399, -106.84283522121919, -109.37463094562665, -110.6659164208801, -38.202839458334495, -107.55230839786057, -132.1100932731274, -121.01934004531863, -121.65136217843929, -106.66544314674475, -106.48982656791124, -110.53737394000466, -133.3622463918794, -128.48691687297386, -103.14561739230591, -109.79722223208037, -126.2489125257147, -110.56739755802975, -45.5108935200336, -45.16360647359183, -51.709247200138286, -108.14889314686818, -41.931938188068486, -112.50698269766445, -107.13883769350127, -103.87035525517601, -115.77835467432627, -117.61576298354815, -109.55061502788402, -39.4566132901069, -110.47364988147841, -132.6863165245192, -46.865318447202306, -105.46540259215733, -136.6536987534576, -45.23290894703313, -48.65583342564916, -59.0216904875929, -44.31085595682138, -43.74589045116623, -118.11041362082648, -114.33997741754787, -129.76464484349015, -45.621720003678185, -43.11279635486127, -226.27534340332718, -110.51492038701724, -104.26563396884936, -131.8870327002269, -47.7832500013213, -106.90834782281021, -109.9734789232798, -116.44278589757593, -114.21522308595542, -42.62320690124544, -50.25534256394082, -112.81470110831845, -42.87594693415867, -46.564535504661464, -116.93149316692974, -49.691149577184824, -38.450620935976545, -107.34578243715565, -37.80543074111144, -108.2977852633577, -119.39405348527305, -170.5108973302504, -115.86091524636994, -107.2147554962126, -116.8684270284983, -122.95839870536886, -45.50417409730018, -55.22738663798694, -114.17630567635224, -114.9250432772264, -107.28855771225815, -45.35923587964283, -45.32367281420102, -51.678164660633776, -46.73691846846173, -129.31263490978313, -105.34884912771359, -107.4006865157659, -112.32702260404888, -119.25023556967639, -47.154447793442735, -57.29043465219078, -107.02065075497765, -104.64139201256695, -106.14207767795958, -116.22948460667209, -50.906572966702356, -44.7373481902536, -272.2014183453091], "episode_lengths": [1600, 1600, 1600, 41, 1600, 78, 127, 97, 38, 50, 1600, 47, 183, 81, 61, 68, 77, 51, 117, 82, 100, 60, 160, 107, 1600, 1600, 1600, 42, 1600, 91, 43, 62, 73, 64, 299, 1600, 72, 216, 1600, 81, 1234, 1600, 1600, 1600, 1600, 1600, 75, 50, 114, 1600, 1600, 988, 51, 48, 874, 1600, 65, 52, 118, 54, 1600, 1600, 79, 1600, 1600, 78, 1600, 1600, 38, 1600, 62, 136, 754, 46, 44, 51, 91, 1600, 1600, 66, 53, 72, 1600, 1600, 1600, 1600, 240, 74, 62, 42, 83, 1600, 1600, 79, 76, 70, 62, 1600, 1600, 1471]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2962341796706708, "mean_inference_ms": 0.9979795068333521, "mean_action_processing_ms": 0.1952538590297133, "mean_env_wait_ms": 0.3935905520513404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006119728088378906, "StateBufferConnector_ms": 0.004445075988769531, "ViewRequirementAgentConnector_ms": 0.11861729621887207}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 395.0203356214567, "num_env_steps_trained_throughput_per_sec": 395.0203356214567, "timesteps_total": 252000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 9964.23, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9964.194, "sample_time_ms": 3720.718, "load_time_ms": 0.417, "load_throughput": 9599047.946, "learn_time_ms": 6234.85, "learn_throughput": 641.555, "synch_weights_time_ms": 7.651}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": true, "episodes_total": 362, "training_iteration": 63, "trial_id": "3adab_00000", "date": "2024-04-27_21-07-04", "timestamp": 1714277224, "time_this_iter_s": 10.130697965621948, "time_total_s": 629.9089393615723, "pid": 63094, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15bf2b420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 629.9089393615723, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 26.693333333333335, "ram_util_percent": 62.680000000000014}}
