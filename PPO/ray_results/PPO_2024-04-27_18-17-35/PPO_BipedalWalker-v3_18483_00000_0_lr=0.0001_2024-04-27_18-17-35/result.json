{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.837467565683909, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.7158708821256115, "policy_loss": -0.016800680404068322, "vf_loss": 6.7303801493298625, "vf_explained_var": -0.02888846948582639, "kl": 0.011456955490061236, "entropy": 5.6756760889484035, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 465.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": -101.47808510866575, "episode_reward_min": -119.99187985174297, "episode_reward_mean": -109.04399867417865, "episode_len_mean": 460.125, "episode_media": {}, "episodes_this_iter": 8, "episodes_timesteps_total": 3681, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-117.86402474794237, -106.17705658237884, -105.47617446869239, -101.47808510866575, -112.10230150072836, -102.71106771712378, -106.55139941615485, -119.99187985174297], "episode_lengths": [1600, 75, 73, 122, 65, 57, 1600, 89]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3554367649739888, "mean_inference_ms": 1.205989922481081, "mean_action_processing_ms": 0.232153389228695, "mean_env_wait_ms": 0.4661300073916289, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006857514381408691, "StateBufferConnector_ms": 0.0049561262130737305, "ViewRequirementAgentConnector_ms": 0.14292895793914795}}, "episode_reward_max": -101.47808510866575, "episode_reward_min": -119.99187985174297, "episode_reward_mean": -109.04399867417865, "episode_len_mean": 460.125, "episodes_this_iter": 8, "episodes_timesteps_total": 3681, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-117.86402474794237, -106.17705658237884, -105.47617446869239, -101.47808510866575, -112.10230150072836, -102.71106771712378, -106.55139941615485, -119.99187985174297], "episode_lengths": [1600, 75, 73, 122, 65, 57, 1600, 89]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3554367649739888, "mean_inference_ms": 1.205989922481081, "mean_action_processing_ms": 0.232153389228695, "mean_env_wait_ms": 0.4661300073916289, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006857514381408691, "StateBufferConnector_ms": 0.0049561262130737305, "ViewRequirementAgentConnector_ms": 0.14292895793914795}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 352.1579635561397, "num_env_steps_trained_throughput_per_sec": 352.1579635561397, "timesteps_total": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 11358.549, "restore_workers_time_ms": 0.022, "training_step_time_ms": 11358.484, "sample_time_ms": 4570.572, "load_time_ms": 0.312, "load_throughput": 12816818.946, "learn_time_ms": 6777.833, "learn_throughput": 590.159, "synch_weights_time_ms": 8.878}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 8, "training_iteration": 1, "trial_id": "18483_00000", "date": "2024-04-27_18-18-22", "timestamp": 1714267102, "time_this_iter_s": 11.363626956939697, "time_total_s": 11.363626956939697, "pid": 61200, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 11.363626956939697, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 44.75294117647059, "ram_util_percent": 65.39999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.744748803588653, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9025578899873437, "policy_loss": -0.01989148960558958, "vf_loss": 3.9198028321628287, "vf_explained_var": -7.23775996956774e-05, "kl": 0.013232794395795134, "entropy": 5.655474156205372, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1395.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": -100.47906191585648, "episode_reward_min": -210.08591263714916, "episode_reward_mean": -113.83307683461744, "episode_len_mean": 373.2631578947368, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 7092, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-117.86402474794237, -106.17705658237884, -105.47617446869239, -101.47808510866575, -112.10230150072836, -102.71106771712378, -106.55139941615485, -119.99187985174297, -115.44447814442329, -105.05783314400104, -106.43909637518723, -113.69735318632112, -108.41370915803748, -102.06718632235254, -108.26197980482132, -100.47906191585648, -113.24163094989707, -210.08591263714916, -107.28822882625524], "episode_lengths": [1600, 75, 73, 122, 65, 57, 1600, 89, 1600, 50, 57, 49, 84, 53, 100, 57, 79, 1245, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3618709174744176, "mean_inference_ms": 1.2210294312214574, "mean_action_processing_ms": 0.23357867230131796, "mean_env_wait_ms": 0.46939508960130283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006963077344392475, "StateBufferConnector_ms": 0.004745784558747944, "ViewRequirementAgentConnector_ms": 0.14263579719945005}}, "episode_reward_max": -100.47906191585648, "episode_reward_min": -210.08591263714916, "episode_reward_mean": -113.83307683461744, "episode_len_mean": 373.2631578947368, "episodes_this_iter": 11, "episodes_timesteps_total": 7092, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-117.86402474794237, -106.17705658237884, -105.47617446869239, -101.47808510866575, -112.10230150072836, -102.71106771712378, -106.55139941615485, -119.99187985174297, -115.44447814442329, -105.05783314400104, -106.43909637518723, -113.69735318632112, -108.41370915803748, -102.06718632235254, -108.26197980482132, -100.47906191585648, -113.24163094989707, -210.08591263714916, -107.28822882625524], "episode_lengths": [1600, 75, 73, 122, 65, 57, 1600, 89, 1600, 50, 57, 49, 84, 53, 100, 57, 79, 1245, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3618709174744176, "mean_inference_ms": 1.2210294312214574, "mean_action_processing_ms": 0.23357867230131796, "mean_env_wait_ms": 0.46939508960130283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006963077344392475, "StateBufferConnector_ms": 0.004745784558747944, "ViewRequirementAgentConnector_ms": 0.14263579719945005}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 336.5686532333696, "num_env_steps_trained_throughput_per_sec": 336.5686532333696, "timesteps_total": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 11621.603, "restore_workers_time_ms": 0.037, "training_step_time_ms": 11621.526, "sample_time_ms": 4662.866, "load_time_ms": 0.449, "load_throughput": 8916936.487, "learn_time_ms": 6948.555, "learn_throughput": 575.659, "synch_weights_time_ms": 8.949}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 19, "training_iteration": 2, "trial_id": "18483_00000", "date": "2024-04-27_18-18-34", "timestamp": 1714267114, "time_this_iter_s": 11.890019178390503, "time_total_s": 23.2536461353302, "pid": 61200, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 23.2536461353302, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 51.22941176470588, "ram_util_percent": 64.71176470588236}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.261295043396693, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9632804674717286, "policy_loss": -0.01956212659196187, "vf_loss": 3.980099722054056, "vf_explained_var": 0.004496712966631818, "kl": 0.013714531294874032, "entropy": 5.945413341317126, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2325.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": -100.47906191585648, "episode_reward_min": -225.32522422382362, "episode_reward_mean": -117.25793432918574, "episode_len_mean": 391.0740740740741, "episode_media": {}, "episodes_this_iter": 8, "episodes_timesteps_total": 10559, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-117.86402474794237, -106.17705658237884, -105.47617446869239, -101.47808510866575, -112.10230150072836, -102.71106771712378, -106.55139941615485, -119.99187985174297, -115.44447814442329, -105.05783314400104, -106.43909637518723, -113.69735318632112, -108.41370915803748, -102.06718632235254, -108.26197980482132, -100.47906191585648, -113.24163094989707, -210.08591263714916, -107.28822882625524, -120.5692908932368, -225.32522422382362, -102.58423405726937, -115.83474722360137, -107.29658268793114, -112.9025480714223, -101.36300081752427, -117.26013905547508], "episode_lengths": [1600, 75, 73, 122, 65, 57, 1600, 89, 1600, 50, 57, 49, 84, 53, 100, 57, 79, 1245, 37, 89, 1407, 73, 99, 58, 60, 81, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3662326472118583, "mean_inference_ms": 1.2256685483932475, "mean_action_processing_ms": 0.23387972763354845, "mean_env_wait_ms": 0.4700187902372481, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0076664818657769095, "StateBufferConnector_ms": 0.0048054589165581595, "ViewRequirementAgentConnector_ms": 0.14595632199887876}}, "episode_reward_max": -100.47906191585648, "episode_reward_min": -225.32522422382362, "episode_reward_mean": -117.25793432918574, "episode_len_mean": 391.0740740740741, "episodes_this_iter": 8, "episodes_timesteps_total": 10559, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-117.86402474794237, -106.17705658237884, -105.47617446869239, -101.47808510866575, -112.10230150072836, -102.71106771712378, -106.55139941615485, -119.99187985174297, -115.44447814442329, -105.05783314400104, -106.43909637518723, -113.69735318632112, -108.41370915803748, -102.06718632235254, -108.26197980482132, -100.47906191585648, -113.24163094989707, -210.08591263714916, -107.28822882625524, -120.5692908932368, -225.32522422382362, -102.58423405726937, -115.83474722360137, -107.29658268793114, -112.9025480714223, -101.36300081752427, -117.26013905547508], "episode_lengths": [1600, 75, 73, 122, 65, 57, 1600, 89, 1600, 50, 57, 49, 84, 53, 100, 57, 79, 1245, 37, 89, 1407, 73, 99, 58, 60, 81, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3662326472118583, "mean_inference_ms": 1.2256685483932475, "mean_action_processing_ms": 0.23387972763354845, "mean_env_wait_ms": 0.4700187902372481, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0076664818657769095, "StateBufferConnector_ms": 0.0048054589165581595, "ViewRequirementAgentConnector_ms": 0.14595632199887876}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 339.97277132196274, "num_env_steps_trained_throughput_per_sec": 339.97277132196274, "timesteps_total": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 11669.623, "restore_workers_time_ms": 0.031, "training_step_time_ms": 11669.553, "sample_time_ms": 4690.044, "load_time_ms": 0.424, "load_throughput": 9425402.247, "learn_time_ms": 6969.004, "learn_throughput": 573.97, "synch_weights_time_ms": 9.398}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 27, "training_iteration": 3, "trial_id": "18483_00000", "date": "2024-04-27_18-18-46", "timestamp": 1714267126, "time_this_iter_s": 11.771036863327026, "time_total_s": 35.02468299865723, "pid": 61200, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 35.02468299865723, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 52.2125, "ram_util_percent": 65.39375000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.399275171115836, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.6459457941882825, "policy_loss": -0.02107867761164583, "vf_loss": 5.663922954086335, "vf_explained_var": 0.014359579419576994, "kl": 0.015507451544277432, "entropy": 5.955149611093665, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3255.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": -100.47906191585648, "episode_reward_min": -225.4935192884377, "episode_reward_mean": -124.26390548194715, "episode_len_mean": 450.6, "episode_media": {}, "episodes_this_iter": 8, "episodes_timesteps_total": 15771, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-117.86402474794237, -106.17705658237884, -105.47617446869239, -101.47808510866575, -112.10230150072836, -102.71106771712378, -106.55139941615485, -119.99187985174297, -115.44447814442329, -105.05783314400104, -106.43909637518723, -113.69735318632112, -108.41370915803748, -102.06718632235254, -108.26197980482132, -100.47906191585648, -113.24163094989707, -210.08591263714916, -107.28822882625524, -120.5692908932368, -225.32522422382362, -102.58423405726937, -115.83474722360137, -107.29658268793114, -112.9025480714223, -101.36300081752427, -117.26013905547508, -214.82475130915591, -176.55355417474476, -131.77975427607385, -103.59887231908365, -103.54657603090132, -117.69297798024304, -225.4935192884377, -109.78245960149418], "episode_lengths": [1600, 75, 73, 122, 65, 57, 1600, 89, 1600, 50, 57, 49, 84, 53, 100, 57, 79, 1245, 37, 89, 1407, 73, 99, 58, 60, 81, 1600, 1230, 735, 1600, 49, 116, 62, 1366, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3693592349348937, "mean_inference_ms": 1.2411243501983713, "mean_action_processing_ms": 0.23725553494562968, "mean_env_wait_ms": 0.47493304255690294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007634844098772321, "StateBufferConnector_ms": 0.004983629499162946, "ViewRequirementAgentConnector_ms": 0.1473869596208845}}, "episode_reward_max": -100.47906191585648, "episode_reward_min": -225.4935192884377, "episode_reward_mean": -124.26390548194715, "episode_len_mean": 450.6, "episodes_this_iter": 8, "episodes_timesteps_total": 15771, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-117.86402474794237, -106.17705658237884, -105.47617446869239, -101.47808510866575, -112.10230150072836, -102.71106771712378, -106.55139941615485, -119.99187985174297, -115.44447814442329, -105.05783314400104, -106.43909637518723, -113.69735318632112, -108.41370915803748, -102.06718632235254, -108.26197980482132, -100.47906191585648, -113.24163094989707, -210.08591263714916, -107.28822882625524, -120.5692908932368, -225.32522422382362, -102.58423405726937, -115.83474722360137, -107.29658268793114, -112.9025480714223, -101.36300081752427, -117.26013905547508, -214.82475130915591, -176.55355417474476, -131.77975427607385, -103.59887231908365, -103.54657603090132, -117.69297798024304, -225.4935192884377, -109.78245960149418], "episode_lengths": [1600, 75, 73, 122, 65, 57, 1600, 89, 1600, 50, 57, 49, 84, 53, 100, 57, 79, 1245, 37, 89, 1407, 73, 99, 58, 60, 81, 1600, 1230, 735, 1600, 49, 116, 62, 1366, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3693592349348937, "mean_inference_ms": 1.2411243501983713, "mean_action_processing_ms": 0.23725553494562968, "mean_env_wait_ms": 0.47493304255690294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007634844098772321, "StateBufferConnector_ms": 0.004983629499162946, "ViewRequirementAgentConnector_ms": 0.1473869596208845}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 326.80080371276154, "num_env_steps_trained_throughput_per_sec": 326.80080371276154, "timesteps_total": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 11812.188, "restore_workers_time_ms": 0.028, "training_step_time_ms": 11812.121, "sample_time_ms": 4906.257, "load_time_ms": 0.422, "load_throughput": 9471963.867, "learn_time_ms": 6895.741, "learn_throughput": 580.068, "synch_weights_time_ms": 9.044}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 35, "training_iteration": 4, "trial_id": "18483_00000", "date": "2024-04-27_18-18-58", "timestamp": 1714267138, "time_this_iter_s": 12.24416995048523, "time_total_s": 47.268852949142456, "pid": 61200, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 47.268852949142456, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 51.30555555555556, "ram_util_percent": 66.00555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.515085040657752, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.272799933513987, "policy_loss": -0.016281980344204493, "vf_loss": 4.286311721353121, "vf_explained_var": -0.0942297750903714, "kl": 0.013850962797048245, "entropy": 6.051804333348428, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4185.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": -100.08605692698497, "episode_reward_min": -225.4935192884377, "episode_reward_mean": -125.7458669706803, "episode_len_mean": 459.8333333333333, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 19313, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-117.86402474794237, -106.17705658237884, -105.47617446869239, -101.47808510866575, -112.10230150072836, -102.71106771712378, -106.55139941615485, -119.99187985174297, -115.44447814442329, -105.05783314400104, -106.43909637518723, -113.69735318632112, -108.41370915803748, -102.06718632235254, -108.26197980482132, -100.47906191585648, -113.24163094989707, -210.08591263714916, -107.28822882625524, -120.5692908932368, -225.32522422382362, -102.58423405726937, -115.83474722360137, -107.29658268793114, -112.9025480714223, -101.36300081752427, -117.26013905547508, -214.82475130915591, -176.55355417474476, -131.77975427607385, -103.59887231908365, -103.54657603090132, -117.69297798024304, -225.4935192884377, -109.78245960149418, -222.38940802688842, -100.08605692698497, -133.85475837077075, -118.45719759115019, -109.18703580505836, -117.9972324553281, -130.11803172424183], "episode_lengths": [1600, 75, 73, 122, 65, 57, 1600, 89, 1600, 50, 57, 49, 84, 53, 100, 57, 79, 1245, 37, 89, 1407, 73, 99, 58, 60, 81, 1600, 1230, 735, 1600, 49, 116, 62, 1366, 54, 1353, 73, 161, 76, 83, 196, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37103131430167613, "mean_inference_ms": 1.2448139932875997, "mean_action_processing_ms": 0.23775306726470327, "mean_env_wait_ms": 0.47605249810555755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00760725566319057, "StateBufferConnector_ms": 0.005448999859037853, "ViewRequirementAgentConnector_ms": 0.14592863264537992}}, "episode_reward_max": -100.08605692698497, "episode_reward_min": -225.4935192884377, "episode_reward_mean": -125.7458669706803, "episode_len_mean": 459.8333333333333, "episodes_this_iter": 7, "episodes_timesteps_total": 19313, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-117.86402474794237, -106.17705658237884, -105.47617446869239, -101.47808510866575, -112.10230150072836, -102.71106771712378, -106.55139941615485, -119.99187985174297, -115.44447814442329, -105.05783314400104, -106.43909637518723, -113.69735318632112, -108.41370915803748, -102.06718632235254, -108.26197980482132, -100.47906191585648, -113.24163094989707, -210.08591263714916, -107.28822882625524, -120.5692908932368, -225.32522422382362, -102.58423405726937, -115.83474722360137, -107.29658268793114, -112.9025480714223, -101.36300081752427, -117.26013905547508, -214.82475130915591, -176.55355417474476, -131.77975427607385, -103.59887231908365, -103.54657603090132, -117.69297798024304, -225.4935192884377, -109.78245960149418, -222.38940802688842, -100.08605692698497, -133.85475837077075, -118.45719759115019, -109.18703580505836, -117.9972324553281, -130.11803172424183], "episode_lengths": [1600, 75, 73, 122, 65, 57, 1600, 89, 1600, 50, 57, 49, 84, 53, 100, 57, 79, 1245, 37, 89, 1407, 73, 99, 58, 60, 81, 1600, 1230, 735, 1600, 49, 116, 62, 1366, 54, 1353, 73, 161, 76, 83, 196, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37103131430167613, "mean_inference_ms": 1.2448139932875997, "mean_action_processing_ms": 0.23775306726470327, "mean_env_wait_ms": 0.47605249810555755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00760725566319057, "StateBufferConnector_ms": 0.005448999859037853, "ViewRequirementAgentConnector_ms": 0.14592863264537992}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 378.8288155656469, "num_env_steps_trained_throughput_per_sec": 378.8288155656469, "timesteps_total": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 11561.525, "restore_workers_time_ms": 0.026, "training_step_time_ms": 11561.461, "sample_time_ms": 4785.131, "load_time_ms": 0.44, "load_throughput": 9098273.319, "learn_time_ms": 6766.151, "learn_throughput": 591.178, "synch_weights_time_ms": 9.094}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 42, "training_iteration": 5, "trial_id": "18483_00000", "date": "2024-04-27_18-19-09", "timestamp": 1714267149, "time_this_iter_s": 10.56333589553833, "time_total_s": 57.832188844680786, "pid": 61200, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 57.832188844680786, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 44.49333333333334, "ram_util_percent": 65.66666666666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.521225501580904, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.296011264478132, "policy_loss": -0.023980475171038542, "vf_loss": 2.317023827944712, "vf_explained_var": -0.17760820715658127, "kl": 0.014839548501935203, "entropy": 5.962339943711475, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5115.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": -100.08605692698497, "episode_reward_min": -225.4935192884377, "episode_reward_mean": -124.64949696576294, "episode_len_mean": 475.375, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 22818, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-117.86402474794237, -106.17705658237884, -105.47617446869239, -101.47808510866575, -112.10230150072836, -102.71106771712378, -106.55139941615485, -119.99187985174297, -115.44447814442329, -105.05783314400104, -106.43909637518723, -113.69735318632112, -108.41370915803748, -102.06718632235254, -108.26197980482132, -100.47906191585648, -113.24163094989707, -210.08591263714916, -107.28822882625524, -120.5692908932368, -225.32522422382362, -102.58423405726937, -115.83474722360137, -107.29658268793114, -112.9025480714223, -101.36300081752427, -117.26013905547508, -214.82475130915591, -176.55355417474476, -131.77975427607385, -103.59887231908365, -103.54657603090132, -117.69297798024304, -225.4935192884377, -109.78245960149418, -222.38940802688842, -100.08605692698497, -133.85475837077075, -118.45719759115019, -109.18703580505836, -117.9972324553281, -130.11803172424183, -118.69226812656089, -121.2829648088552, -108.25004858669328, -128.1841191137347, -116.16517135825754, -109.27486959394689], "episode_lengths": [1600, 75, 73, 122, 65, 57, 1600, 89, 1600, 50, 57, 49, 84, 53, 100, 57, 79, 1245, 37, 89, 1407, 73, 99, 58, 60, 81, 1600, 1230, 735, 1600, 49, 116, 62, 1366, 54, 1353, 73, 161, 76, 83, 196, 1600, 1600, 74, 104, 1600, 87, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3706674726040191, "mean_inference_ms": 1.2436348549683542, "mean_action_processing_ms": 0.23756524036624882, "mean_env_wait_ms": 0.47543704582115504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007504721482594808, "StateBufferConnector_ms": 0.005370875199635823, "ViewRequirementAgentConnector_ms": 0.14455368121465048}}, "episode_reward_max": -100.08605692698497, "episode_reward_min": -225.4935192884377, "episode_reward_mean": -124.64949696576294, "episode_len_mean": 475.375, "episodes_this_iter": 6, "episodes_timesteps_total": 22818, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-117.86402474794237, -106.17705658237884, -105.47617446869239, -101.47808510866575, -112.10230150072836, -102.71106771712378, -106.55139941615485, -119.99187985174297, -115.44447814442329, -105.05783314400104, -106.43909637518723, -113.69735318632112, -108.41370915803748, -102.06718632235254, -108.26197980482132, -100.47906191585648, -113.24163094989707, -210.08591263714916, -107.28822882625524, -120.5692908932368, -225.32522422382362, -102.58423405726937, -115.83474722360137, -107.29658268793114, -112.9025480714223, -101.36300081752427, -117.26013905547508, -214.82475130915591, -176.55355417474476, -131.77975427607385, -103.59887231908365, -103.54657603090132, -117.69297798024304, -225.4935192884377, -109.78245960149418, -222.38940802688842, -100.08605692698497, -133.85475837077075, -118.45719759115019, -109.18703580505836, -117.9972324553281, -130.11803172424183, -118.69226812656089, -121.2829648088552, -108.25004858669328, -128.1841191137347, -116.16517135825754, -109.27486959394689], "episode_lengths": [1600, 75, 73, 122, 65, 57, 1600, 89, 1600, 50, 57, 49, 84, 53, 100, 57, 79, 1245, 37, 89, 1407, 73, 99, 58, 60, 81, 1600, 1230, 735, 1600, 49, 116, 62, 1366, 54, 1353, 73, 161, 76, 83, 196, 1600, 1600, 74, 104, 1600, 87, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3706674726040191, "mean_inference_ms": 1.2436348549683542, "mean_action_processing_ms": 0.23756524036624882, "mean_env_wait_ms": 0.47543704582115504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007504721482594808, "StateBufferConnector_ms": 0.005370875199635823, "ViewRequirementAgentConnector_ms": 0.14455368121465048}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 365.4612482206675, "num_env_steps_trained_throughput_per_sec": 365.4612482206675, "timesteps_total": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 11458.784, "restore_workers_time_ms": 0.024, "training_step_time_ms": 11458.724, "sample_time_ms": 4685.996, "load_time_ms": 0.463, "load_throughput": 8644336.282, "learn_time_ms": 6762.709, "learn_throughput": 591.479, "synch_weights_time_ms": 8.915}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 48, "training_iteration": 6, "trial_id": "18483_00000", "date": "2024-04-27_18-19-20", "timestamp": 1714267160, "time_this_iter_s": 10.949634075164795, "time_total_s": 68.78182291984558, "pid": 61200, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 68.78182291984558, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 46.34375, "ram_util_percent": 64.5375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.948753411987777, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.166483722877894, "policy_loss": -0.02421969175739314, "vf_loss": 3.186851967422552, "vf_explained_var": 0.12141805983358814, "kl": 0.01925729995596232, "entropy": 6.317676866695445, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6045.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": -100.08605692698497, "episode_reward_min": -225.4935192884377, "episode_reward_mean": -123.94599280493915, "episode_len_mean": 460.7068965517241, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 26721, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-117.86402474794237, -106.17705658237884, -105.47617446869239, -101.47808510866575, -112.10230150072836, -102.71106771712378, -106.55139941615485, -119.99187985174297, -115.44447814442329, -105.05783314400104, -106.43909637518723, -113.69735318632112, -108.41370915803748, -102.06718632235254, -108.26197980482132, -100.47906191585648, -113.24163094989707, -210.08591263714916, -107.28822882625524, -120.5692908932368, -225.32522422382362, -102.58423405726937, -115.83474722360137, -107.29658268793114, -112.9025480714223, -101.36300081752427, -117.26013905547508, -214.82475130915591, -176.55355417474476, -131.77975427607385, -103.59887231908365, -103.54657603090132, -117.69297798024304, -225.4935192884377, -109.78245960149418, -222.38940802688842, -100.08605692698497, -133.85475837077075, -118.45719759115019, -109.18703580505836, -117.9972324553281, -130.11803172424183, -118.69226812656089, -121.2829648088552, -108.25004858669328, -128.1841191137347, -116.16517135825754, -109.27486959394689, -129.63636659248937, -121.83242389203856, -116.1156360745039, -112.26451227215492, -117.90128699942989, -114.67032638365342, -122.6710409705465, -125.12980408831437, -138.2483572175242, -107.22197383919544], "episode_lengths": [1600, 75, 73, 122, 65, 57, 1600, 89, 1600, 50, 57, 49, 84, 53, 100, 57, 79, 1245, 37, 89, 1407, 73, 99, 58, 60, 81, 1600, 1230, 735, 1600, 49, 116, 62, 1366, 54, 1353, 73, 161, 76, 83, 196, 1600, 1600, 74, 104, 1600, 87, 40, 1600, 78, 72, 65, 76, 54, 1600, 95, 184, 79]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3701729227559957, "mean_inference_ms": 1.240913435983197, "mean_action_processing_ms": 0.2370620952098609, "mean_env_wait_ms": 0.47427453242184214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007686121710415544, "StateBufferConnector_ms": 0.0052653509995033, "ViewRequirementAgentConnector_ms": 0.1449950810136466}}, "episode_reward_max": -100.08605692698497, "episode_reward_min": -225.4935192884377, "episode_reward_mean": -123.94599280493915, "episode_len_mean": 460.7068965517241, "episodes_this_iter": 10, "episodes_timesteps_total": 26721, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-117.86402474794237, -106.17705658237884, -105.47617446869239, -101.47808510866575, -112.10230150072836, -102.71106771712378, -106.55139941615485, -119.99187985174297, -115.44447814442329, -105.05783314400104, -106.43909637518723, -113.69735318632112, -108.41370915803748, -102.06718632235254, -108.26197980482132, -100.47906191585648, -113.24163094989707, -210.08591263714916, -107.28822882625524, -120.5692908932368, -225.32522422382362, -102.58423405726937, -115.83474722360137, -107.29658268793114, -112.9025480714223, -101.36300081752427, -117.26013905547508, -214.82475130915591, -176.55355417474476, -131.77975427607385, -103.59887231908365, -103.54657603090132, -117.69297798024304, -225.4935192884377, -109.78245960149418, -222.38940802688842, -100.08605692698497, -133.85475837077075, -118.45719759115019, -109.18703580505836, -117.9972324553281, -130.11803172424183, -118.69226812656089, -121.2829648088552, -108.25004858669328, -128.1841191137347, -116.16517135825754, -109.27486959394689, -129.63636659248937, -121.83242389203856, -116.1156360745039, -112.26451227215492, -117.90128699942989, -114.67032638365342, -122.6710409705465, -125.12980408831437, -138.2483572175242, -107.22197383919544], "episode_lengths": [1600, 75, 73, 122, 65, 57, 1600, 89, 1600, 50, 57, 49, 84, 53, 100, 57, 79, 1245, 37, 89, 1407, 73, 99, 58, 60, 81, 1600, 1230, 735, 1600, 49, 116, 62, 1366, 54, 1353, 73, 161, 76, 83, 196, 1600, 1600, 74, 104, 1600, 87, 40, 1600, 78, 72, 65, 76, 54, 1600, 95, 184, 79]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3701729227559957, "mean_inference_ms": 1.240913435983197, "mean_action_processing_ms": 0.2370620952098609, "mean_env_wait_ms": 0.47427453242184214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007686121710415544, "StateBufferConnector_ms": 0.0052653509995033, "ViewRequirementAgentConnector_ms": 0.1449950810136466}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 362.4307837835818, "num_env_steps_trained_throughput_per_sec": 362.4307837835818, "timesteps_total": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 11398.472, "restore_workers_time_ms": 0.023, "training_step_time_ms": 11398.414, "sample_time_ms": 4656.081, "load_time_ms": 0.47, "load_throughput": 8508948.848, "learn_time_ms": 6732.425, "learn_throughput": 594.14, "synch_weights_time_ms": 8.816}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 58, "training_iteration": 7, "trial_id": "18483_00000", "date": "2024-04-27_18-19-31", "timestamp": 1714267171, "time_this_iter_s": 11.04232120513916, "time_total_s": 79.82414412498474, "pid": 61200, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 79.82414412498474, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 41.68666666666666, "ram_util_percent": 64.64666666666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.00360074451854, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8961613561499924, "policy_loss": -0.0221911724427745, "vf_loss": 1.9158948738368289, "vf_explained_var": 0.25279402008620644, "kl": 0.012288228318132963, "entropy": 6.2184504165444325, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6975.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": -100.08605692698497, "episode_reward_min": -225.4935192884377, "episode_reward_mean": -124.20081541878771, "episode_len_mean": 491.5245901639344, "episode_media": {}, "episodes_this_iter": 3, "episodes_timesteps_total": 29983, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-117.86402474794237, -106.17705658237884, -105.47617446869239, -101.47808510866575, -112.10230150072836, -102.71106771712378, -106.55139941615485, -119.99187985174297, -115.44447814442329, -105.05783314400104, -106.43909637518723, -113.69735318632112, -108.41370915803748, -102.06718632235254, -108.26197980482132, -100.47906191585648, -113.24163094989707, -210.08591263714916, -107.28822882625524, -120.5692908932368, -225.32522422382362, -102.58423405726937, -115.83474722360137, -107.29658268793114, -112.9025480714223, -101.36300081752427, -117.26013905547508, -214.82475130915591, -176.55355417474476, -131.77975427607385, -103.59887231908365, -103.54657603090132, -117.69297798024304, -225.4935192884377, -109.78245960149418, -222.38940802688842, -100.08605692698497, -133.85475837077075, -118.45719759115019, -109.18703580505836, -117.9972324553281, -130.11803172424183, -118.69226812656089, -121.2829648088552, -108.25004858669328, -128.1841191137347, -116.16517135825754, -109.27486959394689, -129.63636659248937, -121.83242389203856, -116.1156360745039, -112.26451227215492, -117.90128699942989, -114.67032638365342, -122.6710409705465, -125.12980408831437, -138.2483572175242, -107.22197383919544, -134.27612650056875, -111.3914582707317, -141.71457308827908], "episode_lengths": [1600, 75, 73, 122, 65, 57, 1600, 89, 1600, 50, 57, 49, 84, 53, 100, 57, 79, 1245, 37, 89, 1407, 73, 99, 58, 60, 81, 1600, 1230, 735, 1600, 49, 116, 62, 1366, 54, 1353, 73, 161, 76, 83, 196, 1600, 1600, 74, 104, 1600, 87, 40, 1600, 78, 72, 65, 76, 54, 1600, 95, 184, 79, 1600, 62, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3699175504406439, "mean_inference_ms": 1.2398677861288478, "mean_action_processing_ms": 0.23685826430184015, "mean_env_wait_ms": 0.47391848970814476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007618841577748783, "StateBufferConnector_ms": 0.0052510714921794955, "ViewRequirementAgentConnector_ms": 0.14440075295870422}}, "episode_reward_max": -100.08605692698497, "episode_reward_min": -225.4935192884377, "episode_reward_mean": -124.20081541878771, "episode_len_mean": 491.5245901639344, "episodes_this_iter": 3, "episodes_timesteps_total": 29983, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-117.86402474794237, -106.17705658237884, -105.47617446869239, -101.47808510866575, -112.10230150072836, -102.71106771712378, -106.55139941615485, -119.99187985174297, -115.44447814442329, -105.05783314400104, -106.43909637518723, -113.69735318632112, -108.41370915803748, -102.06718632235254, -108.26197980482132, -100.47906191585648, -113.24163094989707, -210.08591263714916, -107.28822882625524, -120.5692908932368, -225.32522422382362, -102.58423405726937, -115.83474722360137, -107.29658268793114, -112.9025480714223, -101.36300081752427, -117.26013905547508, -214.82475130915591, -176.55355417474476, -131.77975427607385, -103.59887231908365, -103.54657603090132, -117.69297798024304, -225.4935192884377, -109.78245960149418, -222.38940802688842, -100.08605692698497, -133.85475837077075, -118.45719759115019, -109.18703580505836, -117.9972324553281, -130.11803172424183, -118.69226812656089, -121.2829648088552, -108.25004858669328, -128.1841191137347, -116.16517135825754, -109.27486959394689, -129.63636659248937, -121.83242389203856, -116.1156360745039, -112.26451227215492, -117.90128699942989, -114.67032638365342, -122.6710409705465, -125.12980408831437, -138.2483572175242, -107.22197383919544, -134.27612650056875, -111.3914582707317, -141.71457308827908], "episode_lengths": [1600, 75, 73, 122, 65, 57, 1600, 89, 1600, 50, 57, 49, 84, 53, 100, 57, 79, 1245, 37, 89, 1407, 73, 99, 58, 60, 81, 1600, 1230, 735, 1600, 49, 116, 62, 1366, 54, 1353, 73, 161, 76, 83, 196, 1600, 1600, 74, 104, 1600, 87, 40, 1600, 78, 72, 65, 76, 54, 1600, 95, 184, 79, 1600, 62, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3699175504406439, "mean_inference_ms": 1.2398677861288478, "mean_action_processing_ms": 0.23685826430184015, "mean_env_wait_ms": 0.47391848970814476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007618841577748783, "StateBufferConnector_ms": 0.0052510714921794955, "ViewRequirementAgentConnector_ms": 0.14440075295870422}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 362.04822699969725, "num_env_steps_trained_throughput_per_sec": 362.04822699969725, "timesteps_total": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 11354.696, "restore_workers_time_ms": 0.023, "training_step_time_ms": 11354.639, "sample_time_ms": 4623.342, "load_time_ms": 0.461, "load_throughput": 8670956.005, "learn_time_ms": 6721.409, "learn_throughput": 595.113, "synch_weights_time_ms": 8.807}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 61, "training_iteration": 8, "trial_id": "18483_00000", "date": "2024-04-27_18-19-42", "timestamp": 1714267182, "time_this_iter_s": 11.05262804031372, "time_total_s": 90.87677216529846, "pid": 61200, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 90.87677216529846, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 43.35625, "ram_util_percent": 64.55625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.093872420057174, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5737098969248753, "policy_loss": -0.028959616457903258, "vf_loss": 2.598276508907958, "vf_explained_var": 0.10552751389882897, "kl": 0.021965022696172988, "entropy": 5.93454893737711, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7905.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": -100.08605692698497, "episode_reward_min": -225.4935192884377, "episode_reward_mean": -123.01686609423537, "episode_len_mean": 488.42028985507244, "episode_media": {}, "episodes_this_iter": 8, "episodes_timesteps_total": 33701, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-117.86402474794237, -106.17705658237884, -105.47617446869239, -101.47808510866575, -112.10230150072836, -102.71106771712378, -106.55139941615485, -119.99187985174297, -115.44447814442329, -105.05783314400104, -106.43909637518723, -113.69735318632112, -108.41370915803748, -102.06718632235254, -108.26197980482132, -100.47906191585648, -113.24163094989707, -210.08591263714916, -107.28822882625524, -120.5692908932368, -225.32522422382362, -102.58423405726937, -115.83474722360137, -107.29658268793114, -112.9025480714223, -101.36300081752427, -117.26013905547508, -214.82475130915591, -176.55355417474476, -131.77975427607385, -103.59887231908365, -103.54657603090132, -117.69297798024304, -225.4935192884377, -109.78245960149418, -222.38940802688842, -100.08605692698497, -133.85475837077075, -118.45719759115019, -109.18703580505836, -117.9972324553281, -130.11803172424183, -118.69226812656089, -121.2829648088552, -108.25004858669328, -128.1841191137347, -116.16517135825754, -109.27486959394689, -129.63636659248937, -121.83242389203856, -116.1156360745039, -112.26451227215492, -117.90128699942989, -114.67032638365342, -122.6710409705465, -125.12980408831437, -138.2483572175242, -107.22197383919544, -134.27612650056875, -111.3914582707317, -141.71457308827908, -110.0876244718291, -122.13585767712392, -108.7432033397096, -104.7071009990784, -113.32949340357135, -109.03847561115337, -109.13506782398248, -134.73719662974153], "episode_lengths": [1600, 75, 73, 122, 65, 57, 1600, 89, 1600, 50, 57, 49, 84, 53, 100, 57, 79, 1245, 37, 89, 1407, 73, 99, 58, 60, 81, 1600, 1230, 735, 1600, 49, 116, 62, 1366, 54, 1353, 73, 161, 76, 83, 196, 1600, 1600, 74, 104, 1600, 87, 40, 1600, 78, 72, 65, 76, 54, 1600, 95, 184, 79, 1600, 62, 1600, 1600, 1600, 66, 54, 49, 64, 59, 226]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3688543245298027, "mean_inference_ms": 1.2382221012104389, "mean_action_processing_ms": 0.23676463414612994, "mean_env_wait_ms": 0.4730966014606471, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0075734179952870245, "StateBufferConnector_ms": 0.005287709443465523, "ViewRequirementAgentConnector_ms": 0.14443639395893484}}, "episode_reward_max": -100.08605692698497, "episode_reward_min": -225.4935192884377, "episode_reward_mean": -123.01686609423537, "episode_len_mean": 488.42028985507244, "episodes_this_iter": 8, "episodes_timesteps_total": 33701, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-117.86402474794237, -106.17705658237884, -105.47617446869239, -101.47808510866575, -112.10230150072836, -102.71106771712378, -106.55139941615485, -119.99187985174297, -115.44447814442329, -105.05783314400104, -106.43909637518723, -113.69735318632112, -108.41370915803748, -102.06718632235254, -108.26197980482132, -100.47906191585648, -113.24163094989707, -210.08591263714916, -107.28822882625524, -120.5692908932368, -225.32522422382362, -102.58423405726937, -115.83474722360137, -107.29658268793114, -112.9025480714223, -101.36300081752427, -117.26013905547508, -214.82475130915591, -176.55355417474476, -131.77975427607385, -103.59887231908365, -103.54657603090132, -117.69297798024304, -225.4935192884377, -109.78245960149418, -222.38940802688842, -100.08605692698497, -133.85475837077075, -118.45719759115019, -109.18703580505836, -117.9972324553281, -130.11803172424183, -118.69226812656089, -121.2829648088552, -108.25004858669328, -128.1841191137347, -116.16517135825754, -109.27486959394689, -129.63636659248937, -121.83242389203856, -116.1156360745039, -112.26451227215492, -117.90128699942989, -114.67032638365342, -122.6710409705465, -125.12980408831437, -138.2483572175242, -107.22197383919544, -134.27612650056875, -111.3914582707317, -141.71457308827908, -110.0876244718291, -122.13585767712392, -108.7432033397096, -104.7071009990784, -113.32949340357135, -109.03847561115337, -109.13506782398248, -134.73719662974153], "episode_lengths": [1600, 75, 73, 122, 65, 57, 1600, 89, 1600, 50, 57, 49, 84, 53, 100, 57, 79, 1245, 37, 89, 1407, 73, 99, 58, 60, 81, 1600, 1230, 735, 1600, 49, 116, 62, 1366, 54, 1353, 73, 161, 76, 83, 196, 1600, 1600, 74, 104, 1600, 87, 40, 1600, 78, 72, 65, 76, 54, 1600, 95, 184, 79, 1600, 62, 1600, 1600, 1600, 66, 54, 49, 64, 59, 226]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3688543245298027, "mean_inference_ms": 1.2382221012104389, "mean_action_processing_ms": 0.23676463414612994, "mean_env_wait_ms": 0.4730966014606471, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0075734179952870245, "StateBufferConnector_ms": 0.005287709443465523, "ViewRequirementAgentConnector_ms": 0.14443639395893484}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 332.50865562775397, "num_env_steps_trained_throughput_per_sec": 332.50865562775397, "timesteps_total": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 11429.705, "restore_workers_time_ms": 0.022, "training_step_time_ms": 11429.649, "sample_time_ms": 4650.589, "load_time_ms": 0.467, "load_throughput": 8572925.907, "learn_time_ms": 6769.133, "learn_throughput": 590.918, "synch_weights_time_ms": 8.846}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 69, "training_iteration": 9, "trial_id": "18483_00000", "date": "2024-04-27_18-19-54", "timestamp": 1714267194, "time_this_iter_s": 12.037099123001099, "time_total_s": 102.91387128829956, "pid": 61200, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 102.91387128829956, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 49.905882352941184, "ram_util_percent": 64.89999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.868692983799082, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8943981279724187, "policy_loss": -0.0345051430406109, "vf_loss": 1.923371997283351, "vf_explained_var": 0.17424711476090135, "kl": 0.018437560249684744, "entropy": 5.808233603098059, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8835.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": -100.08605692698497, "episode_reward_min": -225.4935192884377, "episode_reward_mean": -122.02445749964241, "episode_len_mean": 498.9871794871795, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 38921, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-117.86402474794237, -106.17705658237884, -105.47617446869239, -101.47808510866575, -112.10230150072836, -102.71106771712378, -106.55139941615485, -119.99187985174297, -115.44447814442329, -105.05783314400104, -106.43909637518723, -113.69735318632112, -108.41370915803748, -102.06718632235254, -108.26197980482132, -100.47906191585648, -113.24163094989707, -210.08591263714916, -107.28822882625524, -120.5692908932368, -225.32522422382362, -102.58423405726937, -115.83474722360137, -107.29658268793114, -112.9025480714223, -101.36300081752427, -117.26013905547508, -214.82475130915591, -176.55355417474476, -131.77975427607385, -103.59887231908365, -103.54657603090132, -117.69297798024304, -225.4935192884377, -109.78245960149418, -222.38940802688842, -100.08605692698497, -133.85475837077075, -118.45719759115019, -109.18703580505836, -117.9972324553281, -130.11803172424183, -118.69226812656089, -121.2829648088552, -108.25004858669328, -128.1841191137347, -116.16517135825754, -109.27486959394689, -129.63636659248937, -121.83242389203856, -116.1156360745039, -112.26451227215492, -117.90128699942989, -114.67032638365342, -122.6710409705465, -125.12980408831437, -138.2483572175242, -107.22197383919544, -134.27612650056875, -111.3914582707317, -141.71457308827908, -110.0876244718291, -122.13585767712392, -108.7432033397096, -104.7071009990784, -113.32949340357135, -109.03847561115337, -109.13506782398248, -134.73719662974153, -136.5072860509906, -115.36288643464566, -107.85009866224912, -108.90557783480547, -110.28488156177661, -118.19726827953258, -108.47294992873942, -112.21916346014416, -111.94381225698442], "episode_lengths": [1600, 75, 73, 122, 65, 57, 1600, 89, 1600, 50, 57, 49, 84, 53, 100, 57, 79, 1245, 37, 89, 1407, 73, 99, 58, 60, 81, 1600, 1230, 735, 1600, 49, 116, 62, 1366, 54, 1353, 73, 161, 76, 83, 196, 1600, 1600, 74, 104, 1600, 87, 40, 1600, 78, 72, 65, 76, 54, 1600, 95, 184, 79, 1600, 62, 1600, 1600, 1600, 66, 54, 49, 64, 59, 226, 1600, 1600, 52, 79, 63, 1600, 85, 59, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3690101400664822, "mean_inference_ms": 1.2374511401559578, "mean_action_processing_ms": 0.23662508022017234, "mean_env_wait_ms": 0.4729502105997091, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0077210939847506006, "StateBufferConnector_ms": 0.005335074204664964, "ViewRequirementAgentConnector_ms": 0.14787453871506911}}, "episode_reward_max": -100.08605692698497, "episode_reward_min": -225.4935192884377, "episode_reward_mean": -122.02445749964241, "episode_len_mean": 498.9871794871795, "episodes_this_iter": 9, "episodes_timesteps_total": 38921, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-117.86402474794237, -106.17705658237884, -105.47617446869239, -101.47808510866575, -112.10230150072836, -102.71106771712378, -106.55139941615485, -119.99187985174297, -115.44447814442329, -105.05783314400104, -106.43909637518723, -113.69735318632112, -108.41370915803748, -102.06718632235254, -108.26197980482132, -100.47906191585648, -113.24163094989707, -210.08591263714916, -107.28822882625524, -120.5692908932368, -225.32522422382362, -102.58423405726937, -115.83474722360137, -107.29658268793114, -112.9025480714223, -101.36300081752427, -117.26013905547508, -214.82475130915591, -176.55355417474476, -131.77975427607385, -103.59887231908365, -103.54657603090132, -117.69297798024304, -225.4935192884377, -109.78245960149418, -222.38940802688842, -100.08605692698497, -133.85475837077075, -118.45719759115019, -109.18703580505836, -117.9972324553281, -130.11803172424183, -118.69226812656089, -121.2829648088552, -108.25004858669328, -128.1841191137347, -116.16517135825754, -109.27486959394689, -129.63636659248937, -121.83242389203856, -116.1156360745039, -112.26451227215492, -117.90128699942989, -114.67032638365342, -122.6710409705465, -125.12980408831437, -138.2483572175242, -107.22197383919544, -134.27612650056875, -111.3914582707317, -141.71457308827908, -110.0876244718291, -122.13585767712392, -108.7432033397096, -104.7071009990784, -113.32949340357135, -109.03847561115337, -109.13506782398248, -134.73719662974153, -136.5072860509906, -115.36288643464566, -107.85009866224912, -108.90557783480547, -110.28488156177661, -118.19726827953258, -108.47294992873942, -112.21916346014416, -111.94381225698442], "episode_lengths": [1600, 75, 73, 122, 65, 57, 1600, 89, 1600, 50, 57, 49, 84, 53, 100, 57, 79, 1245, 37, 89, 1407, 73, 99, 58, 60, 81, 1600, 1230, 735, 1600, 49, 116, 62, 1366, 54, 1353, 73, 161, 76, 83, 196, 1600, 1600, 74, 104, 1600, 87, 40, 1600, 78, 72, 65, 76, 54, 1600, 95, 184, 79, 1600, 62, 1600, 1600, 1600, 66, 54, 49, 64, 59, 226, 1600, 1600, 52, 79, 63, 1600, 85, 59, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3690101400664822, "mean_inference_ms": 1.2374511401559578, "mean_action_processing_ms": 0.23662508022017234, "mean_env_wait_ms": 0.4729502105997091, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0077210939847506006, "StateBufferConnector_ms": 0.005335074204664964, "ViewRequirementAgentConnector_ms": 0.14787453871506911}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.9547636001613, "num_env_steps_trained_throughput_per_sec": 317.9547636001613, "timesteps_total": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 11544.776, "restore_workers_time_ms": 0.021, "training_step_time_ms": 11544.722, "sample_time_ms": 4675.296, "load_time_ms": 0.455, "load_throughput": 8783422.857, "learn_time_ms": 6859.54, "learn_throughput": 583.129, "synch_weights_time_ms": 8.82}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 78, "training_iteration": 10, "trial_id": "18483_00000", "date": "2024-04-27_18-20-07", "timestamp": 1714267207, "time_this_iter_s": 12.58536672592163, "time_total_s": 115.49923801422119, "pid": 61200, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 115.49923801422119, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 44.47222222222222, "ram_util_percent": 65.62777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.03573927969061, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0458543593434477, "policy_loss": -0.02162175700268758, "vf_loss": 2.062901290025442, "vf_explained_var": 0.25077601081581524, "kl": 0.015249415149273499, "entropy": 5.650557461605277, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9765.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "sampler_results": {"episode_reward_max": -100.08605692698497, "episode_reward_min": -225.4935192884377, "episode_reward_mean": -122.96605557957004, "episode_len_mean": 531.390243902439, "episode_media": {}, "episodes_this_iter": 4, "episodes_timesteps_total": 43574, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-117.86402474794237, -106.17705658237884, -105.47617446869239, -101.47808510866575, -112.10230150072836, -102.71106771712378, -106.55139941615485, -119.99187985174297, -115.44447814442329, -105.05783314400104, -106.43909637518723, -113.69735318632112, -108.41370915803748, -102.06718632235254, -108.26197980482132, -100.47906191585648, -113.24163094989707, -210.08591263714916, -107.28822882625524, -120.5692908932368, -225.32522422382362, -102.58423405726937, -115.83474722360137, -107.29658268793114, -112.9025480714223, -101.36300081752427, -117.26013905547508, -214.82475130915591, -176.55355417474476, -131.77975427607385, -103.59887231908365, -103.54657603090132, -117.69297798024304, -225.4935192884377, -109.78245960149418, -222.38940802688842, -100.08605692698497, -133.85475837077075, -118.45719759115019, -109.18703580505836, -117.9972324553281, -130.11803172424183, -118.69226812656089, -121.2829648088552, -108.25004858669328, -128.1841191137347, -116.16517135825754, -109.27486959394689, -129.63636659248937, -121.83242389203856, -116.1156360745039, -112.26451227215492, -117.90128699942989, -114.67032638365342, -122.6710409705465, -125.12980408831437, -138.2483572175242, -107.22197383919544, -134.27612650056875, -111.3914582707317, -141.71457308827908, -110.0876244718291, -122.13585767712392, -108.7432033397096, -104.7071009990784, -113.32949340357135, -109.03847561115337, -109.13506782398248, -134.73719662974153, -136.5072860509906, -115.36288643464566, -107.85009866224912, -108.90557783480547, -110.28488156177661, -118.19726827953258, -108.47294992873942, -112.21916346014416, -111.94381225698442, -114.12724515745789, -118.47782343002577, -109.36109784013222, -223.3427061250187], "episode_lengths": [1600, 75, 73, 122, 65, 57, 1600, 89, 1600, 50, 57, 49, 84, 53, 100, 57, 79, 1245, 37, 89, 1407, 73, 99, 58, 60, 81, 1600, 1230, 735, 1600, 49, 116, 62, 1366, 54, 1353, 73, 161, 76, 83, 196, 1600, 1600, 74, 104, 1600, 87, 40, 1600, 78, 72, 65, 76, 54, 1600, 95, 184, 79, 1600, 62, 1600, 1600, 1600, 66, 54, 49, 64, 59, 226, 1600, 1600, 52, 79, 63, 1600, 85, 59, 82, 52, 1600, 1600, 1401]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3689708264266788, "mean_inference_ms": 1.237180149254167, "mean_action_processing_ms": 0.23658838898960705, "mean_env_wait_ms": 0.47289507930112, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0076901621934844224, "StateBufferConnector_ms": 0.00535802143376048, "ViewRequirementAgentConnector_ms": 0.14746305419177544}}, "episode_reward_max": -100.08605692698497, "episode_reward_min": -225.4935192884377, "episode_reward_mean": -122.96605557957004, "episode_len_mean": 531.390243902439, "episodes_this_iter": 4, "episodes_timesteps_total": 43574, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-117.86402474794237, -106.17705658237884, -105.47617446869239, -101.47808510866575, -112.10230150072836, -102.71106771712378, -106.55139941615485, -119.99187985174297, -115.44447814442329, -105.05783314400104, -106.43909637518723, -113.69735318632112, -108.41370915803748, -102.06718632235254, -108.26197980482132, -100.47906191585648, -113.24163094989707, -210.08591263714916, -107.28822882625524, -120.5692908932368, -225.32522422382362, -102.58423405726937, -115.83474722360137, -107.29658268793114, -112.9025480714223, -101.36300081752427, -117.26013905547508, -214.82475130915591, -176.55355417474476, -131.77975427607385, -103.59887231908365, -103.54657603090132, -117.69297798024304, -225.4935192884377, -109.78245960149418, -222.38940802688842, -100.08605692698497, -133.85475837077075, -118.45719759115019, -109.18703580505836, -117.9972324553281, -130.11803172424183, -118.69226812656089, -121.2829648088552, -108.25004858669328, -128.1841191137347, -116.16517135825754, -109.27486959394689, -129.63636659248937, -121.83242389203856, -116.1156360745039, -112.26451227215492, -117.90128699942989, -114.67032638365342, -122.6710409705465, -125.12980408831437, -138.2483572175242, -107.22197383919544, -134.27612650056875, -111.3914582707317, -141.71457308827908, -110.0876244718291, -122.13585767712392, -108.7432033397096, -104.7071009990784, -113.32949340357135, -109.03847561115337, -109.13506782398248, -134.73719662974153, -136.5072860509906, -115.36288643464566, -107.85009866224912, -108.90557783480547, -110.28488156177661, -118.19726827953258, -108.47294992873942, -112.21916346014416, -111.94381225698442, -114.12724515745789, -118.47782343002577, -109.36109784013222, -223.3427061250187], "episode_lengths": [1600, 75, 73, 122, 65, 57, 1600, 89, 1600, 50, 57, 49, 84, 53, 100, 57, 79, 1245, 37, 89, 1407, 73, 99, 58, 60, 81, 1600, 1230, 735, 1600, 49, 116, 62, 1366, 54, 1353, 73, 161, 76, 83, 196, 1600, 1600, 74, 104, 1600, 87, 40, 1600, 78, 72, 65, 76, 54, 1600, 95, 184, 79, 1600, 62, 1600, 1600, 1600, 66, 54, 49, 64, 59, 226, 1600, 1600, 52, 79, 63, 1600, 85, 59, 82, 52, 1600, 1600, 1401]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3689708264266788, "mean_inference_ms": 1.237180149254167, "mean_action_processing_ms": 0.23658838898960705, "mean_env_wait_ms": 0.47289507930112, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0076901621934844224, "StateBufferConnector_ms": 0.00535802143376048, "ViewRequirementAgentConnector_ms": 0.14746305419177544}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 342.5342310852724, "num_env_steps_trained_throughput_per_sec": 342.5342310852724, "timesteps_total": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 11576.688, "restore_workers_time_ms": 0.02, "training_step_time_ms": 11576.637, "sample_time_ms": 4685.041, "load_time_ms": 0.468, "load_throughput": 8551078.491, "learn_time_ms": 6881.647, "learn_throughput": 581.256, "synch_weights_time_ms": 8.897}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "episodes_total": 82, "training_iteration": 11, "trial_id": "18483_00000", "date": "2024-04-27_18-20-18", "timestamp": 1714267218, "time_this_iter_s": 11.681860208511353, "time_total_s": 127.18109822273254, "pid": 61200, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 127.18109822273254, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 46.094117647058816, "ram_util_percent": 64.22941176470589}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.595887602144671, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6507102637484128, "policy_loss": -0.03261760397944399, "vf_loss": 1.678934173610422, "vf_explained_var": 0.2856118441268962, "kl": 0.014645616182213593, "entropy": 5.7760338634573, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10695.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": -100.08605692698497, "episode_reward_min": -225.4935192884377, "episode_reward_mean": -122.29911359708666, "episode_len_mean": 539.8850574712644, "episode_media": {}, "episodes_this_iter": 5, "episodes_timesteps_total": 46970, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-117.86402474794237, -106.17705658237884, -105.47617446869239, -101.47808510866575, -112.10230150072836, -102.71106771712378, -106.55139941615485, -119.99187985174297, -115.44447814442329, -105.05783314400104, -106.43909637518723, -113.69735318632112, -108.41370915803748, -102.06718632235254, -108.26197980482132, -100.47906191585648, -113.24163094989707, -210.08591263714916, -107.28822882625524, -120.5692908932368, -225.32522422382362, -102.58423405726937, -115.83474722360137, -107.29658268793114, -112.9025480714223, -101.36300081752427, -117.26013905547508, -214.82475130915591, -176.55355417474476, -131.77975427607385, -103.59887231908365, -103.54657603090132, -117.69297798024304, -225.4935192884377, -109.78245960149418, -222.38940802688842, -100.08605692698497, -133.85475837077075, -118.45719759115019, -109.18703580505836, -117.9972324553281, -130.11803172424183, -118.69226812656089, -121.2829648088552, -108.25004858669328, -128.1841191137347, -116.16517135825754, -109.27486959394689, -129.63636659248937, -121.83242389203856, -116.1156360745039, -112.26451227215492, -117.90128699942989, -114.67032638365342, -122.6710409705465, -125.12980408831437, -138.2483572175242, -107.22197383919544, -134.27612650056875, -111.3914582707317, -141.71457308827908, -110.0876244718291, -122.13585767712392, -108.7432033397096, -104.7071009990784, -113.32949340357135, -109.03847561115337, -109.13506782398248, -134.73719662974153, -136.5072860509906, -115.36288643464566, -107.85009866224912, -108.90557783480547, -110.28488156177661, -118.19726827953258, -108.47294992873942, -112.21916346014416, -111.94381225698442, -114.12724515745789, -118.47782343002577, -109.36109784013222, -223.3427061250187, -112.11248990356115, -110.86285228432715, -114.45061551271131, -110.42187315593411, -108.95849456526463], "episode_lengths": [1600, 75, 73, 122, 65, 57, 1600, 89, 1600, 50, 57, 49, 84, 53, 100, 57, 79, 1245, 37, 89, 1407, 73, 99, 58, 60, 81, 1600, 1230, 735, 1600, 49, 116, 62, 1366, 54, 1353, 73, 161, 76, 83, 196, 1600, 1600, 74, 104, 1600, 87, 40, 1600, 78, 72, 65, 76, 54, 1600, 95, 184, 79, 1600, 62, 1600, 1600, 1600, 66, 54, 49, 64, 59, 226, 1600, 1600, 52, 79, 63, 1600, 85, 59, 82, 52, 1600, 1600, 1401, 1600, 61, 85, 1600, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36930728594159923, "mean_inference_ms": 1.2380091130818298, "mean_action_processing_ms": 0.23672901746069763, "mean_env_wait_ms": 0.47332780594425444, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007862058179131869, "StateBufferConnector_ms": 0.005371817227067618, "ViewRequirementAgentConnector_ms": 0.14841446931334748}}, "episode_reward_max": -100.08605692698497, "episode_reward_min": -225.4935192884377, "episode_reward_mean": -122.29911359708666, "episode_len_mean": 539.8850574712644, "episodes_this_iter": 5, "episodes_timesteps_total": 46970, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-117.86402474794237, -106.17705658237884, -105.47617446869239, -101.47808510866575, -112.10230150072836, -102.71106771712378, -106.55139941615485, -119.99187985174297, -115.44447814442329, -105.05783314400104, -106.43909637518723, -113.69735318632112, -108.41370915803748, -102.06718632235254, -108.26197980482132, -100.47906191585648, -113.24163094989707, -210.08591263714916, -107.28822882625524, -120.5692908932368, -225.32522422382362, -102.58423405726937, -115.83474722360137, -107.29658268793114, -112.9025480714223, -101.36300081752427, -117.26013905547508, -214.82475130915591, -176.55355417474476, -131.77975427607385, -103.59887231908365, -103.54657603090132, -117.69297798024304, -225.4935192884377, -109.78245960149418, -222.38940802688842, -100.08605692698497, -133.85475837077075, -118.45719759115019, -109.18703580505836, -117.9972324553281, -130.11803172424183, -118.69226812656089, -121.2829648088552, -108.25004858669328, -128.1841191137347, -116.16517135825754, -109.27486959394689, -129.63636659248937, -121.83242389203856, -116.1156360745039, -112.26451227215492, -117.90128699942989, -114.67032638365342, -122.6710409705465, -125.12980408831437, -138.2483572175242, -107.22197383919544, -134.27612650056875, -111.3914582707317, -141.71457308827908, -110.0876244718291, -122.13585767712392, -108.7432033397096, -104.7071009990784, -113.32949340357135, -109.03847561115337, -109.13506782398248, -134.73719662974153, -136.5072860509906, -115.36288643464566, -107.85009866224912, -108.90557783480547, -110.28488156177661, -118.19726827953258, -108.47294992873942, -112.21916346014416, -111.94381225698442, -114.12724515745789, -118.47782343002577, -109.36109784013222, -223.3427061250187, -112.11248990356115, -110.86285228432715, -114.45061551271131, -110.42187315593411, -108.95849456526463], "episode_lengths": [1600, 75, 73, 122, 65, 57, 1600, 89, 1600, 50, 57, 49, 84, 53, 100, 57, 79, 1245, 37, 89, 1407, 73, 99, 58, 60, 81, 1600, 1230, 735, 1600, 49, 116, 62, 1366, 54, 1353, 73, 161, 76, 83, 196, 1600, 1600, 74, 104, 1600, 87, 40, 1600, 78, 72, 65, 76, 54, 1600, 95, 184, 79, 1600, 62, 1600, 1600, 1600, 66, 54, 49, 64, 59, 226, 1600, 1600, 52, 79, 63, 1600, 85, 59, 82, 52, 1600, 1600, 1401, 1600, 61, 85, 1600, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36930728594159923, "mean_inference_ms": 1.2380091130818298, "mean_action_processing_ms": 0.23672901746069763, "mean_env_wait_ms": 0.47332780594425444, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007862058179131869, "StateBufferConnector_ms": 0.005371817227067618, "ViewRequirementAgentConnector_ms": 0.14841446931334748}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.0636141010739, "num_env_steps_trained_throughput_per_sec": 317.0636141010739, "timesteps_total": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 11649.8, "restore_workers_time_ms": 0.016, "training_step_time_ms": 11649.755, "sample_time_ms": 4764.01, "load_time_ms": 0.454, "load_throughput": 8807399.864, "learn_time_ms": 6875.949, "learn_throughput": 581.738, "synch_weights_time_ms": 8.757}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 87, "training_iteration": 12, "trial_id": "18483_00000", "date": "2024-04-27_18-20-31", "timestamp": 1714267231, "time_this_iter_s": 12.62023663520813, "time_total_s": 139.80133485794067, "pid": 61200, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 139.80133485794067, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 46.93333333333333, "ram_util_percent": 65.15}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.195376340932743, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.363194382538198, "policy_loss": -0.02711920034020178, "vf_loss": 2.3856121126281957, "vf_explained_var": 0.2879275361696879, "kl": 0.015671558665980575, "entropy": 5.751846030963365, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11625.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "sampler_results": {"episode_reward_max": -100.08605692698497, "episode_reward_min": -225.4935192884377, "episode_reward_mean": -122.6215459818892, "episode_len_mean": 555.4347826086956, "episode_media": {}, "episodes_this_iter": 5, "episodes_timesteps_total": 51100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-117.86402474794237, -106.17705658237884, -105.47617446869239, -101.47808510866575, -112.10230150072836, -102.71106771712378, -106.55139941615485, -119.99187985174297, -115.44447814442329, -105.05783314400104, -106.43909637518723, -113.69735318632112, -108.41370915803748, -102.06718632235254, -108.26197980482132, -100.47906191585648, -113.24163094989707, -210.08591263714916, -107.28822882625524, -120.5692908932368, -225.32522422382362, -102.58423405726937, -115.83474722360137, -107.29658268793114, -112.9025480714223, -101.36300081752427, -117.26013905547508, -214.82475130915591, -176.55355417474476, -131.77975427607385, -103.59887231908365, -103.54657603090132, -117.69297798024304, -225.4935192884377, -109.78245960149418, -222.38940802688842, -100.08605692698497, -133.85475837077075, -118.45719759115019, -109.18703580505836, -117.9972324553281, -130.11803172424183, -118.69226812656089, -121.2829648088552, -108.25004858669328, -128.1841191137347, -116.16517135825754, -109.27486959394689, -129.63636659248937, -121.83242389203856, -116.1156360745039, -112.26451227215492, -117.90128699942989, -114.67032638365342, -122.6710409705465, -125.12980408831437, -138.2483572175242, -107.22197383919544, -134.27612650056875, -111.3914582707317, -141.71457308827908, -110.0876244718291, -122.13585767712392, -108.7432033397096, -104.7071009990784, -113.32949340357135, -109.03847561115337, -109.13506782398248, -134.73719662974153, -136.5072860509906, -115.36288643464566, -107.85009866224912, -108.90557783480547, -110.28488156177661, -118.19726827953258, -108.47294992873942, -112.21916346014416, -111.94381225698442, -114.12724515745789, -118.47782343002577, -109.36109784013222, -223.3427061250187, -112.11248990356115, -110.86285228432715, -114.45061551271131, -110.42187315593411, -108.95849456526463, -117.24383048786382, -107.5561403732008, -124.2558574964193, -177.33671534051496, -114.76680368926695], "episode_lengths": [1600, 75, 73, 122, 65, 57, 1600, 89, 1600, 50, 57, 49, 84, 53, 100, 57, 79, 1245, 37, 89, 1407, 73, 99, 58, 60, 81, 1600, 1230, 735, 1600, 49, 116, 62, 1366, 54, 1353, 73, 161, 76, 83, 196, 1600, 1600, 74, 104, 1600, 87, 40, 1600, 78, 72, 65, 76, 54, 1600, 95, 184, 79, 1600, 62, 1600, 1600, 1600, 66, 54, 49, 64, 59, 226, 1600, 1600, 52, 79, 63, 1600, 85, 59, 82, 52, 1600, 1600, 1401, 1600, 61, 85, 1600, 50, 1600, 87, 95, 748, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36957932588871917, "mean_inference_ms": 1.2388400535278132, "mean_action_processing_ms": 0.23687132814381415, "mean_env_wait_ms": 0.4737655126954358, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00794115273848824, "StateBufferConnector_ms": 0.005350164745164954, "ViewRequirementAgentConnector_ms": 0.14835285103839377}}, "episode_reward_max": -100.08605692698497, "episode_reward_min": -225.4935192884377, "episode_reward_mean": -122.6215459818892, "episode_len_mean": 555.4347826086956, "episodes_this_iter": 5, "episodes_timesteps_total": 51100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-117.86402474794237, -106.17705658237884, -105.47617446869239, -101.47808510866575, -112.10230150072836, -102.71106771712378, -106.55139941615485, -119.99187985174297, -115.44447814442329, -105.05783314400104, -106.43909637518723, -113.69735318632112, -108.41370915803748, -102.06718632235254, -108.26197980482132, -100.47906191585648, -113.24163094989707, -210.08591263714916, -107.28822882625524, -120.5692908932368, -225.32522422382362, -102.58423405726937, -115.83474722360137, -107.29658268793114, -112.9025480714223, -101.36300081752427, -117.26013905547508, -214.82475130915591, -176.55355417474476, -131.77975427607385, -103.59887231908365, -103.54657603090132, -117.69297798024304, -225.4935192884377, -109.78245960149418, -222.38940802688842, -100.08605692698497, -133.85475837077075, -118.45719759115019, -109.18703580505836, -117.9972324553281, -130.11803172424183, -118.69226812656089, -121.2829648088552, -108.25004858669328, -128.1841191137347, -116.16517135825754, -109.27486959394689, -129.63636659248937, -121.83242389203856, -116.1156360745039, -112.26451227215492, -117.90128699942989, -114.67032638365342, -122.6710409705465, -125.12980408831437, -138.2483572175242, -107.22197383919544, -134.27612650056875, -111.3914582707317, -141.71457308827908, -110.0876244718291, -122.13585767712392, -108.7432033397096, -104.7071009990784, -113.32949340357135, -109.03847561115337, -109.13506782398248, -134.73719662974153, -136.5072860509906, -115.36288643464566, -107.85009866224912, -108.90557783480547, -110.28488156177661, -118.19726827953258, -108.47294992873942, -112.21916346014416, -111.94381225698442, -114.12724515745789, -118.47782343002577, -109.36109784013222, -223.3427061250187, -112.11248990356115, -110.86285228432715, -114.45061551271131, -110.42187315593411, -108.95849456526463, -117.24383048786382, -107.5561403732008, -124.2558574964193, -177.33671534051496, -114.76680368926695], "episode_lengths": [1600, 75, 73, 122, 65, 57, 1600, 89, 1600, 50, 57, 49, 84, 53, 100, 57, 79, 1245, 37, 89, 1407, 73, 99, 58, 60, 81, 1600, 1230, 735, 1600, 49, 116, 62, 1366, 54, 1353, 73, 161, 76, 83, 196, 1600, 1600, 74, 104, 1600, 87, 40, 1600, 78, 72, 65, 76, 54, 1600, 95, 184, 79, 1600, 62, 1600, 1600, 1600, 66, 54, 49, 64, 59, 226, 1600, 1600, 52, 79, 63, 1600, 85, 59, 82, 52, 1600, 1600, 1401, 1600, 61, 85, 1600, 50, 1600, 87, 95, 748, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36957932588871917, "mean_inference_ms": 1.2388400535278132, "mean_action_processing_ms": 0.23687132814381415, "mean_env_wait_ms": 0.4737655126954358, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00794115273848824, "StateBufferConnector_ms": 0.005350164745164954, "ViewRequirementAgentConnector_ms": 0.14835285103839377}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 346.3419672189288, "num_env_steps_trained_throughput_per_sec": 346.3419672189288, "timesteps_total": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 11628.163, "restore_workers_time_ms": 0.017, "training_step_time_ms": 11628.118, "sample_time_ms": 4771.039, "load_time_ms": 0.456, "load_throughput": 8772400.523, "learn_time_ms": 6847.55, "learn_throughput": 584.151, "synch_weights_time_ms": 8.493}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": true, "episodes_total": 92, "training_iteration": 13, "trial_id": "18483_00000", "date": "2024-04-27_18-20-43", "timestamp": 1714267243, "time_this_iter_s": 11.553870916366577, "time_total_s": 151.35520577430725, "pid": 61200, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 151.35520577430725, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 46.175, "ram_util_percent": 64.1125}}
