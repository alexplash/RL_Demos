{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4635594068996367, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 4.999999999999999e-08, "total_loss": 9.298659462057135, "policy_loss": 0.004061726520779312, "vf_loss": 9.29459772212531, "vf_explained_var": -0.00029896882272535756, "kl": 1.5516083074037261e-07, "entropy": 5.668143590291341, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 465.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": -100.3147927513762, "episode_reward_min": -113.66877018753502, "episode_reward_mean": -105.64475312953427, "episode_len_mean": 502.14285714285717, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 3515, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-100.9665273347355, -107.53677974307723, -103.72629878972967, -112.44248012946797, -100.85762297081824, -113.66877018753502, -100.3147927513762], "episode_lengths": [1600, 43, 54, 1600, 79, 79, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3516912851819068, "mean_inference_ms": 1.203044064935001, "mean_action_processing_ms": 0.2284002838548726, "mean_env_wait_ms": 0.4693012621551338, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007660048348563058, "StateBufferConnector_ms": 0.0049114227294921875, "ViewRequirementAgentConnector_ms": 0.13563292367117746}}, "episode_reward_max": -100.3147927513762, "episode_reward_min": -113.66877018753502, "episode_reward_mean": -105.64475312953427, "episode_len_mean": 502.14285714285717, "episodes_this_iter": 7, "episodes_timesteps_total": 3515, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-100.9665273347355, -107.53677974307723, -103.72629878972967, -112.44248012946797, -100.85762297081824, -113.66877018753502, -100.3147927513762], "episode_lengths": [1600, 43, 54, 1600, 79, 79, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3516912851819068, "mean_inference_ms": 1.203044064935001, "mean_action_processing_ms": 0.2284002838548726, "mean_env_wait_ms": 0.4693012621551338, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007660048348563058, "StateBufferConnector_ms": 0.0049114227294921875, "ViewRequirementAgentConnector_ms": 0.13563292367117746}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 352.7310412186891, "num_env_steps_trained_throughput_per_sec": 352.7310412186891, "timesteps_total": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 11340.095, "restore_workers_time_ms": 0.02, "training_step_time_ms": 11340.038, "sample_time_ms": 4560.2, "load_time_ms": 0.807, "load_throughput": 4956341.507, "learn_time_ms": 6769.355, "learn_throughput": 590.898, "synch_weights_time_ms": 8.933}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 7, "training_iteration": 1, "trial_id": "18483_00001", "date": "2024-04-27_18-18-22", "timestamp": 1714267102, "time_this_iter_s": 11.34499716758728, "time_total_s": 11.34499716758728, "pid": 61201, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-08, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 11.34499716758728, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 44.75294117647059, "ram_util_percent": 65.39999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6712542794084035, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 4.999999999999999e-08, "total_loss": 9.831215822568504, "policy_loss": 0.005372123784756148, "vf_loss": 9.825843666445824, "vf_explained_var": -0.0005027174308735837, "kl": 3.3291377214817137e-07, "entropy": 5.667995844605149, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1395.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": -99.75504342977206, "episode_reward_min": -193.37824126062046, "episode_reward_mean": -114.02927320830017, "episode_len_mean": 624.7, "episode_media": {}, "episodes_this_iter": 3, "episodes_timesteps_total": 6247, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-100.9665273347355, -107.53677974307723, -103.72629878972967, -112.44248012946797, -100.85762297081824, -113.66877018753502, -100.3147927513762, -107.64617548586938, -193.37824126062046, -99.75504342977206], "episode_lengths": [1600, 43, 54, 1600, 79, 79, 60, 1600, 1029, 103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3541125758940896, "mean_inference_ms": 1.20950787088427, "mean_action_processing_ms": 0.22934741741733639, "mean_env_wait_ms": 0.4697114952018312, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007510185241699219, "StateBufferConnector_ms": 0.004863739013671875, "ViewRequirementAgentConnector_ms": 0.13730525970458984}}, "episode_reward_max": -99.75504342977206, "episode_reward_min": -193.37824126062046, "episode_reward_mean": -114.02927320830017, "episode_len_mean": 624.7, "episodes_this_iter": 3, "episodes_timesteps_total": 6247, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-100.9665273347355, -107.53677974307723, -103.72629878972967, -112.44248012946797, -100.85762297081824, -113.66877018753502, -100.3147927513762, -107.64617548586938, -193.37824126062046, -99.75504342977206], "episode_lengths": [1600, 43, 54, 1600, 79, 79, 60, 1600, 1029, 103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3541125758940896, "mean_inference_ms": 1.20950787088427, "mean_action_processing_ms": 0.22934741741733639, "mean_env_wait_ms": 0.4697114952018312, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007510185241699219, "StateBufferConnector_ms": 0.004863739013671875, "ViewRequirementAgentConnector_ms": 0.13730525970458984}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 338.60639177787, "num_env_steps_trained_throughput_per_sec": 338.60639177787, "timesteps_total": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 11576.616, "restore_workers_time_ms": 0.022, "training_step_time_ms": 11576.521, "sample_time_ms": 4627.175, "load_time_ms": 0.574, "load_throughput": 6962945.009, "learn_time_ms": 6939.015, "learn_throughput": 576.451, "synch_weights_time_ms": 9.122}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 10, "training_iteration": 2, "trial_id": "18483_00001", "date": "2024-04-27_18-18-34", "timestamp": 1714267114, "time_this_iter_s": 11.818444013595581, "time_total_s": 23.16344118118286, "pid": 61201, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-08, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 23.16344118118286, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 51.205882352941174, "ram_util_percent": 64.71176470588236}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.626507928855317, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 4.999999999999999e-08, "total_loss": 9.644270290866976, "policy_loss": 0.004654810593653751, "vf_loss": 9.639615483437815, "vf_explained_var": -0.00038216729317941975, "kl": 2.779683062697151e-07, "entropy": 5.668362497514294, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2325.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": -99.75504342977206, "episode_reward_min": -193.37824126062046, "episode_reward_mean": -112.9298082574651, "episode_len_mean": 574.7647058823529, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 9771, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-100.9665273347355, -107.53677974307723, -103.72629878972967, -112.44248012946797, -100.85762297081824, -113.66877018753502, -100.3147927513762, -107.64617548586938, -193.37824126062046, -99.75504342977206, -123.99132397749857, -104.31733036092794, -105.61479217483725, -115.97532220628588, -108.33979475233828, -117.98778702973202, -103.28765779228509], "episode_lengths": [1600, 43, 54, 1600, 79, 79, 60, 1600, 1029, 103, 1600, 68, 54, 1600, 78, 61, 63]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3569615931531076, "mean_inference_ms": 1.2182284522101017, "mean_action_processing_ms": 0.2314907637738131, "mean_env_wait_ms": 0.47024772019035366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00717920415541705, "StateBufferConnector_ms": 0.004963313832002527, "ViewRequirementAgentConnector_ms": 0.14075110940372243}}, "episode_reward_max": -99.75504342977206, "episode_reward_min": -193.37824126062046, "episode_reward_mean": -112.9298082574651, "episode_len_mean": 574.7647058823529, "episodes_this_iter": 7, "episodes_timesteps_total": 9771, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-100.9665273347355, -107.53677974307723, -103.72629878972967, -112.44248012946797, -100.85762297081824, -113.66877018753502, -100.3147927513762, -107.64617548586938, -193.37824126062046, -99.75504342977206, -123.99132397749857, -104.31733036092794, -105.61479217483725, -115.97532220628588, -108.33979475233828, -117.98778702973202, -103.28765779228509], "episode_lengths": [1600, 43, 54, 1600, 79, 79, 60, 1600, 1029, 103, 1600, 68, 54, 1600, 78, 61, 63]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3569615931531076, "mean_inference_ms": 1.2182284522101017, "mean_action_processing_ms": 0.2314907637738131, "mean_env_wait_ms": 0.47024772019035366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00717920415541705, "StateBufferConnector_ms": 0.004963313832002527, "ViewRequirementAgentConnector_ms": 0.14075110940372243}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 342.1453368262965, "num_env_steps_trained_throughput_per_sec": 342.1453368262965, "timesteps_total": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 11614.727, "restore_workers_time_ms": 0.019, "training_step_time_ms": 11614.649, "sample_time_ms": 4646.913, "load_time_ms": 0.508, "load_throughput": 7875394.774, "learn_time_ms": 6957.792, "learn_throughput": 574.895, "synch_weights_time_ms": 8.847}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 17, "training_iteration": 3, "trial_id": "18483_00001", "date": "2024-04-27_18-18-46", "timestamp": 1714267126, "time_this_iter_s": 11.695698976516724, "time_total_s": 34.859140157699585, "pid": 61201, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-08, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 34.859140157699585, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 47.43125, "ram_util_percent": 65.39375000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6026253580486263, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 4.999999999999999e-08, "total_loss": 9.515043476576446, "policy_loss": 0.008387605850684947, "vf_loss": 9.506655899170907, "vf_explained_var": -0.0005570143140772337, "kl": 1.8524877451076602e-07, "entropy": 5.668105243354716, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3255.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": -99.75504342977206, "episode_reward_min": -193.37824126062046, "episode_reward_mean": -113.1228374797339, "episode_len_mean": 695.6666666666666, "episode_media": {}, "episodes_this_iter": 4, "episodes_timesteps_total": 14609, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-100.9665273347355, -107.53677974307723, -103.72629878972967, -112.44248012946797, -100.85762297081824, -113.66877018753502, -100.3147927513762, -107.64617548586938, -193.37824126062046, -99.75504342977206, -123.99132397749857, -104.31733036092794, -105.61479217483725, -115.97532220628588, -108.33979475233828, -117.98778702973202, -103.28765779228509, -115.80236757777882, -108.56443154377243, -112.19397289371757, -119.2120746822362], "episode_lengths": [1600, 43, 54, 1600, 79, 79, 60, 1600, 1029, 103, 1600, 68, 54, 1600, 78, 61, 63, 1600, 38, 1600, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3600520470866536, "mean_inference_ms": 1.232326839153708, "mean_action_processing_ms": 0.23411308840994793, "mean_env_wait_ms": 0.4749520247185143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007084437779017857, "StateBufferConnector_ms": 0.005021549406505767, "ViewRequirementAgentConnector_ms": 0.14717692420596168}}, "episode_reward_max": -99.75504342977206, "episode_reward_min": -193.37824126062046, "episode_reward_mean": -113.1228374797339, "episode_len_mean": 695.6666666666666, "episodes_this_iter": 4, "episodes_timesteps_total": 14609, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-100.9665273347355, -107.53677974307723, -103.72629878972967, -112.44248012946797, -100.85762297081824, -113.66877018753502, -100.3147927513762, -107.64617548586938, -193.37824126062046, -99.75504342977206, -123.99132397749857, -104.31733036092794, -105.61479217483725, -115.97532220628588, -108.33979475233828, -117.98778702973202, -103.28765779228509, -115.80236757777882, -108.56443154377243, -112.19397289371757, -119.2120746822362], "episode_lengths": [1600, 43, 54, 1600, 79, 79, 60, 1600, 1029, 103, 1600, 68, 54, 1600, 78, 61, 63, 1600, 38, 1600, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3600520470866536, "mean_inference_ms": 1.232326839153708, "mean_action_processing_ms": 0.23411308840994793, "mean_env_wait_ms": 0.4749520247185143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007084437779017857, "StateBufferConnector_ms": 0.005021549406505767, "ViewRequirementAgentConnector_ms": 0.14717692420596168}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 327.81863142593033, "num_env_steps_trained_throughput_per_sec": 327.81863142593033, "timesteps_total": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 11761.515, "restore_workers_time_ms": 0.018, "training_step_time_ms": 11761.445, "sample_time_ms": 4863.217, "load_time_ms": 0.475, "load_throughput": 8417015.427, "learn_time_ms": 6888.19, "learn_throughput": 580.704, "synch_weights_time_ms": 8.938}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 21, "training_iteration": 4, "trial_id": "18483_00001", "date": "2024-04-27_18-18-58", "timestamp": 1714267138, "time_this_iter_s": 12.20720887184143, "time_total_s": 47.066349029541016, "pid": 61201, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-08, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 47.066349029541016, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 48.53333333333333, "ram_util_percent": 66.00555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5704738482352227, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 4.999999999999999e-08, "total_loss": 9.581787534939345, "policy_loss": -0.020323532417176233, "vf_loss": 9.602111053979526, "vf_explained_var": -0.0008109870777335219, "kl": 1.2163442149992169e-07, "entropy": 5.6668428441529635, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4185.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": -99.75504342977206, "episode_reward_min": -193.37824126062046, "episode_reward_mean": -112.20669994732766, "episode_len_mean": 576.09375, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 18435, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-100.9665273347355, -107.53677974307723, -103.72629878972967, -112.44248012946797, -100.85762297081824, -113.66877018753502, -100.3147927513762, -107.64617548586938, -193.37824126062046, -99.75504342977206, -123.99132397749857, -104.31733036092794, -105.61479217483725, -115.97532220628588, -108.33979475233828, -117.98778702973202, -103.28765779228509, -115.80236757777882, -108.56443154377243, -112.19397289371757, -119.2120746822362, -125.75508894289024, -120.49024091202395, -116.27983054841683, -109.22102970358792, -102.35949248859845, -111.67326691346193, -100.79518969422703, -103.36397470530186, -115.94847880997634, -102.53754972448013, -106.61066879710866], "episode_lengths": [1600, 43, 54, 1600, 79, 79, 60, 1600, 1029, 103, 1600, 68, 54, 1600, 78, 61, 63, 1600, 38, 1600, 1600, 1600, 82, 54, 45, 65, 1600, 70, 95, 68, 83, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36246209320255884, "mean_inference_ms": 1.2422706835971336, "mean_action_processing_ms": 0.23600367692049765, "mean_env_wait_ms": 0.47747666858951, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007029622793197632, "StateBufferConnector_ms": 0.0048860907554626465, "ViewRequirementAgentConnector_ms": 0.1439012587070465}}, "episode_reward_max": -99.75504342977206, "episode_reward_min": -193.37824126062046, "episode_reward_mean": -112.20669994732766, "episode_len_mean": 576.09375, "episodes_this_iter": 11, "episodes_timesteps_total": 18435, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-100.9665273347355, -107.53677974307723, -103.72629878972967, -112.44248012946797, -100.85762297081824, -113.66877018753502, -100.3147927513762, -107.64617548586938, -193.37824126062046, -99.75504342977206, -123.99132397749857, -104.31733036092794, -105.61479217483725, -115.97532220628588, -108.33979475233828, -117.98778702973202, -103.28765779228509, -115.80236757777882, -108.56443154377243, -112.19397289371757, -119.2120746822362, -125.75508894289024, -120.49024091202395, -116.27983054841683, -109.22102970358792, -102.35949248859845, -111.67326691346193, -100.79518969422703, -103.36397470530186, -115.94847880997634, -102.53754972448013, -106.61066879710866], "episode_lengths": [1600, 43, 54, 1600, 79, 79, 60, 1600, 1029, 103, 1600, 68, 54, 1600, 78, 61, 63, 1600, 38, 1600, 1600, 1600, 82, 54, 45, 65, 1600, 70, 95, 68, 83, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36246209320255884, "mean_inference_ms": 1.2422706835971336, "mean_action_processing_ms": 0.23600367692049765, "mean_env_wait_ms": 0.47747666858951, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007029622793197632, "StateBufferConnector_ms": 0.0048860907554626465, "ViewRequirementAgentConnector_ms": 0.1439012587070465}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 379.3078422994988, "num_env_steps_trained_throughput_per_sec": 379.3078422994988, "timesteps_total": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 11518.319, "restore_workers_time_ms": 0.018, "training_step_time_ms": 11518.254, "sample_time_ms": 4751.505, "load_time_ms": 0.495, "load_throughput": 8084626.06, "learn_time_ms": 6756.607, "learn_throughput": 592.013, "synch_weights_time_ms": 9.023}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 32, "training_iteration": 5, "trial_id": "18483_00001", "date": "2024-04-27_18-19-08", "timestamp": 1714267148, "time_this_iter_s": 10.549236059188843, "time_total_s": 57.61558508872986, "pid": 61201, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-08, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 57.61558508872986, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 40.54666666666667, "ram_util_percent": 65.66666666666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.226086963216464, "cur_kl_coeff": 0.006250000000000001, "cur_lr": 4.999999999999999e-08, "total_loss": 9.821166793248986, "policy_loss": 0.006417490413752935, "vf_loss": 9.814749308042629, "vf_explained_var": -0.00036026008667484406, "kl": 2.789444731490637e-07, "entropy": 5.668334989650275, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5115.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": -99.75504342977206, "episode_reward_min": -193.37824126062046, "episode_reward_mean": -113.14906193686895, "episode_len_mean": 473.19565217391306, "episode_media": {}, "episodes_this_iter": 14, "episodes_timesteps_total": 21767, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-100.9665273347355, -107.53677974307723, -103.72629878972967, -112.44248012946797, -100.85762297081824, -113.66877018753502, -100.3147927513762, -107.64617548586938, -193.37824126062046, -99.75504342977206, -123.99132397749857, -104.31733036092794, -105.61479217483725, -115.97532220628588, -108.33979475233828, -117.98778702973202, -103.28765779228509, -115.80236757777882, -108.56443154377243, -112.19397289371757, -119.2120746822362, -125.75508894289024, -120.49024091202395, -116.27983054841683, -109.22102970358792, -102.35949248859845, -111.67326691346193, -100.79518969422703, -103.36397470530186, -115.94847880997634, -102.53754972448013, -106.61066879710866, -109.4425806054372, -120.77363260627725, -101.32210442767727, -109.52026319669187, -112.73291942123944, -104.14201234138943, -117.58834016730077, -104.78888215835516, -108.66498004829076, -129.46583870538012, -178.50659666727603, -108.14864963730301, -109.11960280525187, -100.02604799361465], "episode_lengths": [1600, 43, 54, 1600, 79, 79, 60, 1600, 1029, 103, 1600, 68, 54, 1600, 78, 61, 63, 1600, 38, 1600, 1600, 1600, 82, 54, 45, 65, 1600, 70, 95, 68, 83, 64, 1600, 104, 104, 39, 68, 69, 83, 56, 91, 109, 732, 99, 39, 139]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36237124830475265, "mean_inference_ms": 1.239798362321219, "mean_action_processing_ms": 0.23561335901497354, "mean_env_wait_ms": 0.47622916694627054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069390172543733015, "StateBufferConnector_ms": 0.0047662983769955845, "ViewRequirementAgentConnector_ms": 0.140176130377728}}, "episode_reward_max": -99.75504342977206, "episode_reward_min": -193.37824126062046, "episode_reward_mean": -113.14906193686895, "episode_len_mean": 473.19565217391306, "episodes_this_iter": 14, "episodes_timesteps_total": 21767, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-100.9665273347355, -107.53677974307723, -103.72629878972967, -112.44248012946797, -100.85762297081824, -113.66877018753502, -100.3147927513762, -107.64617548586938, -193.37824126062046, -99.75504342977206, -123.99132397749857, -104.31733036092794, -105.61479217483725, -115.97532220628588, -108.33979475233828, -117.98778702973202, -103.28765779228509, -115.80236757777882, -108.56443154377243, -112.19397289371757, -119.2120746822362, -125.75508894289024, -120.49024091202395, -116.27983054841683, -109.22102970358792, -102.35949248859845, -111.67326691346193, -100.79518969422703, -103.36397470530186, -115.94847880997634, -102.53754972448013, -106.61066879710866, -109.4425806054372, -120.77363260627725, -101.32210442767727, -109.52026319669187, -112.73291942123944, -104.14201234138943, -117.58834016730077, -104.78888215835516, -108.66498004829076, -129.46583870538012, -178.50659666727603, -108.14864963730301, -109.11960280525187, -100.02604799361465], "episode_lengths": [1600, 43, 54, 1600, 79, 79, 60, 1600, 1029, 103, 1600, 68, 54, 1600, 78, 61, 63, 1600, 38, 1600, 1600, 1600, 82, 54, 45, 65, 1600, 70, 95, 68, 83, 64, 1600, 104, 104, 39, 68, 69, 83, 56, 91, 109, 732, 99, 39, 139]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36237124830475265, "mean_inference_ms": 1.239798362321219, "mean_action_processing_ms": 0.23561335901497354, "mean_env_wait_ms": 0.47622916694627054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069390172543733015, "StateBufferConnector_ms": 0.0047662983769955845, "ViewRequirementAgentConnector_ms": 0.140176130377728}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 366.2518652637489, "num_env_steps_trained_throughput_per_sec": 366.2518652637489, "timesteps_total": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 11418.842, "restore_workers_time_ms": 0.017, "training_step_time_ms": 11418.781, "sample_time_ms": 4657.56, "load_time_ms": 0.516, "load_throughput": 7749888.059, "learn_time_ms": 6751.219, "learn_throughput": 592.486, "synch_weights_time_ms": 8.887}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 46, "training_iteration": 6, "trial_id": "18483_00001", "date": "2024-04-27_18-19-19", "timestamp": 1714267159, "time_this_iter_s": 10.926629066467285, "time_total_s": 68.54221415519714, "pid": 61201, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-08, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 68.54221415519714, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 40.220000000000006, "ram_util_percent": 64.53333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.775668595619099, "cur_kl_coeff": 0.0031250000000000006, "cur_lr": 4.999999999999999e-08, "total_loss": 9.208402492410393, "policy_loss": 0.015986579632566823, "vf_loss": 9.192415919355167, "vf_explained_var": -0.00045749372051608175, "kl": 5.35080275067432e-07, "entropy": 5.668184797738188, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6045.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": -99.75504342977206, "episode_reward_min": -193.37824126062046, "episode_reward_mean": -113.50538741351883, "episode_len_mean": 542.1836734693877, "episode_media": {}, "episodes_this_iter": 3, "episodes_timesteps_total": 26567, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-100.9665273347355, -107.53677974307723, -103.72629878972967, -112.44248012946797, -100.85762297081824, -113.66877018753502, -100.3147927513762, -107.64617548586938, -193.37824126062046, -99.75504342977206, -123.99132397749857, -104.31733036092794, -105.61479217483725, -115.97532220628588, -108.33979475233828, -117.98778702973202, -103.28765779228509, -115.80236757777882, -108.56443154377243, -112.19397289371757, -119.2120746822362, -125.75508894289024, -120.49024091202395, -116.27983054841683, -109.22102970358792, -102.35949248859845, -111.67326691346193, -100.79518969422703, -103.36397470530186, -115.94847880997634, -102.53754972448013, -106.61066879710866, -109.4425806054372, -120.77363260627725, -101.32210442767727, -109.52026319669187, -112.73291942123944, -104.14201234138943, -117.58834016730077, -104.78888215835516, -108.66498004829076, -129.46583870538012, -178.50659666727603, -108.14864963730301, -109.11960280525187, -100.02604799361465, -108.71615792149571, -121.74540377845364, -126.44557246650291], "episode_lengths": [1600, 43, 54, 1600, 79, 79, 60, 1600, 1029, 103, 1600, 68, 54, 1600, 78, 61, 63, 1600, 38, 1600, 1600, 1600, 82, 54, 45, 65, 1600, 70, 95, 68, 83, 64, 1600, 104, 104, 39, 68, 69, 83, 56, 91, 109, 732, 99, 39, 139, 1600, 1600, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36220871402064014, "mean_inference_ms": 1.2389653164281278, "mean_action_processing_ms": 0.23547123242858622, "mean_env_wait_ms": 0.47599021973329303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006874240174585459, "StateBufferConnector_ms": 0.004752801389110332, "ViewRequirementAgentConnector_ms": 0.13963543638891104}}, "episode_reward_max": -99.75504342977206, "episode_reward_min": -193.37824126062046, "episode_reward_mean": -113.50538741351883, "episode_len_mean": 542.1836734693877, "episodes_this_iter": 3, "episodes_timesteps_total": 26567, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-100.9665273347355, -107.53677974307723, -103.72629878972967, -112.44248012946797, -100.85762297081824, -113.66877018753502, -100.3147927513762, -107.64617548586938, -193.37824126062046, -99.75504342977206, -123.99132397749857, -104.31733036092794, -105.61479217483725, -115.97532220628588, -108.33979475233828, -117.98778702973202, -103.28765779228509, -115.80236757777882, -108.56443154377243, -112.19397289371757, -119.2120746822362, -125.75508894289024, -120.49024091202395, -116.27983054841683, -109.22102970358792, -102.35949248859845, -111.67326691346193, -100.79518969422703, -103.36397470530186, -115.94847880997634, -102.53754972448013, -106.61066879710866, -109.4425806054372, -120.77363260627725, -101.32210442767727, -109.52026319669187, -112.73291942123944, -104.14201234138943, -117.58834016730077, -104.78888215835516, -108.66498004829076, -129.46583870538012, -178.50659666727603, -108.14864963730301, -109.11960280525187, -100.02604799361465, -108.71615792149571, -121.74540377845364, -126.44557246650291], "episode_lengths": [1600, 43, 54, 1600, 79, 79, 60, 1600, 1029, 103, 1600, 68, 54, 1600, 78, 61, 63, 1600, 38, 1600, 1600, 1600, 82, 54, 45, 65, 1600, 70, 95, 68, 83, 64, 1600, 104, 104, 39, 68, 69, 83, 56, 91, 109, 732, 99, 39, 139, 1600, 1600, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36220871402064014, "mean_inference_ms": 1.2389653164281278, "mean_action_processing_ms": 0.23547123242858622, "mean_env_wait_ms": 0.47599021973329303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006874240174585459, "StateBufferConnector_ms": 0.004752801389110332, "ViewRequirementAgentConnector_ms": 0.13963543638891104}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 363.4433667771157, "num_env_steps_trained_throughput_per_sec": 363.4433667771157, "timesteps_total": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 11359.843, "restore_workers_time_ms": 0.017, "training_step_time_ms": 11359.784, "sample_time_ms": 4629.973, "load_time_ms": 0.501, "load_throughput": 7982634.04, "learn_time_ms": 6720.059, "learn_throughput": 595.233, "synch_weights_time_ms": 8.659}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 49, "training_iteration": 7, "trial_id": "18483_00001", "date": "2024-04-27_18-19-30", "timestamp": 1714267170, "time_this_iter_s": 11.010642051696777, "time_total_s": 79.55285620689392, "pid": 61201, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-08, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 79.55285620689392, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 44.181250000000006, "ram_util_percent": 64.6375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8827513546072028, "cur_kl_coeff": 0.0015625000000000003, "cur_lr": 4.999999999999999e-08, "total_loss": 9.858403529915758, "policy_loss": 0.00581955720660507, "vf_loss": 9.852583948771159, "vf_explained_var": -0.0008677196118139452, "kl": 2.4024312535351867e-07, "entropy": 5.6670859664999025, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6975.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": -99.75504342977206, "episode_reward_min": -193.37824126062046, "episode_reward_mean": -113.03291580272348, "episode_len_mean": 486.7142857142857, "episode_media": {}, "episodes_this_iter": 14, "episodes_timesteps_total": 30663, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-100.9665273347355, -107.53677974307723, -103.72629878972967, -112.44248012946797, -100.85762297081824, -113.66877018753502, -100.3147927513762, -107.64617548586938, -193.37824126062046, -99.75504342977206, -123.99132397749857, -104.31733036092794, -105.61479217483725, -115.97532220628588, -108.33979475233828, -117.98778702973202, -103.28765779228509, -115.80236757777882, -108.56443154377243, -112.19397289371757, -119.2120746822362, -125.75508894289024, -120.49024091202395, -116.27983054841683, -109.22102970358792, -102.35949248859845, -111.67326691346193, -100.79518969422703, -103.36397470530186, -115.94847880997634, -102.53754972448013, -106.61066879710866, -109.4425806054372, -120.77363260627725, -101.32210442767727, -109.52026319669187, -112.73291942123944, -104.14201234138943, -117.58834016730077, -104.78888215835516, -108.66498004829076, -129.46583870538012, -178.50659666727603, -108.14864963730301, -109.11960280525187, -100.02604799361465, -108.71615792149571, -121.74540377845364, -126.44557246650291, -107.37379496690856, -100.8686986759156, -126.87702747674348, -102.35568605415834, -108.67223015701708, -102.46208205309634, -115.44205827328997, -120.91940137352358, -129.28075279126193, -112.70495332071198, -108.84573948096111, -114.00727892658239, -108.06346453592367, -101.43654422306456], "episode_lengths": [1600, 43, 54, 1600, 79, 79, 60, 1600, 1029, 103, 1600, 68, 54, 1600, 78, 61, 63, 1600, 38, 1600, 1600, 1600, 82, 54, 45, 65, 1600, 70, 95, 68, 83, 64, 1600, 104, 104, 39, 68, 69, 83, 56, 91, 109, 732, 99, 39, 139, 1600, 1600, 1600, 1600, 92, 119, 84, 68, 65, 74, 66, 115, 1600, 48, 60, 53, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36176064930293295, "mean_inference_ms": 1.2342782964939887, "mean_action_processing_ms": 0.23469940862762514, "mean_env_wait_ms": 0.4743852915673228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006847154526483445, "StateBufferConnector_ms": 0.004815676855662513, "ViewRequirementAgentConnector_ms": 0.13970079876127697}}, "episode_reward_max": -99.75504342977206, "episode_reward_min": -193.37824126062046, "episode_reward_mean": -113.03291580272348, "episode_len_mean": 486.7142857142857, "episodes_this_iter": 14, "episodes_timesteps_total": 30663, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-100.9665273347355, -107.53677974307723, -103.72629878972967, -112.44248012946797, -100.85762297081824, -113.66877018753502, -100.3147927513762, -107.64617548586938, -193.37824126062046, -99.75504342977206, -123.99132397749857, -104.31733036092794, -105.61479217483725, -115.97532220628588, -108.33979475233828, -117.98778702973202, -103.28765779228509, -115.80236757777882, -108.56443154377243, -112.19397289371757, -119.2120746822362, -125.75508894289024, -120.49024091202395, -116.27983054841683, -109.22102970358792, -102.35949248859845, -111.67326691346193, -100.79518969422703, -103.36397470530186, -115.94847880997634, -102.53754972448013, -106.61066879710866, -109.4425806054372, -120.77363260627725, -101.32210442767727, -109.52026319669187, -112.73291942123944, -104.14201234138943, -117.58834016730077, -104.78888215835516, -108.66498004829076, -129.46583870538012, -178.50659666727603, -108.14864963730301, -109.11960280525187, -100.02604799361465, -108.71615792149571, -121.74540377845364, -126.44557246650291, -107.37379496690856, -100.8686986759156, -126.87702747674348, -102.35568605415834, -108.67223015701708, -102.46208205309634, -115.44205827328997, -120.91940137352358, -129.28075279126193, -112.70495332071198, -108.84573948096111, -114.00727892658239, -108.06346453592367, -101.43654422306456], "episode_lengths": [1600, 43, 54, 1600, 79, 79, 60, 1600, 1029, 103, 1600, 68, 54, 1600, 78, 61, 63, 1600, 38, 1600, 1600, 1600, 82, 54, 45, 65, 1600, 70, 95, 68, 83, 64, 1600, 104, 104, 39, 68, 69, 83, 56, 91, 109, 732, 99, 39, 139, 1600, 1600, 1600, 1600, 92, 119, 84, 68, 65, 74, 66, 115, 1600, 48, 60, 53, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36176064930293295, "mean_inference_ms": 1.2342782964939887, "mean_action_processing_ms": 0.23469940862762514, "mean_env_wait_ms": 0.4743852915673228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006847154526483445, "StateBufferConnector_ms": 0.004815676855662513, "ViewRequirementAgentConnector_ms": 0.13970079876127697}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 361.84781179359356, "num_env_steps_trained_throughput_per_sec": 361.84781179359356, "timesteps_total": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 11321.661, "restore_workers_time_ms": 0.018, "training_step_time_ms": 11321.602, "sample_time_ms": 4604.413, "load_time_ms": 0.51, "load_throughput": 7839362.654, "learn_time_ms": 6707.569, "learn_throughput": 596.341, "synch_weights_time_ms": 8.527}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 63, "training_iteration": 8, "trial_id": "18483_00001", "date": "2024-04-27_18-19-42", "timestamp": 1714267182, "time_this_iter_s": 11.060145854949951, "time_total_s": 90.61300206184387, "pid": 61201, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-08, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 90.61300206184387, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 43.35625, "ram_util_percent": 64.55625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.272167241573334, "cur_kl_coeff": 0.0007812500000000002, "cur_lr": 4.999999999999999e-08, "total_loss": 9.706958520540628, "policy_loss": 0.005862010694960112, "vf_loss": 9.70109654703448, "vf_explained_var": -0.0005355029336867794, "kl": 1.897470072467617e-07, "entropy": 5.667135455531459, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7905.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": -99.67041659420977, "episode_reward_min": -193.37824126062046, "episode_reward_mean": -112.73693609830131, "episode_len_mean": 441.36708860759495, "episode_media": {}, "episodes_this_iter": 16, "episodes_timesteps_total": 34868, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-100.9665273347355, -107.53677974307723, -103.72629878972967, -112.44248012946797, -100.85762297081824, -113.66877018753502, -100.3147927513762, -107.64617548586938, -193.37824126062046, -99.75504342977206, -123.99132397749857, -104.31733036092794, -105.61479217483725, -115.97532220628588, -108.33979475233828, -117.98778702973202, -103.28765779228509, -115.80236757777882, -108.56443154377243, -112.19397289371757, -119.2120746822362, -125.75508894289024, -120.49024091202395, -116.27983054841683, -109.22102970358792, -102.35949248859845, -111.67326691346193, -100.79518969422703, -103.36397470530186, -115.94847880997634, -102.53754972448013, -106.61066879710866, -109.4425806054372, -120.77363260627725, -101.32210442767727, -109.52026319669187, -112.73291942123944, -104.14201234138943, -117.58834016730077, -104.78888215835516, -108.66498004829076, -129.46583870538012, -178.50659666727603, -108.14864963730301, -109.11960280525187, -100.02604799361465, -108.71615792149571, -121.74540377845364, -126.44557246650291, -107.37379496690856, -100.8686986759156, -126.87702747674348, -102.35568605415834, -108.67223015701708, -102.46208205309634, -115.44205827328997, -120.91940137352358, -129.28075279126193, -112.70495332071198, -108.84573948096111, -114.00727892658239, -108.06346453592367, -101.43654422306456, -114.09524803257175, -114.11672183161726, -112.57259399435544, -102.54682336353945, -120.46515106175586, -117.21116257003509, -112.50248490940116, -118.82038026859176, -114.3599675469293, -99.67041659420977, -118.81749162750752, -124.69768136543718, -102.01306060355654, -108.79558293935159, -100.3464075601579, -104.11308192520465], "episode_lengths": [1600, 43, 54, 1600, 79, 79, 60, 1600, 1029, 103, 1600, 68, 54, 1600, 78, 61, 63, 1600, 38, 1600, 1600, 1600, 82, 54, 45, 65, 1600, 70, 95, 68, 83, 64, 1600, 104, 104, 39, 68, 69, 83, 56, 91, 109, 732, 99, 39, 139, 1600, 1600, 1600, 1600, 92, 119, 84, 68, 65, 74, 66, 115, 1600, 48, 60, 53, 52, 79, 62, 51, 80, 1600, 59, 1600, 58, 47, 78, 96, 119, 65, 71, 80, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3620458640309882, "mean_inference_ms": 1.2320754970777108, "mean_action_processing_ms": 0.2344897237741275, "mean_env_wait_ms": 0.47288314654331787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006821185727662678, "StateBufferConnector_ms": 0.004899350902702235, "ViewRequirementAgentConnector_ms": 0.14035399956039235}}, "episode_reward_max": -99.67041659420977, "episode_reward_min": -193.37824126062046, "episode_reward_mean": -112.73693609830131, "episode_len_mean": 441.36708860759495, "episodes_this_iter": 16, "episodes_timesteps_total": 34868, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-100.9665273347355, -107.53677974307723, -103.72629878972967, -112.44248012946797, -100.85762297081824, -113.66877018753502, -100.3147927513762, -107.64617548586938, -193.37824126062046, -99.75504342977206, -123.99132397749857, -104.31733036092794, -105.61479217483725, -115.97532220628588, -108.33979475233828, -117.98778702973202, -103.28765779228509, -115.80236757777882, -108.56443154377243, -112.19397289371757, -119.2120746822362, -125.75508894289024, -120.49024091202395, -116.27983054841683, -109.22102970358792, -102.35949248859845, -111.67326691346193, -100.79518969422703, -103.36397470530186, -115.94847880997634, -102.53754972448013, -106.61066879710866, -109.4425806054372, -120.77363260627725, -101.32210442767727, -109.52026319669187, -112.73291942123944, -104.14201234138943, -117.58834016730077, -104.78888215835516, -108.66498004829076, -129.46583870538012, -178.50659666727603, -108.14864963730301, -109.11960280525187, -100.02604799361465, -108.71615792149571, -121.74540377845364, -126.44557246650291, -107.37379496690856, -100.8686986759156, -126.87702747674348, -102.35568605415834, -108.67223015701708, -102.46208205309634, -115.44205827328997, -120.91940137352358, -129.28075279126193, -112.70495332071198, -108.84573948096111, -114.00727892658239, -108.06346453592367, -101.43654422306456, -114.09524803257175, -114.11672183161726, -112.57259399435544, -102.54682336353945, -120.46515106175586, -117.21116257003509, -112.50248490940116, -118.82038026859176, -114.3599675469293, -99.67041659420977, -118.81749162750752, -124.69768136543718, -102.01306060355654, -108.79558293935159, -100.3464075601579, -104.11308192520465], "episode_lengths": [1600, 43, 54, 1600, 79, 79, 60, 1600, 1029, 103, 1600, 68, 54, 1600, 78, 61, 63, 1600, 38, 1600, 1600, 1600, 82, 54, 45, 65, 1600, 70, 95, 68, 83, 64, 1600, 104, 104, 39, 68, 69, 83, 56, 91, 109, 732, 99, 39, 139, 1600, 1600, 1600, 1600, 92, 119, 84, 68, 65, 74, 66, 115, 1600, 48, 60, 53, 52, 79, 62, 51, 80, 1600, 59, 1600, 58, 47, 78, 96, 119, 65, 71, 80, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3620458640309882, "mean_inference_ms": 1.2320754970777108, "mean_action_processing_ms": 0.2344897237741275, "mean_env_wait_ms": 0.47288314654331787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006821185727662678, "StateBufferConnector_ms": 0.004899350902702235, "ViewRequirementAgentConnector_ms": 0.14035399956039235}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 333.2006929500114, "num_env_steps_trained_throughput_per_sec": 333.2006929500114, "timesteps_total": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 11397.564, "restore_workers_time_ms": 0.018, "training_step_time_ms": 11397.507, "sample_time_ms": 4623.453, "load_time_ms": 0.558, "load_throughput": 7174519.814, "learn_time_ms": 6764.281, "learn_throughput": 591.341, "synch_weights_time_ms": 8.641}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 79, "training_iteration": 9, "trial_id": "18483_00001", "date": "2024-04-27_18-19-54", "timestamp": 1714267194, "time_this_iter_s": 12.010025978088379, "time_total_s": 102.62302803993225, "pid": 61201, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-08, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 102.62302803993225, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 45.98823529411764, "ram_util_percent": 64.89999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.645866858254197, "cur_kl_coeff": 0.0003906250000000001, "cur_lr": 4.999999999999999e-08, "total_loss": 9.560333813390423, "policy_loss": 0.005037842963331489, "vf_loss": 9.555295933959304, "vf_explained_var": -0.0005397710748898085, "kl": 3.1108952538653807e-07, "entropy": 5.668510309342415, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8835.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": -99.67041659420977, "episode_reward_min": -193.37824126062046, "episode_reward_mean": -112.21821758539026, "episode_len_mean": 430.68888888888887, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 38762, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-100.9665273347355, -107.53677974307723, -103.72629878972967, -112.44248012946797, -100.85762297081824, -113.66877018753502, -100.3147927513762, -107.64617548586938, -193.37824126062046, -99.75504342977206, -123.99132397749857, -104.31733036092794, -105.61479217483725, -115.97532220628588, -108.33979475233828, -117.98778702973202, -103.28765779228509, -115.80236757777882, -108.56443154377243, -112.19397289371757, -119.2120746822362, -125.75508894289024, -120.49024091202395, -116.27983054841683, -109.22102970358792, -102.35949248859845, -111.67326691346193, -100.79518969422703, -103.36397470530186, -115.94847880997634, -102.53754972448013, -106.61066879710866, -109.4425806054372, -120.77363260627725, -101.32210442767727, -109.52026319669187, -112.73291942123944, -104.14201234138943, -117.58834016730077, -104.78888215835516, -108.66498004829076, -129.46583870538012, -178.50659666727603, -108.14864963730301, -109.11960280525187, -100.02604799361465, -108.71615792149571, -121.74540377845364, -126.44557246650291, -107.37379496690856, -100.8686986759156, -126.87702747674348, -102.35568605415834, -108.67223015701708, -102.46208205309634, -115.44205827328997, -120.91940137352358, -129.28075279126193, -112.70495332071198, -108.84573948096111, -114.00727892658239, -108.06346453592367, -101.43654422306456, -114.09524803257175, -114.11672183161726, -112.57259399435544, -102.54682336353945, -120.46515106175586, -117.21116257003509, -112.50248490940116, -118.82038026859176, -114.3599675469293, -99.67041659420977, -118.81749162750752, -124.69768136543718, -102.01306060355654, -108.79558293935159, -100.3464075601579, -104.11308192520465, -114.6263300264321, -100.13951265262067, -107.76808419776957, -100.94820716559452, -106.7186558547734, -107.56238851198057, -122.26349451965639, -102.433417669187, -103.30970101681352, -106.61139094173225, -121.04044836276024], "episode_lengths": [1600, 43, 54, 1600, 79, 79, 60, 1600, 1029, 103, 1600, 68, 54, 1600, 78, 61, 63, 1600, 38, 1600, 1600, 1600, 82, 54, 45, 65, 1600, 70, 95, 68, 83, 64, 1600, 104, 104, 39, 68, 69, 83, 56, 91, 109, 732, 99, 39, 139, 1600, 1600, 1600, 1600, 92, 119, 84, 68, 65, 74, 66, 115, 1600, 48, 60, 53, 52, 79, 62, 51, 80, 1600, 59, 1600, 58, 47, 78, 96, 119, 65, 71, 80, 60, 1600, 90, 53, 72, 62, 57, 1600, 113, 55, 51, 141]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3624651760086074, "mean_inference_ms": 1.2314510776490033, "mean_action_processing_ms": 0.23447677514854345, "mean_env_wait_ms": 0.4725895924973107, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00692182117038303, "StateBufferConnector_ms": 0.004953013526068794, "ViewRequirementAgentConnector_ms": 0.14135466681586373}}, "episode_reward_max": -99.67041659420977, "episode_reward_min": -193.37824126062046, "episode_reward_mean": -112.21821758539026, "episode_len_mean": 430.68888888888887, "episodes_this_iter": 11, "episodes_timesteps_total": 38762, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-100.9665273347355, -107.53677974307723, -103.72629878972967, -112.44248012946797, -100.85762297081824, -113.66877018753502, -100.3147927513762, -107.64617548586938, -193.37824126062046, -99.75504342977206, -123.99132397749857, -104.31733036092794, -105.61479217483725, -115.97532220628588, -108.33979475233828, -117.98778702973202, -103.28765779228509, -115.80236757777882, -108.56443154377243, -112.19397289371757, -119.2120746822362, -125.75508894289024, -120.49024091202395, -116.27983054841683, -109.22102970358792, -102.35949248859845, -111.67326691346193, -100.79518969422703, -103.36397470530186, -115.94847880997634, -102.53754972448013, -106.61066879710866, -109.4425806054372, -120.77363260627725, -101.32210442767727, -109.52026319669187, -112.73291942123944, -104.14201234138943, -117.58834016730077, -104.78888215835516, -108.66498004829076, -129.46583870538012, -178.50659666727603, -108.14864963730301, -109.11960280525187, -100.02604799361465, -108.71615792149571, -121.74540377845364, -126.44557246650291, -107.37379496690856, -100.8686986759156, -126.87702747674348, -102.35568605415834, -108.67223015701708, -102.46208205309634, -115.44205827328997, -120.91940137352358, -129.28075279126193, -112.70495332071198, -108.84573948096111, -114.00727892658239, -108.06346453592367, -101.43654422306456, -114.09524803257175, -114.11672183161726, -112.57259399435544, -102.54682336353945, -120.46515106175586, -117.21116257003509, -112.50248490940116, -118.82038026859176, -114.3599675469293, -99.67041659420977, -118.81749162750752, -124.69768136543718, -102.01306060355654, -108.79558293935159, -100.3464075601579, -104.11308192520465, -114.6263300264321, -100.13951265262067, -107.76808419776957, -100.94820716559452, -106.7186558547734, -107.56238851198057, -122.26349451965639, -102.433417669187, -103.30970101681352, -106.61139094173225, -121.04044836276024], "episode_lengths": [1600, 43, 54, 1600, 79, 79, 60, 1600, 1029, 103, 1600, 68, 54, 1600, 78, 61, 63, 1600, 38, 1600, 1600, 1600, 82, 54, 45, 65, 1600, 70, 95, 68, 83, 64, 1600, 104, 104, 39, 68, 69, 83, 56, 91, 109, 732, 99, 39, 139, 1600, 1600, 1600, 1600, 92, 119, 84, 68, 65, 74, 66, 115, 1600, 48, 60, 53, 52, 79, 62, 51, 80, 1600, 59, 1600, 58, 47, 78, 96, 119, 65, 71, 80, 60, 1600, 90, 53, 72, 62, 57, 1600, 113, 55, 51, 141]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3624651760086074, "mean_inference_ms": 1.2314510776490033, "mean_action_processing_ms": 0.23447677514854345, "mean_env_wait_ms": 0.4725895924973107, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00692182117038303, "StateBufferConnector_ms": 0.004953013526068794, "ViewRequirementAgentConnector_ms": 0.14135466681586373}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 318.8603416336367, "num_env_steps_trained_throughput_per_sec": 318.8603416336367, "timesteps_total": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 11512.277, "restore_workers_time_ms": 0.018, "training_step_time_ms": 11512.22, "sample_time_ms": 4642.378, "load_time_ms": 0.581, "load_throughput": 6883807.648, "learn_time_ms": 6860.169, "learn_throughput": 583.076, "synch_weights_time_ms": 8.517}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 90, "training_iteration": 10, "trial_id": "18483_00001", "date": "2024-04-27_18-20-06", "timestamp": 1714267206, "time_this_iter_s": 12.549021244049072, "time_total_s": 115.17204928398132, "pid": 61201, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-08, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 115.17204928398132, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 48.94444444444444, "ram_util_percent": 65.62777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3940373998816296, "cur_kl_coeff": 0.00019531250000000004, "cur_lr": 4.999999999999999e-08, "total_loss": 9.594811768685618, "policy_loss": 0.004773744524166148, "vf_loss": 9.59003802217463, "vf_explained_var": -0.000842614519980646, "kl": 3.725460331163095e-07, "entropy": 5.668799072696316, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9765.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "sampler_results": {"episode_reward_max": -99.67041659420977, "episode_reward_min": -193.37824126062046, "episode_reward_mean": -112.16404741612773, "episode_len_mean": 436.41237113402065, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 42332, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-100.9665273347355, -107.53677974307723, -103.72629878972967, -112.44248012946797, -100.85762297081824, -113.66877018753502, -100.3147927513762, -107.64617548586938, -193.37824126062046, -99.75504342977206, -123.99132397749857, -104.31733036092794, -105.61479217483725, -115.97532220628588, -108.33979475233828, -117.98778702973202, -103.28765779228509, -115.80236757777882, -108.56443154377243, -112.19397289371757, -119.2120746822362, -125.75508894289024, -120.49024091202395, -116.27983054841683, -109.22102970358792, -102.35949248859845, -111.67326691346193, -100.79518969422703, -103.36397470530186, -115.94847880997634, -102.53754972448013, -106.61066879710866, -109.4425806054372, -120.77363260627725, -101.32210442767727, -109.52026319669187, -112.73291942123944, -104.14201234138943, -117.58834016730077, -104.78888215835516, -108.66498004829076, -129.46583870538012, -178.50659666727603, -108.14864963730301, -109.11960280525187, -100.02604799361465, -108.71615792149571, -121.74540377845364, -126.44557246650291, -107.37379496690856, -100.8686986759156, -126.87702747674348, -102.35568605415834, -108.67223015701708, -102.46208205309634, -115.44205827328997, -120.91940137352358, -129.28075279126193, -112.70495332071198, -108.84573948096111, -114.00727892658239, -108.06346453592367, -101.43654422306456, -114.09524803257175, -114.11672183161726, -112.57259399435544, -102.54682336353945, -120.46515106175586, -117.21116257003509, -112.50248490940116, -118.82038026859176, -114.3599675469293, -99.67041659420977, -118.81749162750752, -124.69768136543718, -102.01306060355654, -108.79558293935159, -100.3464075601579, -104.11308192520465, -114.6263300264321, -100.13951265262067, -107.76808419776957, -100.94820716559452, -106.7186558547734, -107.56238851198057, -122.26349451965639, -102.433417669187, -103.30970101681352, -106.61139094173225, -121.04044836276024, -128.24714107024909, -106.00015377605644, -104.57859818223368, -108.50131299280623, -108.36244901065577, -124.21840683991958, -100.36495480734607], "episode_lengths": [1600, 43, 54, 1600, 79, 79, 60, 1600, 1029, 103, 1600, 68, 54, 1600, 78, 61, 63, 1600, 38, 1600, 1600, 1600, 82, 54, 45, 65, 1600, 70, 95, 68, 83, 64, 1600, 104, 104, 39, 68, 69, 83, 56, 91, 109, 732, 99, 39, 139, 1600, 1600, 1600, 1600, 92, 119, 84, 68, 65, 74, 66, 115, 1600, 48, 60, 53, 52, 79, 62, 51, 80, 1600, 59, 1600, 58, 47, 78, 96, 119, 65, 71, 80, 60, 1600, 90, 53, 72, 62, 57, 1600, 113, 55, 51, 141, 1600, 50, 115, 42, 1600, 93, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36266787194547, "mean_inference_ms": 1.231121533754073, "mean_action_processing_ms": 0.23448773239087506, "mean_env_wait_ms": 0.4725155260389846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069903344223179766, "StateBufferConnector_ms": 0.004956894314166196, "ViewRequirementAgentConnector_ms": 0.14342204811646767}}, "episode_reward_max": -99.67041659420977, "episode_reward_min": -193.37824126062046, "episode_reward_mean": -112.16404741612773, "episode_len_mean": 436.41237113402065, "episodes_this_iter": 7, "episodes_timesteps_total": 42332, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-100.9665273347355, -107.53677974307723, -103.72629878972967, -112.44248012946797, -100.85762297081824, -113.66877018753502, -100.3147927513762, -107.64617548586938, -193.37824126062046, -99.75504342977206, -123.99132397749857, -104.31733036092794, -105.61479217483725, -115.97532220628588, -108.33979475233828, -117.98778702973202, -103.28765779228509, -115.80236757777882, -108.56443154377243, -112.19397289371757, -119.2120746822362, -125.75508894289024, -120.49024091202395, -116.27983054841683, -109.22102970358792, -102.35949248859845, -111.67326691346193, -100.79518969422703, -103.36397470530186, -115.94847880997634, -102.53754972448013, -106.61066879710866, -109.4425806054372, -120.77363260627725, -101.32210442767727, -109.52026319669187, -112.73291942123944, -104.14201234138943, -117.58834016730077, -104.78888215835516, -108.66498004829076, -129.46583870538012, -178.50659666727603, -108.14864963730301, -109.11960280525187, -100.02604799361465, -108.71615792149571, -121.74540377845364, -126.44557246650291, -107.37379496690856, -100.8686986759156, -126.87702747674348, -102.35568605415834, -108.67223015701708, -102.46208205309634, -115.44205827328997, -120.91940137352358, -129.28075279126193, -112.70495332071198, -108.84573948096111, -114.00727892658239, -108.06346453592367, -101.43654422306456, -114.09524803257175, -114.11672183161726, -112.57259399435544, -102.54682336353945, -120.46515106175586, -117.21116257003509, -112.50248490940116, -118.82038026859176, -114.3599675469293, -99.67041659420977, -118.81749162750752, -124.69768136543718, -102.01306060355654, -108.79558293935159, -100.3464075601579, -104.11308192520465, -114.6263300264321, -100.13951265262067, -107.76808419776957, -100.94820716559452, -106.7186558547734, -107.56238851198057, -122.26349451965639, -102.433417669187, -103.30970101681352, -106.61139094173225, -121.04044836276024, -128.24714107024909, -106.00015377605644, -104.57859818223368, -108.50131299280623, -108.36244901065577, -124.21840683991958, -100.36495480734607], "episode_lengths": [1600, 43, 54, 1600, 79, 79, 60, 1600, 1029, 103, 1600, 68, 54, 1600, 78, 61, 63, 1600, 38, 1600, 1600, 1600, 82, 54, 45, 65, 1600, 70, 95, 68, 83, 64, 1600, 104, 104, 39, 68, 69, 83, 56, 91, 109, 732, 99, 39, 139, 1600, 1600, 1600, 1600, 92, 119, 84, 68, 65, 74, 66, 115, 1600, 48, 60, 53, 52, 79, 62, 51, 80, 1600, 59, 1600, 58, 47, 78, 96, 119, 65, 71, 80, 60, 1600, 90, 53, 72, 62, 57, 1600, 113, 55, 51, 141, 1600, 50, 115, 42, 1600, 93, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36266787194547, "mean_inference_ms": 1.231121533754073, "mean_action_processing_ms": 0.23448773239087506, "mean_env_wait_ms": 0.4725155260389846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069903344223179766, "StateBufferConnector_ms": 0.004956894314166196, "ViewRequirementAgentConnector_ms": 0.14342204811646767}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 348.5375054309617, "num_env_steps_trained_throughput_per_sec": 348.5375054309617, "timesteps_total": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 11525.921, "restore_workers_time_ms": 0.017, "training_step_time_ms": 11525.866, "sample_time_ms": 4652.804, "load_time_ms": 0.549, "load_throughput": 7283990.796, "learn_time_ms": 6863.305, "learn_throughput": 582.81, "synch_weights_time_ms": 8.629}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "episodes_total": 97, "training_iteration": 11, "trial_id": "18483_00001", "date": "2024-04-27_18-20-18", "timestamp": 1714267218, "time_this_iter_s": 11.482898950576782, "time_total_s": 126.6549482345581, "pid": 61201, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-08, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 126.6549482345581, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 45.3625, "ram_util_percent": 64.18125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0334986592652977, "cur_kl_coeff": 9.765625000000002e-05, "cur_lr": 4.999999999999999e-08, "total_loss": 9.567596684732745, "policy_loss": 0.003937531334738577, "vf_loss": 9.563659142935148, "vf_explained_var": -0.00040835622818239276, "kl": 2.6207820474826983e-07, "entropy": 5.668217607723769, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10695.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": -99.67041659420977, "episode_reward_min": -193.37824126062046, "episode_reward_mean": -112.12168584241492, "episode_len_mean": 456.18, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 45618, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-112.44248012946797, -100.85762297081824, -113.66877018753502, -100.3147927513762, -107.64617548586938, -193.37824126062046, -99.75504342977206, -123.99132397749857, -104.31733036092794, -105.61479217483725, -115.97532220628588, -108.33979475233828, -117.98778702973202, -103.28765779228509, -115.80236757777882, -108.56443154377243, -112.19397289371757, -119.2120746822362, -125.75508894289024, -120.49024091202395, -116.27983054841683, -109.22102970358792, -102.35949248859845, -111.67326691346193, -100.79518969422703, -103.36397470530186, -115.94847880997634, -102.53754972448013, -106.61066879710866, -109.4425806054372, -120.77363260627725, -101.32210442767727, -109.52026319669187, -112.73291942123944, -104.14201234138943, -117.58834016730077, -104.78888215835516, -108.66498004829076, -129.46583870538012, -178.50659666727603, -108.14864963730301, -109.11960280525187, -100.02604799361465, -108.71615792149571, -121.74540377845364, -126.44557246650291, -107.37379496690856, -100.8686986759156, -126.87702747674348, -102.35568605415834, -108.67223015701708, -102.46208205309634, -115.44205827328997, -120.91940137352358, -129.28075279126193, -112.70495332071198, -108.84573948096111, -114.00727892658239, -108.06346453592367, -101.43654422306456, -114.09524803257175, -114.11672183161726, -112.57259399435544, -102.54682336353945, -120.46515106175586, -117.21116257003509, -112.50248490940116, -118.82038026859176, -114.3599675469293, -99.67041659420977, -118.81749162750752, -124.69768136543718, -102.01306060355654, -108.79558293935159, -100.3464075601579, -104.11308192520465, -114.6263300264321, -100.13951265262067, -107.76808419776957, -100.94820716559452, -106.7186558547734, -107.56238851198057, -122.26349451965639, -102.433417669187, -103.30970101681352, -106.61139094173225, -121.04044836276024, -128.24714107024909, -106.00015377605644, -104.57859818223368, -108.50131299280623, -108.36244901065577, -124.21840683991958, -100.36495480734607, -105.45090042248565, -103.28107500129752, -106.53116505563693, -105.74808996592161, -113.06849307529131, -110.40586722400909], "episode_lengths": [1600, 79, 79, 60, 1600, 1029, 103, 1600, 68, 54, 1600, 78, 61, 63, 1600, 38, 1600, 1600, 1600, 82, 54, 45, 65, 1600, 70, 95, 68, 83, 64, 1600, 104, 104, 39, 68, 69, 83, 56, 91, 109, 732, 99, 39, 139, 1600, 1600, 1600, 1600, 92, 119, 84, 68, 65, 74, 66, 115, 1600, 48, 60, 53, 52, 79, 62, 51, 80, 1600, 59, 1600, 58, 47, 78, 96, 119, 65, 71, 80, 60, 1600, 90, 53, 72, 62, 57, 1600, 113, 55, 51, 141, 1600, 50, 115, 42, 1600, 93, 70, 1600, 69, 62, 1600, 52, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3635897570363172, "mean_inference_ms": 1.2332170136940892, "mean_action_processing_ms": 0.2349206196451693, "mean_env_wait_ms": 0.4728067733316989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007106781005859375, "StateBufferConnector_ms": 0.005194664001464844, "ViewRequirementAgentConnector_ms": 0.14612698554992676}}, "episode_reward_max": -99.67041659420977, "episode_reward_min": -193.37824126062046, "episode_reward_mean": -112.12168584241492, "episode_len_mean": 456.18, "episodes_this_iter": 6, "episodes_timesteps_total": 45618, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-112.44248012946797, -100.85762297081824, -113.66877018753502, -100.3147927513762, -107.64617548586938, -193.37824126062046, -99.75504342977206, -123.99132397749857, -104.31733036092794, -105.61479217483725, -115.97532220628588, -108.33979475233828, -117.98778702973202, -103.28765779228509, -115.80236757777882, -108.56443154377243, -112.19397289371757, -119.2120746822362, -125.75508894289024, -120.49024091202395, -116.27983054841683, -109.22102970358792, -102.35949248859845, -111.67326691346193, -100.79518969422703, -103.36397470530186, -115.94847880997634, -102.53754972448013, -106.61066879710866, -109.4425806054372, -120.77363260627725, -101.32210442767727, -109.52026319669187, -112.73291942123944, -104.14201234138943, -117.58834016730077, -104.78888215835516, -108.66498004829076, -129.46583870538012, -178.50659666727603, -108.14864963730301, -109.11960280525187, -100.02604799361465, -108.71615792149571, -121.74540377845364, -126.44557246650291, -107.37379496690856, -100.8686986759156, -126.87702747674348, -102.35568605415834, -108.67223015701708, -102.46208205309634, -115.44205827328997, -120.91940137352358, -129.28075279126193, -112.70495332071198, -108.84573948096111, -114.00727892658239, -108.06346453592367, -101.43654422306456, -114.09524803257175, -114.11672183161726, -112.57259399435544, -102.54682336353945, -120.46515106175586, -117.21116257003509, -112.50248490940116, -118.82038026859176, -114.3599675469293, -99.67041659420977, -118.81749162750752, -124.69768136543718, -102.01306060355654, -108.79558293935159, -100.3464075601579, -104.11308192520465, -114.6263300264321, -100.13951265262067, -107.76808419776957, -100.94820716559452, -106.7186558547734, -107.56238851198057, -122.26349451965639, -102.433417669187, -103.30970101681352, -106.61139094173225, -121.04044836276024, -128.24714107024909, -106.00015377605644, -104.57859818223368, -108.50131299280623, -108.36244901065577, -124.21840683991958, -100.36495480734607, -105.45090042248565, -103.28107500129752, -106.53116505563693, -105.74808996592161, -113.06849307529131, -110.40586722400909], "episode_lengths": [1600, 79, 79, 60, 1600, 1029, 103, 1600, 68, 54, 1600, 78, 61, 63, 1600, 38, 1600, 1600, 1600, 82, 54, 45, 65, 1600, 70, 95, 68, 83, 64, 1600, 104, 104, 39, 68, 69, 83, 56, 91, 109, 732, 99, 39, 139, 1600, 1600, 1600, 1600, 92, 119, 84, 68, 65, 74, 66, 115, 1600, 48, 60, 53, 52, 79, 62, 51, 80, 1600, 59, 1600, 58, 47, 78, 96, 119, 65, 71, 80, 60, 1600, 90, 53, 72, 62, 57, 1600, 113, 55, 51, 141, 1600, 50, 115, 42, 1600, 93, 70, 1600, 69, 62, 1600, 52, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3635897570363172, "mean_inference_ms": 1.2332170136940892, "mean_action_processing_ms": 0.2349206196451693, "mean_env_wait_ms": 0.4728067733316989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007106781005859375, "StateBufferConnector_ms": 0.005194664001464844, "ViewRequirementAgentConnector_ms": 0.14612698554992676}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.0385686277894, "num_env_steps_trained_throughput_per_sec": 313.0385686277894, "timesteps_total": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 11622.406, "restore_workers_time_ms": 0.016, "training_step_time_ms": 11622.361, "sample_time_ms": 4751.338, "load_time_ms": 0.549, "load_throughput": 7279566.104, "learn_time_ms": 6861.291, "learn_throughput": 582.981, "synch_weights_time_ms": 8.594}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 103, "training_iteration": 12, "trial_id": "18483_00001", "date": "2024-04-27_18-20-31", "timestamp": 1714267231, "time_this_iter_s": 12.78389596939087, "time_total_s": 139.43884420394897, "pid": 61201, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-08, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 139.43884420394897, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 47.81666666666667, "ram_util_percent": 65.1888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3397039948932585, "cur_kl_coeff": 4.882812500000001e-05, "cur_lr": 4.999999999999999e-08, "total_loss": 9.548178474364741, "policy_loss": 0.004650188085212502, "vf_loss": 9.543528282001454, "vf_explained_var": -0.000552479810612176, "kl": 2.3054604385110308e-07, "entropy": 5.666156320161717, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11625.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "sampler_results": {"episode_reward_max": -99.67041659420977, "episode_reward_min": -178.50659666727603, "episode_reward_mean": -111.32331330941435, "episode_len_mean": 431.34, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 43134, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-105.61479217483725, -115.97532220628588, -108.33979475233828, -117.98778702973202, -103.28765779228509, -115.80236757777882, -108.56443154377243, -112.19397289371757, -119.2120746822362, -125.75508894289024, -120.49024091202395, -116.27983054841683, -109.22102970358792, -102.35949248859845, -111.67326691346193, -100.79518969422703, -103.36397470530186, -115.94847880997634, -102.53754972448013, -106.61066879710866, -109.4425806054372, -120.77363260627725, -101.32210442767727, -109.52026319669187, -112.73291942123944, -104.14201234138943, -117.58834016730077, -104.78888215835516, -108.66498004829076, -129.46583870538012, -178.50659666727603, -108.14864963730301, -109.11960280525187, -100.02604799361465, -108.71615792149571, -121.74540377845364, -126.44557246650291, -107.37379496690856, -100.8686986759156, -126.87702747674348, -102.35568605415834, -108.67223015701708, -102.46208205309634, -115.44205827328997, -120.91940137352358, -129.28075279126193, -112.70495332071198, -108.84573948096111, -114.00727892658239, -108.06346453592367, -101.43654422306456, -114.09524803257175, -114.11672183161726, -112.57259399435544, -102.54682336353945, -120.46515106175586, -117.21116257003509, -112.50248490940116, -118.82038026859176, -114.3599675469293, -99.67041659420977, -118.81749162750752, -124.69768136543718, -102.01306060355654, -108.79558293935159, -100.3464075601579, -104.11308192520465, -114.6263300264321, -100.13951265262067, -107.76808419776957, -100.94820716559452, -106.7186558547734, -107.56238851198057, -122.26349451965639, -102.433417669187, -103.30970101681352, -106.61139094173225, -121.04044836276024, -128.24714107024909, -106.00015377605644, -104.57859818223368, -108.50131299280623, -108.36244901065577, -124.21840683991958, -100.36495480734607, -105.45090042248565, -103.28107500129752, -106.53116505563693, -105.74808996592161, -113.06849307529131, -110.40586722400909, -115.21209078354617, -107.02555064854585, -102.88357371391666, -104.91533447741283, -114.89281417647562, -116.15093769641966, -100.16214183817432, -114.0165662296644, -101.27551768967571], "episode_lengths": [54, 1600, 78, 61, 63, 1600, 38, 1600, 1600, 1600, 82, 54, 45, 65, 1600, 70, 95, 68, 83, 64, 1600, 104, 104, 39, 68, 69, 83, 56, 91, 109, 732, 99, 39, 139, 1600, 1600, 1600, 1600, 92, 119, 84, 68, 65, 74, 66, 115, 1600, 48, 60, 53, 52, 79, 62, 51, 80, 1600, 59, 1600, 58, 47, 78, 96, 119, 65, 71, 80, 60, 1600, 90, 53, 72, 62, 57, 1600, 113, 55, 51, 141, 1600, 50, 115, 42, 1600, 93, 70, 1600, 69, 62, 1600, 52, 1600, 1600, 69, 66, 81, 95, 65, 90, 1600, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36511581608113003, "mean_inference_ms": 1.2360754661592674, "mean_action_processing_ms": 0.23571111459068533, "mean_env_wait_ms": 0.4741094306591417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007022380828857422, "StateBufferConnector_ms": 0.005284786224365234, "ViewRequirementAgentConnector_ms": 0.14623737335205078}}, "episode_reward_max": -99.67041659420977, "episode_reward_min": -178.50659666727603, "episode_reward_mean": -111.32331330941435, "episode_len_mean": 431.34, "episodes_this_iter": 9, "episodes_timesteps_total": 43134, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-105.61479217483725, -115.97532220628588, -108.33979475233828, -117.98778702973202, -103.28765779228509, -115.80236757777882, -108.56443154377243, -112.19397289371757, -119.2120746822362, -125.75508894289024, -120.49024091202395, -116.27983054841683, -109.22102970358792, -102.35949248859845, -111.67326691346193, -100.79518969422703, -103.36397470530186, -115.94847880997634, -102.53754972448013, -106.61066879710866, -109.4425806054372, -120.77363260627725, -101.32210442767727, -109.52026319669187, -112.73291942123944, -104.14201234138943, -117.58834016730077, -104.78888215835516, -108.66498004829076, -129.46583870538012, -178.50659666727603, -108.14864963730301, -109.11960280525187, -100.02604799361465, -108.71615792149571, -121.74540377845364, -126.44557246650291, -107.37379496690856, -100.8686986759156, -126.87702747674348, -102.35568605415834, -108.67223015701708, -102.46208205309634, -115.44205827328997, -120.91940137352358, -129.28075279126193, -112.70495332071198, -108.84573948096111, -114.00727892658239, -108.06346453592367, -101.43654422306456, -114.09524803257175, -114.11672183161726, -112.57259399435544, -102.54682336353945, -120.46515106175586, -117.21116257003509, -112.50248490940116, -118.82038026859176, -114.3599675469293, -99.67041659420977, -118.81749162750752, -124.69768136543718, -102.01306060355654, -108.79558293935159, -100.3464075601579, -104.11308192520465, -114.6263300264321, -100.13951265262067, -107.76808419776957, -100.94820716559452, -106.7186558547734, -107.56238851198057, -122.26349451965639, -102.433417669187, -103.30970101681352, -106.61139094173225, -121.04044836276024, -128.24714107024909, -106.00015377605644, -104.57859818223368, -108.50131299280623, -108.36244901065577, -124.21840683991958, -100.36495480734607, -105.45090042248565, -103.28107500129752, -106.53116505563693, -105.74808996592161, -113.06849307529131, -110.40586722400909, -115.21209078354617, -107.02555064854585, -102.88357371391666, -104.91533447741283, -114.89281417647562, -116.15093769641966, -100.16214183817432, -114.0165662296644, -101.27551768967571], "episode_lengths": [54, 1600, 78, 61, 63, 1600, 38, 1600, 1600, 1600, 82, 54, 45, 65, 1600, 70, 95, 68, 83, 64, 1600, 104, 104, 39, 68, 69, 83, 56, 91, 109, 732, 99, 39, 139, 1600, 1600, 1600, 1600, 92, 119, 84, 68, 65, 74, 66, 115, 1600, 48, 60, 53, 52, 79, 62, 51, 80, 1600, 59, 1600, 58, 47, 78, 96, 119, 65, 71, 80, 60, 1600, 90, 53, 72, 62, 57, 1600, 113, 55, 51, 141, 1600, 50, 115, 42, 1600, 93, 70, 1600, 69, 62, 1600, 52, 1600, 1600, 69, 66, 81, 95, 65, 90, 1600, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36511581608113003, "mean_inference_ms": 1.2360754661592674, "mean_action_processing_ms": 0.23571111459068533, "mean_env_wait_ms": 0.4741094306591417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007022380828857422, "StateBufferConnector_ms": 0.005284786224365234, "ViewRequirementAgentConnector_ms": 0.14623737335205078}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 345.7025402390969, "num_env_steps_trained_throughput_per_sec": 345.7025402390969, "timesteps_total": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 11610.377, "restore_workers_time_ms": 0.016, "training_step_time_ms": 11610.331, "sample_time_ms": 4767.391, "load_time_ms": 0.567, "load_throughput": 7049842.844, "learn_time_ms": 6833.159, "learn_throughput": 585.381, "synch_weights_time_ms": 8.604}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": true, "episodes_total": 112, "training_iteration": 13, "trial_id": "18483_00001", "date": "2024-04-27_18-20-42", "timestamp": 1714267242, "time_this_iter_s": 11.575275897979736, "time_total_s": 151.0141201019287, "pid": 61201, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-08, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 151.0141201019287, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 45.911764705882355, "ram_util_percent": 64.12941176470588}}
