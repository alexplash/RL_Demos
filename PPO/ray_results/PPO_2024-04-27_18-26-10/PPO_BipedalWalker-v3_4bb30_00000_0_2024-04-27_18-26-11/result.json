{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.07996413340812, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.94316868908423, "policy_loss": -0.02327049579671634, "vf_loss": 6.963530536372495, "vf_explained_var": -0.024226574551674627, "kl": 0.014543166474066565, "entropy": 5.7151475229570945, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 465.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": -109.92209126871509, "episode_reward_min": -122.59190624748243, "episode_reward_mean": -117.27981179020968, "episode_len_mean": 582.3333333333334, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 3494, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-109.92209126871509, -116.65098024864868, -119.19884756607065, -120.36671843321808, -122.59190624748243, -114.9483269771232], "episode_lengths": [1600, 89, 58, 70, 1600, 77]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28561797118993193, "mean_inference_ms": 0.9374164172694739, "mean_action_processing_ms": 0.18304869391094858, "mean_env_wait_ms": 0.3753289091334866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005884965260823567, "StateBufferConnector_ms": 0.004549821217854817, "ViewRequirementAgentConnector_ms": 0.11634429295857747}}, "episode_reward_max": -109.92209126871509, "episode_reward_min": -122.59190624748243, "episode_reward_mean": -117.27981179020968, "episode_len_mean": 582.3333333333334, "episodes_this_iter": 6, "episodes_timesteps_total": 3494, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-109.92209126871509, -116.65098024864868, -119.19884756607065, -120.36671843321808, -122.59190624748243, -114.9483269771232], "episode_lengths": [1600, 89, 58, 70, 1600, 77]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28561797118993193, "mean_inference_ms": 0.9374164172694739, "mean_action_processing_ms": 0.18304869391094858, "mean_env_wait_ms": 0.3753289091334866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005884965260823567, "StateBufferConnector_ms": 0.004549821217854817, "ViewRequirementAgentConnector_ms": 0.11634429295857747}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 418.90444452467705, "num_env_steps_trained_throughput_per_sec": 418.90444452467705, "timesteps_total": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 9548.726, "restore_workers_time_ms": 0.017, "training_step_time_ms": 9548.676, "sample_time_ms": 3602.184, "load_time_ms": 0.277, "load_throughput": 14425809.114, "learn_time_ms": 5937.258, "learn_throughput": 673.712, "synch_weights_time_ms": 8.311}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 6, "training_iteration": 1, "trial_id": "4bb30_00000", "date": "2024-04-27_18-26-47", "timestamp": 1714267607, "time_this_iter_s": 9.55262017250061, "time_total_s": 9.55262017250061, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 9.55262017250061, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 23.485714285714288, "ram_util_percent": 64.00714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.659599468592674, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.8715776270027624, "policy_loss": -0.02760338353053216, "vf_loss": 3.8953973470195646, "vf_explained_var": -0.0006623508468750984, "kl": 0.01891830207620295, "entropy": 5.727541714329873, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1395.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": -100.56002648907092, "episode_reward_min": -134.52705748740647, "episode_reward_mean": -113.68829741314816, "episode_len_mean": 393.75, "episode_media": {}, "episodes_this_iter": 14, "episodes_timesteps_total": 7875, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-109.92209126871509, -116.65098024864868, -119.19884756607065, -120.36671843321808, -122.59190624748243, -114.9483269771232, -106.9671069564334, -129.36910563969923, -101.1867437075482, -100.56002648907092, -134.52705748740647, -102.38913960639263, -118.74994481244994, -108.43117049997673, -116.09746386926, -109.57829472732104, -120.75273682216742, -115.15058579896576, -104.29314177363676, -102.03455933137673], "episode_lengths": [1600, 89, 58, 70, 1600, 77, 1600, 184, 80, 75, 212, 65, 87, 115, 80, 1600, 65, 74, 65, 79]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28702701514140216, "mean_inference_ms": 0.9421499248726916, "mean_action_processing_ms": 0.1839023786161567, "mean_env_wait_ms": 0.3773732995150616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00592350959777832, "StateBufferConnector_ms": 0.004324913024902344, "ViewRequirementAgentConnector_ms": 0.11325359344482422}}, "episode_reward_max": -100.56002648907092, "episode_reward_min": -134.52705748740647, "episode_reward_mean": -113.68829741314816, "episode_len_mean": 393.75, "episodes_this_iter": 14, "episodes_timesteps_total": 7875, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-109.92209126871509, -116.65098024864868, -119.19884756607065, -120.36671843321808, -122.59190624748243, -114.9483269771232, -106.9671069564334, -129.36910563969923, -101.1867437075482, -100.56002648907092, -134.52705748740647, -102.38913960639263, -118.74994481244994, -108.43117049997673, -116.09746386926, -109.57829472732104, -120.75273682216742, -115.15058579896576, -104.29314177363676, -102.03455933137673], "episode_lengths": [1600, 89, 58, 70, 1600, 77, 1600, 184, 80, 75, 212, 65, 87, 115, 80, 1600, 65, 74, 65, 79]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28702701514140216, "mean_inference_ms": 0.9421499248726916, "mean_action_processing_ms": 0.1839023786161567, "mean_env_wait_ms": 0.3773732995150616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00592350959777832, "StateBufferConnector_ms": 0.004324913024902344, "ViewRequirementAgentConnector_ms": 0.11325359344482422}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 414.56094639559007, "num_env_steps_trained_throughput_per_sec": 414.56094639559007, "timesteps_total": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 9598.749, "restore_workers_time_ms": 0.016, "training_step_time_ms": 9598.7, "sample_time_ms": 3627.138, "load_time_ms": 0.315, "load_throughput": 12690783.661, "learn_time_ms": 5962.862, "learn_throughput": 670.819, "synch_weights_time_ms": 7.787}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 20, "training_iteration": 2, "trial_id": "4bb30_00000", "date": "2024-04-27_18-26-57", "timestamp": 1714267617, "time_this_iter_s": 9.652399778366089, "time_total_s": 19.2050199508667, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 19.2050199508667, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 24.63571428571429, "ram_util_percent": 63.564285714285724}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.67713172392499, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.115309673645884, "policy_loss": -0.01747607182215659, "vf_loss": 1.1313316127786073, "vf_explained_var": -0.0043684933775214735, "kl": 0.007270641447078657, "entropy": 5.964600646111273, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2325.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": -100.56002648907092, "episode_reward_min": -134.52705748740647, "episode_reward_mean": -112.66169586724537, "episode_len_mean": 483.7391304347826, "episode_media": {}, "episodes_this_iter": 3, "episodes_timesteps_total": 11126, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-109.92209126871509, -116.65098024864868, -119.19884756607065, -120.36671843321808, -122.59190624748243, -114.9483269771232, -106.9671069564334, -129.36910563969923, -101.1867437075482, -100.56002648907092, -134.52705748740647, -102.38913960639263, -118.74994481244994, -108.43117049997673, -116.09746386926, -109.57829472732104, -120.75273682216742, -115.15058579896576, -104.29314177363676, -102.03455933137673, -112.93015447386226, -100.76253953828603, -103.76036267153174], "episode_lengths": [1600, 89, 58, 70, 1600, 77, 1600, 184, 80, 75, 212, 65, 87, 115, 80, 1600, 65, 74, 65, 79, 1600, 1600, 51]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2866548337697393, "mean_inference_ms": 0.9421385663580834, "mean_action_processing_ms": 0.18379392019931592, "mean_env_wait_ms": 0.3774152290268046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005976013515306556, "StateBufferConnector_ms": 0.00428635141123896, "ViewRequirementAgentConnector_ms": 0.11196447455364725}}, "episode_reward_max": -100.56002648907092, "episode_reward_min": -134.52705748740647, "episode_reward_mean": -112.66169586724537, "episode_len_mean": 483.7391304347826, "episodes_this_iter": 3, "episodes_timesteps_total": 11126, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-109.92209126871509, -116.65098024864868, -119.19884756607065, -120.36671843321808, -122.59190624748243, -114.9483269771232, -106.9671069564334, -129.36910563969923, -101.1867437075482, -100.56002648907092, -134.52705748740647, -102.38913960639263, -118.74994481244994, -108.43117049997673, -116.09746386926, -109.57829472732104, -120.75273682216742, -115.15058579896576, -104.29314177363676, -102.03455933137673, -112.93015447386226, -100.76253953828603, -103.76036267153174], "episode_lengths": [1600, 89, 58, 70, 1600, 77, 1600, 184, 80, 75, 212, 65, 87, 115, 80, 1600, 65, 74, 65, 79, 1600, 1600, 51]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2866548337697393, "mean_inference_ms": 0.9421385663580834, "mean_action_processing_ms": 0.18379392019931592, "mean_env_wait_ms": 0.3774152290268046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005976013515306556, "StateBufferConnector_ms": 0.00428635141123896, "ViewRequirementAgentConnector_ms": 0.11196447455364725}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 409.8965745821366, "num_env_steps_trained_throughput_per_sec": 409.8965745821366, "timesteps_total": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 9652.022, "restore_workers_time_ms": 0.016, "training_step_time_ms": 9651.975, "sample_time_ms": 3609.85, "load_time_ms": 0.356, "load_throughput": 11242271.164, "learn_time_ms": 6033.643, "learn_throughput": 662.949, "synch_weights_time_ms": 7.556}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 23, "training_iteration": 3, "trial_id": "4bb30_00000", "date": "2024-04-27_18-27-06", "timestamp": 1714267626, "time_this_iter_s": 9.763356924057007, "time_total_s": 28.968376874923706, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 28.968376874923706, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 29.95, "ram_util_percent": 63.657142857142844}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.897739982092252, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3323636898866063, "policy_loss": -0.02271049338322814, "vf_loss": 1.3516420685395758, "vf_explained_var": 0.05012858977881811, "kl": 0.017160548507124132, "entropy": 5.895720320875927, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3255.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": -100.12750228362395, "episode_reward_min": -134.52705748740647, "episode_reward_mean": -111.92201128593875, "episode_len_mean": 573.04, "episode_media": {}, "episodes_this_iter": 2, "episodes_timesteps_total": 14326, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-109.92209126871509, -116.65098024864868, -119.19884756607065, -120.36671843321808, -122.59190624748243, -114.9483269771232, -106.9671069564334, -129.36910563969923, -101.1867437075482, -100.56002648907092, -134.52705748740647, -102.38913960639263, -118.74994481244994, -108.43117049997673, -116.09746386926, -109.57829472732104, -120.75273682216742, -115.15058579896576, -104.29314177363676, -102.03455933137673, -112.93015447386226, -100.76253953828603, -103.76036267153174, -100.12750228362395, -106.70377491820184], "episode_lengths": [1600, 89, 58, 70, 1600, 77, 1600, 184, 80, 75, 212, 65, 87, 115, 80, 1600, 65, 74, 65, 79, 1600, 1600, 51, 1600, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.286314162030868, "mean_inference_ms": 0.9421589376925366, "mean_action_processing_ms": 0.18378924066351307, "mean_env_wait_ms": 0.3776331518149968, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0058994293212890625, "StateBufferConnector_ms": 0.004261970520019531, "ViewRequirementAgentConnector_ms": 0.11121559143066406}}, "episode_reward_max": -100.12750228362395, "episode_reward_min": -134.52705748740647, "episode_reward_mean": -111.92201128593875, "episode_len_mean": 573.04, "episodes_this_iter": 2, "episodes_timesteps_total": 14326, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-109.92209126871509, -116.65098024864868, -119.19884756607065, -120.36671843321808, -122.59190624748243, -114.9483269771232, -106.9671069564334, -129.36910563969923, -101.1867437075482, -100.56002648907092, -134.52705748740647, -102.38913960639263, -118.74994481244994, -108.43117049997673, -116.09746386926, -109.57829472732104, -120.75273682216742, -115.15058579896576, -104.29314177363676, -102.03455933137673, -112.93015447386226, -100.76253953828603, -103.76036267153174, -100.12750228362395, -106.70377491820184], "episode_lengths": [1600, 89, 58, 70, 1600, 77, 1600, 184, 80, 75, 212, 65, 87, 115, 80, 1600, 65, 74, 65, 79, 1600, 1600, 51, 1600, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.286314162030868, "mean_inference_ms": 0.9421589376925366, "mean_action_processing_ms": 0.18378924066351307, "mean_env_wait_ms": 0.3776331518149968, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0058994293212890625, "StateBufferConnector_ms": 0.004261970520019531, "ViewRequirementAgentConnector_ms": 0.11121559143066406}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 417.8284145215931, "num_env_steps_trained_throughput_per_sec": 417.8284145215931, "timesteps_total": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 9632.346, "restore_workers_time_ms": 0.016, "training_step_time_ms": 9632.298, "sample_time_ms": 3614.747, "load_time_ms": 0.372, "load_throughput": 10756349.415, "learn_time_ms": 6008.911, "learn_throughput": 665.678, "synch_weights_time_ms": 7.694}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 25, "training_iteration": 4, "trial_id": "4bb30_00000", "date": "2024-04-27_18-27-16", "timestamp": 1714267636, "time_this_iter_s": 9.57725977897644, "time_total_s": 38.54563665390015, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 38.54563665390015, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 24.907692307692308, "ram_util_percent": 63.75384615384617}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.384979584460618, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2826719742083061, "policy_loss": -0.04592350019562629, "vf_loss": 1.3227016820021535, "vf_explained_var": 0.021740133659813993, "kl": 0.02946891271753201, "entropy": 5.875307842992967, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4185.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": -94.07629407043389, "episode_reward_min": -134.52705748740647, "episode_reward_mean": -111.86276057493927, "episode_len_mean": 559.25, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 17896, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-109.92209126871509, -116.65098024864868, -119.19884756607065, -120.36671843321808, -122.59190624748243, -114.9483269771232, -106.9671069564334, -129.36910563969923, -101.1867437075482, -100.56002648907092, -134.52705748740647, -102.38913960639263, -118.74994481244994, -108.43117049997673, -116.09746386926, -109.57829472732104, -120.75273682216742, -115.15058579896576, -104.29314177363676, -102.03455933137673, -112.93015447386226, -100.76253953828603, -103.76036267153174, -100.12750228362395, -106.70377491820184, -94.07629407043389, -130.28073055823396, -103.46340804175365, -113.61107132631541, -117.80560272874311, -116.22227911966792, -106.09867040443979], "episode_lengths": [1600, 89, 58, 70, 1600, 77, 1600, 184, 80, 75, 212, 65, 87, 115, 80, 1600, 65, 74, 65, 79, 1600, 1600, 51, 1600, 1600, 1600, 118, 1600, 61, 64, 54, 73]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28580377552520575, "mean_inference_ms": 0.9427564748695492, "mean_action_processing_ms": 0.1837649725374324, "mean_env_wait_ms": 0.37815734824794045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006226450204849243, "StateBufferConnector_ms": 0.0042632222175598145, "ViewRequirementAgentConnector_ms": 0.1131497323513031}}, "episode_reward_max": -94.07629407043389, "episode_reward_min": -134.52705748740647, "episode_reward_mean": -111.86276057493927, "episode_len_mean": 559.25, "episodes_this_iter": 7, "episodes_timesteps_total": 17896, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-109.92209126871509, -116.65098024864868, -119.19884756607065, -120.36671843321808, -122.59190624748243, -114.9483269771232, -106.9671069564334, -129.36910563969923, -101.1867437075482, -100.56002648907092, -134.52705748740647, -102.38913960639263, -118.74994481244994, -108.43117049997673, -116.09746386926, -109.57829472732104, -120.75273682216742, -115.15058579896576, -104.29314177363676, -102.03455933137673, -112.93015447386226, -100.76253953828603, -103.76036267153174, -100.12750228362395, -106.70377491820184, -94.07629407043389, -130.28073055823396, -103.46340804175365, -113.61107132631541, -117.80560272874311, -116.22227911966792, -106.09867040443979], "episode_lengths": [1600, 89, 58, 70, 1600, 77, 1600, 184, 80, 75, 212, 65, 87, 115, 80, 1600, 65, 74, 65, 79, 1600, 1600, 51, 1600, 1600, 1600, 118, 1600, 61, 64, 54, 73]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28580377552520575, "mean_inference_ms": 0.9427564748695492, "mean_action_processing_ms": 0.1837649725374324, "mean_env_wait_ms": 0.37815734824794045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006226450204849243, "StateBufferConnector_ms": 0.0042632222175598145, "ViewRequirementAgentConnector_ms": 0.1131497323513031}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 420.7222487007481, "num_env_steps_trained_throughput_per_sec": 420.7222487007481, "timesteps_total": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 9607.371, "restore_workers_time_ms": 0.015, "training_step_time_ms": 9607.324, "sample_time_ms": 3622.752, "load_time_ms": 0.384, "load_throughput": 10415455.674, "learn_time_ms": 5976.089, "learn_throughput": 669.334, "synch_weights_time_ms": 7.509}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 32, "training_iteration": 5, "trial_id": "4bb30_00000", "date": "2024-04-27_18-27-26", "timestamp": 1714267646, "time_this_iter_s": 9.511296033859253, "time_total_s": 48.0569326877594, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 48.0569326877594, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 24.24285714285714, "ram_util_percent": 63.657142857142865}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.156383212215157, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.680118890215833, "policy_loss": -0.025763479804479947, "vf_loss": 0.7029082275766839, "vf_explained_var": 0.08360358713775552, "kl": 0.009913808583802693, "entropy": 5.837889966657085, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5115.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": -94.07629407043389, "episode_reward_min": -134.52705748740647, "episode_reward_mean": -111.49782441268172, "episode_len_mean": 605.3714285714286, "episode_media": {}, "episodes_this_iter": 3, "episodes_timesteps_total": 21188, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-109.92209126871509, -116.65098024864868, -119.19884756607065, -120.36671843321808, -122.59190624748243, -114.9483269771232, -106.9671069564334, -129.36910563969923, -101.1867437075482, -100.56002648907092, -134.52705748740647, -102.38913960639263, -118.74994481244994, -108.43117049997673, -116.09746386926, -109.57829472732104, -120.75273682216742, -115.15058579896576, -104.29314177363676, -102.03455933137673, -112.93015447386226, -100.76253953828603, -103.76036267153174, -100.12750228362395, -106.70377491820184, -94.07629407043389, -130.28073055823396, -103.46340804175365, -113.61107132631541, -117.80560272874311, -116.22227911966792, -106.09867040443979, -95.82713960919102, -106.64188679593971, -120.346489640673], "episode_lengths": [1600, 89, 58, 70, 1600, 77, 1600, 184, 80, 75, 212, 65, 87, 115, 80, 1600, 65, 74, 65, 79, 1600, 1600, 51, 1600, 1600, 1600, 118, 1600, 61, 64, 54, 73, 1600, 1600, 92]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28551703731637756, "mean_inference_ms": 0.9427530477459674, "mean_action_processing_ms": 0.18374136877403277, "mean_env_wait_ms": 0.3783723884602071, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006301743643624442, "StateBufferConnector_ms": 0.004304477146693638, "ViewRequirementAgentConnector_ms": 0.11313574654715401}}, "episode_reward_max": -94.07629407043389, "episode_reward_min": -134.52705748740647, "episode_reward_mean": -111.49782441268172, "episode_len_mean": 605.3714285714286, "episodes_this_iter": 3, "episodes_timesteps_total": 21188, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-109.92209126871509, -116.65098024864868, -119.19884756607065, -120.36671843321808, -122.59190624748243, -114.9483269771232, -106.9671069564334, -129.36910563969923, -101.1867437075482, -100.56002648907092, -134.52705748740647, -102.38913960639263, -118.74994481244994, -108.43117049997673, -116.09746386926, -109.57829472732104, -120.75273682216742, -115.15058579896576, -104.29314177363676, -102.03455933137673, -112.93015447386226, -100.76253953828603, -103.76036267153174, -100.12750228362395, -106.70377491820184, -94.07629407043389, -130.28073055823396, -103.46340804175365, -113.61107132631541, -117.80560272874311, -116.22227911966792, -106.09867040443979, -95.82713960919102, -106.64188679593971, -120.346489640673], "episode_lengths": [1600, 89, 58, 70, 1600, 77, 1600, 184, 80, 75, 212, 65, 87, 115, 80, 1600, 65, 74, 65, 79, 1600, 1600, 51, 1600, 1600, 1600, 118, 1600, 61, 64, 54, 73, 1600, 1600, 92]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28551703731637756, "mean_inference_ms": 0.9427530477459674, "mean_action_processing_ms": 0.18374136877403277, "mean_env_wait_ms": 0.3783723884602071, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006301743643624442, "StateBufferConnector_ms": 0.004304477146693638, "ViewRequirementAgentConnector_ms": 0.11313574654715401}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 411.51916019285153, "num_env_steps_trained_throughput_per_sec": 411.51916019285153, "timesteps_total": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 9626.158, "restore_workers_time_ms": 0.015, "training_step_time_ms": 9626.112, "sample_time_ms": 3615.491, "load_time_ms": 0.45, "load_throughput": 8898019.623, "learn_time_ms": 6002.231, "learn_throughput": 666.419, "synch_weights_time_ms": 7.358}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 35, "training_iteration": 6, "trial_id": "4bb30_00000", "date": "2024-04-27_18-27-35", "timestamp": 1714267655, "time_this_iter_s": 9.724057912826538, "time_total_s": 57.78099060058594, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 57.78099060058594, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 24.364285714285717, "ram_util_percent": 63.671428571428585}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.75386744090306, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1257130912205915, "policy_loss": -0.02665065442842822, "vf_loss": 1.1490233746667704, "vf_explained_var": 0.23926644716211545, "kl": 0.01113456313997261, "entropy": 5.83709654654226, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6045.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": -93.43894459780182, "episode_reward_min": -134.52705748740647, "episode_reward_mean": -110.22675283694741, "episode_len_mean": 662.547619047619, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 27827, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-109.92209126871509, -116.65098024864868, -119.19884756607065, -120.36671843321808, -122.59190624748243, -114.9483269771232, -106.9671069564334, -129.36910563969923, -101.1867437075482, -100.56002648907092, -134.52705748740647, -102.38913960639263, -118.74994481244994, -108.43117049997673, -116.09746386926, -109.57829472732104, -120.75273682216742, -115.15058579896576, -104.29314177363676, -102.03455933137673, -112.93015447386226, -100.76253953828603, -103.76036267153174, -100.12750228362395, -106.70377491820184, -94.07629407043389, -130.28073055823396, -103.46340804175365, -113.61107132631541, -117.80560272874311, -116.22227911966792, -106.09867040443979, -95.82713960919102, -106.64188679593971, -120.346489640673, -99.97138137741707, -103.65088717458583, -128.34699429252123, -105.03101388073402, -95.58916962090795, -101.07137376396186, -93.43894459780182], "episode_lengths": [1600, 89, 58, 70, 1600, 77, 1600, 184, 80, 75, 212, 65, 87, 115, 80, 1600, 65, 74, 65, 79, 1600, 1600, 51, 1600, 1600, 1600, 118, 1600, 61, 64, 54, 73, 1600, 1600, 92, 1600, 53, 102, 84, 1600, 1600, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28503910607271726, "mean_inference_ms": 0.9426380994749887, "mean_action_processing_ms": 0.1838659189250599, "mean_env_wait_ms": 0.3793138075349907, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006213074638730004, "StateBufferConnector_ms": 0.004234200432187035, "ViewRequirementAgentConnector_ms": 0.11304957526070732}}, "episode_reward_max": -93.43894459780182, "episode_reward_min": -134.52705748740647, "episode_reward_mean": -110.22675283694741, "episode_len_mean": 662.547619047619, "episodes_this_iter": 7, "episodes_timesteps_total": 27827, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-109.92209126871509, -116.65098024864868, -119.19884756607065, -120.36671843321808, -122.59190624748243, -114.9483269771232, -106.9671069564334, -129.36910563969923, -101.1867437075482, -100.56002648907092, -134.52705748740647, -102.38913960639263, -118.74994481244994, -108.43117049997673, -116.09746386926, -109.57829472732104, -120.75273682216742, -115.15058579896576, -104.29314177363676, -102.03455933137673, -112.93015447386226, -100.76253953828603, -103.76036267153174, -100.12750228362395, -106.70377491820184, -94.07629407043389, -130.28073055823396, -103.46340804175365, -113.61107132631541, -117.80560272874311, -116.22227911966792, -106.09867040443979, -95.82713960919102, -106.64188679593971, -120.346489640673, -99.97138137741707, -103.65088717458583, -128.34699429252123, -105.03101388073402, -95.58916962090795, -101.07137376396186, -93.43894459780182], "episode_lengths": [1600, 89, 58, 70, 1600, 77, 1600, 184, 80, 75, 212, 65, 87, 115, 80, 1600, 65, 74, 65, 79, 1600, 1600, 51, 1600, 1600, 1600, 118, 1600, 61, 64, 54, 73, 1600, 1600, 92, 1600, 53, 102, 84, 1600, 1600, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28503910607271726, "mean_inference_ms": 0.9426380994749887, "mean_action_processing_ms": 0.1838659189250599, "mean_env_wait_ms": 0.3793138075349907, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006213074638730004, "StateBufferConnector_ms": 0.004234200432187035, "ViewRequirementAgentConnector_ms": 0.11304957526070732}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 417.1493958174654, "num_env_steps_trained_throughput_per_sec": 417.1493958174654, "timesteps_total": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 9620.835, "restore_workers_time_ms": 0.015, "training_step_time_ms": 9620.79, "sample_time_ms": 3624.783, "load_time_ms": 0.449, "load_throughput": 8908481.529, "learn_time_ms": 5987.666, "learn_throughput": 668.04, "synch_weights_time_ms": 7.328}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 42, "training_iteration": 7, "trial_id": "4bb30_00000", "date": "2024-04-27_18-27-45", "timestamp": 1714267665, "time_this_iter_s": 9.593386173248291, "time_total_s": 67.37437677383423, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 67.37437677383423, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 25.015384615384615, "ram_util_percent": 63.77692307692306}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.152589410671624, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9768001376945395, "policy_loss": -0.027505573430048523, "vf_loss": 1.000827384395625, "vf_explained_var": 0.13838315035707208, "kl": 0.01159441856576374, "entropy": 5.878090846666725, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6975.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": -93.43894459780182, "episode_reward_min": -134.52705748740647, "episode_reward_mean": -109.84444970206674, "episode_len_mean": 664.3617021276596, "episode_media": {}, "episodes_this_iter": 5, "episodes_timesteps_total": 31225, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-109.92209126871509, -116.65098024864868, -119.19884756607065, -120.36671843321808, -122.59190624748243, -114.9483269771232, -106.9671069564334, -129.36910563969923, -101.1867437075482, -100.56002648907092, -134.52705748740647, -102.38913960639263, -118.74994481244994, -108.43117049997673, -116.09746386926, -109.57829472732104, -120.75273682216742, -115.15058579896576, -104.29314177363676, -102.03455933137673, -112.93015447386226, -100.76253953828603, -103.76036267153174, -100.12750228362395, -106.70377491820184, -94.07629407043389, -130.28073055823396, -103.46340804175365, -113.61107132631541, -117.80560272874311, -116.22227911966792, -106.09867040443979, -95.82713960919102, -106.64188679593971, -120.346489640673, -99.97138137741707, -103.65088717458583, -128.34699429252123, -105.03101388073402, -95.58916962090795, -101.07137376396186, -93.43894459780182, -115.23800575581697, -104.73206383782501, -112.70068885155021, -96.21844597999262, -104.27631242016145], "episode_lengths": [1600, 89, 58, 70, 1600, 77, 1600, 184, 80, 75, 212, 65, 87, 115, 80, 1600, 65, 74, 65, 79, 1600, 1600, 51, 1600, 1600, 1600, 118, 1600, 61, 64, 54, 73, 1600, 1600, 92, 1600, 53, 102, 84, 1600, 1600, 1600, 1600, 45, 67, 1600, 86]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2847774625610556, "mean_inference_ms": 0.9428940909261571, "mean_action_processing_ms": 0.1838917509513035, "mean_env_wait_ms": 0.37970957146329476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006169968463004904, "StateBufferConnector_ms": 0.004212399746509309, "ViewRequirementAgentConnector_ms": 0.11292569180752368}}, "episode_reward_max": -93.43894459780182, "episode_reward_min": -134.52705748740647, "episode_reward_mean": -109.84444970206674, "episode_len_mean": 664.3617021276596, "episodes_this_iter": 5, "episodes_timesteps_total": 31225, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-109.92209126871509, -116.65098024864868, -119.19884756607065, -120.36671843321808, -122.59190624748243, -114.9483269771232, -106.9671069564334, -129.36910563969923, -101.1867437075482, -100.56002648907092, -134.52705748740647, -102.38913960639263, -118.74994481244994, -108.43117049997673, -116.09746386926, -109.57829472732104, -120.75273682216742, -115.15058579896576, -104.29314177363676, -102.03455933137673, -112.93015447386226, -100.76253953828603, -103.76036267153174, -100.12750228362395, -106.70377491820184, -94.07629407043389, -130.28073055823396, -103.46340804175365, -113.61107132631541, -117.80560272874311, -116.22227911966792, -106.09867040443979, -95.82713960919102, -106.64188679593971, -120.346489640673, -99.97138137741707, -103.65088717458583, -128.34699429252123, -105.03101388073402, -95.58916962090795, -101.07137376396186, -93.43894459780182, -115.23800575581697, -104.73206383782501, -112.70068885155021, -96.21844597999262, -104.27631242016145], "episode_lengths": [1600, 89, 58, 70, 1600, 77, 1600, 184, 80, 75, 212, 65, 87, 115, 80, 1600, 65, 74, 65, 79, 1600, 1600, 51, 1600, 1600, 1600, 118, 1600, 61, 64, 54, 73, 1600, 1600, 92, 1600, 53, 102, 84, 1600, 1600, 1600, 1600, 45, 67, 1600, 86]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2847774625610556, "mean_inference_ms": 0.9428940909261571, "mean_action_processing_ms": 0.1838917509513035, "mean_env_wait_ms": 0.37970957146329476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006169968463004904, "StateBufferConnector_ms": 0.004212399746509309, "ViewRequirementAgentConnector_ms": 0.11292569180752368}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 414.9597071075645, "num_env_steps_trained_throughput_per_sec": 414.9597071075645, "timesteps_total": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 9623.168, "restore_workers_time_ms": 0.015, "training_step_time_ms": 9623.124, "sample_time_ms": 3627.142, "load_time_ms": 0.449, "load_throughput": 8906285.866, "learn_time_ms": 5987.521, "learn_throughput": 668.056, "synch_weights_time_ms": 7.432}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 47, "training_iteration": 8, "trial_id": "4bb30_00000", "date": "2024-04-27_18-27-55", "timestamp": 1714267675, "time_this_iter_s": 9.643548965454102, "time_total_s": 77.01792573928833, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 77.01792573928833, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 24.592857142857138, "ram_util_percent": 63.778571428571425}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.485484327712367, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6087959904515188, "policy_loss": -0.021966883953600014, "vf_loss": 0.6283651268169764, "vf_explained_var": 0.22870447276740946, "kl": 0.007992486087923162, "entropy": 5.824670425538094, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7905.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": -89.53560562766668, "episode_reward_min": -134.52705748740647, "episode_reward_mean": -109.05113429020047, "episode_len_mean": 689.62, "episode_media": {}, "episodes_this_iter": 3, "episodes_timesteps_total": 34481, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-109.92209126871509, -116.65098024864868, -119.19884756607065, -120.36671843321808, -122.59190624748243, -114.9483269771232, -106.9671069564334, -129.36910563969923, -101.1867437075482, -100.56002648907092, -134.52705748740647, -102.38913960639263, -118.74994481244994, -108.43117049997673, -116.09746386926, -109.57829472732104, -120.75273682216742, -115.15058579896576, -104.29314177363676, -102.03455933137673, -112.93015447386226, -100.76253953828603, -103.76036267153174, -100.12750228362395, -106.70377491820184, -94.07629407043389, -130.28073055823396, -103.46340804175365, -113.61107132631541, -117.80560272874311, -116.22227911966792, -106.09867040443979, -95.82713960919102, -106.64188679593971, -120.346489640673, -99.97138137741707, -103.65088717458583, -128.34699429252123, -105.03101388073402, -95.58916962090795, -101.07137376396186, -93.43894459780182, -115.23800575581697, -104.73206383782501, -112.70068885155021, -96.21844597999262, -104.27631242016145, -89.53560562766668, -103.56851343003412, -96.76345945518584], "episode_lengths": [1600, 89, 58, 70, 1600, 77, 1600, 184, 80, 75, 212, 65, 87, 115, 80, 1600, 65, 74, 65, 79, 1600, 1600, 51, 1600, 1600, 1600, 118, 1600, 61, 64, 54, 73, 1600, 1600, 92, 1600, 53, 102, 84, 1600, 1600, 1600, 1600, 45, 67, 1600, 86, 1600, 56, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2846104130432304, "mean_inference_ms": 0.9428336090717724, "mean_action_processing_ms": 0.18392787522710427, "mean_env_wait_ms": 0.3799929792292962, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006110191345214844, "StateBufferConnector_ms": 0.0042819976806640625, "ViewRequirementAgentConnector_ms": 0.11257362365722656}}, "episode_reward_max": -89.53560562766668, "episode_reward_min": -134.52705748740647, "episode_reward_mean": -109.05113429020047, "episode_len_mean": 689.62, "episodes_this_iter": 3, "episodes_timesteps_total": 34481, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-109.92209126871509, -116.65098024864868, -119.19884756607065, -120.36671843321808, -122.59190624748243, -114.9483269771232, -106.9671069564334, -129.36910563969923, -101.1867437075482, -100.56002648907092, -134.52705748740647, -102.38913960639263, -118.74994481244994, -108.43117049997673, -116.09746386926, -109.57829472732104, -120.75273682216742, -115.15058579896576, -104.29314177363676, -102.03455933137673, -112.93015447386226, -100.76253953828603, -103.76036267153174, -100.12750228362395, -106.70377491820184, -94.07629407043389, -130.28073055823396, -103.46340804175365, -113.61107132631541, -117.80560272874311, -116.22227911966792, -106.09867040443979, -95.82713960919102, -106.64188679593971, -120.346489640673, -99.97138137741707, -103.65088717458583, -128.34699429252123, -105.03101388073402, -95.58916962090795, -101.07137376396186, -93.43894459780182, -115.23800575581697, -104.73206383782501, -112.70068885155021, -96.21844597999262, -104.27631242016145, -89.53560562766668, -103.56851343003412, -96.76345945518584], "episode_lengths": [1600, 89, 58, 70, 1600, 77, 1600, 184, 80, 75, 212, 65, 87, 115, 80, 1600, 65, 74, 65, 79, 1600, 1600, 51, 1600, 1600, 1600, 118, 1600, 61, 64, 54, 73, 1600, 1600, 92, 1600, 53, 102, 84, 1600, 1600, 1600, 1600, 45, 67, 1600, 86, 1600, 56, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2846104130432304, "mean_inference_ms": 0.9428336090717724, "mean_action_processing_ms": 0.18392787522710427, "mean_env_wait_ms": 0.3799929792292962, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006110191345214844, "StateBufferConnector_ms": 0.0042819976806640625, "ViewRequirementAgentConnector_ms": 0.11257362365722656}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 421.04576312250765, "num_env_steps_trained_throughput_per_sec": 421.04576312250765, "timesteps_total": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 9609.501, "restore_workers_time_ms": 0.015, "training_step_time_ms": 9609.458, "sample_time_ms": 3623.462, "load_time_ms": 0.459, "load_throughput": 8709906.784, "learn_time_ms": 5977.49, "learn_throughput": 669.177, "synch_weights_time_ms": 7.472}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 50, "training_iteration": 9, "trial_id": "4bb30_00000", "date": "2024-04-27_18-28-04", "timestamp": 1714267684, "time_this_iter_s": 9.504530906677246, "time_total_s": 86.52245664596558, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 86.52245664596558, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 24.61538461538462, "ram_util_percent": 63.73076923076925}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.954723253685941, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2703302289749827, "policy_loss": -0.033714813346503884, "vf_loss": 1.3000233640193297, "vf_explained_var": 0.13341971642227582, "kl": 0.013405588265449051, "entropy": 5.916240680345925, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8835.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": -89.53560562766668, "episode_reward_min": -134.52705748740647, "episode_reward_mean": -109.06330820166785, "episode_len_mean": 678.1071428571429, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 37974, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-109.92209126871509, -116.65098024864868, -119.19884756607065, -120.36671843321808, -122.59190624748243, -114.9483269771232, -106.9671069564334, -129.36910563969923, -101.1867437075482, -100.56002648907092, -134.52705748740647, -102.38913960639263, -118.74994481244994, -108.43117049997673, -116.09746386926, -109.57829472732104, -120.75273682216742, -115.15058579896576, -104.29314177363676, -102.03455933137673, -112.93015447386226, -100.76253953828603, -103.76036267153174, -100.12750228362395, -106.70377491820184, -94.07629407043389, -130.28073055823396, -103.46340804175365, -113.61107132631541, -117.80560272874311, -116.22227911966792, -106.09867040443979, -95.82713960919102, -106.64188679593971, -120.346489640673, -99.97138137741707, -103.65088717458583, -128.34699429252123, -105.03101388073402, -95.58916962090795, -101.07137376396186, -93.43894459780182, -115.23800575581697, -104.73206383782501, -112.70068885155021, -96.21844597999262, -104.27631242016145, -89.53560562766668, -103.56851343003412, -96.76345945518584, -112.24333749494114, -106.71667261362387, -108.70939206354065, -106.32906870663787, -116.68288022541192, -104.30719367922036], "episode_lengths": [1600, 89, 58, 70, 1600, 77, 1600, 184, 80, 75, 212, 65, 87, 115, 80, 1600, 65, 74, 65, 79, 1600, 1600, 51, 1600, 1600, 1600, 118, 1600, 61, 64, 54, 73, 1600, 1600, 92, 1600, 53, 102, 84, 1600, 1600, 1600, 1600, 45, 67, 1600, 86, 1600, 56, 1600, 1600, 57, 1600, 93, 68, 75]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28437805899314955, "mean_inference_ms": 0.9430527634289231, "mean_action_processing_ms": 0.1839671843492646, "mean_env_wait_ms": 0.38030425923278327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006004316466195243, "StateBufferConnector_ms": 0.00425236565726144, "ViewRequirementAgentConnector_ms": 0.11233176503862653}}, "episode_reward_max": -89.53560562766668, "episode_reward_min": -134.52705748740647, "episode_reward_mean": -109.06330820166785, "episode_len_mean": 678.1071428571429, "episodes_this_iter": 6, "episodes_timesteps_total": 37974, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-109.92209126871509, -116.65098024864868, -119.19884756607065, -120.36671843321808, -122.59190624748243, -114.9483269771232, -106.9671069564334, -129.36910563969923, -101.1867437075482, -100.56002648907092, -134.52705748740647, -102.38913960639263, -118.74994481244994, -108.43117049997673, -116.09746386926, -109.57829472732104, -120.75273682216742, -115.15058579896576, -104.29314177363676, -102.03455933137673, -112.93015447386226, -100.76253953828603, -103.76036267153174, -100.12750228362395, -106.70377491820184, -94.07629407043389, -130.28073055823396, -103.46340804175365, -113.61107132631541, -117.80560272874311, -116.22227911966792, -106.09867040443979, -95.82713960919102, -106.64188679593971, -120.346489640673, -99.97138137741707, -103.65088717458583, -128.34699429252123, -105.03101388073402, -95.58916962090795, -101.07137376396186, -93.43894459780182, -115.23800575581697, -104.73206383782501, -112.70068885155021, -96.21844597999262, -104.27631242016145, -89.53560562766668, -103.56851343003412, -96.76345945518584, -112.24333749494114, -106.71667261362387, -108.70939206354065, -106.32906870663787, -116.68288022541192, -104.30719367922036], "episode_lengths": [1600, 89, 58, 70, 1600, 77, 1600, 184, 80, 75, 212, 65, 87, 115, 80, 1600, 65, 74, 65, 79, 1600, 1600, 51, 1600, 1600, 1600, 118, 1600, 61, 64, 54, 73, 1600, 1600, 92, 1600, 53, 102, 84, 1600, 1600, 1600, 1600, 45, 67, 1600, 86, 1600, 56, 1600, 1600, 57, 1600, 93, 68, 75]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28437805899314955, "mean_inference_ms": 0.9430527634289231, "mean_action_processing_ms": 0.1839671843492646, "mean_env_wait_ms": 0.38030425923278327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006004316466195243, "StateBufferConnector_ms": 0.00425236565726144, "ViewRequirementAgentConnector_ms": 0.11233176503862653}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 415.136970424476, "num_env_steps_trained_throughput_per_sec": 415.136970424476, "timesteps_total": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 9612.089, "restore_workers_time_ms": 0.015, "training_step_time_ms": 9612.047, "sample_time_ms": 3626.338, "load_time_ms": 0.462, "load_throughput": 8657867.685, "learn_time_ms": 5977.153, "learn_throughput": 669.215, "synch_weights_time_ms": 7.513}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 56, "training_iteration": 10, "trial_id": "4bb30_00000", "date": "2024-04-27_18-28-14", "timestamp": 1714267694, "time_this_iter_s": 9.639670133590698, "time_total_s": 96.16212677955627, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 96.16212677955627, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 24.72142857142857, "ram_util_percent": 63.7642857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.12467005688657, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.546750517584689, "policy_loss": -0.03263308120671139, "vf_loss": 1.5732590394495156, "vf_explained_var": 0.2957544054395409, "kl": 0.02041516694559692, "entropy": 5.904469186003491, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9765.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "sampler_results": {"episode_reward_max": -82.45233979494078, "episode_reward_min": -134.52705748740647, "episode_reward_mean": -108.31383415365912, "episode_len_mean": 631.1818181818181, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 41658, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-109.92209126871509, -116.65098024864868, -119.19884756607065, -120.36671843321808, -122.59190624748243, -114.9483269771232, -106.9671069564334, -129.36910563969923, -101.1867437075482, -100.56002648907092, -134.52705748740647, -102.38913960639263, -118.74994481244994, -108.43117049997673, -116.09746386926, -109.57829472732104, -120.75273682216742, -115.15058579896576, -104.29314177363676, -102.03455933137673, -112.93015447386226, -100.76253953828603, -103.76036267153174, -100.12750228362395, -106.70377491820184, -94.07629407043389, -130.28073055823396, -103.46340804175365, -113.61107132631541, -117.80560272874311, -116.22227911966792, -106.09867040443979, -95.82713960919102, -106.64188679593971, -120.346489640673, -99.97138137741707, -103.65088717458583, -128.34699429252123, -105.03101388073402, -95.58916962090795, -101.07137376396186, -93.43894459780182, -115.23800575581697, -104.73206383782501, -112.70068885155021, -96.21844597999262, -104.27631242016145, -89.53560562766668, -103.56851343003412, -96.76345945518584, -112.24333749494114, -106.71667261362387, -108.70939206354065, -106.32906870663787, -116.68288022541192, -104.30719367922036, -87.11550999566906, -107.50258675165475, -104.111180958086, -122.01708324265914, -108.0012975794319, -82.45233979494078, -104.14582359977129, -107.12532983712417, -103.94129217610757, -114.75535091265726], "episode_lengths": [1600, 89, 58, 70, 1600, 77, 1600, 184, 80, 75, 212, 65, 87, 115, 80, 1600, 65, 74, 65, 79, 1600, 1600, 51, 1600, 1600, 1600, 118, 1600, 61, 64, 54, 73, 1600, 1600, 92, 1600, 53, 102, 84, 1600, 1600, 1600, 1600, 45, 67, 1600, 86, 1600, 56, 1600, 1600, 57, 1600, 93, 68, 75, 1600, 50, 60, 93, 70, 1600, 49, 39, 62, 61]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28416918879496955, "mean_inference_ms": 0.9431669956072531, "mean_action_processing_ms": 0.1840336353315043, "mean_env_wait_ms": 0.3809881668518764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006015734239058061, "StateBufferConnector_ms": 0.00438870805682558, "ViewRequirementAgentConnector_ms": 0.11500625899343779}}, "episode_reward_max": -82.45233979494078, "episode_reward_min": -134.52705748740647, "episode_reward_mean": -108.31383415365912, "episode_len_mean": 631.1818181818181, "episodes_this_iter": 10, "episodes_timesteps_total": 41658, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-109.92209126871509, -116.65098024864868, -119.19884756607065, -120.36671843321808, -122.59190624748243, -114.9483269771232, -106.9671069564334, -129.36910563969923, -101.1867437075482, -100.56002648907092, -134.52705748740647, -102.38913960639263, -118.74994481244994, -108.43117049997673, -116.09746386926, -109.57829472732104, -120.75273682216742, -115.15058579896576, -104.29314177363676, -102.03455933137673, -112.93015447386226, -100.76253953828603, -103.76036267153174, -100.12750228362395, -106.70377491820184, -94.07629407043389, -130.28073055823396, -103.46340804175365, -113.61107132631541, -117.80560272874311, -116.22227911966792, -106.09867040443979, -95.82713960919102, -106.64188679593971, -120.346489640673, -99.97138137741707, -103.65088717458583, -128.34699429252123, -105.03101388073402, -95.58916962090795, -101.07137376396186, -93.43894459780182, -115.23800575581697, -104.73206383782501, -112.70068885155021, -96.21844597999262, -104.27631242016145, -89.53560562766668, -103.56851343003412, -96.76345945518584, -112.24333749494114, -106.71667261362387, -108.70939206354065, -106.32906870663787, -116.68288022541192, -104.30719367922036, -87.11550999566906, -107.50258675165475, -104.111180958086, -122.01708324265914, -108.0012975794319, -82.45233979494078, -104.14582359977129, -107.12532983712417, -103.94129217610757, -114.75535091265726], "episode_lengths": [1600, 89, 58, 70, 1600, 77, 1600, 184, 80, 75, 212, 65, 87, 115, 80, 1600, 65, 74, 65, 79, 1600, 1600, 51, 1600, 1600, 1600, 118, 1600, 61, 64, 54, 73, 1600, 1600, 92, 1600, 53, 102, 84, 1600, 1600, 1600, 1600, 45, 67, 1600, 86, 1600, 56, 1600, 1600, 57, 1600, 93, 68, 75, 1600, 50, 60, 93, 70, 1600, 49, 39, 62, 61]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28416918879496955, "mean_inference_ms": 0.9431669956072531, "mean_action_processing_ms": 0.1840336353315043, "mean_env_wait_ms": 0.3809881668518764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006015734239058061, "StateBufferConnector_ms": 0.00438870805682558, "ViewRequirementAgentConnector_ms": 0.11500625899343779}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 415.9177561921354, "num_env_steps_trained_throughput_per_sec": 415.9177561921354, "timesteps_total": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 9618.946, "restore_workers_time_ms": 0.014, "training_step_time_ms": 9618.906, "sample_time_ms": 3632.707, "load_time_ms": 0.489, "load_throughput": 8180815.292, "learn_time_ms": 5977.647, "learn_throughput": 669.16, "synch_weights_time_ms": 7.498}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "episodes_total": 66, "training_iteration": 11, "trial_id": "4bb30_00000", "date": "2024-04-27_18-28-23", "timestamp": 1714267703, "time_this_iter_s": 9.621753215789795, "time_total_s": 105.78387999534607, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 105.78387999534607, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 25.364285714285717, "ram_util_percent": 63.76428571428569}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.968434365077686, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.272910068368399, "policy_loss": -0.03475738057406039, "vf_loss": 2.3006138708602677, "vf_explained_var": 0.27666392313536775, "kl": 0.015674610491128928, "entropy": 5.999432758618426, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10695.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": -81.22369246140391, "episode_reward_min": -134.52705748740647, "episode_reward_mean": -107.80421522862082, "episode_len_mean": 614.5675675675676, "episode_media": {}, "episodes_this_iter": 8, "episodes_timesteps_total": 45478, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-109.92209126871509, -116.65098024864868, -119.19884756607065, -120.36671843321808, -122.59190624748243, -114.9483269771232, -106.9671069564334, -129.36910563969923, -101.1867437075482, -100.56002648907092, -134.52705748740647, -102.38913960639263, -118.74994481244994, -108.43117049997673, -116.09746386926, -109.57829472732104, -120.75273682216742, -115.15058579896576, -104.29314177363676, -102.03455933137673, -112.93015447386226, -100.76253953828603, -103.76036267153174, -100.12750228362395, -106.70377491820184, -94.07629407043389, -130.28073055823396, -103.46340804175365, -113.61107132631541, -117.80560272874311, -116.22227911966792, -106.09867040443979, -95.82713960919102, -106.64188679593971, -120.346489640673, -99.97138137741707, -103.65088717458583, -128.34699429252123, -105.03101388073402, -95.58916962090795, -101.07137376396186, -93.43894459780182, -115.23800575581697, -104.73206383782501, -112.70068885155021, -96.21844597999262, -104.27631242016145, -89.53560562766668, -103.56851343003412, -96.76345945518584, -112.24333749494114, -106.71667261362387, -108.70939206354065, -106.32906870663787, -116.68288022541192, -104.30719367922036, -87.11550999566906, -107.50258675165475, -104.111180958086, -122.01708324265914, -108.0012975794319, -82.45233979494078, -104.14582359977129, -107.12532983712417, -103.94129217610757, -114.75535091265726, -81.22369246140391, -127.99003755195812, -102.79396384006739, -101.79639154564651, -87.33775281334725, -116.7657107462082, -104.76372078885139, -106.1276030289568], "episode_lengths": [1600, 89, 58, 70, 1600, 77, 1600, 184, 80, 75, 212, 65, 87, 115, 80, 1600, 65, 74, 65, 79, 1600, 1600, 51, 1600, 1600, 1600, 118, 1600, 61, 64, 54, 73, 1600, 1600, 92, 1600, 53, 102, 84, 1600, 1600, 1600, 1600, 45, 67, 1600, 86, 1600, 56, 1600, 1600, 57, 1600, 93, 68, 75, 1600, 50, 60, 93, 70, 1600, 49, 39, 62, 61, 1600, 303, 50, 49, 1600, 71, 67, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2840683842955394, "mean_inference_ms": 0.943281665993172, "mean_action_processing_ms": 0.18409708993993576, "mean_env_wait_ms": 0.3814007876829717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005985595084525444, "StateBufferConnector_ms": 0.004452950245625264, "ViewRequirementAgentConnector_ms": 0.11449182355726087}}, "episode_reward_max": -81.22369246140391, "episode_reward_min": -134.52705748740647, "episode_reward_mean": -107.80421522862082, "episode_len_mean": 614.5675675675676, "episodes_this_iter": 8, "episodes_timesteps_total": 45478, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-109.92209126871509, -116.65098024864868, -119.19884756607065, -120.36671843321808, -122.59190624748243, -114.9483269771232, -106.9671069564334, -129.36910563969923, -101.1867437075482, -100.56002648907092, -134.52705748740647, -102.38913960639263, -118.74994481244994, -108.43117049997673, -116.09746386926, -109.57829472732104, -120.75273682216742, -115.15058579896576, -104.29314177363676, -102.03455933137673, -112.93015447386226, -100.76253953828603, -103.76036267153174, -100.12750228362395, -106.70377491820184, -94.07629407043389, -130.28073055823396, -103.46340804175365, -113.61107132631541, -117.80560272874311, -116.22227911966792, -106.09867040443979, -95.82713960919102, -106.64188679593971, -120.346489640673, -99.97138137741707, -103.65088717458583, -128.34699429252123, -105.03101388073402, -95.58916962090795, -101.07137376396186, -93.43894459780182, -115.23800575581697, -104.73206383782501, -112.70068885155021, -96.21844597999262, -104.27631242016145, -89.53560562766668, -103.56851343003412, -96.76345945518584, -112.24333749494114, -106.71667261362387, -108.70939206354065, -106.32906870663787, -116.68288022541192, -104.30719367922036, -87.11550999566906, -107.50258675165475, -104.111180958086, -122.01708324265914, -108.0012975794319, -82.45233979494078, -104.14582359977129, -107.12532983712417, -103.94129217610757, -114.75535091265726, -81.22369246140391, -127.99003755195812, -102.79396384006739, -101.79639154564651, -87.33775281334725, -116.7657107462082, -104.76372078885139, -106.1276030289568], "episode_lengths": [1600, 89, 58, 70, 1600, 77, 1600, 184, 80, 75, 212, 65, 87, 115, 80, 1600, 65, 74, 65, 79, 1600, 1600, 51, 1600, 1600, 1600, 118, 1600, 61, 64, 54, 73, 1600, 1600, 92, 1600, 53, 102, 84, 1600, 1600, 1600, 1600, 45, 67, 1600, 86, 1600, 56, 1600, 1600, 57, 1600, 93, 68, 75, 1600, 50, 60, 93, 70, 1600, 49, 39, 62, 61, 1600, 303, 50, 49, 1600, 71, 67, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2840683842955394, "mean_inference_ms": 0.943281665993172, "mean_action_processing_ms": 0.18409708993993576, "mean_env_wait_ms": 0.3814007876829717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005985595084525444, "StateBufferConnector_ms": 0.004452950245625264, "ViewRequirementAgentConnector_ms": 0.11449182355726087}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 415.4910874507705, "num_env_steps_trained_throughput_per_sec": 415.4910874507705, "timesteps_total": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 9616.786, "restore_workers_time_ms": 0.014, "training_step_time_ms": 9616.747, "sample_time_ms": 3632.306, "load_time_ms": 0.501, "load_throughput": 7989911.42, "learn_time_ms": 5975.877, "learn_throughput": 669.358, "synch_weights_time_ms": 7.485}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 74, "training_iteration": 12, "trial_id": "4bb30_00000", "date": "2024-04-27_18-28-33", "timestamp": 1714267713, "time_this_iter_s": 9.631042957305908, "time_total_s": 115.41492295265198, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 115.41492295265198, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 24.342857142857138, "ram_util_percent": 63.799999999999976}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.636658394208519, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1861200396011595, "policy_loss": -0.02864395264656313, "vf_loss": 2.2090427040993688, "vf_explained_var": 0.2304091489443215, "kl": 0.012713958167403963, "entropy": 6.1159454776394755, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11625.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "sampler_results": {"episode_reward_max": -81.22369246140391, "episode_reward_min": -134.52705748740647, "episode_reward_mean": -107.87007083232548, "episode_len_mean": 573.8953488372093, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 49355, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-109.92209126871509, -116.65098024864868, -119.19884756607065, -120.36671843321808, -122.59190624748243, -114.9483269771232, -106.9671069564334, -129.36910563969923, -101.1867437075482, -100.56002648907092, -134.52705748740647, -102.38913960639263, -118.74994481244994, -108.43117049997673, -116.09746386926, -109.57829472732104, -120.75273682216742, -115.15058579896576, -104.29314177363676, -102.03455933137673, -112.93015447386226, -100.76253953828603, -103.76036267153174, -100.12750228362395, -106.70377491820184, -94.07629407043389, -130.28073055823396, -103.46340804175365, -113.61107132631541, -117.80560272874311, -116.22227911966792, -106.09867040443979, -95.82713960919102, -106.64188679593971, -120.346489640673, -99.97138137741707, -103.65088717458583, -128.34699429252123, -105.03101388073402, -95.58916962090795, -101.07137376396186, -93.43894459780182, -115.23800575581697, -104.73206383782501, -112.70068885155021, -96.21844597999262, -104.27631242016145, -89.53560562766668, -103.56851343003412, -96.76345945518584, -112.24333749494114, -106.71667261362387, -108.70939206354065, -106.32906870663787, -116.68288022541192, -104.30719367922036, -87.11550999566906, -107.50258675165475, -104.111180958086, -122.01708324265914, -108.0012975794319, -82.45233979494078, -104.14582359977129, -107.12532983712417, -103.94129217610757, -114.75535091265726, -81.22369246140391, -127.99003755195812, -102.79396384006739, -101.79639154564651, -87.33775281334725, -116.7657107462082, -104.76372078885139, -106.1276030289568, -89.10226245965167, -118.44361436706409, -105.24952318280315, -92.5982794553297, -111.02403319416257, -107.45596948867912, -103.86614714373648, -108.90085686180555, -112.1067748894555, -124.04939442002772, -110.29107356416435, -116.22623563516885], "episode_lengths": [1600, 89, 58, 70, 1600, 77, 1600, 184, 80, 75, 212, 65, 87, 115, 80, 1600, 65, 74, 65, 79, 1600, 1600, 51, 1600, 1600, 1600, 118, 1600, 61, 64, 54, 73, 1600, 1600, 92, 1600, 53, 102, 84, 1600, 1600, 1600, 1600, 45, 67, 1600, 86, 1600, 56, 1600, 1600, 57, 1600, 93, 68, 75, 1600, 50, 60, 93, 70, 1600, 49, 39, 62, 61, 1600, 303, 50, 49, 1600, 71, 67, 80, 1600, 101, 51, 1600, 44, 62, 67, 52, 45, 125, 43, 87]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28406601451949515, "mean_inference_ms": 0.9437381423758985, "mean_action_processing_ms": 0.18414483578980748, "mean_env_wait_ms": 0.38165458329182567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0059762666391771895, "StateBufferConnector_ms": 0.004419060640556868, "ViewRequirementAgentConnector_ms": 0.11520413465278093}}, "episode_reward_max": -81.22369246140391, "episode_reward_min": -134.52705748740647, "episode_reward_mean": -107.87007083232548, "episode_len_mean": 573.8953488372093, "episodes_this_iter": 12, "episodes_timesteps_total": 49355, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-109.92209126871509, -116.65098024864868, -119.19884756607065, -120.36671843321808, -122.59190624748243, -114.9483269771232, -106.9671069564334, -129.36910563969923, -101.1867437075482, -100.56002648907092, -134.52705748740647, -102.38913960639263, -118.74994481244994, -108.43117049997673, -116.09746386926, -109.57829472732104, -120.75273682216742, -115.15058579896576, -104.29314177363676, -102.03455933137673, -112.93015447386226, -100.76253953828603, -103.76036267153174, -100.12750228362395, -106.70377491820184, -94.07629407043389, -130.28073055823396, -103.46340804175365, -113.61107132631541, -117.80560272874311, -116.22227911966792, -106.09867040443979, -95.82713960919102, -106.64188679593971, -120.346489640673, -99.97138137741707, -103.65088717458583, -128.34699429252123, -105.03101388073402, -95.58916962090795, -101.07137376396186, -93.43894459780182, -115.23800575581697, -104.73206383782501, -112.70068885155021, -96.21844597999262, -104.27631242016145, -89.53560562766668, -103.56851343003412, -96.76345945518584, -112.24333749494114, -106.71667261362387, -108.70939206354065, -106.32906870663787, -116.68288022541192, -104.30719367922036, -87.11550999566906, -107.50258675165475, -104.111180958086, -122.01708324265914, -108.0012975794319, -82.45233979494078, -104.14582359977129, -107.12532983712417, -103.94129217610757, -114.75535091265726, -81.22369246140391, -127.99003755195812, -102.79396384006739, -101.79639154564651, -87.33775281334725, -116.7657107462082, -104.76372078885139, -106.1276030289568, -89.10226245965167, -118.44361436706409, -105.24952318280315, -92.5982794553297, -111.02403319416257, -107.45596948867912, -103.86614714373648, -108.90085686180555, -112.1067748894555, -124.04939442002772, -110.29107356416435, -116.22623563516885], "episode_lengths": [1600, 89, 58, 70, 1600, 77, 1600, 184, 80, 75, 212, 65, 87, 115, 80, 1600, 65, 74, 65, 79, 1600, 1600, 51, 1600, 1600, 1600, 118, 1600, 61, 64, 54, 73, 1600, 1600, 92, 1600, 53, 102, 84, 1600, 1600, 1600, 1600, 45, 67, 1600, 86, 1600, 56, 1600, 1600, 57, 1600, 93, 68, 75, 1600, 50, 60, 93, 70, 1600, 49, 39, 62, 61, 1600, 303, 50, 49, 1600, 71, 67, 80, 1600, 101, 51, 1600, 44, 62, 67, 52, 45, 125, 43, 87]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28406601451949515, "mean_inference_ms": 0.9437381423758985, "mean_action_processing_ms": 0.18414483578980748, "mean_env_wait_ms": 0.38165458329182567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0059762666391771895, "StateBufferConnector_ms": 0.004419060640556868, "ViewRequirementAgentConnector_ms": 0.11520413465278093}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 415.06240773967005, "num_env_steps_trained_throughput_per_sec": 415.06240773967005, "timesteps_total": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 9604.64, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9604.603, "sample_time_ms": 3641.23, "load_time_ms": 0.497, "load_throughput": 8050873.842, "learn_time_ms": 5954.739, "learn_throughput": 671.734, "synch_weights_time_ms": 7.558}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "episodes_total": 86, "training_iteration": 13, "trial_id": "4bb30_00000", "date": "2024-04-27_18-28-43", "timestamp": 1714267723, "time_this_iter_s": 9.641134977340698, "time_total_s": 125.05605792999268, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 125.05605792999268, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 24.87692307692308, "ram_util_percent": 63.80769230769229}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.303712122222429, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8913414688330263, "policy_loss": -0.028498892790527752, "vf_loss": 1.9137232506507507, "vf_explained_var": 0.30230627258618675, "kl": 0.013593590455177487, "entropy": 6.136361190836917, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 12555.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "sampler_results": {"episode_reward_max": -81.22369246140391, "episode_reward_min": -134.52705748740647, "episode_reward_mean": -106.97770136820974, "episode_len_mean": 563.9072164948453, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 54699, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-109.92209126871509, -116.65098024864868, -119.19884756607065, -120.36671843321808, -122.59190624748243, -114.9483269771232, -106.9671069564334, -129.36910563969923, -101.1867437075482, -100.56002648907092, -134.52705748740647, -102.38913960639263, -118.74994481244994, -108.43117049997673, -116.09746386926, -109.57829472732104, -120.75273682216742, -115.15058579896576, -104.29314177363676, -102.03455933137673, -112.93015447386226, -100.76253953828603, -103.76036267153174, -100.12750228362395, -106.70377491820184, -94.07629407043389, -130.28073055823396, -103.46340804175365, -113.61107132631541, -117.80560272874311, -116.22227911966792, -106.09867040443979, -95.82713960919102, -106.64188679593971, -120.346489640673, -99.97138137741707, -103.65088717458583, -128.34699429252123, -105.03101388073402, -95.58916962090795, -101.07137376396186, -93.43894459780182, -115.23800575581697, -104.73206383782501, -112.70068885155021, -96.21844597999262, -104.27631242016145, -89.53560562766668, -103.56851343003412, -96.76345945518584, -112.24333749494114, -106.71667261362387, -108.70939206354065, -106.32906870663787, -116.68288022541192, -104.30719367922036, -87.11550999566906, -107.50258675165475, -104.111180958086, -122.01708324265914, -108.0012975794319, -82.45233979494078, -104.14582359977129, -107.12532983712417, -103.94129217610757, -114.75535091265726, -81.22369246140391, -127.99003755195812, -102.79396384006739, -101.79639154564651, -87.33775281334725, -116.7657107462082, -104.76372078885139, -106.1276030289568, -89.10226245965167, -118.44361436706409, -105.24952318280315, -92.5982794553297, -111.02403319416257, -107.45596948867912, -103.86614714373648, -108.90085686180555, -112.1067748894555, -124.04939442002772, -110.29107356416435, -116.22623563516885, -84.64630997967907, -105.76017226390044, -103.97930915100065, -108.41757266596704, -89.03733666494176, -107.70220346655199, -84.23273590600103, -104.90585915759269, -106.2253520122189, -101.0719301598873, -104.03215970861228], "episode_lengths": [1600, 89, 58, 70, 1600, 77, 1600, 184, 80, 75, 212, 65, 87, 115, 80, 1600, 65, 74, 65, 79, 1600, 1600, 51, 1600, 1600, 1600, 118, 1600, 61, 64, 54, 73, 1600, 1600, 92, 1600, 53, 102, 84, 1600, 1600, 1600, 1600, 45, 67, 1600, 86, 1600, 56, 1600, 1600, 57, 1600, 93, 68, 75, 1600, 50, 60, 93, 70, 1600, 49, 39, 62, 61, 1600, 303, 50, 49, 1600, 71, 67, 80, 1600, 101, 51, 1600, 44, 62, 67, 52, 45, 125, 43, 87, 1600, 89, 58, 64, 1600, 60, 1600, 81, 60, 71, 61]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28410507548856473, "mean_inference_ms": 0.9438876709078695, "mean_action_processing_ms": 0.18423940639777536, "mean_env_wait_ms": 0.38204627567616256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00593539365788096, "StateBufferConnector_ms": 0.004373137483891752, "ViewRequirementAgentConnector_ms": 0.11462083796864932}}, "episode_reward_max": -81.22369246140391, "episode_reward_min": -134.52705748740647, "episode_reward_mean": -106.97770136820974, "episode_len_mean": 563.9072164948453, "episodes_this_iter": 11, "episodes_timesteps_total": 54699, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-109.92209126871509, -116.65098024864868, -119.19884756607065, -120.36671843321808, -122.59190624748243, -114.9483269771232, -106.9671069564334, -129.36910563969923, -101.1867437075482, -100.56002648907092, -134.52705748740647, -102.38913960639263, -118.74994481244994, -108.43117049997673, -116.09746386926, -109.57829472732104, -120.75273682216742, -115.15058579896576, -104.29314177363676, -102.03455933137673, -112.93015447386226, -100.76253953828603, -103.76036267153174, -100.12750228362395, -106.70377491820184, -94.07629407043389, -130.28073055823396, -103.46340804175365, -113.61107132631541, -117.80560272874311, -116.22227911966792, -106.09867040443979, -95.82713960919102, -106.64188679593971, -120.346489640673, -99.97138137741707, -103.65088717458583, -128.34699429252123, -105.03101388073402, -95.58916962090795, -101.07137376396186, -93.43894459780182, -115.23800575581697, -104.73206383782501, -112.70068885155021, -96.21844597999262, -104.27631242016145, -89.53560562766668, -103.56851343003412, -96.76345945518584, -112.24333749494114, -106.71667261362387, -108.70939206354065, -106.32906870663787, -116.68288022541192, -104.30719367922036, -87.11550999566906, -107.50258675165475, -104.111180958086, -122.01708324265914, -108.0012975794319, -82.45233979494078, -104.14582359977129, -107.12532983712417, -103.94129217610757, -114.75535091265726, -81.22369246140391, -127.99003755195812, -102.79396384006739, -101.79639154564651, -87.33775281334725, -116.7657107462082, -104.76372078885139, -106.1276030289568, -89.10226245965167, -118.44361436706409, -105.24952318280315, -92.5982794553297, -111.02403319416257, -107.45596948867912, -103.86614714373648, -108.90085686180555, -112.1067748894555, -124.04939442002772, -110.29107356416435, -116.22623563516885, -84.64630997967907, -105.76017226390044, -103.97930915100065, -108.41757266596704, -89.03733666494176, -107.70220346655199, -84.23273590600103, -104.90585915759269, -106.2253520122189, -101.0719301598873, -104.03215970861228], "episode_lengths": [1600, 89, 58, 70, 1600, 77, 1600, 184, 80, 75, 212, 65, 87, 115, 80, 1600, 65, 74, 65, 79, 1600, 1600, 51, 1600, 1600, 1600, 118, 1600, 61, 64, 54, 73, 1600, 1600, 92, 1600, 53, 102, 84, 1600, 1600, 1600, 1600, 45, 67, 1600, 86, 1600, 56, 1600, 1600, 57, 1600, 93, 68, 75, 1600, 50, 60, 93, 70, 1600, 49, 39, 62, 61, 1600, 303, 50, 49, 1600, 71, 67, 80, 1600, 101, 51, 1600, 44, 62, 67, 52, 45, 125, 43, 87, 1600, 89, 58, 64, 1600, 60, 1600, 81, 60, 71, 61]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28410507548856473, "mean_inference_ms": 0.9438876709078695, "mean_action_processing_ms": 0.18423940639777536, "mean_env_wait_ms": 0.38204627567616256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00593539365788096, "StateBufferConnector_ms": 0.004373137483891752, "ViewRequirementAgentConnector_ms": 0.11462083796864932}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 413.40734437756004, "num_env_steps_trained_throughput_per_sec": 413.40734437756004, "timesteps_total": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 9614.878, "restore_workers_time_ms": 0.016, "training_step_time_ms": 9614.839, "sample_time_ms": 3646.464, "load_time_ms": 0.503, "load_throughput": 7945262.36, "learn_time_ms": 5959.871, "learn_throughput": 671.156, "synch_weights_time_ms": 7.428}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "episodes_total": 97, "training_iteration": 14, "trial_id": "4bb30_00000", "date": "2024-04-27_18-28-53", "timestamp": 1714267733, "time_this_iter_s": 9.680163145065308, "time_total_s": 134.73622107505798, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 134.73622107505798, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 24.321428571428577, "ram_util_percent": 63.799999999999976}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.4796141971824, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1613993744501063, "policy_loss": -0.033808210572247865, "vf_loss": 2.189825601479219, "vf_explained_var": 0.2829001699724505, "kl": 0.011959984976000426, "entropy": 6.6620206817503895, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13485.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": -81.22369246140391, "episode_reward_min": -134.52705748740647, "episode_reward_mean": -106.75266428641143, "episode_len_mean": 564.8, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 56480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-122.59190624748243, -114.9483269771232, -106.9671069564334, -129.36910563969923, -101.1867437075482, -100.56002648907092, -134.52705748740647, -102.38913960639263, -118.74994481244994, -108.43117049997673, -116.09746386926, -109.57829472732104, -120.75273682216742, -115.15058579896576, -104.29314177363676, -102.03455933137673, -112.93015447386226, -100.76253953828603, -103.76036267153174, -100.12750228362395, -106.70377491820184, -94.07629407043389, -130.28073055823396, -103.46340804175365, -113.61107132631541, -117.80560272874311, -116.22227911966792, -106.09867040443979, -95.82713960919102, -106.64188679593971, -120.346489640673, -99.97138137741707, -103.65088717458583, -128.34699429252123, -105.03101388073402, -95.58916962090795, -101.07137376396186, -93.43894459780182, -115.23800575581697, -104.73206383782501, -112.70068885155021, -96.21844597999262, -104.27631242016145, -89.53560562766668, -103.56851343003412, -96.76345945518584, -112.24333749494114, -106.71667261362387, -108.70939206354065, -106.32906870663787, -116.68288022541192, -104.30719367922036, -87.11550999566906, -107.50258675165475, -104.111180958086, -122.01708324265914, -108.0012975794319, -82.45233979494078, -104.14582359977129, -107.12532983712417, -103.94129217610757, -114.75535091265726, -81.22369246140391, -127.99003755195812, -102.79396384006739, -101.79639154564651, -87.33775281334725, -116.7657107462082, -104.76372078885139, -106.1276030289568, -89.10226245965167, -118.44361436706409, -105.24952318280315, -92.5982794553297, -111.02403319416257, -107.45596948867912, -103.86614714373648, -108.90085686180555, -112.1067748894555, -124.04939442002772, -110.29107356416435, -116.22623563516885, -84.64630997967907, -105.76017226390044, -103.97930915100065, -108.41757266596704, -89.03733666494176, -107.70220346655199, -84.23273590600103, -104.90585915759269, -106.2253520122189, -101.0719301598873, -104.03215970861228, -124.00182596852915, -107.41293677988587, -103.84442762617519, -114.16456270627243, -123.82013567618466, -92.0159127928355, -99.30823189157124], "episode_lengths": [1600, 77, 1600, 184, 80, 75, 212, 65, 87, 115, 80, 1600, 65, 74, 65, 79, 1600, 1600, 51, 1600, 1600, 1600, 118, 1600, 61, 64, 54, 73, 1600, 1600, 92, 1600, 53, 102, 84, 1600, 1600, 1600, 1600, 45, 67, 1600, 86, 1600, 56, 1600, 1600, 57, 1600, 93, 68, 75, 1600, 50, 60, 93, 70, 1600, 49, 39, 62, 61, 1600, 303, 50, 49, 1600, 71, 67, 80, 1600, 101, 51, 1600, 44, 62, 67, 52, 45, 125, 43, 87, 1600, 89, 58, 64, 1600, 60, 1600, 81, 60, 71, 61, 1600, 71, 68, 69, 104, 1600, 86]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28411603331598456, "mean_inference_ms": 0.9441394443804982, "mean_action_processing_ms": 0.18433459241012476, "mean_env_wait_ms": 0.3825249558787682, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005857944488525391, "StateBufferConnector_ms": 0.004405498504638672, "ViewRequirementAgentConnector_ms": 0.11392831802368164}}, "episode_reward_max": -81.22369246140391, "episode_reward_min": -134.52705748740647, "episode_reward_mean": -106.75266428641143, "episode_len_mean": 564.8, "episodes_this_iter": 7, "episodes_timesteps_total": 56480, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-122.59190624748243, -114.9483269771232, -106.9671069564334, -129.36910563969923, -101.1867437075482, -100.56002648907092, -134.52705748740647, -102.38913960639263, -118.74994481244994, -108.43117049997673, -116.09746386926, -109.57829472732104, -120.75273682216742, -115.15058579896576, -104.29314177363676, -102.03455933137673, -112.93015447386226, -100.76253953828603, -103.76036267153174, -100.12750228362395, -106.70377491820184, -94.07629407043389, -130.28073055823396, -103.46340804175365, -113.61107132631541, -117.80560272874311, -116.22227911966792, -106.09867040443979, -95.82713960919102, -106.64188679593971, -120.346489640673, -99.97138137741707, -103.65088717458583, -128.34699429252123, -105.03101388073402, -95.58916962090795, -101.07137376396186, -93.43894459780182, -115.23800575581697, -104.73206383782501, -112.70068885155021, -96.21844597999262, -104.27631242016145, -89.53560562766668, -103.56851343003412, -96.76345945518584, -112.24333749494114, -106.71667261362387, -108.70939206354065, -106.32906870663787, -116.68288022541192, -104.30719367922036, -87.11550999566906, -107.50258675165475, -104.111180958086, -122.01708324265914, -108.0012975794319, -82.45233979494078, -104.14582359977129, -107.12532983712417, -103.94129217610757, -114.75535091265726, -81.22369246140391, -127.99003755195812, -102.79396384006739, -101.79639154564651, -87.33775281334725, -116.7657107462082, -104.76372078885139, -106.1276030289568, -89.10226245965167, -118.44361436706409, -105.24952318280315, -92.5982794553297, -111.02403319416257, -107.45596948867912, -103.86614714373648, -108.90085686180555, -112.1067748894555, -124.04939442002772, -110.29107356416435, -116.22623563516885, -84.64630997967907, -105.76017226390044, -103.97930915100065, -108.41757266596704, -89.03733666494176, -107.70220346655199, -84.23273590600103, -104.90585915759269, -106.2253520122189, -101.0719301598873, -104.03215970861228, -124.00182596852915, -107.41293677988587, -103.84442762617519, -114.16456270627243, -123.82013567618466, -92.0159127928355, -99.30823189157124], "episode_lengths": [1600, 77, 1600, 184, 80, 75, 212, 65, 87, 115, 80, 1600, 65, 74, 65, 79, 1600, 1600, 51, 1600, 1600, 1600, 118, 1600, 61, 64, 54, 73, 1600, 1600, 92, 1600, 53, 102, 84, 1600, 1600, 1600, 1600, 45, 67, 1600, 86, 1600, 56, 1600, 1600, 57, 1600, 93, 68, 75, 1600, 50, 60, 93, 70, 1600, 49, 39, 62, 61, 1600, 303, 50, 49, 1600, 71, 67, 80, 1600, 101, 51, 1600, 44, 62, 67, 52, 45, 125, 43, 87, 1600, 89, 58, 64, 1600, 60, 1600, 81, 60, 71, 61, 1600, 71, 68, 69, 104, 1600, 86]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28411603331598456, "mean_inference_ms": 0.9441394443804982, "mean_action_processing_ms": 0.18433459241012476, "mean_env_wait_ms": 0.3825249558787682, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005857944488525391, "StateBufferConnector_ms": 0.004405498504638672, "ViewRequirementAgentConnector_ms": 0.11392831802368164}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 417.27409438983113, "num_env_steps_trained_throughput_per_sec": 417.27409438983113, "timesteps_total": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 9622.735, "restore_workers_time_ms": 0.016, "training_step_time_ms": 9622.696, "sample_time_ms": 3642.013, "load_time_ms": 0.511, "load_throughput": 7826289.126, "learn_time_ms": 5972.092, "learn_throughput": 669.782, "synch_weights_time_ms": 7.52}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 104, "training_iteration": 15, "trial_id": "4bb30_00000", "date": "2024-04-27_18-29-02", "timestamp": 1714267742, "time_this_iter_s": 9.59041428565979, "time_total_s": 144.32663536071777, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 144.32663536071777, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 23.799999999999994, "ram_util_percent": 63.78571428571427}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.148326773572993, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.172905274957133, "policy_loss": -0.022441579102568568, "vf_loss": 1.1919609606326107, "vf_explained_var": 0.415079576289782, "kl": 0.007524223215407664, "entropy": 6.52492520014445, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 14415.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": -81.22369246140391, "episode_reward_min": -134.52705748740647, "episode_reward_mean": -106.28723004371497, "episode_len_mean": 579.11, "episode_media": {}, "episodes_this_iter": 4, "episodes_timesteps_total": 57911, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-101.1867437075482, -100.56002648907092, -134.52705748740647, -102.38913960639263, -118.74994481244994, -108.43117049997673, -116.09746386926, -109.57829472732104, -120.75273682216742, -115.15058579896576, -104.29314177363676, -102.03455933137673, -112.93015447386226, -100.76253953828603, -103.76036267153174, -100.12750228362395, -106.70377491820184, -94.07629407043389, -130.28073055823396, -103.46340804175365, -113.61107132631541, -117.80560272874311, -116.22227911966792, -106.09867040443979, -95.82713960919102, -106.64188679593971, -120.346489640673, -99.97138137741707, -103.65088717458583, -128.34699429252123, -105.03101388073402, -95.58916962090795, -101.07137376396186, -93.43894459780182, -115.23800575581697, -104.73206383782501, -112.70068885155021, -96.21844597999262, -104.27631242016145, -89.53560562766668, -103.56851343003412, -96.76345945518584, -112.24333749494114, -106.71667261362387, -108.70939206354065, -106.32906870663787, -116.68288022541192, -104.30719367922036, -87.11550999566906, -107.50258675165475, -104.111180958086, -122.01708324265914, -108.0012975794319, -82.45233979494078, -104.14582359977129, -107.12532983712417, -103.94129217610757, -114.75535091265726, -81.22369246140391, -127.99003755195812, -102.79396384006739, -101.79639154564651, -87.33775281334725, -116.7657107462082, -104.76372078885139, -106.1276030289568, -89.10226245965167, -118.44361436706409, -105.24952318280315, -92.5982794553297, -111.02403319416257, -107.45596948867912, -103.86614714373648, -108.90085686180555, -112.1067748894555, -124.04939442002772, -110.29107356416435, -116.22623563516885, -84.64630997967907, -105.76017226390044, -103.97930915100065, -108.41757266596704, -89.03733666494176, -107.70220346655199, -84.23273590600103, -104.90585915759269, -106.2253520122189, -101.0719301598873, -104.03215970861228, -124.00182596852915, -107.41293677988587, -103.84442762617519, -114.16456270627243, -123.82013567618466, -92.0159127928355, -99.30823189157124, -98.90157378649079, -87.24410146207171, -126.69359647860942, -114.49374982391981], "episode_lengths": [80, 75, 212, 65, 87, 115, 80, 1600, 65, 74, 65, 79, 1600, 1600, 51, 1600, 1600, 1600, 118, 1600, 61, 64, 54, 73, 1600, 1600, 92, 1600, 53, 102, 84, 1600, 1600, 1600, 1600, 45, 67, 1600, 86, 1600, 56, 1600, 1600, 57, 1600, 93, 68, 75, 1600, 50, 60, 93, 70, 1600, 49, 39, 62, 61, 1600, 303, 50, 49, 1600, 71, 67, 80, 1600, 101, 51, 1600, 44, 62, 67, 52, 45, 125, 43, 87, 1600, 89, 58, 64, 1600, 60, 1600, 81, 60, 71, 61, 1600, 71, 68, 69, 104, 1600, 86, 1600, 1600, 1600, 92]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2840215545564101, "mean_inference_ms": 0.9444948136218254, "mean_action_processing_ms": 0.18436486939469862, "mean_env_wait_ms": 0.3827703034876801, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005804538726806641, "StateBufferConnector_ms": 0.004405021667480469, "ViewRequirementAgentConnector_ms": 0.11364436149597168}}, "episode_reward_max": -81.22369246140391, "episode_reward_min": -134.52705748740647, "episode_reward_mean": -106.28723004371497, "episode_len_mean": 579.11, "episodes_this_iter": 4, "episodes_timesteps_total": 57911, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-101.1867437075482, -100.56002648907092, -134.52705748740647, -102.38913960639263, -118.74994481244994, -108.43117049997673, -116.09746386926, -109.57829472732104, -120.75273682216742, -115.15058579896576, -104.29314177363676, -102.03455933137673, -112.93015447386226, -100.76253953828603, -103.76036267153174, -100.12750228362395, -106.70377491820184, -94.07629407043389, -130.28073055823396, -103.46340804175365, -113.61107132631541, -117.80560272874311, -116.22227911966792, -106.09867040443979, -95.82713960919102, -106.64188679593971, -120.346489640673, -99.97138137741707, -103.65088717458583, -128.34699429252123, -105.03101388073402, -95.58916962090795, -101.07137376396186, -93.43894459780182, -115.23800575581697, -104.73206383782501, -112.70068885155021, -96.21844597999262, -104.27631242016145, -89.53560562766668, -103.56851343003412, -96.76345945518584, -112.24333749494114, -106.71667261362387, -108.70939206354065, -106.32906870663787, -116.68288022541192, -104.30719367922036, -87.11550999566906, -107.50258675165475, -104.111180958086, -122.01708324265914, -108.0012975794319, -82.45233979494078, -104.14582359977129, -107.12532983712417, -103.94129217610757, -114.75535091265726, -81.22369246140391, -127.99003755195812, -102.79396384006739, -101.79639154564651, -87.33775281334725, -116.7657107462082, -104.76372078885139, -106.1276030289568, -89.10226245965167, -118.44361436706409, -105.24952318280315, -92.5982794553297, -111.02403319416257, -107.45596948867912, -103.86614714373648, -108.90085686180555, -112.1067748894555, -124.04939442002772, -110.29107356416435, -116.22623563516885, -84.64630997967907, -105.76017226390044, -103.97930915100065, -108.41757266596704, -89.03733666494176, -107.70220346655199, -84.23273590600103, -104.90585915759269, -106.2253520122189, -101.0719301598873, -104.03215970861228, -124.00182596852915, -107.41293677988587, -103.84442762617519, -114.16456270627243, -123.82013567618466, -92.0159127928355, -99.30823189157124, -98.90157378649079, -87.24410146207171, -126.69359647860942, -114.49374982391981], "episode_lengths": [80, 75, 212, 65, 87, 115, 80, 1600, 65, 74, 65, 79, 1600, 1600, 51, 1600, 1600, 1600, 118, 1600, 61, 64, 54, 73, 1600, 1600, 92, 1600, 53, 102, 84, 1600, 1600, 1600, 1600, 45, 67, 1600, 86, 1600, 56, 1600, 1600, 57, 1600, 93, 68, 75, 1600, 50, 60, 93, 70, 1600, 49, 39, 62, 61, 1600, 303, 50, 49, 1600, 71, 67, 80, 1600, 101, 51, 1600, 44, 62, 67, 52, 45, 125, 43, 87, 1600, 89, 58, 64, 1600, 60, 1600, 81, 60, 71, 61, 1600, 71, 68, 69, 104, 1600, 86, 1600, 1600, 1600, 92]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2840215545564101, "mean_inference_ms": 0.9444948136218254, "mean_action_processing_ms": 0.18436486939469862, "mean_env_wait_ms": 0.3827703034876801, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005804538726806641, "StateBufferConnector_ms": 0.004405021667480469, "ViewRequirementAgentConnector_ms": 0.11364436149597168}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 411.782921991372, "num_env_steps_trained_throughput_per_sec": 411.782921991372, "timesteps_total": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 9622.112, "restore_workers_time_ms": 0.016, "training_step_time_ms": 9622.074, "sample_time_ms": 3652.589, "load_time_ms": 0.477, "load_throughput": 8393224.273, "learn_time_ms": 5960.833, "learn_throughput": 671.047, "synch_weights_time_ms": 7.614}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "episodes_total": 108, "training_iteration": 16, "trial_id": "4bb30_00000", "date": "2024-04-27_18-29-12", "timestamp": 1714267752, "time_this_iter_s": 9.718615055084229, "time_total_s": 154.045250415802, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 154.045250415802, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 24.807142857142853, "ram_util_percent": 63.799999999999976}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.705052293180138, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0835730559387875, "policy_loss": -0.02397982057319173, "vf_loss": 1.104197343294659, "vf_explained_var": 0.3258894127543255, "kl": 0.007456746156055986, "entropy": 6.01823805480875, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 15345.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "sampler_results": {"episode_reward_max": -81.22369246140391, "episode_reward_min": -130.28073055823396, "episode_reward_mean": -106.00088727431537, "episode_len_mean": 608.31, "episode_media": {}, "episodes_this_iter": 3, "episodes_timesteps_total": 60831, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-102.38913960639263, -118.74994481244994, -108.43117049997673, -116.09746386926, -109.57829472732104, -120.75273682216742, -115.15058579896576, -104.29314177363676, -102.03455933137673, -112.93015447386226, -100.76253953828603, -103.76036267153174, -100.12750228362395, -106.70377491820184, -94.07629407043389, -130.28073055823396, -103.46340804175365, -113.61107132631541, -117.80560272874311, -116.22227911966792, -106.09867040443979, -95.82713960919102, -106.64188679593971, -120.346489640673, -99.97138137741707, -103.65088717458583, -128.34699429252123, -105.03101388073402, -95.58916962090795, -101.07137376396186, -93.43894459780182, -115.23800575581697, -104.73206383782501, -112.70068885155021, -96.21844597999262, -104.27631242016145, -89.53560562766668, -103.56851343003412, -96.76345945518584, -112.24333749494114, -106.71667261362387, -108.70939206354065, -106.32906870663787, -116.68288022541192, -104.30719367922036, -87.11550999566906, -107.50258675165475, -104.111180958086, -122.01708324265914, -108.0012975794319, -82.45233979494078, -104.14582359977129, -107.12532983712417, -103.94129217610757, -114.75535091265726, -81.22369246140391, -127.99003755195812, -102.79396384006739, -101.79639154564651, -87.33775281334725, -116.7657107462082, -104.76372078885139, -106.1276030289568, -89.10226245965167, -118.44361436706409, -105.24952318280315, -92.5982794553297, -111.02403319416257, -107.45596948867912, -103.86614714373648, -108.90085686180555, -112.1067748894555, -124.04939442002772, -110.29107356416435, -116.22623563516885, -84.64630997967907, -105.76017226390044, -103.97930915100065, -108.41757266596704, -89.03733666494176, -107.70220346655199, -84.23273590600103, -104.90585915759269, -106.2253520122189, -101.0719301598873, -104.03215970861228, -124.00182596852915, -107.41293677988587, -103.84442762617519, -114.16456270627243, -123.82013567618466, -92.0159127928355, -99.30823189157124, -98.90157378649079, -87.24410146207171, -126.69359647860942, -114.49374982391981, -98.97965821101738, -118.97522755241768, -89.68466498063243], "episode_lengths": [65, 87, 115, 80, 1600, 65, 74, 65, 79, 1600, 1600, 51, 1600, 1600, 1600, 118, 1600, 61, 64, 54, 73, 1600, 1600, 92, 1600, 53, 102, 84, 1600, 1600, 1600, 1600, 45, 67, 1600, 86, 1600, 56, 1600, 1600, 57, 1600, 93, 68, 75, 1600, 50, 60, 93, 70, 1600, 49, 39, 62, 61, 1600, 303, 50, 49, 1600, 71, 67, 80, 1600, 101, 51, 1600, 44, 62, 67, 52, 45, 125, 43, 87, 1600, 89, 58, 64, 1600, 60, 1600, 81, 60, 71, 61, 1600, 71, 68, 69, 104, 1600, 86, 1600, 1600, 1600, 92, 1600, 87, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28399012020583586, "mean_inference_ms": 0.9446660713212403, "mean_action_processing_ms": 0.18436663600183675, "mean_env_wait_ms": 0.38289897596520217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005822896957397461, "StateBufferConnector_ms": 0.0044171810150146484, "ViewRequirementAgentConnector_ms": 0.1139688491821289}}, "episode_reward_max": -81.22369246140391, "episode_reward_min": -130.28073055823396, "episode_reward_mean": -106.00088727431537, "episode_len_mean": 608.31, "episodes_this_iter": 3, "episodes_timesteps_total": 60831, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-102.38913960639263, -118.74994481244994, -108.43117049997673, -116.09746386926, -109.57829472732104, -120.75273682216742, -115.15058579896576, -104.29314177363676, -102.03455933137673, -112.93015447386226, -100.76253953828603, -103.76036267153174, -100.12750228362395, -106.70377491820184, -94.07629407043389, -130.28073055823396, -103.46340804175365, -113.61107132631541, -117.80560272874311, -116.22227911966792, -106.09867040443979, -95.82713960919102, -106.64188679593971, -120.346489640673, -99.97138137741707, -103.65088717458583, -128.34699429252123, -105.03101388073402, -95.58916962090795, -101.07137376396186, -93.43894459780182, -115.23800575581697, -104.73206383782501, -112.70068885155021, -96.21844597999262, -104.27631242016145, -89.53560562766668, -103.56851343003412, -96.76345945518584, -112.24333749494114, -106.71667261362387, -108.70939206354065, -106.32906870663787, -116.68288022541192, -104.30719367922036, -87.11550999566906, -107.50258675165475, -104.111180958086, -122.01708324265914, -108.0012975794319, -82.45233979494078, -104.14582359977129, -107.12532983712417, -103.94129217610757, -114.75535091265726, -81.22369246140391, -127.99003755195812, -102.79396384006739, -101.79639154564651, -87.33775281334725, -116.7657107462082, -104.76372078885139, -106.1276030289568, -89.10226245965167, -118.44361436706409, -105.24952318280315, -92.5982794553297, -111.02403319416257, -107.45596948867912, -103.86614714373648, -108.90085686180555, -112.1067748894555, -124.04939442002772, -110.29107356416435, -116.22623563516885, -84.64630997967907, -105.76017226390044, -103.97930915100065, -108.41757266596704, -89.03733666494176, -107.70220346655199, -84.23273590600103, -104.90585915759269, -106.2253520122189, -101.0719301598873, -104.03215970861228, -124.00182596852915, -107.41293677988587, -103.84442762617519, -114.16456270627243, -123.82013567618466, -92.0159127928355, -99.30823189157124, -98.90157378649079, -87.24410146207171, -126.69359647860942, -114.49374982391981, -98.97965821101738, -118.97522755241768, -89.68466498063243], "episode_lengths": [65, 87, 115, 80, 1600, 65, 74, 65, 79, 1600, 1600, 51, 1600, 1600, 1600, 118, 1600, 61, 64, 54, 73, 1600, 1600, 92, 1600, 53, 102, 84, 1600, 1600, 1600, 1600, 45, 67, 1600, 86, 1600, 56, 1600, 1600, 57, 1600, 93, 68, 75, 1600, 50, 60, 93, 70, 1600, 49, 39, 62, 61, 1600, 303, 50, 49, 1600, 71, 67, 80, 1600, 101, 51, 1600, 44, 62, 67, 52, 45, 125, 43, 87, 1600, 89, 58, 64, 1600, 60, 1600, 81, 60, 71, 61, 1600, 71, 68, 69, 104, 1600, 86, 1600, 1600, 1600, 92, 1600, 87, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28399012020583586, "mean_inference_ms": 0.9446660713212403, "mean_action_processing_ms": 0.18436663600183675, "mean_env_wait_ms": 0.38289897596520217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005822896957397461, "StateBufferConnector_ms": 0.0044171810150146484, "ViewRequirementAgentConnector_ms": 0.1139688491821289}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 413.8416444740765, "num_env_steps_trained_throughput_per_sec": 413.8416444740765, "timesteps_total": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 9629.776, "restore_workers_time_ms": 0.016, "training_step_time_ms": 9629.739, "sample_time_ms": 3651.843, "load_time_ms": 0.473, "load_throughput": 8458389.715, "learn_time_ms": 5969.205, "learn_throughput": 670.106, "synch_weights_time_ms": 7.65}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "episodes_total": 111, "training_iteration": 17, "trial_id": "4bb30_00000", "date": "2024-04-27_18-29-22", "timestamp": 1714267762, "time_this_iter_s": 9.670778036117554, "time_total_s": 163.71602845191956, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 163.71602845191956, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 24.915384615384617, "ram_util_percent": 63.83846153846153}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.14963768041262, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5784539914579803, "policy_loss": -0.03181947146051674, "vf_loss": 1.6045138973542439, "vf_explained_var": 0.36827469801390045, "kl": 0.012799029364481268, "entropy": 7.0379881202533685, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 16275.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": -81.22369246140391, "episode_reward_min": -130.28073055823396, "episode_reward_mean": -106.02255377808733, "episode_len_mean": 622.54, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 62254, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-112.93015447386226, -100.76253953828603, -103.76036267153174, -100.12750228362395, -106.70377491820184, -94.07629407043389, -130.28073055823396, -103.46340804175365, -113.61107132631541, -117.80560272874311, -116.22227911966792, -106.09867040443979, -95.82713960919102, -106.64188679593971, -120.346489640673, -99.97138137741707, -103.65088717458583, -128.34699429252123, -105.03101388073402, -95.58916962090795, -101.07137376396186, -93.43894459780182, -115.23800575581697, -104.73206383782501, -112.70068885155021, -96.21844597999262, -104.27631242016145, -89.53560562766668, -103.56851343003412, -96.76345945518584, -112.24333749494114, -106.71667261362387, -108.70939206354065, -106.32906870663787, -116.68288022541192, -104.30719367922036, -87.11550999566906, -107.50258675165475, -104.111180958086, -122.01708324265914, -108.0012975794319, -82.45233979494078, -104.14582359977129, -107.12532983712417, -103.94129217610757, -114.75535091265726, -81.22369246140391, -127.99003755195812, -102.79396384006739, -101.79639154564651, -87.33775281334725, -116.7657107462082, -104.76372078885139, -106.1276030289568, -89.10226245965167, -118.44361436706409, -105.24952318280315, -92.5982794553297, -111.02403319416257, -107.45596948867912, -103.86614714373648, -108.90085686180555, -112.1067748894555, -124.04939442002772, -110.29107356416435, -116.22623563516885, -84.64630997967907, -105.76017226390044, -103.97930915100065, -108.41757266596704, -89.03733666494176, -107.70220346655199, -84.23273590600103, -104.90585915759269, -106.2253520122189, -101.0719301598873, -104.03215970861228, -124.00182596852915, -107.41293677988587, -103.84442762617519, -114.16456270627243, -123.82013567618466, -92.0159127928355, -99.30823189157124, -98.90157378649079, -87.24410146207171, -126.69359647860942, -114.49374982391981, -98.97965821101738, -118.97522755241768, -89.68466498063243, -96.69764637943052, -116.99469528599208, -117.87439857650735, -102.8569549187428, -116.15287061359298, -104.25965632993852, -108.41541547152649, -123.27304140878776, -113.11900863422204], "episode_lengths": [1600, 1600, 51, 1600, 1600, 1600, 118, 1600, 61, 64, 54, 73, 1600, 1600, 92, 1600, 53, 102, 84, 1600, 1600, 1600, 1600, 45, 67, 1600, 86, 1600, 56, 1600, 1600, 57, 1600, 93, 68, 75, 1600, 50, 60, 93, 70, 1600, 49, 39, 62, 61, 1600, 303, 50, 49, 1600, 71, 67, 80, 1600, 101, 51, 1600, 44, 62, 67, 52, 45, 125, 43, 87, 1600, 89, 58, 64, 1600, 60, 1600, 81, 60, 71, 61, 1600, 71, 68, 69, 104, 1600, 86, 1600, 1600, 1600, 92, 1600, 87, 1600, 1600, 71, 60, 59, 69, 64, 66, 1600, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28365616970362195, "mean_inference_ms": 0.9445426981094814, "mean_action_processing_ms": 0.184508619212355, "mean_env_wait_ms": 0.38379524570670803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005839347839355469, "StateBufferConnector_ms": 0.004387617111206055, "ViewRequirementAgentConnector_ms": 0.11438536643981934}}, "episode_reward_max": -81.22369246140391, "episode_reward_min": -130.28073055823396, "episode_reward_mean": -106.02255377808733, "episode_len_mean": 622.54, "episodes_this_iter": 9, "episodes_timesteps_total": 62254, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-112.93015447386226, -100.76253953828603, -103.76036267153174, -100.12750228362395, -106.70377491820184, -94.07629407043389, -130.28073055823396, -103.46340804175365, -113.61107132631541, -117.80560272874311, -116.22227911966792, -106.09867040443979, -95.82713960919102, -106.64188679593971, -120.346489640673, -99.97138137741707, -103.65088717458583, -128.34699429252123, -105.03101388073402, -95.58916962090795, -101.07137376396186, -93.43894459780182, -115.23800575581697, -104.73206383782501, -112.70068885155021, -96.21844597999262, -104.27631242016145, -89.53560562766668, -103.56851343003412, -96.76345945518584, -112.24333749494114, -106.71667261362387, -108.70939206354065, -106.32906870663787, -116.68288022541192, -104.30719367922036, -87.11550999566906, -107.50258675165475, -104.111180958086, -122.01708324265914, -108.0012975794319, -82.45233979494078, -104.14582359977129, -107.12532983712417, -103.94129217610757, -114.75535091265726, -81.22369246140391, -127.99003755195812, -102.79396384006739, -101.79639154564651, -87.33775281334725, -116.7657107462082, -104.76372078885139, -106.1276030289568, -89.10226245965167, -118.44361436706409, -105.24952318280315, -92.5982794553297, -111.02403319416257, -107.45596948867912, -103.86614714373648, -108.90085686180555, -112.1067748894555, -124.04939442002772, -110.29107356416435, -116.22623563516885, -84.64630997967907, -105.76017226390044, -103.97930915100065, -108.41757266596704, -89.03733666494176, -107.70220346655199, -84.23273590600103, -104.90585915759269, -106.2253520122189, -101.0719301598873, -104.03215970861228, -124.00182596852915, -107.41293677988587, -103.84442762617519, -114.16456270627243, -123.82013567618466, -92.0159127928355, -99.30823189157124, -98.90157378649079, -87.24410146207171, -126.69359647860942, -114.49374982391981, -98.97965821101738, -118.97522755241768, -89.68466498063243, -96.69764637943052, -116.99469528599208, -117.87439857650735, -102.8569549187428, -116.15287061359298, -104.25965632993852, -108.41541547152649, -123.27304140878776, -113.11900863422204], "episode_lengths": [1600, 1600, 51, 1600, 1600, 1600, 118, 1600, 61, 64, 54, 73, 1600, 1600, 92, 1600, 53, 102, 84, 1600, 1600, 1600, 1600, 45, 67, 1600, 86, 1600, 56, 1600, 1600, 57, 1600, 93, 68, 75, 1600, 50, 60, 93, 70, 1600, 49, 39, 62, 61, 1600, 303, 50, 49, 1600, 71, 67, 80, 1600, 101, 51, 1600, 44, 62, 67, 52, 45, 125, 43, 87, 1600, 89, 58, 64, 1600, 60, 1600, 81, 60, 71, 61, 1600, 71, 68, 69, 104, 1600, 86, 1600, 1600, 1600, 92, 1600, 87, 1600, 1600, 71, 60, 59, 69, 64, 66, 1600, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28365616970362195, "mean_inference_ms": 0.9445426981094814, "mean_action_processing_ms": 0.184508619212355, "mean_env_wait_ms": 0.38379524570670803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005839347839355469, "StateBufferConnector_ms": 0.004387617111206055, "ViewRequirementAgentConnector_ms": 0.11438536643981934}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 415.79169255572936, "num_env_steps_trained_throughput_per_sec": 415.79169255572936, "timesteps_total": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 9627.847, "restore_workers_time_ms": 0.017, "training_step_time_ms": 9627.808, "sample_time_ms": 3653.546, "load_time_ms": 0.486, "load_throughput": 8228562.46, "learn_time_ms": 5965.561, "learn_throughput": 670.515, "synch_weights_time_ms": 7.661}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 120, "training_iteration": 18, "trial_id": "4bb30_00000", "date": "2024-04-27_18-29-31", "timestamp": 1714267771, "time_this_iter_s": 9.624230146408081, "time_total_s": 173.34025859832764, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 173.34025859832764, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 24.178571428571423, "ram_util_percent": 63.84285714285712}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.234469584752155, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1794975862998553, "policy_loss": -0.029381912962723803, "vf_loss": 2.2018629300418078, "vf_explained_var": 0.3158387584071006, "kl": 0.015592347912244769, "entropy": 6.309521456687681, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 17205.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "sampler_results": {"episode_reward_max": -81.22369246140391, "episode_reward_min": -208.42292559103774, "episode_reward_mean": -107.18451879379656, "episode_len_mean": 556.01, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 55601, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-106.09867040443979, -95.82713960919102, -106.64188679593971, -120.346489640673, -99.97138137741707, -103.65088717458583, -128.34699429252123, -105.03101388073402, -95.58916962090795, -101.07137376396186, -93.43894459780182, -115.23800575581697, -104.73206383782501, -112.70068885155021, -96.21844597999262, -104.27631242016145, -89.53560562766668, -103.56851343003412, -96.76345945518584, -112.24333749494114, -106.71667261362387, -108.70939206354065, -106.32906870663787, -116.68288022541192, -104.30719367922036, -87.11550999566906, -107.50258675165475, -104.111180958086, -122.01708324265914, -108.0012975794319, -82.45233979494078, -104.14582359977129, -107.12532983712417, -103.94129217610757, -114.75535091265726, -81.22369246140391, -127.99003755195812, -102.79396384006739, -101.79639154564651, -87.33775281334725, -116.7657107462082, -104.76372078885139, -106.1276030289568, -89.10226245965167, -118.44361436706409, -105.24952318280315, -92.5982794553297, -111.02403319416257, -107.45596948867912, -103.86614714373648, -108.90085686180555, -112.1067748894555, -124.04939442002772, -110.29107356416435, -116.22623563516885, -84.64630997967907, -105.76017226390044, -103.97930915100065, -108.41757266596704, -89.03733666494176, -107.70220346655199, -84.23273590600103, -104.90585915759269, -106.2253520122189, -101.0719301598873, -104.03215970861228, -124.00182596852915, -107.41293677988587, -103.84442762617519, -114.16456270627243, -123.82013567618466, -92.0159127928355, -99.30823189157124, -98.90157378649079, -87.24410146207171, -126.69359647860942, -114.49374982391981, -98.97965821101738, -118.97522755241768, -89.68466498063243, -96.69764637943052, -116.99469528599208, -117.87439857650735, -102.8569549187428, -116.15287061359298, -104.25965632993852, -108.41541547152649, -123.27304140878776, -113.11900863422204, -208.42292559103774, -115.28789020491764, -106.51947552365003, -120.02475186642508, -106.62792120518039, -103.5504115927828, -89.11765456292778, -120.89098993378133, -124.35177706614137, -112.22933584387974, -108.91708791085209], "episode_lengths": [73, 1600, 1600, 92, 1600, 53, 102, 84, 1600, 1600, 1600, 1600, 45, 67, 1600, 86, 1600, 56, 1600, 1600, 57, 1600, 93, 68, 75, 1600, 50, 60, 93, 70, 1600, 49, 39, 62, 61, 1600, 303, 50, 49, 1600, 71, 67, 80, 1600, 101, 51, 1600, 44, 62, 67, 52, 45, 125, 43, 87, 1600, 89, 58, 64, 1600, 60, 1600, 81, 60, 71, 61, 1600, 71, 68, 69, 104, 1600, 86, 1600, 1600, 1600, 92, 1600, 87, 1600, 1600, 71, 60, 59, 69, 64, 66, 1600, 64, 1075, 99, 42, 91, 57, 59, 1600, 87, 87, 63, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2838134249847368, "mean_inference_ms": 0.9450138436834553, "mean_action_processing_ms": 0.18469963582686638, "mean_env_wait_ms": 0.38445358307661054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005658149719238281, "StateBufferConnector_ms": 0.0044252872467041016, "ViewRequirementAgentConnector_ms": 0.11415386199951172}}, "episode_reward_max": -81.22369246140391, "episode_reward_min": -208.42292559103774, "episode_reward_mean": -107.18451879379656, "episode_len_mean": 556.01, "episodes_this_iter": 11, "episodes_timesteps_total": 55601, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-106.09867040443979, -95.82713960919102, -106.64188679593971, -120.346489640673, -99.97138137741707, -103.65088717458583, -128.34699429252123, -105.03101388073402, -95.58916962090795, -101.07137376396186, -93.43894459780182, -115.23800575581697, -104.73206383782501, -112.70068885155021, -96.21844597999262, -104.27631242016145, -89.53560562766668, -103.56851343003412, -96.76345945518584, -112.24333749494114, -106.71667261362387, -108.70939206354065, -106.32906870663787, -116.68288022541192, -104.30719367922036, -87.11550999566906, -107.50258675165475, -104.111180958086, -122.01708324265914, -108.0012975794319, -82.45233979494078, -104.14582359977129, -107.12532983712417, -103.94129217610757, -114.75535091265726, -81.22369246140391, -127.99003755195812, -102.79396384006739, -101.79639154564651, -87.33775281334725, -116.7657107462082, -104.76372078885139, -106.1276030289568, -89.10226245965167, -118.44361436706409, -105.24952318280315, -92.5982794553297, -111.02403319416257, -107.45596948867912, -103.86614714373648, -108.90085686180555, -112.1067748894555, -124.04939442002772, -110.29107356416435, -116.22623563516885, -84.64630997967907, -105.76017226390044, -103.97930915100065, -108.41757266596704, -89.03733666494176, -107.70220346655199, -84.23273590600103, -104.90585915759269, -106.2253520122189, -101.0719301598873, -104.03215970861228, -124.00182596852915, -107.41293677988587, -103.84442762617519, -114.16456270627243, -123.82013567618466, -92.0159127928355, -99.30823189157124, -98.90157378649079, -87.24410146207171, -126.69359647860942, -114.49374982391981, -98.97965821101738, -118.97522755241768, -89.68466498063243, -96.69764637943052, -116.99469528599208, -117.87439857650735, -102.8569549187428, -116.15287061359298, -104.25965632993852, -108.41541547152649, -123.27304140878776, -113.11900863422204, -208.42292559103774, -115.28789020491764, -106.51947552365003, -120.02475186642508, -106.62792120518039, -103.5504115927828, -89.11765456292778, -120.89098993378133, -124.35177706614137, -112.22933584387974, -108.91708791085209], "episode_lengths": [73, 1600, 1600, 92, 1600, 53, 102, 84, 1600, 1600, 1600, 1600, 45, 67, 1600, 86, 1600, 56, 1600, 1600, 57, 1600, 93, 68, 75, 1600, 50, 60, 93, 70, 1600, 49, 39, 62, 61, 1600, 303, 50, 49, 1600, 71, 67, 80, 1600, 101, 51, 1600, 44, 62, 67, 52, 45, 125, 43, 87, 1600, 89, 58, 64, 1600, 60, 1600, 81, 60, 71, 61, 1600, 71, 68, 69, 104, 1600, 86, 1600, 1600, 1600, 92, 1600, 87, 1600, 1600, 71, 60, 59, 69, 64, 66, 1600, 64, 1075, 99, 42, 91, 57, 59, 1600, 87, 87, 63, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2838134249847368, "mean_inference_ms": 0.9450138436834553, "mean_action_processing_ms": 0.18469963582686638, "mean_env_wait_ms": 0.38445358307661054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005658149719238281, "StateBufferConnector_ms": 0.0044252872467041016, "ViewRequirementAgentConnector_ms": 0.11415386199951172}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 406.30430272339527, "num_env_steps_trained_throughput_per_sec": 406.30430272339527, "timesteps_total": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 9662.316, "restore_workers_time_ms": 0.017, "training_step_time_ms": 9662.276, "sample_time_ms": 3664.311, "load_time_ms": 0.483, "load_throughput": 8276461.941, "learn_time_ms": 5989.175, "learn_throughput": 667.872, "synch_weights_time_ms": 7.751}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "episodes_total": 131, "training_iteration": 19, "trial_id": "4bb30_00000", "date": "2024-04-27_18-29-41", "timestamp": 1714267781, "time_this_iter_s": 9.85010290145874, "time_total_s": 183.19036149978638, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 183.19036149978638, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 24.85, "ram_util_percent": 63.8642857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.480346719680293, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.509596759852107, "policy_loss": -0.031257259525278566, "vf_loss": 2.534073616508194, "vf_explained_var": 0.2524862579120103, "kl": 0.015067565715467975, "entropy": 7.216678645021172, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 18135.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "sampler_results": {"episode_reward_max": -81.22369246140391, "episode_reward_min": -208.42292559103774, "episode_reward_mean": -107.49426482241742, "episode_len_mean": 478.96, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 47896, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-104.73206383782501, -112.70068885155021, -96.21844597999262, -104.27631242016145, -89.53560562766668, -103.56851343003412, -96.76345945518584, -112.24333749494114, -106.71667261362387, -108.70939206354065, -106.32906870663787, -116.68288022541192, -104.30719367922036, -87.11550999566906, -107.50258675165475, -104.111180958086, -122.01708324265914, -108.0012975794319, -82.45233979494078, -104.14582359977129, -107.12532983712417, -103.94129217610757, -114.75535091265726, -81.22369246140391, -127.99003755195812, -102.79396384006739, -101.79639154564651, -87.33775281334725, -116.7657107462082, -104.76372078885139, -106.1276030289568, -89.10226245965167, -118.44361436706409, -105.24952318280315, -92.5982794553297, -111.02403319416257, -107.45596948867912, -103.86614714373648, -108.90085686180555, -112.1067748894555, -124.04939442002772, -110.29107356416435, -116.22623563516885, -84.64630997967907, -105.76017226390044, -103.97930915100065, -108.41757266596704, -89.03733666494176, -107.70220346655199, -84.23273590600103, -104.90585915759269, -106.2253520122189, -101.0719301598873, -104.03215970861228, -124.00182596852915, -107.41293677988587, -103.84442762617519, -114.16456270627243, -123.82013567618466, -92.0159127928355, -99.30823189157124, -98.90157378649079, -87.24410146207171, -126.69359647860942, -114.49374982391981, -98.97965821101738, -118.97522755241768, -89.68466498063243, -96.69764637943052, -116.99469528599208, -117.87439857650735, -102.8569549187428, -116.15287061359298, -104.25965632993852, -108.41541547152649, -123.27304140878776, -113.11900863422204, -208.42292559103774, -115.28789020491764, -106.51947552365003, -120.02475186642508, -106.62792120518039, -103.5504115927828, -89.11765456292778, -120.89098993378133, -124.35177706614137, -112.22933584387974, -108.91708791085209, -91.11357980011654, -112.42013489465975, -107.65276561370491, -115.44956072049465, -116.21857580757887, -112.67950386769138, -108.23144093765319, -113.28327438948055, -108.72698965338867, -118.82346322147734, -112.10272236209487, -85.52454850773826], "episode_lengths": [45, 67, 1600, 86, 1600, 56, 1600, 1600, 57, 1600, 93, 68, 75, 1600, 50, 60, 93, 70, 1600, 49, 39, 62, 61, 1600, 303, 50, 49, 1600, 71, 67, 80, 1600, 101, 51, 1600, 44, 62, 67, 52, 45, 125, 43, 87, 1600, 89, 58, 64, 1600, 60, 1600, 81, 60, 71, 61, 1600, 71, 68, 69, 104, 1600, 86, 1600, 1600, 1600, 92, 1600, 87, 1600, 1600, 71, 60, 59, 69, 64, 66, 1600, 64, 1075, 99, 42, 91, 57, 59, 1600, 87, 87, 63, 35, 1600, 101, 52, 46, 72, 51, 107, 72, 58, 62, 78, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28428729210759696, "mean_inference_ms": 0.9454154190070038, "mean_action_processing_ms": 0.18488297007891727, "mean_env_wait_ms": 0.384923795819321, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0056111812591552734, "StateBufferConnector_ms": 0.0044324398040771484, "ViewRequirementAgentConnector_ms": 0.11417746543884277}}, "episode_reward_max": -81.22369246140391, "episode_reward_min": -208.42292559103774, "episode_reward_mean": -107.49426482241742, "episode_len_mean": 478.96, "episodes_this_iter": 12, "episodes_timesteps_total": 47896, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-104.73206383782501, -112.70068885155021, -96.21844597999262, -104.27631242016145, -89.53560562766668, -103.56851343003412, -96.76345945518584, -112.24333749494114, -106.71667261362387, -108.70939206354065, -106.32906870663787, -116.68288022541192, -104.30719367922036, -87.11550999566906, -107.50258675165475, -104.111180958086, -122.01708324265914, -108.0012975794319, -82.45233979494078, -104.14582359977129, -107.12532983712417, -103.94129217610757, -114.75535091265726, -81.22369246140391, -127.99003755195812, -102.79396384006739, -101.79639154564651, -87.33775281334725, -116.7657107462082, -104.76372078885139, -106.1276030289568, -89.10226245965167, -118.44361436706409, -105.24952318280315, -92.5982794553297, -111.02403319416257, -107.45596948867912, -103.86614714373648, -108.90085686180555, -112.1067748894555, -124.04939442002772, -110.29107356416435, -116.22623563516885, -84.64630997967907, -105.76017226390044, -103.97930915100065, -108.41757266596704, -89.03733666494176, -107.70220346655199, -84.23273590600103, -104.90585915759269, -106.2253520122189, -101.0719301598873, -104.03215970861228, -124.00182596852915, -107.41293677988587, -103.84442762617519, -114.16456270627243, -123.82013567618466, -92.0159127928355, -99.30823189157124, -98.90157378649079, -87.24410146207171, -126.69359647860942, -114.49374982391981, -98.97965821101738, -118.97522755241768, -89.68466498063243, -96.69764637943052, -116.99469528599208, -117.87439857650735, -102.8569549187428, -116.15287061359298, -104.25965632993852, -108.41541547152649, -123.27304140878776, -113.11900863422204, -208.42292559103774, -115.28789020491764, -106.51947552365003, -120.02475186642508, -106.62792120518039, -103.5504115927828, -89.11765456292778, -120.89098993378133, -124.35177706614137, -112.22933584387974, -108.91708791085209, -91.11357980011654, -112.42013489465975, -107.65276561370491, -115.44956072049465, -116.21857580757887, -112.67950386769138, -108.23144093765319, -113.28327438948055, -108.72698965338867, -118.82346322147734, -112.10272236209487, -85.52454850773826], "episode_lengths": [45, 67, 1600, 86, 1600, 56, 1600, 1600, 57, 1600, 93, 68, 75, 1600, 50, 60, 93, 70, 1600, 49, 39, 62, 61, 1600, 303, 50, 49, 1600, 71, 67, 80, 1600, 101, 51, 1600, 44, 62, 67, 52, 45, 125, 43, 87, 1600, 89, 58, 64, 1600, 60, 1600, 81, 60, 71, 61, 1600, 71, 68, 69, 104, 1600, 86, 1600, 1600, 1600, 92, 1600, 87, 1600, 1600, 71, 60, 59, 69, 64, 66, 1600, 64, 1075, 99, 42, 91, 57, 59, 1600, 87, 87, 63, 35, 1600, 101, 52, 46, 72, 51, 107, 72, 58, 62, 78, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28428729210759696, "mean_inference_ms": 0.9454154190070038, "mean_action_processing_ms": 0.18488297007891727, "mean_env_wait_ms": 0.384923795819321, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0056111812591552734, "StateBufferConnector_ms": 0.0044324398040771484, "ViewRequirementAgentConnector_ms": 0.11417746543884277}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 414.3487134325668, "num_env_steps_trained_throughput_per_sec": 414.3487134325668, "timesteps_total": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 9664.149, "restore_workers_time_ms": 0.017, "training_step_time_ms": 9664.109, "sample_time_ms": 3669.704, "load_time_ms": 0.481, "load_throughput": 8312548.184, "learn_time_ms": 5985.683, "learn_throughput": 668.261, "synch_weights_time_ms": 7.698}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "episodes_total": 143, "training_iteration": 20, "trial_id": "4bb30_00000", "date": "2024-04-27_18-29-51", "timestamp": 1714267791, "time_this_iter_s": 9.65780520439148, "time_total_s": 192.84816670417786, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 192.84816670417786, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 24.7, "ram_util_percent": 63.87857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.69950925893681, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1919957122948242, "policy_loss": -0.031411816163729595, "vf_loss": 1.218241591987911, "vf_explained_var": 0.44074258246729453, "kl": 0.011479871426727892, "entropy": 6.286533764869936, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 19065.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": -81.22369246140391, "episode_reward_min": -208.42292559103774, "episode_reward_mean": -108.26472381530957, "episode_len_mean": 463.76, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 46376, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-112.24333749494114, -106.71667261362387, -108.70939206354065, -106.32906870663787, -116.68288022541192, -104.30719367922036, -87.11550999566906, -107.50258675165475, -104.111180958086, -122.01708324265914, -108.0012975794319, -82.45233979494078, -104.14582359977129, -107.12532983712417, -103.94129217610757, -114.75535091265726, -81.22369246140391, -127.99003755195812, -102.79396384006739, -101.79639154564651, -87.33775281334725, -116.7657107462082, -104.76372078885139, -106.1276030289568, -89.10226245965167, -118.44361436706409, -105.24952318280315, -92.5982794553297, -111.02403319416257, -107.45596948867912, -103.86614714373648, -108.90085686180555, -112.1067748894555, -124.04939442002772, -110.29107356416435, -116.22623563516885, -84.64630997967907, -105.76017226390044, -103.97930915100065, -108.41757266596704, -89.03733666494176, -107.70220346655199, -84.23273590600103, -104.90585915759269, -106.2253520122189, -101.0719301598873, -104.03215970861228, -124.00182596852915, -107.41293677988587, -103.84442762617519, -114.16456270627243, -123.82013567618466, -92.0159127928355, -99.30823189157124, -98.90157378649079, -87.24410146207171, -126.69359647860942, -114.49374982391981, -98.97965821101738, -118.97522755241768, -89.68466498063243, -96.69764637943052, -116.99469528599208, -117.87439857650735, -102.8569549187428, -116.15287061359298, -104.25965632993852, -108.41541547152649, -123.27304140878776, -113.11900863422204, -208.42292559103774, -115.28789020491764, -106.51947552365003, -120.02475186642508, -106.62792120518039, -103.5504115927828, -89.11765456292778, -120.89098993378133, -124.35177706614137, -112.22933584387974, -108.91708791085209, -91.11357980011654, -112.42013489465975, -107.65276561370491, -115.44956072049465, -116.21857580757887, -112.67950386769138, -108.23144093765319, -113.28327438948055, -108.72698965338867, -118.82346322147734, -112.10272236209487, -85.52454850773826, -127.49041439959022, -88.32800977700842, -119.28933776971886, -113.64965252775637, -106.80316798986185, -118.10685060386545, -111.17355582382964], "episode_lengths": [1600, 57, 1600, 93, 68, 75, 1600, 50, 60, 93, 70, 1600, 49, 39, 62, 61, 1600, 303, 50, 49, 1600, 71, 67, 80, 1600, 101, 51, 1600, 44, 62, 67, 52, 45, 125, 43, 87, 1600, 89, 58, 64, 1600, 60, 1600, 81, 60, 71, 61, 1600, 71, 68, 69, 104, 1600, 86, 1600, 1600, 1600, 92, 1600, 87, 1600, 1600, 71, 60, 59, 69, 64, 66, 1600, 64, 1075, 99, 42, 91, 57, 59, 1600, 87, 87, 63, 35, 1600, 101, 52, 46, 72, 51, 107, 72, 58, 62, 78, 1600, 1600, 1600, 65, 53, 67, 77, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28444140809369, "mean_inference_ms": 0.9459221062731749, "mean_action_processing_ms": 0.18494213345822957, "mean_env_wait_ms": 0.3850188732212702, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005658864974975586, "StateBufferConnector_ms": 0.004420042037963867, "ViewRequirementAgentConnector_ms": 0.11435747146606445}}, "episode_reward_max": -81.22369246140391, "episode_reward_min": -208.42292559103774, "episode_reward_mean": -108.26472381530957, "episode_len_mean": 463.76, "episodes_this_iter": 7, "episodes_timesteps_total": 46376, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-112.24333749494114, -106.71667261362387, -108.70939206354065, -106.32906870663787, -116.68288022541192, -104.30719367922036, -87.11550999566906, -107.50258675165475, -104.111180958086, -122.01708324265914, -108.0012975794319, -82.45233979494078, -104.14582359977129, -107.12532983712417, -103.94129217610757, -114.75535091265726, -81.22369246140391, -127.99003755195812, -102.79396384006739, -101.79639154564651, -87.33775281334725, -116.7657107462082, -104.76372078885139, -106.1276030289568, -89.10226245965167, -118.44361436706409, -105.24952318280315, -92.5982794553297, -111.02403319416257, -107.45596948867912, -103.86614714373648, -108.90085686180555, -112.1067748894555, -124.04939442002772, -110.29107356416435, -116.22623563516885, -84.64630997967907, -105.76017226390044, -103.97930915100065, -108.41757266596704, -89.03733666494176, -107.70220346655199, -84.23273590600103, -104.90585915759269, -106.2253520122189, -101.0719301598873, -104.03215970861228, -124.00182596852915, -107.41293677988587, -103.84442762617519, -114.16456270627243, -123.82013567618466, -92.0159127928355, -99.30823189157124, -98.90157378649079, -87.24410146207171, -126.69359647860942, -114.49374982391981, -98.97965821101738, -118.97522755241768, -89.68466498063243, -96.69764637943052, -116.99469528599208, -117.87439857650735, -102.8569549187428, -116.15287061359298, -104.25965632993852, -108.41541547152649, -123.27304140878776, -113.11900863422204, -208.42292559103774, -115.28789020491764, -106.51947552365003, -120.02475186642508, -106.62792120518039, -103.5504115927828, -89.11765456292778, -120.89098993378133, -124.35177706614137, -112.22933584387974, -108.91708791085209, -91.11357980011654, -112.42013489465975, -107.65276561370491, -115.44956072049465, -116.21857580757887, -112.67950386769138, -108.23144093765319, -113.28327438948055, -108.72698965338867, -118.82346322147734, -112.10272236209487, -85.52454850773826, -127.49041439959022, -88.32800977700842, -119.28933776971886, -113.64965252775637, -106.80316798986185, -118.10685060386545, -111.17355582382964], "episode_lengths": [1600, 57, 1600, 93, 68, 75, 1600, 50, 60, 93, 70, 1600, 49, 39, 62, 61, 1600, 303, 50, 49, 1600, 71, 67, 80, 1600, 101, 51, 1600, 44, 62, 67, 52, 45, 125, 43, 87, 1600, 89, 58, 64, 1600, 60, 1600, 81, 60, 71, 61, 1600, 71, 68, 69, 104, 1600, 86, 1600, 1600, 1600, 92, 1600, 87, 1600, 1600, 71, 60, 59, 69, 64, 66, 1600, 64, 1075, 99, 42, 91, 57, 59, 1600, 87, 87, 63, 35, 1600, 101, 52, 46, 72, 51, 107, 72, 58, 62, 78, 1600, 1600, 1600, 65, 53, 67, 77, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28444140809369, "mean_inference_ms": 0.9459221062731749, "mean_action_processing_ms": 0.18494213345822957, "mean_env_wait_ms": 0.3850188732212702, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005658864974975586, "StateBufferConnector_ms": 0.004420042037963867, "ViewRequirementAgentConnector_ms": 0.11435747146606445}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 413.6566222325404, "num_env_steps_trained_throughput_per_sec": 413.6566222325404, "timesteps_total": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 9669.406, "restore_workers_time_ms": 0.017, "training_step_time_ms": 9669.366, "sample_time_ms": 3669.538, "load_time_ms": 0.465, "load_throughput": 8595765.96, "learn_time_ms": 5991.216, "learn_throughput": 667.644, "synch_weights_time_ms": 7.607}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 150, "training_iteration": 21, "trial_id": "4bb30_00000", "date": "2024-04-27_18-30-01", "timestamp": 1714267801, "time_this_iter_s": 9.675133228302002, "time_total_s": 202.52329993247986, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 202.52329993247986, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 25.8, "ram_util_percent": 63.828571428571415}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.293726009643207, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3438918735922103, "policy_loss": -0.02821269605348828, "vf_loss": 2.366626559426227, "vf_explained_var": 0.3698319997197838, "kl": 0.012173371519767776, "entropy": 6.459095893367644, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 19995.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "sampler_results": {"episode_reward_max": -80.24938785401487, "episode_reward_min": -208.42292559103774, "episode_reward_mean": -108.50028383006936, "episode_len_mean": 468.2, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 46820, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-107.50258675165475, -104.111180958086, -122.01708324265914, -108.0012975794319, -82.45233979494078, -104.14582359977129, -107.12532983712417, -103.94129217610757, -114.75535091265726, -81.22369246140391, -127.99003755195812, -102.79396384006739, -101.79639154564651, -87.33775281334725, -116.7657107462082, -104.76372078885139, -106.1276030289568, -89.10226245965167, -118.44361436706409, -105.24952318280315, -92.5982794553297, -111.02403319416257, -107.45596948867912, -103.86614714373648, -108.90085686180555, -112.1067748894555, -124.04939442002772, -110.29107356416435, -116.22623563516885, -84.64630997967907, -105.76017226390044, -103.97930915100065, -108.41757266596704, -89.03733666494176, -107.70220346655199, -84.23273590600103, -104.90585915759269, -106.2253520122189, -101.0719301598873, -104.03215970861228, -124.00182596852915, -107.41293677988587, -103.84442762617519, -114.16456270627243, -123.82013567618466, -92.0159127928355, -99.30823189157124, -98.90157378649079, -87.24410146207171, -126.69359647860942, -114.49374982391981, -98.97965821101738, -118.97522755241768, -89.68466498063243, -96.69764637943052, -116.99469528599208, -117.87439857650735, -102.8569549187428, -116.15287061359298, -104.25965632993852, -108.41541547152649, -123.27304140878776, -113.11900863422204, -208.42292559103774, -115.28789020491764, -106.51947552365003, -120.02475186642508, -106.62792120518039, -103.5504115927828, -89.11765456292778, -120.89098993378133, -124.35177706614137, -112.22933584387974, -108.91708791085209, -91.11357980011654, -112.42013489465975, -107.65276561370491, -115.44956072049465, -116.21857580757887, -112.67950386769138, -108.23144093765319, -113.28327438948055, -108.72698965338867, -118.82346322147734, -112.10272236209487, -85.52454850773826, -127.49041439959022, -88.32800977700842, -119.28933776971886, -113.64965252775637, -106.80316798986185, -118.10685060386545, -111.17355582382964, -87.36185812653615, -114.02944791099057, -110.77322782724164, -80.24938785401487, -83.49586523579248, -125.8371156722711, -163.91315362817417], "episode_lengths": [50, 60, 93, 70, 1600, 49, 39, 62, 61, 1600, 303, 50, 49, 1600, 71, 67, 80, 1600, 101, 51, 1600, 44, 62, 67, 52, 45, 125, 43, 87, 1600, 89, 58, 64, 1600, 60, 1600, 81, 60, 71, 61, 1600, 71, 68, 69, 104, 1600, 86, 1600, 1600, 1600, 92, 1600, 87, 1600, 1600, 71, 60, 59, 69, 64, 66, 1600, 64, 1075, 99, 42, 91, 57, 59, 1600, 87, 87, 63, 35, 1600, 101, 52, 46, 72, 51, 107, 72, 58, 62, 78, 1600, 1600, 1600, 65, 53, 67, 77, 72, 1600, 59, 53, 1600, 1600, 88, 537]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2846538936517169, "mean_inference_ms": 0.9462157010243344, "mean_action_processing_ms": 0.18501245774324243, "mean_env_wait_ms": 0.38520096268556175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005793571472167969, "StateBufferConnector_ms": 0.0044422149658203125, "ViewRequirementAgentConnector_ms": 0.11540937423706055}}, "episode_reward_max": -80.24938785401487, "episode_reward_min": -208.42292559103774, "episode_reward_mean": -108.50028383006936, "episode_len_mean": 468.2, "episodes_this_iter": 7, "episodes_timesteps_total": 46820, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-107.50258675165475, -104.111180958086, -122.01708324265914, -108.0012975794319, -82.45233979494078, -104.14582359977129, -107.12532983712417, -103.94129217610757, -114.75535091265726, -81.22369246140391, -127.99003755195812, -102.79396384006739, -101.79639154564651, -87.33775281334725, -116.7657107462082, -104.76372078885139, -106.1276030289568, -89.10226245965167, -118.44361436706409, -105.24952318280315, -92.5982794553297, -111.02403319416257, -107.45596948867912, -103.86614714373648, -108.90085686180555, -112.1067748894555, -124.04939442002772, -110.29107356416435, -116.22623563516885, -84.64630997967907, -105.76017226390044, -103.97930915100065, -108.41757266596704, -89.03733666494176, -107.70220346655199, -84.23273590600103, -104.90585915759269, -106.2253520122189, -101.0719301598873, -104.03215970861228, -124.00182596852915, -107.41293677988587, -103.84442762617519, -114.16456270627243, -123.82013567618466, -92.0159127928355, -99.30823189157124, -98.90157378649079, -87.24410146207171, -126.69359647860942, -114.49374982391981, -98.97965821101738, -118.97522755241768, -89.68466498063243, -96.69764637943052, -116.99469528599208, -117.87439857650735, -102.8569549187428, -116.15287061359298, -104.25965632993852, -108.41541547152649, -123.27304140878776, -113.11900863422204, -208.42292559103774, -115.28789020491764, -106.51947552365003, -120.02475186642508, -106.62792120518039, -103.5504115927828, -89.11765456292778, -120.89098993378133, -124.35177706614137, -112.22933584387974, -108.91708791085209, -91.11357980011654, -112.42013489465975, -107.65276561370491, -115.44956072049465, -116.21857580757887, -112.67950386769138, -108.23144093765319, -113.28327438948055, -108.72698965338867, -118.82346322147734, -112.10272236209487, -85.52454850773826, -127.49041439959022, -88.32800977700842, -119.28933776971886, -113.64965252775637, -106.80316798986185, -118.10685060386545, -111.17355582382964, -87.36185812653615, -114.02944791099057, -110.77322782724164, -80.24938785401487, -83.49586523579248, -125.8371156722711, -163.91315362817417], "episode_lengths": [50, 60, 93, 70, 1600, 49, 39, 62, 61, 1600, 303, 50, 49, 1600, 71, 67, 80, 1600, 101, 51, 1600, 44, 62, 67, 52, 45, 125, 43, 87, 1600, 89, 58, 64, 1600, 60, 1600, 81, 60, 71, 61, 1600, 71, 68, 69, 104, 1600, 86, 1600, 1600, 1600, 92, 1600, 87, 1600, 1600, 71, 60, 59, 69, 64, 66, 1600, 64, 1075, 99, 42, 91, 57, 59, 1600, 87, 87, 63, 35, 1600, 101, 52, 46, 72, 51, 107, 72, 58, 62, 78, 1600, 1600, 1600, 65, 53, 67, 77, 72, 1600, 59, 53, 1600, 1600, 88, 537]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2846538936517169, "mean_inference_ms": 0.9462157010243344, "mean_action_processing_ms": 0.18501245774324243, "mean_env_wait_ms": 0.38520096268556175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005793571472167969, "StateBufferConnector_ms": 0.0044422149658203125, "ViewRequirementAgentConnector_ms": 0.11540937423706055}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 414.3701121899365, "num_env_steps_trained_throughput_per_sec": 414.3701121899365, "timesteps_total": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 9672.011, "restore_workers_time_ms": 0.018, "training_step_time_ms": 9671.97, "sample_time_ms": 3669.209, "load_time_ms": 0.47, "load_throughput": 8509873.7, "learn_time_ms": 5994.072, "learn_throughput": 667.326, "synch_weights_time_ms": 7.692}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "episodes_total": 157, "training_iteration": 22, "trial_id": "4bb30_00000", "date": "2024-04-27_18-30-10", "timestamp": 1714267810, "time_this_iter_s": 9.65789794921875, "time_total_s": 212.1811978816986, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 212.1811978816986, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 24.8, "ram_util_percent": 63.87142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.121847148736318, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3077033905194753, "policy_loss": -0.03941130937748058, "vf_loss": 1.3401122173254367, "vf_explained_var": 0.2772481413938666, "kl": 0.015561080648650171, "entropy": 6.931921694868354, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 20925.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "sampler_results": {"episode_reward_max": -80.24938785401487, "episode_reward_min": -208.42292559103774, "episode_reward_mean": -108.88051165940682, "episode_len_mean": 499.11, "episode_media": {}, "episodes_this_iter": 8, "episodes_timesteps_total": 49911, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114.75535091265726, -81.22369246140391, -127.99003755195812, -102.79396384006739, -101.79639154564651, -87.33775281334725, -116.7657107462082, -104.76372078885139, -106.1276030289568, -89.10226245965167, -118.44361436706409, -105.24952318280315, -92.5982794553297, -111.02403319416257, -107.45596948867912, -103.86614714373648, -108.90085686180555, -112.1067748894555, -124.04939442002772, -110.29107356416435, -116.22623563516885, -84.64630997967907, -105.76017226390044, -103.97930915100065, -108.41757266596704, -89.03733666494176, -107.70220346655199, -84.23273590600103, -104.90585915759269, -106.2253520122189, -101.0719301598873, -104.03215970861228, -124.00182596852915, -107.41293677988587, -103.84442762617519, -114.16456270627243, -123.82013567618466, -92.0159127928355, -99.30823189157124, -98.90157378649079, -87.24410146207171, -126.69359647860942, -114.49374982391981, -98.97965821101738, -118.97522755241768, -89.68466498063243, -96.69764637943052, -116.99469528599208, -117.87439857650735, -102.8569549187428, -116.15287061359298, -104.25965632993852, -108.41541547152649, -123.27304140878776, -113.11900863422204, -208.42292559103774, -115.28789020491764, -106.51947552365003, -120.02475186642508, -106.62792120518039, -103.5504115927828, -89.11765456292778, -120.89098993378133, -124.35177706614137, -112.22933584387974, -108.91708791085209, -91.11357980011654, -112.42013489465975, -107.65276561370491, -115.44956072049465, -116.21857580757887, -112.67950386769138, -108.23144093765319, -113.28327438948055, -108.72698965338867, -118.82346322147734, -112.10272236209487, -85.52454850773826, -127.49041439959022, -88.32800977700842, -119.28933776971886, -113.64965252775637, -106.80316798986185, -118.10685060386545, -111.17355582382964, -87.36185812653615, -114.02944791099057, -110.77322782724164, -80.24938785401487, -83.49586523579248, -125.8371156722711, -163.91315362817417, -126.3068465727999, -111.67700693655449, -111.64192951229153, -114.40799519593145, -99.74151464261679, -85.94066479276728, -111.15726156142603, -116.44649765913499], "episode_lengths": [61, 1600, 303, 50, 49, 1600, 71, 67, 80, 1600, 101, 51, 1600, 44, 62, 67, 52, 45, 125, 43, 87, 1600, 89, 58, 64, 1600, 60, 1600, 81, 60, 71, 61, 1600, 71, 68, 69, 104, 1600, 86, 1600, 1600, 1600, 92, 1600, 87, 1600, 1600, 71, 60, 59, 69, 64, 66, 1600, 64, 1075, 99, 42, 91, 57, 59, 1600, 87, 87, 63, 35, 1600, 101, 52, 46, 72, 51, 107, 72, 58, 62, 78, 1600, 1600, 1600, 65, 53, 67, 77, 72, 1600, 59, 53, 1600, 1600, 88, 537, 1600, 49, 107, 43, 1600, 1600, 51, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28489388015536915, "mean_inference_ms": 0.9466465329854711, "mean_action_processing_ms": 0.18508902817066553, "mean_env_wait_ms": 0.3852937290374765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0057370662689208984, "StateBufferConnector_ms": 0.004353523254394531, "ViewRequirementAgentConnector_ms": 0.1136319637298584}}, "episode_reward_max": -80.24938785401487, "episode_reward_min": -208.42292559103774, "episode_reward_mean": -108.88051165940682, "episode_len_mean": 499.11, "episodes_this_iter": 8, "episodes_timesteps_total": 49911, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114.75535091265726, -81.22369246140391, -127.99003755195812, -102.79396384006739, -101.79639154564651, -87.33775281334725, -116.7657107462082, -104.76372078885139, -106.1276030289568, -89.10226245965167, -118.44361436706409, -105.24952318280315, -92.5982794553297, -111.02403319416257, -107.45596948867912, -103.86614714373648, -108.90085686180555, -112.1067748894555, -124.04939442002772, -110.29107356416435, -116.22623563516885, -84.64630997967907, -105.76017226390044, -103.97930915100065, -108.41757266596704, -89.03733666494176, -107.70220346655199, -84.23273590600103, -104.90585915759269, -106.2253520122189, -101.0719301598873, -104.03215970861228, -124.00182596852915, -107.41293677988587, -103.84442762617519, -114.16456270627243, -123.82013567618466, -92.0159127928355, -99.30823189157124, -98.90157378649079, -87.24410146207171, -126.69359647860942, -114.49374982391981, -98.97965821101738, -118.97522755241768, -89.68466498063243, -96.69764637943052, -116.99469528599208, -117.87439857650735, -102.8569549187428, -116.15287061359298, -104.25965632993852, -108.41541547152649, -123.27304140878776, -113.11900863422204, -208.42292559103774, -115.28789020491764, -106.51947552365003, -120.02475186642508, -106.62792120518039, -103.5504115927828, -89.11765456292778, -120.89098993378133, -124.35177706614137, -112.22933584387974, -108.91708791085209, -91.11357980011654, -112.42013489465975, -107.65276561370491, -115.44956072049465, -116.21857580757887, -112.67950386769138, -108.23144093765319, -113.28327438948055, -108.72698965338867, -118.82346322147734, -112.10272236209487, -85.52454850773826, -127.49041439959022, -88.32800977700842, -119.28933776971886, -113.64965252775637, -106.80316798986185, -118.10685060386545, -111.17355582382964, -87.36185812653615, -114.02944791099057, -110.77322782724164, -80.24938785401487, -83.49586523579248, -125.8371156722711, -163.91315362817417, -126.3068465727999, -111.67700693655449, -111.64192951229153, -114.40799519593145, -99.74151464261679, -85.94066479276728, -111.15726156142603, -116.44649765913499], "episode_lengths": [61, 1600, 303, 50, 49, 1600, 71, 67, 80, 1600, 101, 51, 1600, 44, 62, 67, 52, 45, 125, 43, 87, 1600, 89, 58, 64, 1600, 60, 1600, 81, 60, 71, 61, 1600, 71, 68, 69, 104, 1600, 86, 1600, 1600, 1600, 92, 1600, 87, 1600, 1600, 71, 60, 59, 69, 64, 66, 1600, 64, 1075, 99, 42, 91, 57, 59, 1600, 87, 87, 63, 35, 1600, 101, 52, 46, 72, 51, 107, 72, 58, 62, 78, 1600, 1600, 1600, 65, 53, 67, 77, 72, 1600, 59, 53, 1600, 1600, 88, 537, 1600, 49, 107, 43, 1600, 1600, 51, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28489388015536915, "mean_inference_ms": 0.9466465329854711, "mean_action_processing_ms": 0.18508902817066553, "mean_env_wait_ms": 0.3852937290374765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0057370662689208984, "StateBufferConnector_ms": 0.004353523254394531, "ViewRequirementAgentConnector_ms": 0.1136319637298584}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 412.78762545702347, "num_env_steps_trained_throughput_per_sec": 412.78762545702347, "timesteps_total": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 9677.322, "restore_workers_time_ms": 0.018, "training_step_time_ms": 9677.281, "sample_time_ms": 3671.912, "load_time_ms": 0.485, "load_throughput": 8247169.051, "learn_time_ms": 5996.614, "learn_throughput": 667.043, "synch_weights_time_ms": 7.719}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "episodes_total": 165, "training_iteration": 23, "trial_id": "4bb30_00000", "date": "2024-04-27_18-30-20", "timestamp": 1714267820, "time_this_iter_s": 9.695172786712646, "time_total_s": 221.87637066841125, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 221.87637066841125, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 25.15384615384615, "ram_util_percent": 63.86153846153846}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.031957760100724, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0704805281502696, "policy_loss": -0.03165761981439847, "vf_loss": 1.0965687532238262, "vf_explained_var": 0.29405847704538735, "kl": 0.012376399297155791, "entropy": 6.191681497327743, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 21855.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "sampler_results": {"episode_reward_max": -80.24938785401487, "episode_reward_min": -208.42292559103774, "episode_reward_mean": -108.73578096956402, "episode_len_mean": 496.86, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 49686, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-104.76372078885139, -106.1276030289568, -89.10226245965167, -118.44361436706409, -105.24952318280315, -92.5982794553297, -111.02403319416257, -107.45596948867912, -103.86614714373648, -108.90085686180555, -112.1067748894555, -124.04939442002772, -110.29107356416435, -116.22623563516885, -84.64630997967907, -105.76017226390044, -103.97930915100065, -108.41757266596704, -89.03733666494176, -107.70220346655199, -84.23273590600103, -104.90585915759269, -106.2253520122189, -101.0719301598873, -104.03215970861228, -124.00182596852915, -107.41293677988587, -103.84442762617519, -114.16456270627243, -123.82013567618466, -92.0159127928355, -99.30823189157124, -98.90157378649079, -87.24410146207171, -126.69359647860942, -114.49374982391981, -98.97965821101738, -118.97522755241768, -89.68466498063243, -96.69764637943052, -116.99469528599208, -117.87439857650735, -102.8569549187428, -116.15287061359298, -104.25965632993852, -108.41541547152649, -123.27304140878776, -113.11900863422204, -208.42292559103774, -115.28789020491764, -106.51947552365003, -120.02475186642508, -106.62792120518039, -103.5504115927828, -89.11765456292778, -120.89098993378133, -124.35177706614137, -112.22933584387974, -108.91708791085209, -91.11357980011654, -112.42013489465975, -107.65276561370491, -115.44956072049465, -116.21857580757887, -112.67950386769138, -108.23144093765319, -113.28327438948055, -108.72698965338867, -118.82346322147734, -112.10272236209487, -85.52454850773826, -127.49041439959022, -88.32800977700842, -119.28933776971886, -113.64965252775637, -106.80316798986185, -118.10685060386545, -111.17355582382964, -87.36185812653615, -114.02944791099057, -110.77322782724164, -80.24938785401487, -83.49586523579248, -125.8371156722711, -163.91315362817417, -126.3068465727999, -111.67700693655449, -111.64192951229153, -114.40799519593145, -99.74151464261679, -85.94066479276728, -111.15726156142603, -116.44649765913499, -91.00270397756972, -105.16538352170772, -83.00345738233008, -102.39397021510514, -113.89468966227521, -108.17365870481791, -114.55596742320371], "episode_lengths": [67, 80, 1600, 101, 51, 1600, 44, 62, 67, 52, 45, 125, 43, 87, 1600, 89, 58, 64, 1600, 60, 1600, 81, 60, 71, 61, 1600, 71, 68, 69, 104, 1600, 86, 1600, 1600, 1600, 92, 1600, 87, 1600, 1600, 71, 60, 59, 69, 64, 66, 1600, 64, 1075, 99, 42, 91, 57, 59, 1600, 87, 87, 63, 35, 1600, 101, 52, 46, 72, 51, 107, 72, 58, 62, 78, 1600, 1600, 1600, 65, 53, 67, 77, 72, 1600, 59, 53, 1600, 1600, 88, 537, 1600, 49, 107, 43, 1600, 1600, 51, 64, 1600, 39, 1600, 68, 64, 67, 71]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28501400982052427, "mean_inference_ms": 0.9471937941649219, "mean_action_processing_ms": 0.18510441222166812, "mean_env_wait_ms": 0.38526084126502513, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00566864013671875, "StateBufferConnector_ms": 0.004312992095947266, "ViewRequirementAgentConnector_ms": 0.11369085311889648}}, "episode_reward_max": -80.24938785401487, "episode_reward_min": -208.42292559103774, "episode_reward_mean": -108.73578096956402, "episode_len_mean": 496.86, "episodes_this_iter": 7, "episodes_timesteps_total": 49686, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-104.76372078885139, -106.1276030289568, -89.10226245965167, -118.44361436706409, -105.24952318280315, -92.5982794553297, -111.02403319416257, -107.45596948867912, -103.86614714373648, -108.90085686180555, -112.1067748894555, -124.04939442002772, -110.29107356416435, -116.22623563516885, -84.64630997967907, -105.76017226390044, -103.97930915100065, -108.41757266596704, -89.03733666494176, -107.70220346655199, -84.23273590600103, -104.90585915759269, -106.2253520122189, -101.0719301598873, -104.03215970861228, -124.00182596852915, -107.41293677988587, -103.84442762617519, -114.16456270627243, -123.82013567618466, -92.0159127928355, -99.30823189157124, -98.90157378649079, -87.24410146207171, -126.69359647860942, -114.49374982391981, -98.97965821101738, -118.97522755241768, -89.68466498063243, -96.69764637943052, -116.99469528599208, -117.87439857650735, -102.8569549187428, -116.15287061359298, -104.25965632993852, -108.41541547152649, -123.27304140878776, -113.11900863422204, -208.42292559103774, -115.28789020491764, -106.51947552365003, -120.02475186642508, -106.62792120518039, -103.5504115927828, -89.11765456292778, -120.89098993378133, -124.35177706614137, -112.22933584387974, -108.91708791085209, -91.11357980011654, -112.42013489465975, -107.65276561370491, -115.44956072049465, -116.21857580757887, -112.67950386769138, -108.23144093765319, -113.28327438948055, -108.72698965338867, -118.82346322147734, -112.10272236209487, -85.52454850773826, -127.49041439959022, -88.32800977700842, -119.28933776971886, -113.64965252775637, -106.80316798986185, -118.10685060386545, -111.17355582382964, -87.36185812653615, -114.02944791099057, -110.77322782724164, -80.24938785401487, -83.49586523579248, -125.8371156722711, -163.91315362817417, -126.3068465727999, -111.67700693655449, -111.64192951229153, -114.40799519593145, -99.74151464261679, -85.94066479276728, -111.15726156142603, -116.44649765913499, -91.00270397756972, -105.16538352170772, -83.00345738233008, -102.39397021510514, -113.89468966227521, -108.17365870481791, -114.55596742320371], "episode_lengths": [67, 80, 1600, 101, 51, 1600, 44, 62, 67, 52, 45, 125, 43, 87, 1600, 89, 58, 64, 1600, 60, 1600, 81, 60, 71, 61, 1600, 71, 68, 69, 104, 1600, 86, 1600, 1600, 1600, 92, 1600, 87, 1600, 1600, 71, 60, 59, 69, 64, 66, 1600, 64, 1075, 99, 42, 91, 57, 59, 1600, 87, 87, 63, 35, 1600, 101, 52, 46, 72, 51, 107, 72, 58, 62, 78, 1600, 1600, 1600, 65, 53, 67, 77, 72, 1600, 59, 53, 1600, 1600, 88, 537, 1600, 49, 107, 43, 1600, 1600, 51, 64, 1600, 39, 1600, 68, 64, 67, 71]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28501400982052427, "mean_inference_ms": 0.9471937941649219, "mean_action_processing_ms": 0.18510441222166812, "mean_env_wait_ms": 0.38526084126502513, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00566864013671875, "StateBufferConnector_ms": 0.004312992095947266, "ViewRequirementAgentConnector_ms": 0.11369085311889648}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 418.0827520570194, "num_env_steps_trained_throughput_per_sec": 418.0827520570194, "timesteps_total": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 9666.501, "restore_workers_time_ms": 0.015, "training_step_time_ms": 9666.464, "sample_time_ms": 3665.145, "load_time_ms": 0.489, "load_throughput": 8180416.403, "learn_time_ms": 5992.482, "learn_throughput": 667.503, "synch_weights_time_ms": 7.779}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 172, "training_iteration": 24, "trial_id": "4bb30_00000", "date": "2024-04-27_18-30-30", "timestamp": 1714267830, "time_this_iter_s": 9.572166919708252, "time_total_s": 231.4485375881195, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 231.4485375881195, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 24.05, "ram_util_percent": 63.89999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.57958363256147, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5944069241658003, "policy_loss": -0.02741755888026248, "vf_loss": 1.618175466959515, "vf_explained_var": 0.29506409713017046, "kl": 0.00810893955060341, "entropy": 7.199838340410622, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 22785.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "sampler_results": {"episode_reward_max": -80.24938785401487, "episode_reward_min": -208.42292559103774, "episode_reward_mean": -109.00252098415218, "episode_len_mean": 512.09, "episode_media": {}, "episodes_this_iter": 3, "episodes_timesteps_total": 51209, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-118.44361436706409, -105.24952318280315, -92.5982794553297, -111.02403319416257, -107.45596948867912, -103.86614714373648, -108.90085686180555, -112.1067748894555, -124.04939442002772, -110.29107356416435, -116.22623563516885, -84.64630997967907, -105.76017226390044, -103.97930915100065, -108.41757266596704, -89.03733666494176, -107.70220346655199, -84.23273590600103, -104.90585915759269, -106.2253520122189, -101.0719301598873, -104.03215970861228, -124.00182596852915, -107.41293677988587, -103.84442762617519, -114.16456270627243, -123.82013567618466, -92.0159127928355, -99.30823189157124, -98.90157378649079, -87.24410146207171, -126.69359647860942, -114.49374982391981, -98.97965821101738, -118.97522755241768, -89.68466498063243, -96.69764637943052, -116.99469528599208, -117.87439857650735, -102.8569549187428, -116.15287061359298, -104.25965632993852, -108.41541547152649, -123.27304140878776, -113.11900863422204, -208.42292559103774, -115.28789020491764, -106.51947552365003, -120.02475186642508, -106.62792120518039, -103.5504115927828, -89.11765456292778, -120.89098993378133, -124.35177706614137, -112.22933584387974, -108.91708791085209, -91.11357980011654, -112.42013489465975, -107.65276561370491, -115.44956072049465, -116.21857580757887, -112.67950386769138, -108.23144093765319, -113.28327438948055, -108.72698965338867, -118.82346322147734, -112.10272236209487, -85.52454850773826, -127.49041439959022, -88.32800977700842, -119.28933776971886, -113.64965252775637, -106.80316798986185, -118.10685060386545, -111.17355582382964, -87.36185812653615, -114.02944791099057, -110.77322782724164, -80.24938785401487, -83.49586523579248, -125.8371156722711, -163.91315362817417, -126.3068465727999, -111.67700693655449, -111.64192951229153, -114.40799519593145, -99.74151464261679, -85.94066479276728, -111.15726156142603, -116.44649765913499, -91.00270397756972, -105.16538352170772, -83.00345738233008, -102.39397021510514, -113.89468966227521, -108.17365870481791, -114.55596742320371, -84.72089160340515, -138.99723845274144, -102.94945768012789], "episode_lengths": [101, 51, 1600, 44, 62, 67, 52, 45, 125, 43, 87, 1600, 89, 58, 64, 1600, 60, 1600, 81, 60, 71, 61, 1600, 71, 68, 69, 104, 1600, 86, 1600, 1600, 1600, 92, 1600, 87, 1600, 1600, 71, 60, 59, 69, 64, 66, 1600, 64, 1075, 99, 42, 91, 57, 59, 1600, 87, 87, 63, 35, 1600, 101, 52, 46, 72, 51, 107, 72, 58, 62, 78, 1600, 1600, 1600, 65, 53, 67, 77, 72, 1600, 59, 53, 1600, 1600, 88, 537, 1600, 49, 107, 43, 1600, 1600, 51, 64, 1600, 39, 1600, 68, 64, 67, 71, 1600, 1600, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2850696461126934, "mean_inference_ms": 0.9473062694021841, "mean_action_processing_ms": 0.1851209593728174, "mean_env_wait_ms": 0.38529639460262516, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005700588226318359, "StateBufferConnector_ms": 0.0043163299560546875, "ViewRequirementAgentConnector_ms": 0.11343073844909668}}, "episode_reward_max": -80.24938785401487, "episode_reward_min": -208.42292559103774, "episode_reward_mean": -109.00252098415218, "episode_len_mean": 512.09, "episodes_this_iter": 3, "episodes_timesteps_total": 51209, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-118.44361436706409, -105.24952318280315, -92.5982794553297, -111.02403319416257, -107.45596948867912, -103.86614714373648, -108.90085686180555, -112.1067748894555, -124.04939442002772, -110.29107356416435, -116.22623563516885, -84.64630997967907, -105.76017226390044, -103.97930915100065, -108.41757266596704, -89.03733666494176, -107.70220346655199, -84.23273590600103, -104.90585915759269, -106.2253520122189, -101.0719301598873, -104.03215970861228, -124.00182596852915, -107.41293677988587, -103.84442762617519, -114.16456270627243, -123.82013567618466, -92.0159127928355, -99.30823189157124, -98.90157378649079, -87.24410146207171, -126.69359647860942, -114.49374982391981, -98.97965821101738, -118.97522755241768, -89.68466498063243, -96.69764637943052, -116.99469528599208, -117.87439857650735, -102.8569549187428, -116.15287061359298, -104.25965632993852, -108.41541547152649, -123.27304140878776, -113.11900863422204, -208.42292559103774, -115.28789020491764, -106.51947552365003, -120.02475186642508, -106.62792120518039, -103.5504115927828, -89.11765456292778, -120.89098993378133, -124.35177706614137, -112.22933584387974, -108.91708791085209, -91.11357980011654, -112.42013489465975, -107.65276561370491, -115.44956072049465, -116.21857580757887, -112.67950386769138, -108.23144093765319, -113.28327438948055, -108.72698965338867, -118.82346322147734, -112.10272236209487, -85.52454850773826, -127.49041439959022, -88.32800977700842, -119.28933776971886, -113.64965252775637, -106.80316798986185, -118.10685060386545, -111.17355582382964, -87.36185812653615, -114.02944791099057, -110.77322782724164, -80.24938785401487, -83.49586523579248, -125.8371156722711, -163.91315362817417, -126.3068465727999, -111.67700693655449, -111.64192951229153, -114.40799519593145, -99.74151464261679, -85.94066479276728, -111.15726156142603, -116.44649765913499, -91.00270397756972, -105.16538352170772, -83.00345738233008, -102.39397021510514, -113.89468966227521, -108.17365870481791, -114.55596742320371, -84.72089160340515, -138.99723845274144, -102.94945768012789], "episode_lengths": [101, 51, 1600, 44, 62, 67, 52, 45, 125, 43, 87, 1600, 89, 58, 64, 1600, 60, 1600, 81, 60, 71, 61, 1600, 71, 68, 69, 104, 1600, 86, 1600, 1600, 1600, 92, 1600, 87, 1600, 1600, 71, 60, 59, 69, 64, 66, 1600, 64, 1075, 99, 42, 91, 57, 59, 1600, 87, 87, 63, 35, 1600, 101, 52, 46, 72, 51, 107, 72, 58, 62, 78, 1600, 1600, 1600, 65, 53, 67, 77, 72, 1600, 59, 53, 1600, 1600, 88, 537, 1600, 49, 107, 43, 1600, 1600, 51, 64, 1600, 39, 1600, 68, 64, 67, 71, 1600, 1600, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2850696461126934, "mean_inference_ms": 0.9473062694021841, "mean_action_processing_ms": 0.1851209593728174, "mean_env_wait_ms": 0.38529639460262516, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005700588226318359, "StateBufferConnector_ms": 0.0043163299560546875, "ViewRequirementAgentConnector_ms": 0.11343073844909668}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 415.07010925577356, "num_env_steps_trained_throughput_per_sec": 415.07010925577356, "timesteps_total": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 9671.592, "restore_workers_time_ms": 0.015, "training_step_time_ms": 9671.552, "sample_time_ms": 3661.56, "load_time_ms": 0.482, "load_throughput": 8292825.861, "learn_time_ms": 6001.148, "learn_throughput": 666.539, "synch_weights_time_ms": 7.796}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "episodes_total": 175, "training_iteration": 25, "trial_id": "4bb30_00000", "date": "2024-04-27_18-30-39", "timestamp": 1714267839, "time_this_iter_s": 9.641753911972046, "time_total_s": 241.09029150009155, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 241.09029150009155, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 25.657142857142855, "ram_util_percent": 63.949999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.600933740856828, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5603995354215223, "policy_loss": -0.0268187343112884, "vf_loss": 1.5829244603793466, "vf_explained_var": 0.3197107552841145, "kl": 0.009541805721334512, "entropy": 6.9386485176701695, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 23715.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "sampler_results": {"episode_reward_max": -80.24938785401487, "episode_reward_min": -208.42292559103774, "episode_reward_mean": -109.37511766522499, "episode_len_mean": 527.79, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 52779, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-108.90085686180555, -112.1067748894555, -124.04939442002772, -110.29107356416435, -116.22623563516885, -84.64630997967907, -105.76017226390044, -103.97930915100065, -108.41757266596704, -89.03733666494176, -107.70220346655199, -84.23273590600103, -104.90585915759269, -106.2253520122189, -101.0719301598873, -104.03215970861228, -124.00182596852915, -107.41293677988587, -103.84442762617519, -114.16456270627243, -123.82013567618466, -92.0159127928355, -99.30823189157124, -98.90157378649079, -87.24410146207171, -126.69359647860942, -114.49374982391981, -98.97965821101738, -118.97522755241768, -89.68466498063243, -96.69764637943052, -116.99469528599208, -117.87439857650735, -102.8569549187428, -116.15287061359298, -104.25965632993852, -108.41541547152649, -123.27304140878776, -113.11900863422204, -208.42292559103774, -115.28789020491764, -106.51947552365003, -120.02475186642508, -106.62792120518039, -103.5504115927828, -89.11765456292778, -120.89098993378133, -124.35177706614137, -112.22933584387974, -108.91708791085209, -91.11357980011654, -112.42013489465975, -107.65276561370491, -115.44956072049465, -116.21857580757887, -112.67950386769138, -108.23144093765319, -113.28327438948055, -108.72698965338867, -118.82346322147734, -112.10272236209487, -85.52454850773826, -127.49041439959022, -88.32800977700842, -119.28933776971886, -113.64965252775637, -106.80316798986185, -118.10685060386545, -111.17355582382964, -87.36185812653615, -114.02944791099057, -110.77322782724164, -80.24938785401487, -83.49586523579248, -125.8371156722711, -163.91315362817417, -126.3068465727999, -111.67700693655449, -111.64192951229153, -114.40799519593145, -99.74151464261679, -85.94066479276728, -111.15726156142603, -116.44649765913499, -91.00270397756972, -105.16538352170772, -83.00345738233008, -102.39397021510514, -113.89468966227521, -108.17365870481791, -114.55596742320371, -84.72089160340515, -138.99723845274144, -102.94945768012789, -80.67062085370596, -108.25077240848977, -115.86613781278642, -103.0355264597293, -151.84700326090646, -116.22717414344041], "episode_lengths": [52, 45, 125, 43, 87, 1600, 89, 58, 64, 1600, 60, 1600, 81, 60, 71, 61, 1600, 71, 68, 69, 104, 1600, 86, 1600, 1600, 1600, 92, 1600, 87, 1600, 1600, 71, 60, 59, 69, 64, 66, 1600, 64, 1075, 99, 42, 91, 57, 59, 1600, 87, 87, 63, 35, 1600, 101, 52, 46, 72, 51, 107, 72, 58, 62, 78, 1600, 1600, 1600, 65, 53, 67, 77, 72, 1600, 59, 53, 1600, 1600, 88, 537, 1600, 49, 107, 43, 1600, 1600, 51, 64, 1600, 39, 1600, 68, 64, 67, 71, 1600, 1600, 70, 1600, 82, 64, 72, 1600, 77]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2851827879161983, "mean_inference_ms": 0.9473650895354375, "mean_action_processing_ms": 0.18517028199136976, "mean_env_wait_ms": 0.3854589004823819, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0057299137115478516, "StateBufferConnector_ms": 0.0043184757232666016, "ViewRequirementAgentConnector_ms": 0.11306190490722656}}, "episode_reward_max": -80.24938785401487, "episode_reward_min": -208.42292559103774, "episode_reward_mean": -109.37511766522499, "episode_len_mean": 527.79, "episodes_this_iter": 6, "episodes_timesteps_total": 52779, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-108.90085686180555, -112.1067748894555, -124.04939442002772, -110.29107356416435, -116.22623563516885, -84.64630997967907, -105.76017226390044, -103.97930915100065, -108.41757266596704, -89.03733666494176, -107.70220346655199, -84.23273590600103, -104.90585915759269, -106.2253520122189, -101.0719301598873, -104.03215970861228, -124.00182596852915, -107.41293677988587, -103.84442762617519, -114.16456270627243, -123.82013567618466, -92.0159127928355, -99.30823189157124, -98.90157378649079, -87.24410146207171, -126.69359647860942, -114.49374982391981, -98.97965821101738, -118.97522755241768, -89.68466498063243, -96.69764637943052, -116.99469528599208, -117.87439857650735, -102.8569549187428, -116.15287061359298, -104.25965632993852, -108.41541547152649, -123.27304140878776, -113.11900863422204, -208.42292559103774, -115.28789020491764, -106.51947552365003, -120.02475186642508, -106.62792120518039, -103.5504115927828, -89.11765456292778, -120.89098993378133, -124.35177706614137, -112.22933584387974, -108.91708791085209, -91.11357980011654, -112.42013489465975, -107.65276561370491, -115.44956072049465, -116.21857580757887, -112.67950386769138, -108.23144093765319, -113.28327438948055, -108.72698965338867, -118.82346322147734, -112.10272236209487, -85.52454850773826, -127.49041439959022, -88.32800977700842, -119.28933776971886, -113.64965252775637, -106.80316798986185, -118.10685060386545, -111.17355582382964, -87.36185812653615, -114.02944791099057, -110.77322782724164, -80.24938785401487, -83.49586523579248, -125.8371156722711, -163.91315362817417, -126.3068465727999, -111.67700693655449, -111.64192951229153, -114.40799519593145, -99.74151464261679, -85.94066479276728, -111.15726156142603, -116.44649765913499, -91.00270397756972, -105.16538352170772, -83.00345738233008, -102.39397021510514, -113.89468966227521, -108.17365870481791, -114.55596742320371, -84.72089160340515, -138.99723845274144, -102.94945768012789, -80.67062085370596, -108.25077240848977, -115.86613781278642, -103.0355264597293, -151.84700326090646, -116.22717414344041], "episode_lengths": [52, 45, 125, 43, 87, 1600, 89, 58, 64, 1600, 60, 1600, 81, 60, 71, 61, 1600, 71, 68, 69, 104, 1600, 86, 1600, 1600, 1600, 92, 1600, 87, 1600, 1600, 71, 60, 59, 69, 64, 66, 1600, 64, 1075, 99, 42, 91, 57, 59, 1600, 87, 87, 63, 35, 1600, 101, 52, 46, 72, 51, 107, 72, 58, 62, 78, 1600, 1600, 1600, 65, 53, 67, 77, 72, 1600, 59, 53, 1600, 1600, 88, 537, 1600, 49, 107, 43, 1600, 1600, 51, 64, 1600, 39, 1600, 68, 64, 67, 71, 1600, 1600, 70, 1600, 82, 64, 72, 1600, 77]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2851827879161983, "mean_inference_ms": 0.9473650895354375, "mean_action_processing_ms": 0.18517028199136976, "mean_env_wait_ms": 0.3854589004823819, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0057299137115478516, "StateBufferConnector_ms": 0.0043184757232666016, "ViewRequirementAgentConnector_ms": 0.11306190490722656}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 410.64237597062487, "num_env_steps_trained_throughput_per_sec": 410.64237597062487, "timesteps_total": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 9674.29, "restore_workers_time_ms": 0.015, "training_step_time_ms": 9674.251, "sample_time_ms": 3658.643, "load_time_ms": 0.478, "load_throughput": 8372282.05, "learn_time_ms": 6006.744, "learn_throughput": 665.918, "synch_weights_time_ms": 7.822}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "episodes_total": 181, "training_iteration": 26, "trial_id": "4bb30_00000", "date": "2024-04-27_18-30-49", "timestamp": 1714267849, "time_this_iter_s": 9.744986772537231, "time_total_s": 250.83527827262878, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 250.83527827262878, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 24.621428571428574, "ram_util_percent": 64.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.279988104104996, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9757050636055458, "policy_loss": -0.0315400755213153, "vf_loss": 1.9995187232691434, "vf_explained_var": 0.11258371344176672, "kl": 0.017169837918451284, "entropy": 6.72913276303199, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 24645.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": -71.83933218312691, "episode_reward_min": -208.42292559103774, "episode_reward_mean": -108.76863410433964, "episode_len_mean": 560.18, "episode_media": {}, "episodes_this_iter": 8, "episodes_timesteps_total": 56018, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-108.41757266596704, -89.03733666494176, -107.70220346655199, -84.23273590600103, -104.90585915759269, -106.2253520122189, -101.0719301598873, -104.03215970861228, -124.00182596852915, -107.41293677988587, -103.84442762617519, -114.16456270627243, -123.82013567618466, -92.0159127928355, -99.30823189157124, -98.90157378649079, -87.24410146207171, -126.69359647860942, -114.49374982391981, -98.97965821101738, -118.97522755241768, -89.68466498063243, -96.69764637943052, -116.99469528599208, -117.87439857650735, -102.8569549187428, -116.15287061359298, -104.25965632993852, -108.41541547152649, -123.27304140878776, -113.11900863422204, -208.42292559103774, -115.28789020491764, -106.51947552365003, -120.02475186642508, -106.62792120518039, -103.5504115927828, -89.11765456292778, -120.89098993378133, -124.35177706614137, -112.22933584387974, -108.91708791085209, -91.11357980011654, -112.42013489465975, -107.65276561370491, -115.44956072049465, -116.21857580757887, -112.67950386769138, -108.23144093765319, -113.28327438948055, -108.72698965338867, -118.82346322147734, -112.10272236209487, -85.52454850773826, -127.49041439959022, -88.32800977700842, -119.28933776971886, -113.64965252775637, -106.80316798986185, -118.10685060386545, -111.17355582382964, -87.36185812653615, -114.02944791099057, -110.77322782724164, -80.24938785401487, -83.49586523579248, -125.8371156722711, -163.91315362817417, -126.3068465727999, -111.67700693655449, -111.64192951229153, -114.40799519593145, -99.74151464261679, -85.94066479276728, -111.15726156142603, -116.44649765913499, -91.00270397756972, -105.16538352170772, -83.00345738233008, -102.39397021510514, -113.89468966227521, -108.17365870481791, -114.55596742320371, -84.72089160340515, -138.99723845274144, -102.94945768012789, -80.67062085370596, -108.25077240848977, -115.86613781278642, -103.0355264597293, -151.84700326090646, -116.22717414344041, -95.12103612170554, -71.83933218312691, -86.67064132343613, -110.75204453233195, -108.00408695291418, -109.01482975365532, -104.91433270118014, -118.99546710831486], "episode_lengths": [64, 1600, 60, 1600, 81, 60, 71, 61, 1600, 71, 68, 69, 104, 1600, 86, 1600, 1600, 1600, 92, 1600, 87, 1600, 1600, 71, 60, 59, 69, 64, 66, 1600, 64, 1075, 99, 42, 91, 57, 59, 1600, 87, 87, 63, 35, 1600, 101, 52, 46, 72, 51, 107, 72, 58, 62, 78, 1600, 1600, 1600, 65, 53, 67, 77, 72, 1600, 59, 53, 1600, 1600, 88, 537, 1600, 49, 107, 43, 1600, 1600, 51, 64, 1600, 39, 1600, 68, 64, 67, 71, 1600, 1600, 70, 1600, 82, 64, 72, 1600, 77, 1600, 1600, 1600, 79, 78, 92, 147, 142]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28524379963656343, "mean_inference_ms": 0.9476981831782487, "mean_action_processing_ms": 0.18519975704676966, "mean_env_wait_ms": 0.3855275351106189, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00570225715637207, "StateBufferConnector_ms": 0.004345893859863281, "ViewRequirementAgentConnector_ms": 0.11253857612609863}}, "episode_reward_max": -71.83933218312691, "episode_reward_min": -208.42292559103774, "episode_reward_mean": -108.76863410433964, "episode_len_mean": 560.18, "episodes_this_iter": 8, "episodes_timesteps_total": 56018, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-108.41757266596704, -89.03733666494176, -107.70220346655199, -84.23273590600103, -104.90585915759269, -106.2253520122189, -101.0719301598873, -104.03215970861228, -124.00182596852915, -107.41293677988587, -103.84442762617519, -114.16456270627243, -123.82013567618466, -92.0159127928355, -99.30823189157124, -98.90157378649079, -87.24410146207171, -126.69359647860942, -114.49374982391981, -98.97965821101738, -118.97522755241768, -89.68466498063243, -96.69764637943052, -116.99469528599208, -117.87439857650735, -102.8569549187428, -116.15287061359298, -104.25965632993852, -108.41541547152649, -123.27304140878776, -113.11900863422204, -208.42292559103774, -115.28789020491764, -106.51947552365003, -120.02475186642508, -106.62792120518039, -103.5504115927828, -89.11765456292778, -120.89098993378133, -124.35177706614137, -112.22933584387974, -108.91708791085209, -91.11357980011654, -112.42013489465975, -107.65276561370491, -115.44956072049465, -116.21857580757887, -112.67950386769138, -108.23144093765319, -113.28327438948055, -108.72698965338867, -118.82346322147734, -112.10272236209487, -85.52454850773826, -127.49041439959022, -88.32800977700842, -119.28933776971886, -113.64965252775637, -106.80316798986185, -118.10685060386545, -111.17355582382964, -87.36185812653615, -114.02944791099057, -110.77322782724164, -80.24938785401487, -83.49586523579248, -125.8371156722711, -163.91315362817417, -126.3068465727999, -111.67700693655449, -111.64192951229153, -114.40799519593145, -99.74151464261679, -85.94066479276728, -111.15726156142603, -116.44649765913499, -91.00270397756972, -105.16538352170772, -83.00345738233008, -102.39397021510514, -113.89468966227521, -108.17365870481791, -114.55596742320371, -84.72089160340515, -138.99723845274144, -102.94945768012789, -80.67062085370596, -108.25077240848977, -115.86613781278642, -103.0355264597293, -151.84700326090646, -116.22717414344041, -95.12103612170554, -71.83933218312691, -86.67064132343613, -110.75204453233195, -108.00408695291418, -109.01482975365532, -104.91433270118014, -118.99546710831486], "episode_lengths": [64, 1600, 60, 1600, 81, 60, 71, 61, 1600, 71, 68, 69, 104, 1600, 86, 1600, 1600, 1600, 92, 1600, 87, 1600, 1600, 71, 60, 59, 69, 64, 66, 1600, 64, 1075, 99, 42, 91, 57, 59, 1600, 87, 87, 63, 35, 1600, 101, 52, 46, 72, 51, 107, 72, 58, 62, 78, 1600, 1600, 1600, 65, 53, 67, 77, 72, 1600, 59, 53, 1600, 1600, 88, 537, 1600, 49, 107, 43, 1600, 1600, 51, 64, 1600, 39, 1600, 68, 64, 67, 71, 1600, 1600, 70, 1600, 82, 64, 72, 1600, 77, 1600, 1600, 1600, 79, 78, 92, 147, 142]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28524379963656343, "mean_inference_ms": 0.9476981831782487, "mean_action_processing_ms": 0.18519975704676966, "mean_env_wait_ms": 0.3855275351106189, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00570225715637207, "StateBufferConnector_ms": 0.004345893859863281, "ViewRequirementAgentConnector_ms": 0.11253857612609863}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 416.1990926743403, "num_env_steps_trained_throughput_per_sec": 416.1990926743403, "timesteps_total": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 9668.818, "restore_workers_time_ms": 0.015, "training_step_time_ms": 9668.776, "sample_time_ms": 3656.186, "load_time_ms": 0.48, "load_throughput": 8335676.455, "learn_time_ms": 6003.659, "learn_throughput": 666.26, "synch_weights_time_ms": 7.882}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 189, "training_iteration": 27, "trial_id": "4bb30_00000", "date": "2024-04-27_18-30-59", "timestamp": 1714267859, "time_this_iter_s": 9.615247011184692, "time_total_s": 260.4505252838135, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 260.4505252838135, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 24.569230769230767, "ram_util_percent": 63.95384615384614}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.248526517293786, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8608644102568618, "policy_loss": -0.03434024441947219, "vf_loss": 0.890571628394787, "vf_explained_var": 0.29671682548779316, "kl": 0.010295616083201712, "entropy": 5.853437776975734, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 25575.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "sampler_results": {"episode_reward_max": -71.83933218312691, "episode_reward_min": -208.42292559103774, "episode_reward_mean": -108.87434598904238, "episode_len_mean": 560.17, "episode_media": {}, "episodes_this_iter": 5, "episodes_timesteps_total": 56017, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-106.2253520122189, -101.0719301598873, -104.03215970861228, -124.00182596852915, -107.41293677988587, -103.84442762617519, -114.16456270627243, -123.82013567618466, -92.0159127928355, -99.30823189157124, -98.90157378649079, -87.24410146207171, -126.69359647860942, -114.49374982391981, -98.97965821101738, -118.97522755241768, -89.68466498063243, -96.69764637943052, -116.99469528599208, -117.87439857650735, -102.8569549187428, -116.15287061359298, -104.25965632993852, -108.41541547152649, -123.27304140878776, -113.11900863422204, -208.42292559103774, -115.28789020491764, -106.51947552365003, -120.02475186642508, -106.62792120518039, -103.5504115927828, -89.11765456292778, -120.89098993378133, -124.35177706614137, -112.22933584387974, -108.91708791085209, -91.11357980011654, -112.42013489465975, -107.65276561370491, -115.44956072049465, -116.21857580757887, -112.67950386769138, -108.23144093765319, -113.28327438948055, -108.72698965338867, -118.82346322147734, -112.10272236209487, -85.52454850773826, -127.49041439959022, -88.32800977700842, -119.28933776971886, -113.64965252775637, -106.80316798986185, -118.10685060386545, -111.17355582382964, -87.36185812653615, -114.02944791099057, -110.77322782724164, -80.24938785401487, -83.49586523579248, -125.8371156722711, -163.91315362817417, -126.3068465727999, -111.67700693655449, -111.64192951229153, -114.40799519593145, -99.74151464261679, -85.94066479276728, -111.15726156142603, -116.44649765913499, -91.00270397756972, -105.16538352170772, -83.00345738233008, -102.39397021510514, -113.89468966227521, -108.17365870481791, -114.55596742320371, -84.72089160340515, -138.99723845274144, -102.94945768012789, -80.67062085370596, -108.25077240848977, -115.86613781278642, -103.0355264597293, -151.84700326090646, -116.22717414344041, -95.12103612170554, -71.83933218312691, -86.67064132343613, -110.75204453233195, -108.00408695291418, -109.01482975365532, -104.91433270118014, -118.99546710831486, -88.412941530209, -108.72663824119233, -88.96703517702592, -113.23966200823213, -105.52061937466947], "episode_lengths": [60, 71, 61, 1600, 71, 68, 69, 104, 1600, 86, 1600, 1600, 1600, 92, 1600, 87, 1600, 1600, 71, 60, 59, 69, 64, 66, 1600, 64, 1075, 99, 42, 91, 57, 59, 1600, 87, 87, 63, 35, 1600, 101, 52, 46, 72, 51, 107, 72, 58, 62, 78, 1600, 1600, 1600, 65, 53, 67, 77, 72, 1600, 59, 53, 1600, 1600, 88, 537, 1600, 49, 107, 43, 1600, 1600, 51, 64, 1600, 39, 1600, 68, 64, 67, 71, 1600, 1600, 70, 1600, 82, 64, 72, 1600, 77, 1600, 1600, 1600, 79, 78, 92, 147, 142, 1600, 65, 1600, 64, 75]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28528961857985774, "mean_inference_ms": 0.9479226682580834, "mean_action_processing_ms": 0.1852082603220411, "mean_env_wait_ms": 0.3855409950854451, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005734682083129883, "StateBufferConnector_ms": 0.004381895065307617, "ViewRequirementAgentConnector_ms": 0.11258292198181152}}, "episode_reward_max": -71.83933218312691, "episode_reward_min": -208.42292559103774, "episode_reward_mean": -108.87434598904238, "episode_len_mean": 560.17, "episodes_this_iter": 5, "episodes_timesteps_total": 56017, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-106.2253520122189, -101.0719301598873, -104.03215970861228, -124.00182596852915, -107.41293677988587, -103.84442762617519, -114.16456270627243, -123.82013567618466, -92.0159127928355, -99.30823189157124, -98.90157378649079, -87.24410146207171, -126.69359647860942, -114.49374982391981, -98.97965821101738, -118.97522755241768, -89.68466498063243, -96.69764637943052, -116.99469528599208, -117.87439857650735, -102.8569549187428, -116.15287061359298, -104.25965632993852, -108.41541547152649, -123.27304140878776, -113.11900863422204, -208.42292559103774, -115.28789020491764, -106.51947552365003, -120.02475186642508, -106.62792120518039, -103.5504115927828, -89.11765456292778, -120.89098993378133, -124.35177706614137, -112.22933584387974, -108.91708791085209, -91.11357980011654, -112.42013489465975, -107.65276561370491, -115.44956072049465, -116.21857580757887, -112.67950386769138, -108.23144093765319, -113.28327438948055, -108.72698965338867, -118.82346322147734, -112.10272236209487, -85.52454850773826, -127.49041439959022, -88.32800977700842, -119.28933776971886, -113.64965252775637, -106.80316798986185, -118.10685060386545, -111.17355582382964, -87.36185812653615, -114.02944791099057, -110.77322782724164, -80.24938785401487, -83.49586523579248, -125.8371156722711, -163.91315362817417, -126.3068465727999, -111.67700693655449, -111.64192951229153, -114.40799519593145, -99.74151464261679, -85.94066479276728, -111.15726156142603, -116.44649765913499, -91.00270397756972, -105.16538352170772, -83.00345738233008, -102.39397021510514, -113.89468966227521, -108.17365870481791, -114.55596742320371, -84.72089160340515, -138.99723845274144, -102.94945768012789, -80.67062085370596, -108.25077240848977, -115.86613781278642, -103.0355264597293, -151.84700326090646, -116.22717414344041, -95.12103612170554, -71.83933218312691, -86.67064132343613, -110.75204453233195, -108.00408695291418, -109.01482975365532, -104.91433270118014, -118.99546710831486, -88.412941530209, -108.72663824119233, -88.96703517702592, -113.23966200823213, -105.52061937466947], "episode_lengths": [60, 71, 61, 1600, 71, 68, 69, 104, 1600, 86, 1600, 1600, 1600, 92, 1600, 87, 1600, 1600, 71, 60, 59, 69, 64, 66, 1600, 64, 1075, 99, 42, 91, 57, 59, 1600, 87, 87, 63, 35, 1600, 101, 52, 46, 72, 51, 107, 72, 58, 62, 78, 1600, 1600, 1600, 65, 53, 67, 77, 72, 1600, 59, 53, 1600, 1600, 88, 537, 1600, 49, 107, 43, 1600, 1600, 51, 64, 1600, 39, 1600, 68, 64, 67, 71, 1600, 1600, 70, 1600, 82, 64, 72, 1600, 77, 1600, 1600, 1600, 79, 78, 92, 147, 142, 1600, 65, 1600, 64, 75]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28528961857985774, "mean_inference_ms": 0.9479226682580834, "mean_action_processing_ms": 0.1852082603220411, "mean_env_wait_ms": 0.3855409950854451, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005734682083129883, "StateBufferConnector_ms": 0.004381895065307617, "ViewRequirementAgentConnector_ms": 0.11258292198181152}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 408.4595740880789, "num_env_steps_trained_throughput_per_sec": 408.4595740880789, "timesteps_total": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 9686.087, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9686.046, "sample_time_ms": 3657.305, "load_time_ms": 0.472, "load_throughput": 8466499.798, "learn_time_ms": 6019.92, "learn_throughput": 664.461, "synch_weights_time_ms": 7.784}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "episodes_total": 194, "training_iteration": 28, "trial_id": "4bb30_00000", "date": "2024-04-27_18-31-08", "timestamp": 1714267868, "time_this_iter_s": 9.797725915908813, "time_total_s": 270.2482511997223, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 270.2482511997223, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 26.349999999999994, "ram_util_percent": 63.98571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.589597942367677, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.7747912951526033, "policy_loss": -0.03427155119196702, "vf_loss": 2.8013179004032125, "vf_explained_var": 0.1683465853814156, "kl": 0.017210958850505137, "entropy": 7.964315876909482, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 26505.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "sampler_results": {"episode_reward_max": -71.83933218312691, "episode_reward_min": -208.42292559103774, "episode_reward_mean": -109.22317470816799, "episode_len_mean": 496.93, "episode_media": {}, "episodes_this_iter": 16, "episodes_timesteps_total": 49693, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-89.68466498063243, -96.69764637943052, -116.99469528599208, -117.87439857650735, -102.8569549187428, -116.15287061359298, -104.25965632993852, -108.41541547152649, -123.27304140878776, -113.11900863422204, -208.42292559103774, -115.28789020491764, -106.51947552365003, -120.02475186642508, -106.62792120518039, -103.5504115927828, -89.11765456292778, -120.89098993378133, -124.35177706614137, -112.22933584387974, -108.91708791085209, -91.11357980011654, -112.42013489465975, -107.65276561370491, -115.44956072049465, -116.21857580757887, -112.67950386769138, -108.23144093765319, -113.28327438948055, -108.72698965338867, -118.82346322147734, -112.10272236209487, -85.52454850773826, -127.49041439959022, -88.32800977700842, -119.28933776971886, -113.64965252775637, -106.80316798986185, -118.10685060386545, -111.17355582382964, -87.36185812653615, -114.02944791099057, -110.77322782724164, -80.24938785401487, -83.49586523579248, -125.8371156722711, -163.91315362817417, -126.3068465727999, -111.67700693655449, -111.64192951229153, -114.40799519593145, -99.74151464261679, -85.94066479276728, -111.15726156142603, -116.44649765913499, -91.00270397756972, -105.16538352170772, -83.00345738233008, -102.39397021510514, -113.89468966227521, -108.17365870481791, -114.55596742320371, -84.72089160340515, -138.99723845274144, -102.94945768012789, -80.67062085370596, -108.25077240848977, -115.86613781278642, -103.0355264597293, -151.84700326090646, -116.22717414344041, -95.12103612170554, -71.83933218312691, -86.67064132343613, -110.75204453233195, -108.00408695291418, -109.01482975365532, -104.91433270118014, -118.99546710831486, -88.412941530209, -108.72663824119233, -88.96703517702592, -113.23966200823213, -105.52061937466947, -85.36627136432514, -114.51024559673294, -108.94396790004087, -112.40843796739541, -107.52356615774582, -123.9120734313025, -113.49118999093399, -89.43826942713618, -113.37270364682874, -116.04578494502357, -114.64725730017759, -118.70272133657338, -112.6050885285108, -107.74277468968245, -107.00184648572095, -110.35605578113099], "episode_lengths": [1600, 1600, 71, 60, 59, 69, 64, 66, 1600, 64, 1075, 99, 42, 91, 57, 59, 1600, 87, 87, 63, 35, 1600, 101, 52, 46, 72, 51, 107, 72, 58, 62, 78, 1600, 1600, 1600, 65, 53, 67, 77, 72, 1600, 59, 53, 1600, 1600, 88, 537, 1600, 49, 107, 43, 1600, 1600, 51, 64, 1600, 39, 1600, 68, 64, 67, 71, 1600, 1600, 70, 1600, 82, 64, 72, 1600, 77, 1600, 1600, 1600, 79, 78, 92, 147, 142, 1600, 65, 1600, 64, 75, 1600, 41, 79, 49, 95, 107, 40, 1600, 56, 85, 46, 61, 37, 58, 47, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2854893769026921, "mean_inference_ms": 0.9484343445526454, "mean_action_processing_ms": 0.185262124271394, "mean_env_wait_ms": 0.3856762388263046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005843162536621094, "StateBufferConnector_ms": 0.0043566226959228516, "ViewRequirementAgentConnector_ms": 0.11388659477233887}}, "episode_reward_max": -71.83933218312691, "episode_reward_min": -208.42292559103774, "episode_reward_mean": -109.22317470816799, "episode_len_mean": 496.93, "episodes_this_iter": 16, "episodes_timesteps_total": 49693, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-89.68466498063243, -96.69764637943052, -116.99469528599208, -117.87439857650735, -102.8569549187428, -116.15287061359298, -104.25965632993852, -108.41541547152649, -123.27304140878776, -113.11900863422204, -208.42292559103774, -115.28789020491764, -106.51947552365003, -120.02475186642508, -106.62792120518039, -103.5504115927828, -89.11765456292778, -120.89098993378133, -124.35177706614137, -112.22933584387974, -108.91708791085209, -91.11357980011654, -112.42013489465975, -107.65276561370491, -115.44956072049465, -116.21857580757887, -112.67950386769138, -108.23144093765319, -113.28327438948055, -108.72698965338867, -118.82346322147734, -112.10272236209487, -85.52454850773826, -127.49041439959022, -88.32800977700842, -119.28933776971886, -113.64965252775637, -106.80316798986185, -118.10685060386545, -111.17355582382964, -87.36185812653615, -114.02944791099057, -110.77322782724164, -80.24938785401487, -83.49586523579248, -125.8371156722711, -163.91315362817417, -126.3068465727999, -111.67700693655449, -111.64192951229153, -114.40799519593145, -99.74151464261679, -85.94066479276728, -111.15726156142603, -116.44649765913499, -91.00270397756972, -105.16538352170772, -83.00345738233008, -102.39397021510514, -113.89468966227521, -108.17365870481791, -114.55596742320371, -84.72089160340515, -138.99723845274144, -102.94945768012789, -80.67062085370596, -108.25077240848977, -115.86613781278642, -103.0355264597293, -151.84700326090646, -116.22717414344041, -95.12103612170554, -71.83933218312691, -86.67064132343613, -110.75204453233195, -108.00408695291418, -109.01482975365532, -104.91433270118014, -118.99546710831486, -88.412941530209, -108.72663824119233, -88.96703517702592, -113.23966200823213, -105.52061937466947, -85.36627136432514, -114.51024559673294, -108.94396790004087, -112.40843796739541, -107.52356615774582, -123.9120734313025, -113.49118999093399, -89.43826942713618, -113.37270364682874, -116.04578494502357, -114.64725730017759, -118.70272133657338, -112.6050885285108, -107.74277468968245, -107.00184648572095, -110.35605578113099], "episode_lengths": [1600, 1600, 71, 60, 59, 69, 64, 66, 1600, 64, 1075, 99, 42, 91, 57, 59, 1600, 87, 87, 63, 35, 1600, 101, 52, 46, 72, 51, 107, 72, 58, 62, 78, 1600, 1600, 1600, 65, 53, 67, 77, 72, 1600, 59, 53, 1600, 1600, 88, 537, 1600, 49, 107, 43, 1600, 1600, 51, 64, 1600, 39, 1600, 68, 64, 67, 71, 1600, 1600, 70, 1600, 82, 64, 72, 1600, 77, 1600, 1600, 1600, 79, 78, 92, 147, 142, 1600, 65, 1600, 64, 75, 1600, 41, 79, 49, 95, 107, 40, 1600, 56, 85, 46, 61, 37, 58, 47, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2854893769026921, "mean_inference_ms": 0.9484343445526454, "mean_action_processing_ms": 0.185262124271394, "mean_env_wait_ms": 0.3856762388263046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005843162536621094, "StateBufferConnector_ms": 0.0043566226959228516, "ViewRequirementAgentConnector_ms": 0.11388659477233887}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 413.3610303257527, "num_env_steps_trained_throughput_per_sec": 413.3610303257527, "timesteps_total": 116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 9669.28, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9669.24, "sample_time_ms": 3652.827, "load_time_ms": 0.471, "load_throughput": 8484482.654, "learn_time_ms": 6007.753, "learn_throughput": 665.806, "synch_weights_time_ms": 7.615}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "done": false, "episodes_total": 210, "training_iteration": 29, "trial_id": "4bb30_00000", "date": "2024-04-27_18-31-18", "timestamp": 1714267878, "time_this_iter_s": 9.681727886199951, "time_total_s": 279.92997908592224, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 279.92997908592224, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 25.764285714285712, "ram_util_percent": 64.05}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.125991417259298, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.828625341258838, "policy_loss": -0.0333653726084258, "vf_loss": 1.8559595038213077, "vf_explained_var": 0.19089271246746023, "kl": 0.013402697046687027, "entropy": 6.346537537215858, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 27435.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "sampler_results": {"episode_reward_max": -71.83933218312691, "episode_reward_min": -221.17986006872462, "episode_reward_mean": -110.28085572547329, "episode_len_mean": 493.65, "episode_media": {}, "episodes_this_iter": 5, "episodes_timesteps_total": 49365, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-116.15287061359298, -104.25965632993852, -108.41541547152649, -123.27304140878776, -113.11900863422204, -208.42292559103774, -115.28789020491764, -106.51947552365003, -120.02475186642508, -106.62792120518039, -103.5504115927828, -89.11765456292778, -120.89098993378133, -124.35177706614137, -112.22933584387974, -108.91708791085209, -91.11357980011654, -112.42013489465975, -107.65276561370491, -115.44956072049465, -116.21857580757887, -112.67950386769138, -108.23144093765319, -113.28327438948055, -108.72698965338867, -118.82346322147734, -112.10272236209487, -85.52454850773826, -127.49041439959022, -88.32800977700842, -119.28933776971886, -113.64965252775637, -106.80316798986185, -118.10685060386545, -111.17355582382964, -87.36185812653615, -114.02944791099057, -110.77322782724164, -80.24938785401487, -83.49586523579248, -125.8371156722711, -163.91315362817417, -126.3068465727999, -111.67700693655449, -111.64192951229153, -114.40799519593145, -99.74151464261679, -85.94066479276728, -111.15726156142603, -116.44649765913499, -91.00270397756972, -105.16538352170772, -83.00345738233008, -102.39397021510514, -113.89468966227521, -108.17365870481791, -114.55596742320371, -84.72089160340515, -138.99723845274144, -102.94945768012789, -80.67062085370596, -108.25077240848977, -115.86613781278642, -103.0355264597293, -151.84700326090646, -116.22717414344041, -95.12103612170554, -71.83933218312691, -86.67064132343613, -110.75204453233195, -108.00408695291418, -109.01482975365532, -104.91433270118014, -118.99546710831486, -88.412941530209, -108.72663824119233, -88.96703517702592, -113.23966200823213, -105.52061937466947, -85.36627136432514, -114.51024559673294, -108.94396790004087, -112.40843796739541, -107.52356615774582, -123.9120734313025, -113.49118999093399, -89.43826942713618, -113.37270364682874, -116.04578494502357, -114.64725730017759, -118.70272133657338, -112.6050885285108, -107.74277468968245, -107.00184648572095, -110.35605578113099, -82.92322332870636, -103.87237182156308, -114.62842126470059, -221.17986006872462, -107.27258538813952], "episode_lengths": [69, 64, 66, 1600, 64, 1075, 99, 42, 91, 57, 59, 1600, 87, 87, 63, 35, 1600, 101, 52, 46, 72, 51, 107, 72, 58, 62, 78, 1600, 1600, 1600, 65, 53, 67, 77, 72, 1600, 59, 53, 1600, 1600, 88, 537, 1600, 49, 107, 43, 1600, 1600, 51, 64, 1600, 39, 1600, 68, 64, 67, 71, 1600, 1600, 70, 1600, 82, 64, 72, 1600, 77, 1600, 1600, 1600, 79, 78, 92, 147, 142, 1600, 65, 1600, 64, 75, 1600, 41, 79, 49, 95, 107, 40, 1600, 56, 85, 46, 61, 37, 58, 47, 44, 1600, 51, 93, 1235, 83]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28552455054174986, "mean_inference_ms": 0.9485585796285474, "mean_action_processing_ms": 0.18526294219536943, "mean_env_wait_ms": 0.38567040799136637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0057675838470458984, "StateBufferConnector_ms": 0.0043413639068603516, "ViewRequirementAgentConnector_ms": 0.11341142654418945}}, "episode_reward_max": -71.83933218312691, "episode_reward_min": -221.17986006872462, "episode_reward_mean": -110.28085572547329, "episode_len_mean": 493.65, "episodes_this_iter": 5, "episodes_timesteps_total": 49365, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-116.15287061359298, -104.25965632993852, -108.41541547152649, -123.27304140878776, -113.11900863422204, -208.42292559103774, -115.28789020491764, -106.51947552365003, -120.02475186642508, -106.62792120518039, -103.5504115927828, -89.11765456292778, -120.89098993378133, -124.35177706614137, -112.22933584387974, -108.91708791085209, -91.11357980011654, -112.42013489465975, -107.65276561370491, -115.44956072049465, -116.21857580757887, -112.67950386769138, -108.23144093765319, -113.28327438948055, -108.72698965338867, -118.82346322147734, -112.10272236209487, -85.52454850773826, -127.49041439959022, -88.32800977700842, -119.28933776971886, -113.64965252775637, -106.80316798986185, -118.10685060386545, -111.17355582382964, -87.36185812653615, -114.02944791099057, -110.77322782724164, -80.24938785401487, -83.49586523579248, -125.8371156722711, -163.91315362817417, -126.3068465727999, -111.67700693655449, -111.64192951229153, -114.40799519593145, -99.74151464261679, -85.94066479276728, -111.15726156142603, -116.44649765913499, -91.00270397756972, -105.16538352170772, -83.00345738233008, -102.39397021510514, -113.89468966227521, -108.17365870481791, -114.55596742320371, -84.72089160340515, -138.99723845274144, -102.94945768012789, -80.67062085370596, -108.25077240848977, -115.86613781278642, -103.0355264597293, -151.84700326090646, -116.22717414344041, -95.12103612170554, -71.83933218312691, -86.67064132343613, -110.75204453233195, -108.00408695291418, -109.01482975365532, -104.91433270118014, -118.99546710831486, -88.412941530209, -108.72663824119233, -88.96703517702592, -113.23966200823213, -105.52061937466947, -85.36627136432514, -114.51024559673294, -108.94396790004087, -112.40843796739541, -107.52356615774582, -123.9120734313025, -113.49118999093399, -89.43826942713618, -113.37270364682874, -116.04578494502357, -114.64725730017759, -118.70272133657338, -112.6050885285108, -107.74277468968245, -107.00184648572095, -110.35605578113099, -82.92322332870636, -103.87237182156308, -114.62842126470059, -221.17986006872462, -107.27258538813952], "episode_lengths": [69, 64, 66, 1600, 64, 1075, 99, 42, 91, 57, 59, 1600, 87, 87, 63, 35, 1600, 101, 52, 46, 72, 51, 107, 72, 58, 62, 78, 1600, 1600, 1600, 65, 53, 67, 77, 72, 1600, 59, 53, 1600, 1600, 88, 537, 1600, 49, 107, 43, 1600, 1600, 51, 64, 1600, 39, 1600, 68, 64, 67, 71, 1600, 1600, 70, 1600, 82, 64, 72, 1600, 77, 1600, 1600, 1600, 79, 78, 92, 147, 142, 1600, 65, 1600, 64, 75, 1600, 41, 79, 49, 95, 107, 40, 1600, 56, 85, 46, 61, 37, 58, 47, 44, 1600, 51, 93, 1235, 83]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28552455054174986, "mean_inference_ms": 0.9485585796285474, "mean_action_processing_ms": 0.18526294219536943, "mean_env_wait_ms": 0.38567040799136637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0057675838470458984, "StateBufferConnector_ms": 0.0043413639068603516, "ViewRequirementAgentConnector_ms": 0.11341142654418945}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 411.5127708352976, "num_env_steps_trained_throughput_per_sec": 411.5127708352976, "timesteps_total": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 9675.933, "restore_workers_time_ms": 0.014, "training_step_time_ms": 9675.89, "sample_time_ms": 3644.426, "load_time_ms": 0.484, "load_throughput": 8271973.178, "learn_time_ms": 6022.649, "learn_throughput": 664.16, "synch_weights_time_ms": 7.757}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "episodes_total": 215, "training_iteration": 30, "trial_id": "4bb30_00000", "date": "2024-04-27_18-31-28", "timestamp": 1714267888, "time_this_iter_s": 9.724762201309204, "time_total_s": 289.65474128723145, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 289.65474128723145, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 24.77142857142857, "ram_util_percent": 64.02142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.589506105453736, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1519508101223839, "policy_loss": -0.030673291351926583, "vf_loss": 1.178550809671882, "vf_explained_var": 0.32018970295947086, "kl": 0.00905174771642089, "entropy": 6.100341754318565, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 28365.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "sampler_results": {"episode_reward_max": -71.83933218312691, "episode_reward_min": -221.17986006872462, "episode_reward_mean": -108.70196627365209, "episode_len_mean": 514.82, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 51482, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115.28789020491764, -106.51947552365003, -120.02475186642508, -106.62792120518039, -103.5504115927828, -89.11765456292778, -120.89098993378133, -124.35177706614137, -112.22933584387974, -108.91708791085209, -91.11357980011654, -112.42013489465975, -107.65276561370491, -115.44956072049465, -116.21857580757887, -112.67950386769138, -108.23144093765319, -113.28327438948055, -108.72698965338867, -118.82346322147734, -112.10272236209487, -85.52454850773826, -127.49041439959022, -88.32800977700842, -119.28933776971886, -113.64965252775637, -106.80316798986185, -118.10685060386545, -111.17355582382964, -87.36185812653615, -114.02944791099057, -110.77322782724164, -80.24938785401487, -83.49586523579248, -125.8371156722711, -163.91315362817417, -126.3068465727999, -111.67700693655449, -111.64192951229153, -114.40799519593145, -99.74151464261679, -85.94066479276728, -111.15726156142603, -116.44649765913499, -91.00270397756972, -105.16538352170772, -83.00345738233008, -102.39397021510514, -113.89468966227521, -108.17365870481791, -114.55596742320371, -84.72089160340515, -138.99723845274144, -102.94945768012789, -80.67062085370596, -108.25077240848977, -115.86613781278642, -103.0355264597293, -151.84700326090646, -116.22717414344041, -95.12103612170554, -71.83933218312691, -86.67064132343613, -110.75204453233195, -108.00408695291418, -109.01482975365532, -104.91433270118014, -118.99546710831486, -88.412941530209, -108.72663824119233, -88.96703517702592, -113.23966200823213, -105.52061937466947, -85.36627136432514, -114.51024559673294, -108.94396790004087, -112.40843796739541, -107.52356615774582, -123.9120734313025, -113.49118999093399, -89.43826942713618, -113.37270364682874, -116.04578494502357, -114.64725730017759, -118.70272133657338, -112.6050885285108, -107.74277468968245, -107.00184648572095, -110.35605578113099, -82.92322332870636, -103.87237182156308, -114.62842126470059, -221.17986006872462, -107.27258538813952, -91.62360250619118, -84.68372345621452, -124.2412146015844, -118.71168243686854, -108.04384324036353, -88.44990662576315], "episode_lengths": [99, 42, 91, 57, 59, 1600, 87, 87, 63, 35, 1600, 101, 52, 46, 72, 51, 107, 72, 58, 62, 78, 1600, 1600, 1600, 65, 53, 67, 77, 72, 1600, 59, 53, 1600, 1600, 88, 537, 1600, 49, 107, 43, 1600, 1600, 51, 64, 1600, 39, 1600, 68, 64, 67, 71, 1600, 1600, 70, 1600, 82, 64, 72, 1600, 77, 1600, 1600, 1600, 79, 78, 92, 147, 142, 1600, 65, 1600, 64, 75, 1600, 41, 79, 49, 95, 107, 40, 1600, 56, 85, 46, 61, 37, 58, 47, 44, 1600, 51, 93, 1235, 83, 1600, 1600, 95, 86, 74, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28552981592307686, "mean_inference_ms": 0.9488682881049638, "mean_action_processing_ms": 0.18524627948760994, "mean_env_wait_ms": 0.385595081870795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0057735443115234375, "StateBufferConnector_ms": 0.0043487548828125, "ViewRequirementAgentConnector_ms": 0.11389517784118652}}, "episode_reward_max": -71.83933218312691, "episode_reward_min": -221.17986006872462, "episode_reward_mean": -108.70196627365209, "episode_len_mean": 514.82, "episodes_this_iter": 6, "episodes_timesteps_total": 51482, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-115.28789020491764, -106.51947552365003, -120.02475186642508, -106.62792120518039, -103.5504115927828, -89.11765456292778, -120.89098993378133, -124.35177706614137, -112.22933584387974, -108.91708791085209, -91.11357980011654, -112.42013489465975, -107.65276561370491, -115.44956072049465, -116.21857580757887, -112.67950386769138, -108.23144093765319, -113.28327438948055, -108.72698965338867, -118.82346322147734, -112.10272236209487, -85.52454850773826, -127.49041439959022, -88.32800977700842, -119.28933776971886, -113.64965252775637, -106.80316798986185, -118.10685060386545, -111.17355582382964, -87.36185812653615, -114.02944791099057, -110.77322782724164, -80.24938785401487, -83.49586523579248, -125.8371156722711, -163.91315362817417, -126.3068465727999, -111.67700693655449, -111.64192951229153, -114.40799519593145, -99.74151464261679, -85.94066479276728, -111.15726156142603, -116.44649765913499, -91.00270397756972, -105.16538352170772, -83.00345738233008, -102.39397021510514, -113.89468966227521, -108.17365870481791, -114.55596742320371, -84.72089160340515, -138.99723845274144, -102.94945768012789, -80.67062085370596, -108.25077240848977, -115.86613781278642, -103.0355264597293, -151.84700326090646, -116.22717414344041, -95.12103612170554, -71.83933218312691, -86.67064132343613, -110.75204453233195, -108.00408695291418, -109.01482975365532, -104.91433270118014, -118.99546710831486, -88.412941530209, -108.72663824119233, -88.96703517702592, -113.23966200823213, -105.52061937466947, -85.36627136432514, -114.51024559673294, -108.94396790004087, -112.40843796739541, -107.52356615774582, -123.9120734313025, -113.49118999093399, -89.43826942713618, -113.37270364682874, -116.04578494502357, -114.64725730017759, -118.70272133657338, -112.6050885285108, -107.74277468968245, -107.00184648572095, -110.35605578113099, -82.92322332870636, -103.87237182156308, -114.62842126470059, -221.17986006872462, -107.27258538813952, -91.62360250619118, -84.68372345621452, -124.2412146015844, -118.71168243686854, -108.04384324036353, -88.44990662576315], "episode_lengths": [99, 42, 91, 57, 59, 1600, 87, 87, 63, 35, 1600, 101, 52, 46, 72, 51, 107, 72, 58, 62, 78, 1600, 1600, 1600, 65, 53, 67, 77, 72, 1600, 59, 53, 1600, 1600, 88, 537, 1600, 49, 107, 43, 1600, 1600, 51, 64, 1600, 39, 1600, 68, 64, 67, 71, 1600, 1600, 70, 1600, 82, 64, 72, 1600, 77, 1600, 1600, 1600, 79, 78, 92, 147, 142, 1600, 65, 1600, 64, 75, 1600, 41, 79, 49, 95, 107, 40, 1600, 56, 85, 46, 61, 37, 58, 47, 44, 1600, 51, 93, 1235, 83, 1600, 1600, 95, 86, 74, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28552981592307686, "mean_inference_ms": 0.9488682881049638, "mean_action_processing_ms": 0.18524627948760994, "mean_env_wait_ms": 0.385595081870795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0057735443115234375, "StateBufferConnector_ms": 0.0043487548828125, "ViewRequirementAgentConnector_ms": 0.11389517784118652}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 411.32297732317386, "num_env_steps_trained_throughput_per_sec": 411.32297732317386, "timesteps_total": 124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 9681.419, "restore_workers_time_ms": 0.014, "training_step_time_ms": 9681.376, "sample_time_ms": 3646.311, "load_time_ms": 0.488, "load_throughput": 8198004.398, "learn_time_ms": 6026.111, "learn_throughput": 663.778, "synch_weights_time_ms": 7.888}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "done": false, "episodes_total": 221, "training_iteration": 31, "trial_id": "4bb30_00000", "date": "2024-04-27_18-31-38", "timestamp": 1714267898, "time_this_iter_s": 9.729172229766846, "time_total_s": 299.3839135169983, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 299.3839135169983, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 25.02857142857143, "ram_util_percent": 63.99285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.03552022313559, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4958193094442067, "policy_loss": -0.037187116344769795, "vf_loss": 2.5246779131452723, "vf_explained_var": 0.24849150411544307, "kl": 0.01850787380618164, "entropy": 7.208350616885769, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "sampler_results": {"episode_reward_max": -71.83933218312691, "episode_reward_min": -221.17986006872462, "episode_reward_mean": -108.59643039888782, "episode_len_mean": 515.05, "episode_media": {}, "episodes_this_iter": 14, "episodes_timesteps_total": 51505, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-116.21857580757887, -112.67950386769138, -108.23144093765319, -113.28327438948055, -108.72698965338867, -118.82346322147734, -112.10272236209487, -85.52454850773826, -127.49041439959022, -88.32800977700842, -119.28933776971886, -113.64965252775637, -106.80316798986185, -118.10685060386545, -111.17355582382964, -87.36185812653615, -114.02944791099057, -110.77322782724164, -80.24938785401487, -83.49586523579248, -125.8371156722711, -163.91315362817417, -126.3068465727999, -111.67700693655449, -111.64192951229153, -114.40799519593145, -99.74151464261679, -85.94066479276728, -111.15726156142603, -116.44649765913499, -91.00270397756972, -105.16538352170772, -83.00345738233008, -102.39397021510514, -113.89468966227521, -108.17365870481791, -114.55596742320371, -84.72089160340515, -138.99723845274144, -102.94945768012789, -80.67062085370596, -108.25077240848977, -115.86613781278642, -103.0355264597293, -151.84700326090646, -116.22717414344041, -95.12103612170554, -71.83933218312691, -86.67064132343613, -110.75204453233195, -108.00408695291418, -109.01482975365532, -104.91433270118014, -118.99546710831486, -88.412941530209, -108.72663824119233, -88.96703517702592, -113.23966200823213, -105.52061937466947, -85.36627136432514, -114.51024559673294, -108.94396790004087, -112.40843796739541, -107.52356615774582, -123.9120734313025, -113.49118999093399, -89.43826942713618, -113.37270364682874, -116.04578494502357, -114.64725730017759, -118.70272133657338, -112.6050885285108, -107.74277468968245, -107.00184648572095, -110.35605578113099, -82.92322332870636, -103.87237182156308, -114.62842126470059, -221.17986006872462, -107.27258538813952, -91.62360250619118, -84.68372345621452, -124.2412146015844, -118.71168243686854, -108.04384324036353, -88.44990662576315, -86.01741862560363, -126.61621976038006, -108.24786509753702, -109.22560871831826, -110.12264486177142, -114.08329024804073, -110.07239939920728, -85.26246211376436, -125.5911982152164, -104.375435936821, -104.32731182627815, -106.71088721375789, -105.49425215971408, -127.45275508667528], "episode_lengths": [72, 51, 107, 72, 58, 62, 78, 1600, 1600, 1600, 65, 53, 67, 77, 72, 1600, 59, 53, 1600, 1600, 88, 537, 1600, 49, 107, 43, 1600, 1600, 51, 64, 1600, 39, 1600, 68, 64, 67, 71, 1600, 1600, 70, 1600, 82, 64, 72, 1600, 77, 1600, 1600, 1600, 79, 78, 92, 147, 142, 1600, 65, 1600, 64, 75, 1600, 41, 79, 49, 95, 107, 40, 1600, 56, 85, 46, 61, 37, 58, 47, 44, 1600, 51, 93, 1235, 83, 1600, 1600, 95, 86, 74, 1600, 1600, 73, 62, 78, 53, 60, 64, 1600, 119, 74, 38, 87, 51, 83]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2855688059121655, "mean_inference_ms": 0.9490519354992191, "mean_action_processing_ms": 0.1852384343730891, "mean_env_wait_ms": 0.38559762582443924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0058650970458984375, "StateBufferConnector_ms": 0.004313468933105469, "ViewRequirementAgentConnector_ms": 0.11425137519836426}}, "episode_reward_max": -71.83933218312691, "episode_reward_min": -221.17986006872462, "episode_reward_mean": -108.59643039888782, "episode_len_mean": 515.05, "episodes_this_iter": 14, "episodes_timesteps_total": 51505, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-116.21857580757887, -112.67950386769138, -108.23144093765319, -113.28327438948055, -108.72698965338867, -118.82346322147734, -112.10272236209487, -85.52454850773826, -127.49041439959022, -88.32800977700842, -119.28933776971886, -113.64965252775637, -106.80316798986185, -118.10685060386545, -111.17355582382964, -87.36185812653615, -114.02944791099057, -110.77322782724164, -80.24938785401487, -83.49586523579248, -125.8371156722711, -163.91315362817417, -126.3068465727999, -111.67700693655449, -111.64192951229153, -114.40799519593145, -99.74151464261679, -85.94066479276728, -111.15726156142603, -116.44649765913499, -91.00270397756972, -105.16538352170772, -83.00345738233008, -102.39397021510514, -113.89468966227521, -108.17365870481791, -114.55596742320371, -84.72089160340515, -138.99723845274144, -102.94945768012789, -80.67062085370596, -108.25077240848977, -115.86613781278642, -103.0355264597293, -151.84700326090646, -116.22717414344041, -95.12103612170554, -71.83933218312691, -86.67064132343613, -110.75204453233195, -108.00408695291418, -109.01482975365532, -104.91433270118014, -118.99546710831486, -88.412941530209, -108.72663824119233, -88.96703517702592, -113.23966200823213, -105.52061937466947, -85.36627136432514, -114.51024559673294, -108.94396790004087, -112.40843796739541, -107.52356615774582, -123.9120734313025, -113.49118999093399, -89.43826942713618, -113.37270364682874, -116.04578494502357, -114.64725730017759, -118.70272133657338, -112.6050885285108, -107.74277468968245, -107.00184648572095, -110.35605578113099, -82.92322332870636, -103.87237182156308, -114.62842126470059, -221.17986006872462, -107.27258538813952, -91.62360250619118, -84.68372345621452, -124.2412146015844, -118.71168243686854, -108.04384324036353, -88.44990662576315, -86.01741862560363, -126.61621976038006, -108.24786509753702, -109.22560871831826, -110.12264486177142, -114.08329024804073, -110.07239939920728, -85.26246211376436, -125.5911982152164, -104.375435936821, -104.32731182627815, -106.71088721375789, -105.49425215971408, -127.45275508667528], "episode_lengths": [72, 51, 107, 72, 58, 62, 78, 1600, 1600, 1600, 65, 53, 67, 77, 72, 1600, 59, 53, 1600, 1600, 88, 537, 1600, 49, 107, 43, 1600, 1600, 51, 64, 1600, 39, 1600, 68, 64, 67, 71, 1600, 1600, 70, 1600, 82, 64, 72, 1600, 77, 1600, 1600, 1600, 79, 78, 92, 147, 142, 1600, 65, 1600, 64, 75, 1600, 41, 79, 49, 95, 107, 40, 1600, 56, 85, 46, 61, 37, 58, 47, 44, 1600, 51, 93, 1235, 83, 1600, 1600, 95, 86, 74, 1600, 1600, 73, 62, 78, 53, 60, 64, 1600, 119, 74, 38, 87, 51, 83]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2855688059121655, "mean_inference_ms": 0.9490519354992191, "mean_action_processing_ms": 0.1852384343730891, "mean_env_wait_ms": 0.38559762582443924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0058650970458984375, "StateBufferConnector_ms": 0.004313468933105469, "ViewRequirementAgentConnector_ms": 0.11425137519836426}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 405.71416756574996, "num_env_steps_trained_throughput_per_sec": 405.71416756574996, "timesteps_total": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 9702.014, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9701.972, "sample_time_ms": 3646.552, "load_time_ms": 0.484, "load_throughput": 8265452.754, "learn_time_ms": 6046.38, "learn_throughput": 661.553, "synch_weights_time_ms": 7.983}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "episodes_total": 235, "training_iteration": 32, "trial_id": "4bb30_00000", "date": "2024-04-27_18-31-48", "timestamp": 1714267908, "time_this_iter_s": 9.864017963409424, "time_total_s": 309.2479314804077, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 309.2479314804077, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 24.757142857142856, "ram_util_percent": 63.942857142857136}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.540909445862617, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7732154608113311, "policy_loss": -0.02615384181500763, "vf_loss": 0.7964460897910338, "vf_explained_var": 0.3785255385342465, "kl": 0.006496043878872553, "entropy": 6.065799527527184, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 30225.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "sampler_results": {"episode_reward_max": -71.83933218312691, "episode_reward_min": -221.17986006872462, "episode_reward_mean": -108.00420060865464, "episode_len_mean": 545.18, "episode_media": {}, "episodes_this_iter": 4, "episodes_timesteps_total": 54518, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-108.72698965338867, -118.82346322147734, -112.10272236209487, -85.52454850773826, -127.49041439959022, -88.32800977700842, -119.28933776971886, -113.64965252775637, -106.80316798986185, -118.10685060386545, -111.17355582382964, -87.36185812653615, -114.02944791099057, -110.77322782724164, -80.24938785401487, -83.49586523579248, -125.8371156722711, -163.91315362817417, -126.3068465727999, -111.67700693655449, -111.64192951229153, -114.40799519593145, -99.74151464261679, -85.94066479276728, -111.15726156142603, -116.44649765913499, -91.00270397756972, -105.16538352170772, -83.00345738233008, -102.39397021510514, -113.89468966227521, -108.17365870481791, -114.55596742320371, -84.72089160340515, -138.99723845274144, -102.94945768012789, -80.67062085370596, -108.25077240848977, -115.86613781278642, -103.0355264597293, -151.84700326090646, -116.22717414344041, -95.12103612170554, -71.83933218312691, -86.67064132343613, -110.75204453233195, -108.00408695291418, -109.01482975365532, -104.91433270118014, -118.99546710831486, -88.412941530209, -108.72663824119233, -88.96703517702592, -113.23966200823213, -105.52061937466947, -85.36627136432514, -114.51024559673294, -108.94396790004087, -112.40843796739541, -107.52356615774582, -123.9120734313025, -113.49118999093399, -89.43826942713618, -113.37270364682874, -116.04578494502357, -114.64725730017759, -118.70272133657338, -112.6050885285108, -107.74277468968245, -107.00184648572095, -110.35605578113099, -82.92322332870636, -103.87237182156308, -114.62842126470059, -221.17986006872462, -107.27258538813952, -91.62360250619118, -84.68372345621452, -124.2412146015844, -118.71168243686854, -108.04384324036353, -88.44990662576315, -86.01741862560363, -126.61621976038006, -108.24786509753702, -109.22560871831826, -110.12264486177142, -114.08329024804073, -110.07239939920728, -85.26246211376436, -125.5911982152164, -104.375435936821, -104.32731182627815, -106.71088721375789, -105.49425215971408, -127.45275508667528, -87.33622528719219, -116.89823679154925, -79.14790576381417, -107.80744813653455], "episode_lengths": [58, 62, 78, 1600, 1600, 1600, 65, 53, 67, 77, 72, 1600, 59, 53, 1600, 1600, 88, 537, 1600, 49, 107, 43, 1600, 1600, 51, 64, 1600, 39, 1600, 68, 64, 67, 71, 1600, 1600, 70, 1600, 82, 64, 72, 1600, 77, 1600, 1600, 1600, 79, 78, 92, 147, 142, 1600, 65, 1600, 64, 75, 1600, 41, 79, 49, 95, 107, 40, 1600, 56, 85, 46, 61, 37, 58, 47, 44, 1600, 51, 93, 1235, 83, 1600, 1600, 95, 86, 74, 1600, 1600, 73, 62, 78, 53, 60, 64, 1600, 119, 74, 38, 87, 51, 83, 1600, 67, 1600, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2855202740427965, "mean_inference_ms": 0.9491858335097954, "mean_action_processing_ms": 0.18522193591453942, "mean_env_wait_ms": 0.3855574746755724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005868673324584961, "StateBufferConnector_ms": 0.004305839538574219, "ViewRequirementAgentConnector_ms": 0.11436676979064941}}, "episode_reward_max": -71.83933218312691, "episode_reward_min": -221.17986006872462, "episode_reward_mean": -108.00420060865464, "episode_len_mean": 545.18, "episodes_this_iter": 4, "episodes_timesteps_total": 54518, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-108.72698965338867, -118.82346322147734, -112.10272236209487, -85.52454850773826, -127.49041439959022, -88.32800977700842, -119.28933776971886, -113.64965252775637, -106.80316798986185, -118.10685060386545, -111.17355582382964, -87.36185812653615, -114.02944791099057, -110.77322782724164, -80.24938785401487, -83.49586523579248, -125.8371156722711, -163.91315362817417, -126.3068465727999, -111.67700693655449, -111.64192951229153, -114.40799519593145, -99.74151464261679, -85.94066479276728, -111.15726156142603, -116.44649765913499, -91.00270397756972, -105.16538352170772, -83.00345738233008, -102.39397021510514, -113.89468966227521, -108.17365870481791, -114.55596742320371, -84.72089160340515, -138.99723845274144, -102.94945768012789, -80.67062085370596, -108.25077240848977, -115.86613781278642, -103.0355264597293, -151.84700326090646, -116.22717414344041, -95.12103612170554, -71.83933218312691, -86.67064132343613, -110.75204453233195, -108.00408695291418, -109.01482975365532, -104.91433270118014, -118.99546710831486, -88.412941530209, -108.72663824119233, -88.96703517702592, -113.23966200823213, -105.52061937466947, -85.36627136432514, -114.51024559673294, -108.94396790004087, -112.40843796739541, -107.52356615774582, -123.9120734313025, -113.49118999093399, -89.43826942713618, -113.37270364682874, -116.04578494502357, -114.64725730017759, -118.70272133657338, -112.6050885285108, -107.74277468968245, -107.00184648572095, -110.35605578113099, -82.92322332870636, -103.87237182156308, -114.62842126470059, -221.17986006872462, -107.27258538813952, -91.62360250619118, -84.68372345621452, -124.2412146015844, -118.71168243686854, -108.04384324036353, -88.44990662576315, -86.01741862560363, -126.61621976038006, -108.24786509753702, -109.22560871831826, -110.12264486177142, -114.08329024804073, -110.07239939920728, -85.26246211376436, -125.5911982152164, -104.375435936821, -104.32731182627815, -106.71088721375789, -105.49425215971408, -127.45275508667528, -87.33622528719219, -116.89823679154925, -79.14790576381417, -107.80744813653455], "episode_lengths": [58, 62, 78, 1600, 1600, 1600, 65, 53, 67, 77, 72, 1600, 59, 53, 1600, 1600, 88, 537, 1600, 49, 107, 43, 1600, 1600, 51, 64, 1600, 39, 1600, 68, 64, 67, 71, 1600, 1600, 70, 1600, 82, 64, 72, 1600, 77, 1600, 1600, 1600, 79, 78, 92, 147, 142, 1600, 65, 1600, 64, 75, 1600, 41, 79, 49, 95, 107, 40, 1600, 56, 85, 46, 61, 37, 58, 47, 44, 1600, 51, 93, 1235, 83, 1600, 1600, 95, 86, 74, 1600, 1600, 73, 62, 78, 53, 60, 64, 1600, 119, 74, 38, 87, 51, 83, 1600, 67, 1600, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2855202740427965, "mean_inference_ms": 0.9491858335097954, "mean_action_processing_ms": 0.18522193591453942, "mean_env_wait_ms": 0.3855574746755724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005868673324584961, "StateBufferConnector_ms": 0.004305839538574219, "ViewRequirementAgentConnector_ms": 0.11436676979064941}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 416.0982642946155, "num_env_steps_trained_throughput_per_sec": 416.0982642946155, "timesteps_total": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 9694.304, "restore_workers_time_ms": 0.014, "training_step_time_ms": 9694.261, "sample_time_ms": 3642.449, "load_time_ms": 0.48, "load_throughput": 8339405.508, "learn_time_ms": 6042.935, "learn_throughput": 661.93, "synch_weights_time_ms": 7.846}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "episodes_total": 239, "training_iteration": 33, "trial_id": "4bb30_00000", "date": "2024-04-27_18-31-57", "timestamp": 1714267917, "time_this_iter_s": 9.617523908615112, "time_total_s": 318.8654553890228, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 318.8654553890228, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 24.861538461538462, "ram_util_percent": 63.93076923076922}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.326560915926452, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2590506569705202, "policy_loss": -0.0237808679901464, "vf_loss": 1.2776938004198894, "vf_explained_var": 0.49756833212350005, "kl": 0.011417171250189874, "entropy": 7.566421954349805, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 31155.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "sampler_results": {"episode_reward_max": -71.83933218312691, "episode_reward_min": -221.17986006872462, "episode_reward_mean": -107.61468863298813, "episode_len_mean": 591.2, "episode_media": {}, "episodes_this_iter": 3, "episodes_timesteps_total": 59120, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-85.52454850773826, -127.49041439959022, -88.32800977700842, -119.28933776971886, -113.64965252775637, -106.80316798986185, -118.10685060386545, -111.17355582382964, -87.36185812653615, -114.02944791099057, -110.77322782724164, -80.24938785401487, -83.49586523579248, -125.8371156722711, -163.91315362817417, -126.3068465727999, -111.67700693655449, -111.64192951229153, -114.40799519593145, -99.74151464261679, -85.94066479276728, -111.15726156142603, -116.44649765913499, -91.00270397756972, -105.16538352170772, -83.00345738233008, -102.39397021510514, -113.89468966227521, -108.17365870481791, -114.55596742320371, -84.72089160340515, -138.99723845274144, -102.94945768012789, -80.67062085370596, -108.25077240848977, -115.86613781278642, -103.0355264597293, -151.84700326090646, -116.22717414344041, -95.12103612170554, -71.83933218312691, -86.67064132343613, -110.75204453233195, -108.00408695291418, -109.01482975365532, -104.91433270118014, -118.99546710831486, -88.412941530209, -108.72663824119233, -88.96703517702592, -113.23966200823213, -105.52061937466947, -85.36627136432514, -114.51024559673294, -108.94396790004087, -112.40843796739541, -107.52356615774582, -123.9120734313025, -113.49118999093399, -89.43826942713618, -113.37270364682874, -116.04578494502357, -114.64725730017759, -118.70272133657338, -112.6050885285108, -107.74277468968245, -107.00184648572095, -110.35605578113099, -82.92322332870636, -103.87237182156308, -114.62842126470059, -221.17986006872462, -107.27258538813952, -91.62360250619118, -84.68372345621452, -124.2412146015844, -118.71168243686854, -108.04384324036353, -88.44990662576315, -86.01741862560363, -126.61621976038006, -108.24786509753702, -109.22560871831826, -110.12264486177142, -114.08329024804073, -110.07239939920728, -85.26246211376436, -125.5911982152164, -104.375435936821, -104.32731182627815, -106.71088721375789, -105.49425215971408, -127.45275508667528, -87.33622528719219, -116.89823679154925, -79.14790576381417, -107.80744813653455, -88.56477287852039, -94.09449837234887, -118.04270641943467], "episode_lengths": [1600, 1600, 1600, 65, 53, 67, 77, 72, 1600, 59, 53, 1600, 1600, 88, 537, 1600, 49, 107, 43, 1600, 1600, 51, 64, 1600, 39, 1600, 68, 64, 67, 71, 1600, 1600, 70, 1600, 82, 64, 72, 1600, 77, 1600, 1600, 1600, 79, 78, 92, 147, 142, 1600, 65, 1600, 64, 75, 1600, 41, 79, 49, 95, 107, 40, 1600, 56, 85, 46, 61, 37, 58, 47, 44, 1600, 51, 93, 1235, 83, 1600, 1600, 95, 86, 74, 1600, 1600, 73, 62, 78, 53, 60, 64, 1600, 119, 74, 38, 87, 51, 83, 1600, 67, 1600, 48, 1600, 1600, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2854911838262807, "mean_inference_ms": 0.9492568307452355, "mean_action_processing_ms": 0.18521586747818028, "mean_env_wait_ms": 0.3855495158727515, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005871772766113281, "StateBufferConnector_ms": 0.004296779632568359, "ViewRequirementAgentConnector_ms": 0.11434721946716309}}, "episode_reward_max": -71.83933218312691, "episode_reward_min": -221.17986006872462, "episode_reward_mean": -107.61468863298813, "episode_len_mean": 591.2, "episodes_this_iter": 3, "episodes_timesteps_total": 59120, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-85.52454850773826, -127.49041439959022, -88.32800977700842, -119.28933776971886, -113.64965252775637, -106.80316798986185, -118.10685060386545, -111.17355582382964, -87.36185812653615, -114.02944791099057, -110.77322782724164, -80.24938785401487, -83.49586523579248, -125.8371156722711, -163.91315362817417, -126.3068465727999, -111.67700693655449, -111.64192951229153, -114.40799519593145, -99.74151464261679, -85.94066479276728, -111.15726156142603, -116.44649765913499, -91.00270397756972, -105.16538352170772, -83.00345738233008, -102.39397021510514, -113.89468966227521, -108.17365870481791, -114.55596742320371, -84.72089160340515, -138.99723845274144, -102.94945768012789, -80.67062085370596, -108.25077240848977, -115.86613781278642, -103.0355264597293, -151.84700326090646, -116.22717414344041, -95.12103612170554, -71.83933218312691, -86.67064132343613, -110.75204453233195, -108.00408695291418, -109.01482975365532, -104.91433270118014, -118.99546710831486, -88.412941530209, -108.72663824119233, -88.96703517702592, -113.23966200823213, -105.52061937466947, -85.36627136432514, -114.51024559673294, -108.94396790004087, -112.40843796739541, -107.52356615774582, -123.9120734313025, -113.49118999093399, -89.43826942713618, -113.37270364682874, -116.04578494502357, -114.64725730017759, -118.70272133657338, -112.6050885285108, -107.74277468968245, -107.00184648572095, -110.35605578113099, -82.92322332870636, -103.87237182156308, -114.62842126470059, -221.17986006872462, -107.27258538813952, -91.62360250619118, -84.68372345621452, -124.2412146015844, -118.71168243686854, -108.04384324036353, -88.44990662576315, -86.01741862560363, -126.61621976038006, -108.24786509753702, -109.22560871831826, -110.12264486177142, -114.08329024804073, -110.07239939920728, -85.26246211376436, -125.5911982152164, -104.375435936821, -104.32731182627815, -106.71088721375789, -105.49425215971408, -127.45275508667528, -87.33622528719219, -116.89823679154925, -79.14790576381417, -107.80744813653455, -88.56477287852039, -94.09449837234887, -118.04270641943467], "episode_lengths": [1600, 1600, 1600, 65, 53, 67, 77, 72, 1600, 59, 53, 1600, 1600, 88, 537, 1600, 49, 107, 43, 1600, 1600, 51, 64, 1600, 39, 1600, 68, 64, 67, 71, 1600, 1600, 70, 1600, 82, 64, 72, 1600, 77, 1600, 1600, 1600, 79, 78, 92, 147, 142, 1600, 65, 1600, 64, 75, 1600, 41, 79, 49, 95, 107, 40, 1600, 56, 85, 46, 61, 37, 58, 47, 44, 1600, 51, 93, 1235, 83, 1600, 1600, 95, 86, 74, 1600, 1600, 73, 62, 78, 53, 60, 64, 1600, 119, 74, 38, 87, 51, 83, 1600, 67, 1600, 48, 1600, 1600, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2854911838262807, "mean_inference_ms": 0.9492568307452355, "mean_action_processing_ms": 0.18521586747818028, "mean_env_wait_ms": 0.3855495158727515, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005871772766113281, "StateBufferConnector_ms": 0.004296779632568359, "ViewRequirementAgentConnector_ms": 0.11434721946716309}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 382.6498566250407, "num_env_steps_trained_throughput_per_sec": 382.6498566250407, "timesteps_total": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 9782.898, "restore_workers_time_ms": 0.014, "training_step_time_ms": 9782.855, "sample_time_ms": 3647.881, "load_time_ms": 0.465, "load_throughput": 8593564.514, "learn_time_ms": 6125.942, "learn_throughput": 652.961, "synch_weights_time_ms": 8.006}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "episodes_total": 242, "training_iteration": 34, "trial_id": "4bb30_00000", "date": "2024-04-27_18-32-08", "timestamp": 1714267928, "time_this_iter_s": 10.458270788192749, "time_total_s": 329.3237261772156, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 329.3237261772156, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 33.19333333333334, "ram_util_percent": 63.973333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.866414208309624, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4462430084367053, "policy_loss": -0.031028846290803724, "vf_loss": 1.4727128804370921, "vf_explained_var": 0.36640563876398147, "kl": 0.010131061493513968, "entropy": 7.2640107693210725, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 32085.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "sampler_results": {"episode_reward_max": -70.58573169769718, "episode_reward_min": -221.17986006872462, "episode_reward_mean": -107.94150540986946, "episode_len_mean": 577.11, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 57711, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-111.17355582382964, -87.36185812653615, -114.02944791099057, -110.77322782724164, -80.24938785401487, -83.49586523579248, -125.8371156722711, -163.91315362817417, -126.3068465727999, -111.67700693655449, -111.64192951229153, -114.40799519593145, -99.74151464261679, -85.94066479276728, -111.15726156142603, -116.44649765913499, -91.00270397756972, -105.16538352170772, -83.00345738233008, -102.39397021510514, -113.89468966227521, -108.17365870481791, -114.55596742320371, -84.72089160340515, -138.99723845274144, -102.94945768012789, -80.67062085370596, -108.25077240848977, -115.86613781278642, -103.0355264597293, -151.84700326090646, -116.22717414344041, -95.12103612170554, -71.83933218312691, -86.67064132343613, -110.75204453233195, -108.00408695291418, -109.01482975365532, -104.91433270118014, -118.99546710831486, -88.412941530209, -108.72663824119233, -88.96703517702592, -113.23966200823213, -105.52061937466947, -85.36627136432514, -114.51024559673294, -108.94396790004087, -112.40843796739541, -107.52356615774582, -123.9120734313025, -113.49118999093399, -89.43826942713618, -113.37270364682874, -116.04578494502357, -114.64725730017759, -118.70272133657338, -112.6050885285108, -107.74277468968245, -107.00184648572095, -110.35605578113099, -82.92322332870636, -103.87237182156308, -114.62842126470059, -221.17986006872462, -107.27258538813952, -91.62360250619118, -84.68372345621452, -124.2412146015844, -118.71168243686854, -108.04384324036353, -88.44990662576315, -86.01741862560363, -126.61621976038006, -108.24786509753702, -109.22560871831826, -110.12264486177142, -114.08329024804073, -110.07239939920728, -85.26246211376436, -125.5911982152164, -104.375435936821, -104.32731182627815, -106.71088721375789, -105.49425215971408, -127.45275508667528, -87.33622528719219, -116.89823679154925, -79.14790576381417, -107.80744813653455, -88.56477287852039, -94.09449837234887, -118.04270641943467, -70.58573169769718, -120.49794333342649, -106.16135135763388, -109.66154224681607, -115.85989168764651, -134.02767749115884, -135.07952144929695], "episode_lengths": [72, 1600, 59, 53, 1600, 1600, 88, 537, 1600, 49, 107, 43, 1600, 1600, 51, 64, 1600, 39, 1600, 68, 64, 67, 71, 1600, 1600, 70, 1600, 82, 64, 72, 1600, 77, 1600, 1600, 1600, 79, 78, 92, 147, 142, 1600, 65, 1600, 64, 75, 1600, 41, 79, 49, 95, 107, 40, 1600, 56, 85, 46, 61, 37, 58, 47, 44, 1600, 51, 93, 1235, 83, 1600, 1600, 95, 86, 74, 1600, 1600, 73, 62, 78, 53, 60, 64, 1600, 119, 74, 38, 87, 51, 83, 1600, 67, 1600, 48, 1600, 1600, 1600, 1600, 68, 66, 64, 63, 192, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2856346442390286, "mean_inference_ms": 0.9488970316271241, "mean_action_processing_ms": 0.18527339886944355, "mean_env_wait_ms": 0.38575786475321405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005849361419677734, "StateBufferConnector_ms": 0.004312038421630859, "ViewRequirementAgentConnector_ms": 0.11414909362792969}}, "episode_reward_max": -70.58573169769718, "episode_reward_min": -221.17986006872462, "episode_reward_mean": -107.94150540986946, "episode_len_mean": 577.11, "episodes_this_iter": 7, "episodes_timesteps_total": 57711, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-111.17355582382964, -87.36185812653615, -114.02944791099057, -110.77322782724164, -80.24938785401487, -83.49586523579248, -125.8371156722711, -163.91315362817417, -126.3068465727999, -111.67700693655449, -111.64192951229153, -114.40799519593145, -99.74151464261679, -85.94066479276728, -111.15726156142603, -116.44649765913499, -91.00270397756972, -105.16538352170772, -83.00345738233008, -102.39397021510514, -113.89468966227521, -108.17365870481791, -114.55596742320371, -84.72089160340515, -138.99723845274144, -102.94945768012789, -80.67062085370596, -108.25077240848977, -115.86613781278642, -103.0355264597293, -151.84700326090646, -116.22717414344041, -95.12103612170554, -71.83933218312691, -86.67064132343613, -110.75204453233195, -108.00408695291418, -109.01482975365532, -104.91433270118014, -118.99546710831486, -88.412941530209, -108.72663824119233, -88.96703517702592, -113.23966200823213, -105.52061937466947, -85.36627136432514, -114.51024559673294, -108.94396790004087, -112.40843796739541, -107.52356615774582, -123.9120734313025, -113.49118999093399, -89.43826942713618, -113.37270364682874, -116.04578494502357, -114.64725730017759, -118.70272133657338, -112.6050885285108, -107.74277468968245, -107.00184648572095, -110.35605578113099, -82.92322332870636, -103.87237182156308, -114.62842126470059, -221.17986006872462, -107.27258538813952, -91.62360250619118, -84.68372345621452, -124.2412146015844, -118.71168243686854, -108.04384324036353, -88.44990662576315, -86.01741862560363, -126.61621976038006, -108.24786509753702, -109.22560871831826, -110.12264486177142, -114.08329024804073, -110.07239939920728, -85.26246211376436, -125.5911982152164, -104.375435936821, -104.32731182627815, -106.71088721375789, -105.49425215971408, -127.45275508667528, -87.33622528719219, -116.89823679154925, -79.14790576381417, -107.80744813653455, -88.56477287852039, -94.09449837234887, -118.04270641943467, -70.58573169769718, -120.49794333342649, -106.16135135763388, -109.66154224681607, -115.85989168764651, -134.02767749115884, -135.07952144929695], "episode_lengths": [72, 1600, 59, 53, 1600, 1600, 88, 537, 1600, 49, 107, 43, 1600, 1600, 51, 64, 1600, 39, 1600, 68, 64, 67, 71, 1600, 1600, 70, 1600, 82, 64, 72, 1600, 77, 1600, 1600, 1600, 79, 78, 92, 147, 142, 1600, 65, 1600, 64, 75, 1600, 41, 79, 49, 95, 107, 40, 1600, 56, 85, 46, 61, 37, 58, 47, 44, 1600, 51, 93, 1235, 83, 1600, 1600, 95, 86, 74, 1600, 1600, 73, 62, 78, 53, 60, 64, 1600, 119, 74, 38, 87, 51, 83, 1600, 67, 1600, 48, 1600, 1600, 1600, 1600, 68, 66, 64, 63, 192, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2856346442390286, "mean_inference_ms": 0.9488970316271241, "mean_action_processing_ms": 0.18527339886944355, "mean_env_wait_ms": 0.38575786475321405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005849361419677734, "StateBufferConnector_ms": 0.004312038421630859, "ViewRequirementAgentConnector_ms": 0.11414909362792969}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 416.225123165896, "num_env_steps_trained_throughput_per_sec": 416.225123165896, "timesteps_total": 140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 9780.223, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9780.182, "sample_time_ms": 3658.155, "load_time_ms": 0.468, "load_throughput": 8545851.671, "learn_time_ms": 6113.006, "learn_throughput": 654.343, "synch_weights_time_ms": 7.993}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "episodes_total": 249, "training_iteration": 35, "trial_id": "4bb30_00000", "date": "2024-04-27_18-32-17", "timestamp": 1714267937, "time_this_iter_s": 9.614879131317139, "time_total_s": 338.9386053085327, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 338.9386053085327, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 25.0, "ram_util_percent": 63.94285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.237078622848757, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0722719923395325, "policy_loss": -0.0405146242349699, "vf_loss": 2.104340007771007, "vf_explained_var": 0.23191561179776346, "kl": 0.018770231640478266, "entropy": 7.480010561276508, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 33015.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": -70.58573169769718, "episode_reward_min": -221.17986006872462, "episode_reward_mean": -107.79874873962521, "episode_len_mean": 542.74, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 54274, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114.40799519593145, -99.74151464261679, -85.94066479276728, -111.15726156142603, -116.44649765913499, -91.00270397756972, -105.16538352170772, -83.00345738233008, -102.39397021510514, -113.89468966227521, -108.17365870481791, -114.55596742320371, -84.72089160340515, -138.99723845274144, -102.94945768012789, -80.67062085370596, -108.25077240848977, -115.86613781278642, -103.0355264597293, -151.84700326090646, -116.22717414344041, -95.12103612170554, -71.83933218312691, -86.67064132343613, -110.75204453233195, -108.00408695291418, -109.01482975365532, -104.91433270118014, -118.99546710831486, -88.412941530209, -108.72663824119233, -88.96703517702592, -113.23966200823213, -105.52061937466947, -85.36627136432514, -114.51024559673294, -108.94396790004087, -112.40843796739541, -107.52356615774582, -123.9120734313025, -113.49118999093399, -89.43826942713618, -113.37270364682874, -116.04578494502357, -114.64725730017759, -118.70272133657338, -112.6050885285108, -107.74277468968245, -107.00184648572095, -110.35605578113099, -82.92322332870636, -103.87237182156308, -114.62842126470059, -221.17986006872462, -107.27258538813952, -91.62360250619118, -84.68372345621452, -124.2412146015844, -118.71168243686854, -108.04384324036353, -88.44990662576315, -86.01741862560363, -126.61621976038006, -108.24786509753702, -109.22560871831826, -110.12264486177142, -114.08329024804073, -110.07239939920728, -85.26246211376436, -125.5911982152164, -104.375435936821, -104.32731182627815, -106.71088721375789, -105.49425215971408, -127.45275508667528, -87.33622528719219, -116.89823679154925, -79.14790576381417, -107.80744813653455, -88.56477287852039, -94.09449837234887, -118.04270641943467, -70.58573169769718, -120.49794333342649, -106.16135135763388, -109.66154224681607, -115.85989168764651, -134.02767749115884, -135.07952144929695, -75.47727183077906, -112.98674648764171, -106.68817867885033, -131.5757485454958, -112.05600380511147, -118.60056792966711, -116.99882845008125, -74.79165308243324, -106.8970903844939, -139.27869205051599, -116.83294683099973], "episode_lengths": [43, 1600, 1600, 51, 64, 1600, 39, 1600, 68, 64, 67, 71, 1600, 1600, 70, 1600, 82, 64, 72, 1600, 77, 1600, 1600, 1600, 79, 78, 92, 147, 142, 1600, 65, 1600, 64, 75, 1600, 41, 79, 49, 95, 107, 40, 1600, 56, 85, 46, 61, 37, 58, 47, 44, 1600, 51, 93, 1235, 83, 1600, 1600, 95, 86, 74, 1600, 1600, 73, 62, 78, 53, 60, 64, 1600, 119, 74, 38, 87, 51, 83, 1600, 67, 1600, 48, 1600, 1600, 1600, 1600, 68, 66, 64, 63, 192, 1600, 1600, 70, 94, 146, 64, 67, 44, 1600, 42, 143, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28587602398534706, "mean_inference_ms": 0.9495516322945821, "mean_action_processing_ms": 0.18540969307576152, "mean_env_wait_ms": 0.3859779491419924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0059392452239990234, "StateBufferConnector_ms": 0.0044977664947509766, "ViewRequirementAgentConnector_ms": 0.11751270294189453}}, "episode_reward_max": -70.58573169769718, "episode_reward_min": -221.17986006872462, "episode_reward_mean": -107.79874873962521, "episode_len_mean": 542.74, "episodes_this_iter": 11, "episodes_timesteps_total": 54274, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114.40799519593145, -99.74151464261679, -85.94066479276728, -111.15726156142603, -116.44649765913499, -91.00270397756972, -105.16538352170772, -83.00345738233008, -102.39397021510514, -113.89468966227521, -108.17365870481791, -114.55596742320371, -84.72089160340515, -138.99723845274144, -102.94945768012789, -80.67062085370596, -108.25077240848977, -115.86613781278642, -103.0355264597293, -151.84700326090646, -116.22717414344041, -95.12103612170554, -71.83933218312691, -86.67064132343613, -110.75204453233195, -108.00408695291418, -109.01482975365532, -104.91433270118014, -118.99546710831486, -88.412941530209, -108.72663824119233, -88.96703517702592, -113.23966200823213, -105.52061937466947, -85.36627136432514, -114.51024559673294, -108.94396790004087, -112.40843796739541, -107.52356615774582, -123.9120734313025, -113.49118999093399, -89.43826942713618, -113.37270364682874, -116.04578494502357, -114.64725730017759, -118.70272133657338, -112.6050885285108, -107.74277468968245, -107.00184648572095, -110.35605578113099, -82.92322332870636, -103.87237182156308, -114.62842126470059, -221.17986006872462, -107.27258538813952, -91.62360250619118, -84.68372345621452, -124.2412146015844, -118.71168243686854, -108.04384324036353, -88.44990662576315, -86.01741862560363, -126.61621976038006, -108.24786509753702, -109.22560871831826, -110.12264486177142, -114.08329024804073, -110.07239939920728, -85.26246211376436, -125.5911982152164, -104.375435936821, -104.32731182627815, -106.71088721375789, -105.49425215971408, -127.45275508667528, -87.33622528719219, -116.89823679154925, -79.14790576381417, -107.80744813653455, -88.56477287852039, -94.09449837234887, -118.04270641943467, -70.58573169769718, -120.49794333342649, -106.16135135763388, -109.66154224681607, -115.85989168764651, -134.02767749115884, -135.07952144929695, -75.47727183077906, -112.98674648764171, -106.68817867885033, -131.5757485454958, -112.05600380511147, -118.60056792966711, -116.99882845008125, -74.79165308243324, -106.8970903844939, -139.27869205051599, -116.83294683099973], "episode_lengths": [43, 1600, 1600, 51, 64, 1600, 39, 1600, 68, 64, 67, 71, 1600, 1600, 70, 1600, 82, 64, 72, 1600, 77, 1600, 1600, 1600, 79, 78, 92, 147, 142, 1600, 65, 1600, 64, 75, 1600, 41, 79, 49, 95, 107, 40, 1600, 56, 85, 46, 61, 37, 58, 47, 44, 1600, 51, 93, 1235, 83, 1600, 1600, 95, 86, 74, 1600, 1600, 73, 62, 78, 53, 60, 64, 1600, 119, 74, 38, 87, 51, 83, 1600, 67, 1600, 48, 1600, 1600, 1600, 1600, 68, 66, 64, 63, 192, 1600, 1600, 70, 94, 146, 64, 67, 44, 1600, 42, 143, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28587602398534706, "mean_inference_ms": 0.9495516322945821, "mean_action_processing_ms": 0.18540969307576152, "mean_env_wait_ms": 0.3859779491419924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0059392452239990234, "StateBufferConnector_ms": 0.0044977664947509766, "ViewRequirementAgentConnector_ms": 0.11751270294189453}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 364.98952112629485, "num_env_steps_trained_throughput_per_sec": 364.98952112629485, "timesteps_total": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 9902.062, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9902.019, "sample_time_ms": 3735.435, "load_time_ms": 0.471, "load_throughput": 8487487.226, "learn_time_ms": 6157.676, "learn_throughput": 649.596, "synch_weights_time_ms": 7.884}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 260, "training_iteration": 36, "trial_id": "4bb30_00000", "date": "2024-04-27_18-32-28", "timestamp": 1714267948, "time_this_iter_s": 10.964964866638184, "time_total_s": 349.9035701751709, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 349.9035701751709, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 39.26, "ram_util_percent": 63.83999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.73498181226433, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7780192029795119, "policy_loss": -0.037705182195991595, "vf_loss": 1.8089880704158736, "vf_explained_var": 0.2621334418814669, "kl": 0.014969554057089792, "entropy": 8.0661604778741, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 33945.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "sampler_results": {"episode_reward_max": -70.58573169769718, "episode_reward_min": -221.17986006872462, "episode_reward_mean": -108.10853403147972, "episode_len_mean": 528.78, "episode_media": {}, "episodes_this_iter": 8, "episodes_timesteps_total": 52878, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-102.39397021510514, -113.89468966227521, -108.17365870481791, -114.55596742320371, -84.72089160340515, -138.99723845274144, -102.94945768012789, -80.67062085370596, -108.25077240848977, -115.86613781278642, -103.0355264597293, -151.84700326090646, -116.22717414344041, -95.12103612170554, -71.83933218312691, -86.67064132343613, -110.75204453233195, -108.00408695291418, -109.01482975365532, -104.91433270118014, -118.99546710831486, -88.412941530209, -108.72663824119233, -88.96703517702592, -113.23966200823213, -105.52061937466947, -85.36627136432514, -114.51024559673294, -108.94396790004087, -112.40843796739541, -107.52356615774582, -123.9120734313025, -113.49118999093399, -89.43826942713618, -113.37270364682874, -116.04578494502357, -114.64725730017759, -118.70272133657338, -112.6050885285108, -107.74277468968245, -107.00184648572095, -110.35605578113099, -82.92322332870636, -103.87237182156308, -114.62842126470059, -221.17986006872462, -107.27258538813952, -91.62360250619118, -84.68372345621452, -124.2412146015844, -118.71168243686854, -108.04384324036353, -88.44990662576315, -86.01741862560363, -126.61621976038006, -108.24786509753702, -109.22560871831826, -110.12264486177142, -114.08329024804073, -110.07239939920728, -85.26246211376436, -125.5911982152164, -104.375435936821, -104.32731182627815, -106.71088721375789, -105.49425215971408, -127.45275508667528, -87.33622528719219, -116.89823679154925, -79.14790576381417, -107.80744813653455, -88.56477287852039, -94.09449837234887, -118.04270641943467, -70.58573169769718, -120.49794333342649, -106.16135135763388, -109.66154224681607, -115.85989168764651, -134.02767749115884, -135.07952144929695, -75.47727183077906, -112.98674648764171, -106.68817867885033, -131.5757485454958, -112.05600380511147, -118.60056792966711, -116.99882845008125, -74.79165308243324, -106.8970903844939, -139.27869205051599, -116.83294683099973, -134.93468967143133, -103.2133028934865, -125.02396694940948, -106.94857649453171, -70.87234399098405, -114.4429390068762, -107.97819470685535, -74.42999420536307], "episode_lengths": [68, 64, 67, 71, 1600, 1600, 70, 1600, 82, 64, 72, 1600, 77, 1600, 1600, 1600, 79, 78, 92, 147, 142, 1600, 65, 1600, 64, 75, 1600, 41, 79, 49, 95, 107, 40, 1600, 56, 85, 46, 61, 37, 58, 47, 44, 1600, 51, 93, 1235, 83, 1600, 1600, 95, 86, 74, 1600, 1600, 73, 62, 78, 53, 60, 64, 1600, 119, 74, 38, 87, 51, 83, 1600, 67, 1600, 48, 1600, 1600, 1600, 1600, 68, 66, 64, 63, 192, 1600, 1600, 70, 94, 146, 64, 67, 44, 1600, 42, 143, 58, 1600, 89, 107, 103, 1600, 43, 59, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28611311946516793, "mean_inference_ms": 0.9499836587501675, "mean_action_processing_ms": 0.18555456529586864, "mean_env_wait_ms": 0.3862121604585535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00601506233215332, "StateBufferConnector_ms": 0.0045740604400634766, "ViewRequirementAgentConnector_ms": 0.11753439903259277}}, "episode_reward_max": -70.58573169769718, "episode_reward_min": -221.17986006872462, "episode_reward_mean": -108.10853403147972, "episode_len_mean": 528.78, "episodes_this_iter": 8, "episodes_timesteps_total": 52878, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-102.39397021510514, -113.89468966227521, -108.17365870481791, -114.55596742320371, -84.72089160340515, -138.99723845274144, -102.94945768012789, -80.67062085370596, -108.25077240848977, -115.86613781278642, -103.0355264597293, -151.84700326090646, -116.22717414344041, -95.12103612170554, -71.83933218312691, -86.67064132343613, -110.75204453233195, -108.00408695291418, -109.01482975365532, -104.91433270118014, -118.99546710831486, -88.412941530209, -108.72663824119233, -88.96703517702592, -113.23966200823213, -105.52061937466947, -85.36627136432514, -114.51024559673294, -108.94396790004087, -112.40843796739541, -107.52356615774582, -123.9120734313025, -113.49118999093399, -89.43826942713618, -113.37270364682874, -116.04578494502357, -114.64725730017759, -118.70272133657338, -112.6050885285108, -107.74277468968245, -107.00184648572095, -110.35605578113099, -82.92322332870636, -103.87237182156308, -114.62842126470059, -221.17986006872462, -107.27258538813952, -91.62360250619118, -84.68372345621452, -124.2412146015844, -118.71168243686854, -108.04384324036353, -88.44990662576315, -86.01741862560363, -126.61621976038006, -108.24786509753702, -109.22560871831826, -110.12264486177142, -114.08329024804073, -110.07239939920728, -85.26246211376436, -125.5911982152164, -104.375435936821, -104.32731182627815, -106.71088721375789, -105.49425215971408, -127.45275508667528, -87.33622528719219, -116.89823679154925, -79.14790576381417, -107.80744813653455, -88.56477287852039, -94.09449837234887, -118.04270641943467, -70.58573169769718, -120.49794333342649, -106.16135135763388, -109.66154224681607, -115.85989168764651, -134.02767749115884, -135.07952144929695, -75.47727183077906, -112.98674648764171, -106.68817867885033, -131.5757485454958, -112.05600380511147, -118.60056792966711, -116.99882845008125, -74.79165308243324, -106.8970903844939, -139.27869205051599, -116.83294683099973, -134.93468967143133, -103.2133028934865, -125.02396694940948, -106.94857649453171, -70.87234399098405, -114.4429390068762, -107.97819470685535, -74.42999420536307], "episode_lengths": [68, 64, 67, 71, 1600, 1600, 70, 1600, 82, 64, 72, 1600, 77, 1600, 1600, 1600, 79, 78, 92, 147, 142, 1600, 65, 1600, 64, 75, 1600, 41, 79, 49, 95, 107, 40, 1600, 56, 85, 46, 61, 37, 58, 47, 44, 1600, 51, 93, 1235, 83, 1600, 1600, 95, 86, 74, 1600, 1600, 73, 62, 78, 53, 60, 64, 1600, 119, 74, 38, 87, 51, 83, 1600, 67, 1600, 48, 1600, 1600, 1600, 1600, 68, 66, 64, 63, 192, 1600, 1600, 70, 94, 146, 64, 67, 44, 1600, 42, 143, 58, 1600, 89, 107, 103, 1600, 43, 59, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28611311946516793, "mean_inference_ms": 0.9499836587501675, "mean_action_processing_ms": 0.18555456529586864, "mean_env_wait_ms": 0.3862121604585535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00601506233215332, "StateBufferConnector_ms": 0.0045740604400634766, "ViewRequirementAgentConnector_ms": 0.11753439903259277}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 396.17755099920373, "num_env_steps_trained_throughput_per_sec": 396.17755099920373, "timesteps_total": 148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 9950.628, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9950.589, "sample_time_ms": 3754.924, "load_time_ms": 0.472, "load_throughput": 8480622.757, "learn_time_ms": 6186.415, "learn_throughput": 646.578, "synch_weights_time_ms": 8.196}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "done": false, "episodes_total": 268, "training_iteration": 37, "trial_id": "4bb30_00000", "date": "2024-04-27_18-32-39", "timestamp": 1714267959, "time_this_iter_s": 10.101914167404175, "time_total_s": 360.0054843425751, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 360.0054843425751, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 32.66428571428572, "ram_util_percent": 63.814285714285695}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.75853312483398, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.239401621455377, "policy_loss": -0.03391796024966865, "vf_loss": 2.2656566385299928, "vf_explained_var": 0.2322552320136819, "kl": 0.017028757365778725, "entropy": 8.473383728663126, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 34875.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "sampler_results": {"episode_reward_max": -68.50100702885027, "episode_reward_min": -221.17986006872462, "episode_reward_mean": -107.91700317549677, "episode_len_mean": 528.95, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 52895, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-102.94945768012789, -80.67062085370596, -108.25077240848977, -115.86613781278642, -103.0355264597293, -151.84700326090646, -116.22717414344041, -95.12103612170554, -71.83933218312691, -86.67064132343613, -110.75204453233195, -108.00408695291418, -109.01482975365532, -104.91433270118014, -118.99546710831486, -88.412941530209, -108.72663824119233, -88.96703517702592, -113.23966200823213, -105.52061937466947, -85.36627136432514, -114.51024559673294, -108.94396790004087, -112.40843796739541, -107.52356615774582, -123.9120734313025, -113.49118999093399, -89.43826942713618, -113.37270364682874, -116.04578494502357, -114.64725730017759, -118.70272133657338, -112.6050885285108, -107.74277468968245, -107.00184648572095, -110.35605578113099, -82.92322332870636, -103.87237182156308, -114.62842126470059, -221.17986006872462, -107.27258538813952, -91.62360250619118, -84.68372345621452, -124.2412146015844, -118.71168243686854, -108.04384324036353, -88.44990662576315, -86.01741862560363, -126.61621976038006, -108.24786509753702, -109.22560871831826, -110.12264486177142, -114.08329024804073, -110.07239939920728, -85.26246211376436, -125.5911982152164, -104.375435936821, -104.32731182627815, -106.71088721375789, -105.49425215971408, -127.45275508667528, -87.33622528719219, -116.89823679154925, -79.14790576381417, -107.80744813653455, -88.56477287852039, -94.09449837234887, -118.04270641943467, -70.58573169769718, -120.49794333342649, -106.16135135763388, -109.66154224681607, -115.85989168764651, -134.02767749115884, -135.07952144929695, -75.47727183077906, -112.98674648764171, -106.68817867885033, -131.5757485454958, -112.05600380511147, -118.60056792966711, -116.99882845008125, -74.79165308243324, -106.8970903844939, -139.27869205051599, -116.83294683099973, -134.93468967143133, -103.2133028934865, -125.02396694940948, -106.94857649453171, -70.87234399098405, -114.4429390068762, -107.97819470685535, -74.42999420536307, -128.41387730589562, -108.5314804589941, -115.91059448132354, -115.42542596427165, -106.80094522391819, -68.50100702885027], "episode_lengths": [70, 1600, 82, 64, 72, 1600, 77, 1600, 1600, 1600, 79, 78, 92, 147, 142, 1600, 65, 1600, 64, 75, 1600, 41, 79, 49, 95, 107, 40, 1600, 56, 85, 46, 61, 37, 58, 47, 44, 1600, 51, 93, 1235, 83, 1600, 1600, 95, 86, 74, 1600, 1600, 73, 62, 78, 53, 60, 64, 1600, 119, 74, 38, 87, 51, 83, 1600, 67, 1600, 48, 1600, 1600, 1600, 1600, 68, 66, 64, 63, 192, 1600, 1600, 70, 94, 146, 64, 67, 44, 1600, 42, 143, 58, 1600, 89, 107, 103, 1600, 43, 59, 1600, 1600, 72, 77, 74, 64, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2863184923327266, "mean_inference_ms": 0.9503391239180232, "mean_action_processing_ms": 0.18568407220953656, "mean_env_wait_ms": 0.38642054126460634, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0060710906982421875, "StateBufferConnector_ms": 0.0045850276947021484, "ViewRequirementAgentConnector_ms": 0.11804652214050293}}, "episode_reward_max": -68.50100702885027, "episode_reward_min": -221.17986006872462, "episode_reward_mean": -107.91700317549677, "episode_len_mean": 528.95, "episodes_this_iter": 6, "episodes_timesteps_total": 52895, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-102.94945768012789, -80.67062085370596, -108.25077240848977, -115.86613781278642, -103.0355264597293, -151.84700326090646, -116.22717414344041, -95.12103612170554, -71.83933218312691, -86.67064132343613, -110.75204453233195, -108.00408695291418, -109.01482975365532, -104.91433270118014, -118.99546710831486, -88.412941530209, -108.72663824119233, -88.96703517702592, -113.23966200823213, -105.52061937466947, -85.36627136432514, -114.51024559673294, -108.94396790004087, -112.40843796739541, -107.52356615774582, -123.9120734313025, -113.49118999093399, -89.43826942713618, -113.37270364682874, -116.04578494502357, -114.64725730017759, -118.70272133657338, -112.6050885285108, -107.74277468968245, -107.00184648572095, -110.35605578113099, -82.92322332870636, -103.87237182156308, -114.62842126470059, -221.17986006872462, -107.27258538813952, -91.62360250619118, -84.68372345621452, -124.2412146015844, -118.71168243686854, -108.04384324036353, -88.44990662576315, -86.01741862560363, -126.61621976038006, -108.24786509753702, -109.22560871831826, -110.12264486177142, -114.08329024804073, -110.07239939920728, -85.26246211376436, -125.5911982152164, -104.375435936821, -104.32731182627815, -106.71088721375789, -105.49425215971408, -127.45275508667528, -87.33622528719219, -116.89823679154925, -79.14790576381417, -107.80744813653455, -88.56477287852039, -94.09449837234887, -118.04270641943467, -70.58573169769718, -120.49794333342649, -106.16135135763388, -109.66154224681607, -115.85989168764651, -134.02767749115884, -135.07952144929695, -75.47727183077906, -112.98674648764171, -106.68817867885033, -131.5757485454958, -112.05600380511147, -118.60056792966711, -116.99882845008125, -74.79165308243324, -106.8970903844939, -139.27869205051599, -116.83294683099973, -134.93468967143133, -103.2133028934865, -125.02396694940948, -106.94857649453171, -70.87234399098405, -114.4429390068762, -107.97819470685535, -74.42999420536307, -128.41387730589562, -108.5314804589941, -115.91059448132354, -115.42542596427165, -106.80094522391819, -68.50100702885027], "episode_lengths": [70, 1600, 82, 64, 72, 1600, 77, 1600, 1600, 1600, 79, 78, 92, 147, 142, 1600, 65, 1600, 64, 75, 1600, 41, 79, 49, 95, 107, 40, 1600, 56, 85, 46, 61, 37, 58, 47, 44, 1600, 51, 93, 1235, 83, 1600, 1600, 95, 86, 74, 1600, 1600, 73, 62, 78, 53, 60, 64, 1600, 119, 74, 38, 87, 51, 83, 1600, 67, 1600, 48, 1600, 1600, 1600, 1600, 68, 66, 64, 63, 192, 1600, 1600, 70, 94, 146, 64, 67, 44, 1600, 42, 143, 58, 1600, 89, 107, 103, 1600, 43, 59, 1600, 1600, 72, 77, 74, 64, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2863184923327266, "mean_inference_ms": 0.9503391239180232, "mean_action_processing_ms": 0.18568407220953656, "mean_env_wait_ms": 0.38642054126460634, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0060710906982421875, "StateBufferConnector_ms": 0.0045850276947021484, "ViewRequirementAgentConnector_ms": 0.11804652214050293}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 403.55214644667615, "num_env_steps_trained_throughput_per_sec": 403.55214644667615, "timesteps_total": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 9962.537, "restore_workers_time_ms": 0.014, "training_step_time_ms": 9962.497, "sample_time_ms": 3763.152, "load_time_ms": 0.47, "load_throughput": 8514192.337, "learn_time_ms": 6190.142, "learn_throughput": 646.189, "synch_weights_time_ms": 8.142}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "episodes_total": 274, "training_iteration": 38, "trial_id": "4bb30_00000", "date": "2024-04-27_18-32-48", "timestamp": 1714267968, "time_this_iter_s": 9.917281866073608, "time_total_s": 369.9227662086487, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 369.9227662086487, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 31.639999999999997, "ram_util_percent": 63.69333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.00745702930676, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0607393021665272, "policy_loss": -0.03368034730515172, "vf_loss": 2.0904573073710804, "vf_explained_var": 0.228596249575256, "kl": 0.008805206802120219, "entropy": 9.477787641299669, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 35805.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "sampler_results": {"episode_reward_max": -68.50100702885027, "episode_reward_min": -221.17986006872462, "episode_reward_mean": -108.72889365914982, "episode_len_mean": 543.7, "episode_media": {}, "episodes_this_iter": 5, "episodes_timesteps_total": 54370, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-151.84700326090646, -116.22717414344041, -95.12103612170554, -71.83933218312691, -86.67064132343613, -110.75204453233195, -108.00408695291418, -109.01482975365532, -104.91433270118014, -118.99546710831486, -88.412941530209, -108.72663824119233, -88.96703517702592, -113.23966200823213, -105.52061937466947, -85.36627136432514, -114.51024559673294, -108.94396790004087, -112.40843796739541, -107.52356615774582, -123.9120734313025, -113.49118999093399, -89.43826942713618, -113.37270364682874, -116.04578494502357, -114.64725730017759, -118.70272133657338, -112.6050885285108, -107.74277468968245, -107.00184648572095, -110.35605578113099, -82.92322332870636, -103.87237182156308, -114.62842126470059, -221.17986006872462, -107.27258538813952, -91.62360250619118, -84.68372345621452, -124.2412146015844, -118.71168243686854, -108.04384324036353, -88.44990662576315, -86.01741862560363, -126.61621976038006, -108.24786509753702, -109.22560871831826, -110.12264486177142, -114.08329024804073, -110.07239939920728, -85.26246211376436, -125.5911982152164, -104.375435936821, -104.32731182627815, -106.71088721375789, -105.49425215971408, -127.45275508667528, -87.33622528719219, -116.89823679154925, -79.14790576381417, -107.80744813653455, -88.56477287852039, -94.09449837234887, -118.04270641943467, -70.58573169769718, -120.49794333342649, -106.16135135763388, -109.66154224681607, -115.85989168764651, -134.02767749115884, -135.07952144929695, -75.47727183077906, -112.98674648764171, -106.68817867885033, -131.5757485454958, -112.05600380511147, -118.60056792966711, -116.99882845008125, -74.79165308243324, -106.8970903844939, -139.27869205051599, -116.83294683099973, -134.93468967143133, -103.2133028934865, -125.02396694940948, -106.94857649453171, -70.87234399098405, -114.4429390068762, -107.97819470685535, -74.42999420536307, -128.41387730589562, -108.5314804589941, -115.91059448132354, -115.42542596427165, -106.80094522391819, -68.50100702885027, -140.1775371782054, -105.14493667388398, -108.29977580438617, -128.58374013653886, -109.75557378712918], "episode_lengths": [1600, 77, 1600, 1600, 1600, 79, 78, 92, 147, 142, 1600, 65, 1600, 64, 75, 1600, 41, 79, 49, 95, 107, 40, 1600, 56, 85, 46, 61, 37, 58, 47, 44, 1600, 51, 93, 1235, 83, 1600, 1600, 95, 86, 74, 1600, 1600, 73, 62, 78, 53, 60, 64, 1600, 119, 74, 38, 87, 51, 83, 1600, 67, 1600, 48, 1600, 1600, 1600, 1600, 68, 66, 64, 63, 192, 1600, 1600, 70, 94, 146, 64, 67, 44, 1600, 42, 143, 58, 1600, 89, 107, 103, 1600, 43, 59, 1600, 1600, 72, 77, 74, 64, 1600, 1600, 44, 54, 1600, 65]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2864368302075768, "mean_inference_ms": 0.9508959541251839, "mean_action_processing_ms": 0.18577586340764385, "mean_env_wait_ms": 0.38651364613444456, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006005525588989258, "StateBufferConnector_ms": 0.004573345184326172, "ViewRequirementAgentConnector_ms": 0.11836123466491699}}, "episode_reward_max": -68.50100702885027, "episode_reward_min": -221.17986006872462, "episode_reward_mean": -108.72889365914982, "episode_len_mean": 543.7, "episodes_this_iter": 5, "episodes_timesteps_total": 54370, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-151.84700326090646, -116.22717414344041, -95.12103612170554, -71.83933218312691, -86.67064132343613, -110.75204453233195, -108.00408695291418, -109.01482975365532, -104.91433270118014, -118.99546710831486, -88.412941530209, -108.72663824119233, -88.96703517702592, -113.23966200823213, -105.52061937466947, -85.36627136432514, -114.51024559673294, -108.94396790004087, -112.40843796739541, -107.52356615774582, -123.9120734313025, -113.49118999093399, -89.43826942713618, -113.37270364682874, -116.04578494502357, -114.64725730017759, -118.70272133657338, -112.6050885285108, -107.74277468968245, -107.00184648572095, -110.35605578113099, -82.92322332870636, -103.87237182156308, -114.62842126470059, -221.17986006872462, -107.27258538813952, -91.62360250619118, -84.68372345621452, -124.2412146015844, -118.71168243686854, -108.04384324036353, -88.44990662576315, -86.01741862560363, -126.61621976038006, -108.24786509753702, -109.22560871831826, -110.12264486177142, -114.08329024804073, -110.07239939920728, -85.26246211376436, -125.5911982152164, -104.375435936821, -104.32731182627815, -106.71088721375789, -105.49425215971408, -127.45275508667528, -87.33622528719219, -116.89823679154925, -79.14790576381417, -107.80744813653455, -88.56477287852039, -94.09449837234887, -118.04270641943467, -70.58573169769718, -120.49794333342649, -106.16135135763388, -109.66154224681607, -115.85989168764651, -134.02767749115884, -135.07952144929695, -75.47727183077906, -112.98674648764171, -106.68817867885033, -131.5757485454958, -112.05600380511147, -118.60056792966711, -116.99882845008125, -74.79165308243324, -106.8970903844939, -139.27869205051599, -116.83294683099973, -134.93468967143133, -103.2133028934865, -125.02396694940948, -106.94857649453171, -70.87234399098405, -114.4429390068762, -107.97819470685535, -74.42999420536307, -128.41387730589562, -108.5314804589941, -115.91059448132354, -115.42542596427165, -106.80094522391819, -68.50100702885027, -140.1775371782054, -105.14493667388398, -108.29977580438617, -128.58374013653886, -109.75557378712918], "episode_lengths": [1600, 77, 1600, 1600, 1600, 79, 78, 92, 147, 142, 1600, 65, 1600, 64, 75, 1600, 41, 79, 49, 95, 107, 40, 1600, 56, 85, 46, 61, 37, 58, 47, 44, 1600, 51, 93, 1235, 83, 1600, 1600, 95, 86, 74, 1600, 1600, 73, 62, 78, 53, 60, 64, 1600, 119, 74, 38, 87, 51, 83, 1600, 67, 1600, 48, 1600, 1600, 1600, 1600, 68, 66, 64, 63, 192, 1600, 1600, 70, 94, 146, 64, 67, 44, 1600, 42, 143, 58, 1600, 89, 107, 103, 1600, 43, 59, 1600, 1600, 72, 77, 74, 64, 1600, 1600, 44, 54, 1600, 65]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2864368302075768, "mean_inference_ms": 0.9508959541251839, "mean_action_processing_ms": 0.18577586340764385, "mean_env_wait_ms": 0.38651364613444456, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006005525588989258, "StateBufferConnector_ms": 0.004573345184326172, "ViewRequirementAgentConnector_ms": 0.11836123466491699}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 404.54093706504784, "num_env_steps_trained_throughput_per_sec": 404.54093706504784, "timesteps_total": 156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 9983.635, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9983.596, "sample_time_ms": 3773.016, "load_time_ms": 0.487, "load_throughput": 8215265.89, "learn_time_ms": 6201.153, "learn_throughput": 645.041, "synch_weights_time_ms": 8.36}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "episodes_total": 279, "training_iteration": 39, "trial_id": "4bb30_00000", "date": "2024-04-27_18-32-58", "timestamp": 1714267978, "time_this_iter_s": 9.8923499584198, "time_total_s": 379.8151161670685, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 379.8151161670685, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 31.55, "ram_util_percent": 63.700000000000024}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.067401810871658, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.5191758981072194, "policy_loss": -0.03375098782200967, "vf_loss": 3.5457523709183096, "vf_explained_var": 0.2831216283382908, "kl": 0.015943405503855312, "entropy": 10.59861574070428, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 36735.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "sampler_results": {"episode_reward_max": -68.50100702885027, "episode_reward_min": -221.17986006872462, "episode_reward_mean": -109.82396415817175, "episode_len_mean": 479.75, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 47975, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113.23966200823213, -105.52061937466947, -85.36627136432514, -114.51024559673294, -108.94396790004087, -112.40843796739541, -107.52356615774582, -123.9120734313025, -113.49118999093399, -89.43826942713618, -113.37270364682874, -116.04578494502357, -114.64725730017759, -118.70272133657338, -112.6050885285108, -107.74277468968245, -107.00184648572095, -110.35605578113099, -82.92322332870636, -103.87237182156308, -114.62842126470059, -221.17986006872462, -107.27258538813952, -91.62360250619118, -84.68372345621452, -124.2412146015844, -118.71168243686854, -108.04384324036353, -88.44990662576315, -86.01741862560363, -126.61621976038006, -108.24786509753702, -109.22560871831826, -110.12264486177142, -114.08329024804073, -110.07239939920728, -85.26246211376436, -125.5911982152164, -104.375435936821, -104.32731182627815, -106.71088721375789, -105.49425215971408, -127.45275508667528, -87.33622528719219, -116.89823679154925, -79.14790576381417, -107.80744813653455, -88.56477287852039, -94.09449837234887, -118.04270641943467, -70.58573169769718, -120.49794333342649, -106.16135135763388, -109.66154224681607, -115.85989168764651, -134.02767749115884, -135.07952144929695, -75.47727183077906, -112.98674648764171, -106.68817867885033, -131.5757485454958, -112.05600380511147, -118.60056792966711, -116.99882845008125, -74.79165308243324, -106.8970903844939, -139.27869205051599, -116.83294683099973, -134.93468967143133, -103.2133028934865, -125.02396694940948, -106.94857649453171, -70.87234399098405, -114.4429390068762, -107.97819470685535, -74.42999420536307, -128.41387730589562, -108.5314804589941, -115.91059448132354, -115.42542596427165, -106.80094522391819, -68.50100702885027, -140.1775371782054, -105.14493667388398, -108.29977580438617, -128.58374013653886, -109.75557378712918, -135.80315654027675, -110.97934508427046, -115.237382071505, -105.05871098732328, -111.93862545374161, -130.3178459243245, -107.05992151164823, -105.02368306042752, -105.97857513435993, -106.09090342071902, -108.4072053827035, -118.79263029582488, -108.31162806450887], "episode_lengths": [64, 75, 1600, 41, 79, 49, 95, 107, 40, 1600, 56, 85, 46, 61, 37, 58, 47, 44, 1600, 51, 93, 1235, 83, 1600, 1600, 95, 86, 74, 1600, 1600, 73, 62, 78, 53, 60, 64, 1600, 119, 74, 38, 87, 51, 83, 1600, 67, 1600, 48, 1600, 1600, 1600, 1600, 68, 66, 64, 63, 192, 1600, 1600, 70, 94, 146, 64, 67, 44, 1600, 42, 143, 58, 1600, 89, 107, 103, 1600, 43, 59, 1600, 1600, 72, 77, 74, 64, 1600, 1600, 44, 54, 1600, 65, 1600, 55, 58, 108, 48, 1600, 62, 59, 68, 77, 45, 57, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2868962331100237, "mean_inference_ms": 0.9522086032852692, "mean_action_processing_ms": 0.1860706514693069, "mean_env_wait_ms": 0.38692277313292167, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0061244964599609375, "StateBufferConnector_ms": 0.004542827606201172, "ViewRequirementAgentConnector_ms": 0.11992645263671875}}, "episode_reward_max": -68.50100702885027, "episode_reward_min": -221.17986006872462, "episode_reward_mean": -109.82396415817175, "episode_len_mean": 479.75, "episodes_this_iter": 13, "episodes_timesteps_total": 47975, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113.23966200823213, -105.52061937466947, -85.36627136432514, -114.51024559673294, -108.94396790004087, -112.40843796739541, -107.52356615774582, -123.9120734313025, -113.49118999093399, -89.43826942713618, -113.37270364682874, -116.04578494502357, -114.64725730017759, -118.70272133657338, -112.6050885285108, -107.74277468968245, -107.00184648572095, -110.35605578113099, -82.92322332870636, -103.87237182156308, -114.62842126470059, -221.17986006872462, -107.27258538813952, -91.62360250619118, -84.68372345621452, -124.2412146015844, -118.71168243686854, -108.04384324036353, -88.44990662576315, -86.01741862560363, -126.61621976038006, -108.24786509753702, -109.22560871831826, -110.12264486177142, -114.08329024804073, -110.07239939920728, -85.26246211376436, -125.5911982152164, -104.375435936821, -104.32731182627815, -106.71088721375789, -105.49425215971408, -127.45275508667528, -87.33622528719219, -116.89823679154925, -79.14790576381417, -107.80744813653455, -88.56477287852039, -94.09449837234887, -118.04270641943467, -70.58573169769718, -120.49794333342649, -106.16135135763388, -109.66154224681607, -115.85989168764651, -134.02767749115884, -135.07952144929695, -75.47727183077906, -112.98674648764171, -106.68817867885033, -131.5757485454958, -112.05600380511147, -118.60056792966711, -116.99882845008125, -74.79165308243324, -106.8970903844939, -139.27869205051599, -116.83294683099973, -134.93468967143133, -103.2133028934865, -125.02396694940948, -106.94857649453171, -70.87234399098405, -114.4429390068762, -107.97819470685535, -74.42999420536307, -128.41387730589562, -108.5314804589941, -115.91059448132354, -115.42542596427165, -106.80094522391819, -68.50100702885027, -140.1775371782054, -105.14493667388398, -108.29977580438617, -128.58374013653886, -109.75557378712918, -135.80315654027675, -110.97934508427046, -115.237382071505, -105.05871098732328, -111.93862545374161, -130.3178459243245, -107.05992151164823, -105.02368306042752, -105.97857513435993, -106.09090342071902, -108.4072053827035, -118.79263029582488, -108.31162806450887], "episode_lengths": [64, 75, 1600, 41, 79, 49, 95, 107, 40, 1600, 56, 85, 46, 61, 37, 58, 47, 44, 1600, 51, 93, 1235, 83, 1600, 1600, 95, 86, 74, 1600, 1600, 73, 62, 78, 53, 60, 64, 1600, 119, 74, 38, 87, 51, 83, 1600, 67, 1600, 48, 1600, 1600, 1600, 1600, 68, 66, 64, 63, 192, 1600, 1600, 70, 94, 146, 64, 67, 44, 1600, 42, 143, 58, 1600, 89, 107, 103, 1600, 43, 59, 1600, 1600, 72, 77, 74, 64, 1600, 1600, 44, 54, 1600, 65, 1600, 55, 58, 108, 48, 1600, 62, 59, 68, 77, 45, 57, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2868962331100237, "mean_inference_ms": 0.9522086032852692, "mean_action_processing_ms": 0.1860706514693069, "mean_env_wait_ms": 0.38692277313292167, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0061244964599609375, "StateBufferConnector_ms": 0.004542827606201172, "ViewRequirementAgentConnector_ms": 0.11992645263671875}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 398.93646529341424, "num_env_steps_trained_throughput_per_sec": 398.93646529341424, "timesteps_total": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 10014.278, "restore_workers_time_ms": 0.014, "training_step_time_ms": 10014.24, "sample_time_ms": 3798.471, "load_time_ms": 0.469, "load_throughput": 8534548.784, "learn_time_ms": 6206.354, "learn_throughput": 644.501, "synch_weights_time_ms": 8.36}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "episodes_total": 292, "training_iteration": 40, "trial_id": "4bb30_00000", "date": "2024-04-27_18-33-08", "timestamp": 1714267988, "time_this_iter_s": 10.031929969787598, "time_total_s": 389.8470461368561, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 389.8470461368561, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 33.19285714285714, "ram_util_percent": 63.84999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.937275716245816, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.191199704318217, "policy_loss": -0.02876002975208785, "vf_loss": 5.213765729258778, "vf_explained_var": 0.18683244714172936, "kl": 0.013764438095663837, "entropy": 12.086076553406254, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 37665.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "sampler_results": {"episode_reward_max": -68.50100702885027, "episode_reward_min": -221.17986006872462, "episode_reward_mean": -111.1785671272633, "episode_len_mean": 470.26, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 47026, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-221.17986006872462, -107.27258538813952, -91.62360250619118, -84.68372345621452, -124.2412146015844, -118.71168243686854, -108.04384324036353, -88.44990662576315, -86.01741862560363, -126.61621976038006, -108.24786509753702, -109.22560871831826, -110.12264486177142, -114.08329024804073, -110.07239939920728, -85.26246211376436, -125.5911982152164, -104.375435936821, -104.32731182627815, -106.71088721375789, -105.49425215971408, -127.45275508667528, -87.33622528719219, -116.89823679154925, -79.14790576381417, -107.80744813653455, -88.56477287852039, -94.09449837234887, -118.04270641943467, -70.58573169769718, -120.49794333342649, -106.16135135763388, -109.66154224681607, -115.85989168764651, -134.02767749115884, -135.07952144929695, -75.47727183077906, -112.98674648764171, -106.68817867885033, -131.5757485454958, -112.05600380511147, -118.60056792966711, -116.99882845008125, -74.79165308243324, -106.8970903844939, -139.27869205051599, -116.83294683099973, -134.93468967143133, -103.2133028934865, -125.02396694940948, -106.94857649453171, -70.87234399098405, -114.4429390068762, -107.97819470685535, -74.42999420536307, -128.41387730589562, -108.5314804589941, -115.91059448132354, -115.42542596427165, -106.80094522391819, -68.50100702885027, -140.1775371782054, -105.14493667388398, -108.29977580438617, -128.58374013653886, -109.75557378712918, -135.80315654027675, -110.97934508427046, -115.237382071505, -105.05871098732328, -111.93862545374161, -130.3178459243245, -107.05992151164823, -105.02368306042752, -105.97857513435993, -106.09090342071902, -108.4072053827035, -118.79263029582488, -108.31162806450887, -120.40559612334266, -106.56776184486785, -114.46149354648654, -103.58749061410937, -109.43185440131589, -102.3319802166354, -147.20888539672137, -113.92220041706413, -111.29559258890711, -114.47405552487758, -131.13543118011938, -109.60201140976201, -107.34037035808154, -105.2531035514238, -114.56658118286046, -115.919567731884, -106.12499932804518, -135.4520866801453, -119.73250339419644, -108.8972056200821, -114.00207814536058], "episode_lengths": [1235, 83, 1600, 1600, 95, 86, 74, 1600, 1600, 73, 62, 78, 53, 60, 64, 1600, 119, 74, 38, 87, 51, 83, 1600, 67, 1600, 48, 1600, 1600, 1600, 1600, 68, 66, 64, 63, 192, 1600, 1600, 70, 94, 146, 64, 67, 44, 1600, 42, 143, 58, 1600, 89, 107, 103, 1600, 43, 59, 1600, 1600, 72, 77, 74, 64, 1600, 1600, 44, 54, 1600, 65, 1600, 55, 58, 108, 48, 1600, 62, 59, 68, 77, 45, 57, 48, 1600, 60, 93, 52, 68, 69, 456, 88, 42, 105, 1600, 65, 57, 76, 47, 61, 75, 177, 61, 66, 61]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2876528222253398, "mean_inference_ms": 0.9545242944065256, "mean_action_processing_ms": 0.18654543899447837, "mean_env_wait_ms": 0.38749046028181083, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006146669387817383, "StateBufferConnector_ms": 0.004539966583251953, "ViewRequirementAgentConnector_ms": 0.12020134925842285}}, "episode_reward_max": -68.50100702885027, "episode_reward_min": -221.17986006872462, "episode_reward_mean": -111.1785671272633, "episode_len_mean": 470.26, "episodes_this_iter": 21, "episodes_timesteps_total": 47026, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-221.17986006872462, -107.27258538813952, -91.62360250619118, -84.68372345621452, -124.2412146015844, -118.71168243686854, -108.04384324036353, -88.44990662576315, -86.01741862560363, -126.61621976038006, -108.24786509753702, -109.22560871831826, -110.12264486177142, -114.08329024804073, -110.07239939920728, -85.26246211376436, -125.5911982152164, -104.375435936821, -104.32731182627815, -106.71088721375789, -105.49425215971408, -127.45275508667528, -87.33622528719219, -116.89823679154925, -79.14790576381417, -107.80744813653455, -88.56477287852039, -94.09449837234887, -118.04270641943467, -70.58573169769718, -120.49794333342649, -106.16135135763388, -109.66154224681607, -115.85989168764651, -134.02767749115884, -135.07952144929695, -75.47727183077906, -112.98674648764171, -106.68817867885033, -131.5757485454958, -112.05600380511147, -118.60056792966711, -116.99882845008125, -74.79165308243324, -106.8970903844939, -139.27869205051599, -116.83294683099973, -134.93468967143133, -103.2133028934865, -125.02396694940948, -106.94857649453171, -70.87234399098405, -114.4429390068762, -107.97819470685535, -74.42999420536307, -128.41387730589562, -108.5314804589941, -115.91059448132354, -115.42542596427165, -106.80094522391819, -68.50100702885027, -140.1775371782054, -105.14493667388398, -108.29977580438617, -128.58374013653886, -109.75557378712918, -135.80315654027675, -110.97934508427046, -115.237382071505, -105.05871098732328, -111.93862545374161, -130.3178459243245, -107.05992151164823, -105.02368306042752, -105.97857513435993, -106.09090342071902, -108.4072053827035, -118.79263029582488, -108.31162806450887, -120.40559612334266, -106.56776184486785, -114.46149354648654, -103.58749061410937, -109.43185440131589, -102.3319802166354, -147.20888539672137, -113.92220041706413, -111.29559258890711, -114.47405552487758, -131.13543118011938, -109.60201140976201, -107.34037035808154, -105.2531035514238, -114.56658118286046, -115.919567731884, -106.12499932804518, -135.4520866801453, -119.73250339419644, -108.8972056200821, -114.00207814536058], "episode_lengths": [1235, 83, 1600, 1600, 95, 86, 74, 1600, 1600, 73, 62, 78, 53, 60, 64, 1600, 119, 74, 38, 87, 51, 83, 1600, 67, 1600, 48, 1600, 1600, 1600, 1600, 68, 66, 64, 63, 192, 1600, 1600, 70, 94, 146, 64, 67, 44, 1600, 42, 143, 58, 1600, 89, 107, 103, 1600, 43, 59, 1600, 1600, 72, 77, 74, 64, 1600, 1600, 44, 54, 1600, 65, 1600, 55, 58, 108, 48, 1600, 62, 59, 68, 77, 45, 57, 48, 1600, 60, 93, 52, 68, 69, 456, 88, 42, 105, 1600, 65, 57, 76, 47, 61, 75, 177, 61, 66, 61]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2876528222253398, "mean_inference_ms": 0.9545242944065256, "mean_action_processing_ms": 0.18654543899447837, "mean_env_wait_ms": 0.38749046028181083, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006146669387817383, "StateBufferConnector_ms": 0.004539966583251953, "ViewRequirementAgentConnector_ms": 0.12020134925842285}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 407.17491353317484, "num_env_steps_trained_throughput_per_sec": 407.17491353317484, "timesteps_total": 164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 164000, "timers": {"training_iteration_time_ms": 10024.185, "restore_workers_time_ms": 0.014, "training_step_time_ms": 10024.144, "sample_time_ms": 3806.08, "load_time_ms": 0.467, "load_throughput": 8572487.865, "learn_time_ms": 6208.758, "learn_throughput": 644.251, "synch_weights_time_ms": 8.243}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "done": false, "episodes_total": 313, "training_iteration": 41, "trial_id": "4bb30_00000", "date": "2024-04-27_18-33-18", "timestamp": 1714267998, "time_this_iter_s": 9.829239130020142, "time_total_s": 399.6762852668762, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 399.6762852668762, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 30.885714285714283, "ram_util_percent": 63.87857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.036870475994643, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0838051104913116, "policy_loss": -0.03436320382420735, "vf_loss": 2.112096456181939, "vf_explained_var": 0.26589228273719867, "kl": 0.013492990370819724, "entropy": 8.450384024138092, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 38595.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "sampler_results": {"episode_reward_max": -68.50100702885027, "episode_reward_min": -147.20888539672137, "episode_reward_mean": -110.65673793821112, "episode_len_mean": 427.59, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 42759, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-126.61621976038006, -108.24786509753702, -109.22560871831826, -110.12264486177142, -114.08329024804073, -110.07239939920728, -85.26246211376436, -125.5911982152164, -104.375435936821, -104.32731182627815, -106.71088721375789, -105.49425215971408, -127.45275508667528, -87.33622528719219, -116.89823679154925, -79.14790576381417, -107.80744813653455, -88.56477287852039, -94.09449837234887, -118.04270641943467, -70.58573169769718, -120.49794333342649, -106.16135135763388, -109.66154224681607, -115.85989168764651, -134.02767749115884, -135.07952144929695, -75.47727183077906, -112.98674648764171, -106.68817867885033, -131.5757485454958, -112.05600380511147, -118.60056792966711, -116.99882845008125, -74.79165308243324, -106.8970903844939, -139.27869205051599, -116.83294683099973, -134.93468967143133, -103.2133028934865, -125.02396694940948, -106.94857649453171, -70.87234399098405, -114.4429390068762, -107.97819470685535, -74.42999420536307, -128.41387730589562, -108.5314804589941, -115.91059448132354, -115.42542596427165, -106.80094522391819, -68.50100702885027, -140.1775371782054, -105.14493667388398, -108.29977580438617, -128.58374013653886, -109.75557378712918, -135.80315654027675, -110.97934508427046, -115.237382071505, -105.05871098732328, -111.93862545374161, -130.3178459243245, -107.05992151164823, -105.02368306042752, -105.97857513435993, -106.09090342071902, -108.4072053827035, -118.79263029582488, -108.31162806450887, -120.40559612334266, -106.56776184486785, -114.46149354648654, -103.58749061410937, -109.43185440131589, -102.3319802166354, -147.20888539672137, -113.92220041706413, -111.29559258890711, -114.47405552487758, -131.13543118011938, -109.60201140976201, -107.34037035808154, -105.2531035514238, -114.56658118286046, -115.919567731884, -106.12499932804518, -135.4520866801453, -119.73250339419644, -108.8972056200821, -114.00207814536058, -116.04492230889042, -125.3953688067707, -112.99181449688102, -108.90788428806204, -101.36193440639165, -82.74018697735794, -110.32834343545264, -108.44999907075739, -111.82046425366961], "episode_lengths": [73, 62, 78, 53, 60, 64, 1600, 119, 74, 38, 87, 51, 83, 1600, 67, 1600, 48, 1600, 1600, 1600, 1600, 68, 66, 64, 63, 192, 1600, 1600, 70, 94, 146, 64, 67, 44, 1600, 42, 143, 58, 1600, 89, 107, 103, 1600, 43, 59, 1600, 1600, 72, 77, 74, 64, 1600, 1600, 44, 54, 1600, 65, 1600, 55, 58, 108, 48, 1600, 62, 59, 68, 77, 45, 57, 48, 1600, 60, 93, 52, 68, 69, 456, 88, 42, 105, 1600, 65, 57, 76, 47, 61, 75, 177, 61, 66, 61, 1600, 104, 83, 80, 75, 1600, 47, 52, 65]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2880642120121342, "mean_inference_ms": 0.9553069560490463, "mean_action_processing_ms": 0.18678531972678478, "mean_env_wait_ms": 0.3878564168644704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006192207336425781, "StateBufferConnector_ms": 0.0045282840728759766, "ViewRequirementAgentConnector_ms": 0.11963772773742676}}, "episode_reward_max": -68.50100702885027, "episode_reward_min": -147.20888539672137, "episode_reward_mean": -110.65673793821112, "episode_len_mean": 427.59, "episodes_this_iter": 9, "episodes_timesteps_total": 42759, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-126.61621976038006, -108.24786509753702, -109.22560871831826, -110.12264486177142, -114.08329024804073, -110.07239939920728, -85.26246211376436, -125.5911982152164, -104.375435936821, -104.32731182627815, -106.71088721375789, -105.49425215971408, -127.45275508667528, -87.33622528719219, -116.89823679154925, -79.14790576381417, -107.80744813653455, -88.56477287852039, -94.09449837234887, -118.04270641943467, -70.58573169769718, -120.49794333342649, -106.16135135763388, -109.66154224681607, -115.85989168764651, -134.02767749115884, -135.07952144929695, -75.47727183077906, -112.98674648764171, -106.68817867885033, -131.5757485454958, -112.05600380511147, -118.60056792966711, -116.99882845008125, -74.79165308243324, -106.8970903844939, -139.27869205051599, -116.83294683099973, -134.93468967143133, -103.2133028934865, -125.02396694940948, -106.94857649453171, -70.87234399098405, -114.4429390068762, -107.97819470685535, -74.42999420536307, -128.41387730589562, -108.5314804589941, -115.91059448132354, -115.42542596427165, -106.80094522391819, -68.50100702885027, -140.1775371782054, -105.14493667388398, -108.29977580438617, -128.58374013653886, -109.75557378712918, -135.80315654027675, -110.97934508427046, -115.237382071505, -105.05871098732328, -111.93862545374161, -130.3178459243245, -107.05992151164823, -105.02368306042752, -105.97857513435993, -106.09090342071902, -108.4072053827035, -118.79263029582488, -108.31162806450887, -120.40559612334266, -106.56776184486785, -114.46149354648654, -103.58749061410937, -109.43185440131589, -102.3319802166354, -147.20888539672137, -113.92220041706413, -111.29559258890711, -114.47405552487758, -131.13543118011938, -109.60201140976201, -107.34037035808154, -105.2531035514238, -114.56658118286046, -115.919567731884, -106.12499932804518, -135.4520866801453, -119.73250339419644, -108.8972056200821, -114.00207814536058, -116.04492230889042, -125.3953688067707, -112.99181449688102, -108.90788428806204, -101.36193440639165, -82.74018697735794, -110.32834343545264, -108.44999907075739, -111.82046425366961], "episode_lengths": [73, 62, 78, 53, 60, 64, 1600, 119, 74, 38, 87, 51, 83, 1600, 67, 1600, 48, 1600, 1600, 1600, 1600, 68, 66, 64, 63, 192, 1600, 1600, 70, 94, 146, 64, 67, 44, 1600, 42, 143, 58, 1600, 89, 107, 103, 1600, 43, 59, 1600, 1600, 72, 77, 74, 64, 1600, 1600, 44, 54, 1600, 65, 1600, 55, 58, 108, 48, 1600, 62, 59, 68, 77, 45, 57, 48, 1600, 60, 93, 52, 68, 69, 456, 88, 42, 105, 1600, 65, 57, 76, 47, 61, 75, 177, 61, 66, 61, 1600, 104, 83, 80, 75, 1600, 47, 52, 65]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2880642120121342, "mean_inference_ms": 0.9553069560490463, "mean_action_processing_ms": 0.18678531972678478, "mean_env_wait_ms": 0.3878564168644704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006192207336425781, "StateBufferConnector_ms": 0.0045282840728759766, "ViewRequirementAgentConnector_ms": 0.11963772773742676}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 391.8853197192486, "num_env_steps_trained_throughput_per_sec": 391.8853197192486, "timesteps_total": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 10058.976, "restore_workers_time_ms": 0.014, "training_step_time_ms": 10058.935, "sample_time_ms": 3817.406, "load_time_ms": 0.464, "load_throughput": 8611649.728, "learn_time_ms": 6232.196, "learn_throughput": 641.828, "synch_weights_time_ms": 8.251}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "episodes_total": 322, "training_iteration": 42, "trial_id": "4bb30_00000", "date": "2024-04-27_18-33-29", "timestamp": 1714268009, "time_this_iter_s": 10.21164608001709, "time_total_s": 409.8879313468933, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 409.8879313468933, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 36.44285714285714, "ram_util_percent": 63.842857142857135}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.94006184256205, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1216899358364505, "policy_loss": -0.04968032125503786, "vf_loss": 2.160089597582657, "vf_explained_var": 0.3730881053273396, "kl": 0.025068085943740003, "entropy": 8.932948905165478, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 39525.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "sampler_results": {"episode_reward_max": -68.50100702885027, "episode_reward_min": -147.20888539672137, "episode_reward_mean": -110.48089807767875, "episode_len_mean": 442.65, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 44265, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-106.71088721375789, -105.49425215971408, -127.45275508667528, -87.33622528719219, -116.89823679154925, -79.14790576381417, -107.80744813653455, -88.56477287852039, -94.09449837234887, -118.04270641943467, -70.58573169769718, -120.49794333342649, -106.16135135763388, -109.66154224681607, -115.85989168764651, -134.02767749115884, -135.07952144929695, -75.47727183077906, -112.98674648764171, -106.68817867885033, -131.5757485454958, -112.05600380511147, -118.60056792966711, -116.99882845008125, -74.79165308243324, -106.8970903844939, -139.27869205051599, -116.83294683099973, -134.93468967143133, -103.2133028934865, -125.02396694940948, -106.94857649453171, -70.87234399098405, -114.4429390068762, -107.97819470685535, -74.42999420536307, -128.41387730589562, -108.5314804589941, -115.91059448132354, -115.42542596427165, -106.80094522391819, -68.50100702885027, -140.1775371782054, -105.14493667388398, -108.29977580438617, -128.58374013653886, -109.75557378712918, -135.80315654027675, -110.97934508427046, -115.237382071505, -105.05871098732328, -111.93862545374161, -130.3178459243245, -107.05992151164823, -105.02368306042752, -105.97857513435993, -106.09090342071902, -108.4072053827035, -118.79263029582488, -108.31162806450887, -120.40559612334266, -106.56776184486785, -114.46149354648654, -103.58749061410937, -109.43185440131589, -102.3319802166354, -147.20888539672137, -113.92220041706413, -111.29559258890711, -114.47405552487758, -131.13543118011938, -109.60201140976201, -107.34037035808154, -105.2531035514238, -114.56658118286046, -115.919567731884, -106.12499932804518, -135.4520866801453, -119.73250339419644, -108.8972056200821, -114.00207814536058, -116.04492230889042, -125.3953688067707, -112.99181449688102, -108.90788428806204, -101.36193440639165, -82.74018697735794, -110.32834343545264, -108.44999907075739, -111.82046425366961, -82.65581324347407, -109.00157471701131, -105.48914757838598, -103.83510714341887, -129.16959454146448, -111.15420099039811, -106.57041528891462, -108.80447647278446, -117.80663254004158, -105.85348760820429], "episode_lengths": [87, 51, 83, 1600, 67, 1600, 48, 1600, 1600, 1600, 1600, 68, 66, 64, 63, 192, 1600, 1600, 70, 94, 146, 64, 67, 44, 1600, 42, 143, 58, 1600, 89, 107, 103, 1600, 43, 59, 1600, 1600, 72, 77, 74, 64, 1600, 1600, 44, 54, 1600, 65, 1600, 55, 58, 108, 48, 1600, 62, 59, 68, 77, 45, 57, 48, 1600, 60, 93, 52, 68, 69, 456, 88, 42, 105, 1600, 65, 57, 76, 47, 61, 75, 177, 61, 66, 61, 1600, 104, 83, 80, 75, 1600, 47, 52, 65, 1600, 93, 90, 56, 1600, 45, 54, 59, 60, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.288573346256397, "mean_inference_ms": 0.9570718544835534, "mean_action_processing_ms": 0.18708787549356892, "mean_env_wait_ms": 0.3882277662942774, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006382465362548828, "StateBufferConnector_ms": 0.00465846061706543, "ViewRequirementAgentConnector_ms": 0.1236271858215332}}, "episode_reward_max": -68.50100702885027, "episode_reward_min": -147.20888539672137, "episode_reward_mean": -110.48089807767875, "episode_len_mean": 442.65, "episodes_this_iter": 10, "episodes_timesteps_total": 44265, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-106.71088721375789, -105.49425215971408, -127.45275508667528, -87.33622528719219, -116.89823679154925, -79.14790576381417, -107.80744813653455, -88.56477287852039, -94.09449837234887, -118.04270641943467, -70.58573169769718, -120.49794333342649, -106.16135135763388, -109.66154224681607, -115.85989168764651, -134.02767749115884, -135.07952144929695, -75.47727183077906, -112.98674648764171, -106.68817867885033, -131.5757485454958, -112.05600380511147, -118.60056792966711, -116.99882845008125, -74.79165308243324, -106.8970903844939, -139.27869205051599, -116.83294683099973, -134.93468967143133, -103.2133028934865, -125.02396694940948, -106.94857649453171, -70.87234399098405, -114.4429390068762, -107.97819470685535, -74.42999420536307, -128.41387730589562, -108.5314804589941, -115.91059448132354, -115.42542596427165, -106.80094522391819, -68.50100702885027, -140.1775371782054, -105.14493667388398, -108.29977580438617, -128.58374013653886, -109.75557378712918, -135.80315654027675, -110.97934508427046, -115.237382071505, -105.05871098732328, -111.93862545374161, -130.3178459243245, -107.05992151164823, -105.02368306042752, -105.97857513435993, -106.09090342071902, -108.4072053827035, -118.79263029582488, -108.31162806450887, -120.40559612334266, -106.56776184486785, -114.46149354648654, -103.58749061410937, -109.43185440131589, -102.3319802166354, -147.20888539672137, -113.92220041706413, -111.29559258890711, -114.47405552487758, -131.13543118011938, -109.60201140976201, -107.34037035808154, -105.2531035514238, -114.56658118286046, -115.919567731884, -106.12499932804518, -135.4520866801453, -119.73250339419644, -108.8972056200821, -114.00207814536058, -116.04492230889042, -125.3953688067707, -112.99181449688102, -108.90788428806204, -101.36193440639165, -82.74018697735794, -110.32834343545264, -108.44999907075739, -111.82046425366961, -82.65581324347407, -109.00157471701131, -105.48914757838598, -103.83510714341887, -129.16959454146448, -111.15420099039811, -106.57041528891462, -108.80447647278446, -117.80663254004158, -105.85348760820429], "episode_lengths": [87, 51, 83, 1600, 67, 1600, 48, 1600, 1600, 1600, 1600, 68, 66, 64, 63, 192, 1600, 1600, 70, 94, 146, 64, 67, 44, 1600, 42, 143, 58, 1600, 89, 107, 103, 1600, 43, 59, 1600, 1600, 72, 77, 74, 64, 1600, 1600, 44, 54, 1600, 65, 1600, 55, 58, 108, 48, 1600, 62, 59, 68, 77, 45, 57, 48, 1600, 60, 93, 52, 68, 69, 456, 88, 42, 105, 1600, 65, 57, 76, 47, 61, 75, 177, 61, 66, 61, 1600, 104, 83, 80, 75, 1600, 47, 52, 65, 1600, 93, 90, 56, 1600, 45, 54, 59, 60, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.288573346256397, "mean_inference_ms": 0.9570718544835534, "mean_action_processing_ms": 0.18708787549356892, "mean_env_wait_ms": 0.3882277662942774, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006382465362548828, "StateBufferConnector_ms": 0.00465846061706543, "ViewRequirementAgentConnector_ms": 0.1236271858215332}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 353.96783615835847, "num_env_steps_trained_throughput_per_sec": 353.96783615835847, "timesteps_total": 172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 172000, "timers": {"training_iteration_time_ms": 10227.711, "restore_workers_time_ms": 0.014, "training_step_time_ms": 10227.669, "sample_time_ms": 3902.892, "load_time_ms": 0.46, "load_throughput": 8695561.314, "learn_time_ms": 6315.3, "learn_throughput": 633.382, "synch_weights_time_ms": 8.399}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "done": false, "episodes_total": 332, "training_iteration": 43, "trial_id": "4bb30_00000", "date": "2024-04-27_18-33-40", "timestamp": 1714268020, "time_this_iter_s": 11.306017875671387, "time_total_s": 421.1939492225647, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 421.1939492225647, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 57.00625, "ram_util_percent": 63.875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.924511710482259, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5610471507295296, "policy_loss": -0.03481474390593908, "vf_loss": 2.588434342887773, "vf_explained_var": 0.2544985205896439, "kl": 0.011003781757667402, "entropy": 7.908230948704545, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 40455.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "sampler_results": {"episode_reward_max": -68.50100702885027, "episode_reward_min": -194.32339084698253, "episode_reward_mean": -112.07373875423553, "episode_len_mean": 440.05, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 44005, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-88.56477287852039, -94.09449837234887, -118.04270641943467, -70.58573169769718, -120.49794333342649, -106.16135135763388, -109.66154224681607, -115.85989168764651, -134.02767749115884, -135.07952144929695, -75.47727183077906, -112.98674648764171, -106.68817867885033, -131.5757485454958, -112.05600380511147, -118.60056792966711, -116.99882845008125, -74.79165308243324, -106.8970903844939, -139.27869205051599, -116.83294683099973, -134.93468967143133, -103.2133028934865, -125.02396694940948, -106.94857649453171, -70.87234399098405, -114.4429390068762, -107.97819470685535, -74.42999420536307, -128.41387730589562, -108.5314804589941, -115.91059448132354, -115.42542596427165, -106.80094522391819, -68.50100702885027, -140.1775371782054, -105.14493667388398, -108.29977580438617, -128.58374013653886, -109.75557378712918, -135.80315654027675, -110.97934508427046, -115.237382071505, -105.05871098732328, -111.93862545374161, -130.3178459243245, -107.05992151164823, -105.02368306042752, -105.97857513435993, -106.09090342071902, -108.4072053827035, -118.79263029582488, -108.31162806450887, -120.40559612334266, -106.56776184486785, -114.46149354648654, -103.58749061410937, -109.43185440131589, -102.3319802166354, -147.20888539672137, -113.92220041706413, -111.29559258890711, -114.47405552487758, -131.13543118011938, -109.60201140976201, -107.34037035808154, -105.2531035514238, -114.56658118286046, -115.919567731884, -106.12499932804518, -135.4520866801453, -119.73250339419644, -108.8972056200821, -114.00207814536058, -116.04492230889042, -125.3953688067707, -112.99181449688102, -108.90788428806204, -101.36193440639165, -82.74018697735794, -110.32834343545264, -108.44999907075739, -111.82046425366961, -82.65581324347407, -109.00157471701131, -105.48914757838598, -103.83510714341887, -129.16959454146448, -111.15420099039811, -106.57041528891462, -108.80447647278446, -117.80663254004158, -105.85348760820429, -120.72173031863531, -194.32339084698253, -123.84743354289047, -107.90513500382318, -107.60758833826334, -122.78584688601333, -112.94065315830832], "episode_lengths": [1600, 1600, 1600, 1600, 68, 66, 64, 63, 192, 1600, 1600, 70, 94, 146, 64, 67, 44, 1600, 42, 143, 58, 1600, 89, 107, 103, 1600, 43, 59, 1600, 1600, 72, 77, 74, 64, 1600, 1600, 44, 54, 1600, 65, 1600, 55, 58, 108, 48, 1600, 62, 59, 68, 77, 45, 57, 48, 1600, 60, 93, 52, 68, 69, 456, 88, 42, 105, 1600, 65, 57, 76, 47, 61, 75, 177, 61, 66, 61, 1600, 104, 83, 80, 75, 1600, 47, 52, 65, 1600, 93, 90, 56, 1600, 45, 54, 59, 60, 70, 1600, 1315, 85, 39, 90, 84, 63]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28895003961174465, "mean_inference_ms": 0.958291816219778, "mean_action_processing_ms": 0.1873089167791987, "mean_env_wait_ms": 0.3885058682973632, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006332874298095703, "StateBufferConnector_ms": 0.004645824432373047, "ViewRequirementAgentConnector_ms": 0.1233060359954834}}, "episode_reward_max": -68.50100702885027, "episode_reward_min": -194.32339084698253, "episode_reward_mean": -112.07373875423553, "episode_len_mean": 440.05, "episodes_this_iter": 7, "episodes_timesteps_total": 44005, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-88.56477287852039, -94.09449837234887, -118.04270641943467, -70.58573169769718, -120.49794333342649, -106.16135135763388, -109.66154224681607, -115.85989168764651, -134.02767749115884, -135.07952144929695, -75.47727183077906, -112.98674648764171, -106.68817867885033, -131.5757485454958, -112.05600380511147, -118.60056792966711, -116.99882845008125, -74.79165308243324, -106.8970903844939, -139.27869205051599, -116.83294683099973, -134.93468967143133, -103.2133028934865, -125.02396694940948, -106.94857649453171, -70.87234399098405, -114.4429390068762, -107.97819470685535, -74.42999420536307, -128.41387730589562, -108.5314804589941, -115.91059448132354, -115.42542596427165, -106.80094522391819, -68.50100702885027, -140.1775371782054, -105.14493667388398, -108.29977580438617, -128.58374013653886, -109.75557378712918, -135.80315654027675, -110.97934508427046, -115.237382071505, -105.05871098732328, -111.93862545374161, -130.3178459243245, -107.05992151164823, -105.02368306042752, -105.97857513435993, -106.09090342071902, -108.4072053827035, -118.79263029582488, -108.31162806450887, -120.40559612334266, -106.56776184486785, -114.46149354648654, -103.58749061410937, -109.43185440131589, -102.3319802166354, -147.20888539672137, -113.92220041706413, -111.29559258890711, -114.47405552487758, -131.13543118011938, -109.60201140976201, -107.34037035808154, -105.2531035514238, -114.56658118286046, -115.919567731884, -106.12499932804518, -135.4520866801453, -119.73250339419644, -108.8972056200821, -114.00207814536058, -116.04492230889042, -125.3953688067707, -112.99181449688102, -108.90788428806204, -101.36193440639165, -82.74018697735794, -110.32834343545264, -108.44999907075739, -111.82046425366961, -82.65581324347407, -109.00157471701131, -105.48914757838598, -103.83510714341887, -129.16959454146448, -111.15420099039811, -106.57041528891462, -108.80447647278446, -117.80663254004158, -105.85348760820429, -120.72173031863531, -194.32339084698253, -123.84743354289047, -107.90513500382318, -107.60758833826334, -122.78584688601333, -112.94065315830832], "episode_lengths": [1600, 1600, 1600, 1600, 68, 66, 64, 63, 192, 1600, 1600, 70, 94, 146, 64, 67, 44, 1600, 42, 143, 58, 1600, 89, 107, 103, 1600, 43, 59, 1600, 1600, 72, 77, 74, 64, 1600, 1600, 44, 54, 1600, 65, 1600, 55, 58, 108, 48, 1600, 62, 59, 68, 77, 45, 57, 48, 1600, 60, 93, 52, 68, 69, 456, 88, 42, 105, 1600, 65, 57, 76, 47, 61, 75, 177, 61, 66, 61, 1600, 104, 83, 80, 75, 1600, 47, 52, 65, 1600, 93, 90, 56, 1600, 45, 54, 59, 60, 70, 1600, 1315, 85, 39, 90, 84, 63]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28895003961174465, "mean_inference_ms": 0.958291816219778, "mean_action_processing_ms": 0.1873089167791987, "mean_env_wait_ms": 0.3885058682973632, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006332874298095703, "StateBufferConnector_ms": 0.004645824432373047, "ViewRequirementAgentConnector_ms": 0.1233060359954834}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 401.86937154782316, "num_env_steps_trained_throughput_per_sec": 401.86937154782316, "timesteps_total": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 10177.718, "restore_workers_time_ms": 0.015, "training_step_time_ms": 10177.674, "sample_time_ms": 3913.085, "load_time_ms": 0.467, "load_throughput": 8573802.126, "learn_time_ms": 6255.222, "learn_throughput": 639.466, "synch_weights_time_ms": 8.287}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "episodes_total": 339, "training_iteration": 44, "trial_id": "4bb30_00000", "date": "2024-04-27_18-33-50", "timestamp": 1714268030, "time_this_iter_s": 9.958060026168823, "time_total_s": 431.1520092487335, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 431.1520092487335, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 31.928571428571427, "ram_util_percent": 63.84999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.827100169145933, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2073222077951105, "policy_loss": -0.029287143894821725, "vf_loss": 1.2322965028866004, "vf_explained_var": 0.31826173643912037, "kl": 0.006389411027681242, "entropy": 8.256681140776603, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 41385.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": -68.50100702885027, "episode_reward_min": -194.32339084698253, "episode_reward_mean": -111.67066548431741, "episode_len_mean": 424.82, "episode_media": {}, "episodes_this_iter": 3, "episodes_timesteps_total": 42482, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-70.58573169769718, -120.49794333342649, -106.16135135763388, -109.66154224681607, -115.85989168764651, -134.02767749115884, -135.07952144929695, -75.47727183077906, -112.98674648764171, -106.68817867885033, -131.5757485454958, -112.05600380511147, -118.60056792966711, -116.99882845008125, -74.79165308243324, -106.8970903844939, -139.27869205051599, -116.83294683099973, -134.93468967143133, -103.2133028934865, -125.02396694940948, -106.94857649453171, -70.87234399098405, -114.4429390068762, -107.97819470685535, -74.42999420536307, -128.41387730589562, -108.5314804589941, -115.91059448132354, -115.42542596427165, -106.80094522391819, -68.50100702885027, -140.1775371782054, -105.14493667388398, -108.29977580438617, -128.58374013653886, -109.75557378712918, -135.80315654027675, -110.97934508427046, -115.237382071505, -105.05871098732328, -111.93862545374161, -130.3178459243245, -107.05992151164823, -105.02368306042752, -105.97857513435993, -106.09090342071902, -108.4072053827035, -118.79263029582488, -108.31162806450887, -120.40559612334266, -106.56776184486785, -114.46149354648654, -103.58749061410937, -109.43185440131589, -102.3319802166354, -147.20888539672137, -113.92220041706413, -111.29559258890711, -114.47405552487758, -131.13543118011938, -109.60201140976201, -107.34037035808154, -105.2531035514238, -114.56658118286046, -115.919567731884, -106.12499932804518, -135.4520866801453, -119.73250339419644, -108.8972056200821, -114.00207814536058, -116.04492230889042, -125.3953688067707, -112.99181449688102, -108.90788428806204, -101.36193440639165, -82.74018697735794, -110.32834343545264, -108.44999907075739, -111.82046425366961, -82.65581324347407, -109.00157471701131, -105.48914757838598, -103.83510714341887, -129.16959454146448, -111.15420099039811, -106.57041528891462, -108.80447647278446, -117.80663254004158, -105.85348760820429, -120.72173031863531, -194.32339084698253, -123.84743354289047, -107.90513500382318, -107.60758833826334, -122.78584688601333, -112.94065315830832, -79.31654056420992, -105.86337975599618, -75.21473035828602], "episode_lengths": [1600, 68, 66, 64, 63, 192, 1600, 1600, 70, 94, 146, 64, 67, 44, 1600, 42, 143, 58, 1600, 89, 107, 103, 1600, 43, 59, 1600, 1600, 72, 77, 74, 64, 1600, 1600, 44, 54, 1600, 65, 1600, 55, 58, 108, 48, 1600, 62, 59, 68, 77, 45, 57, 48, 1600, 60, 93, 52, 68, 69, 456, 88, 42, 105, 1600, 65, 57, 76, 47, 61, 75, 177, 61, 66, 61, 1600, 104, 83, 80, 75, 1600, 47, 52, 65, 1600, 93, 90, 56, 1600, 45, 54, 59, 60, 70, 1600, 1315, 85, 39, 90, 84, 63, 1600, 77, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2891204823984824, "mean_inference_ms": 0.9587864833361298, "mean_action_processing_ms": 0.18741068314843506, "mean_env_wait_ms": 0.38864179832464624, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006339311599731445, "StateBufferConnector_ms": 0.004649639129638672, "ViewRequirementAgentConnector_ms": 0.12337136268615723}}, "episode_reward_max": -68.50100702885027, "episode_reward_min": -194.32339084698253, "episode_reward_mean": -111.67066548431741, "episode_len_mean": 424.82, "episodes_this_iter": 3, "episodes_timesteps_total": 42482, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-70.58573169769718, -120.49794333342649, -106.16135135763388, -109.66154224681607, -115.85989168764651, -134.02767749115884, -135.07952144929695, -75.47727183077906, -112.98674648764171, -106.68817867885033, -131.5757485454958, -112.05600380511147, -118.60056792966711, -116.99882845008125, -74.79165308243324, -106.8970903844939, -139.27869205051599, -116.83294683099973, -134.93468967143133, -103.2133028934865, -125.02396694940948, -106.94857649453171, -70.87234399098405, -114.4429390068762, -107.97819470685535, -74.42999420536307, -128.41387730589562, -108.5314804589941, -115.91059448132354, -115.42542596427165, -106.80094522391819, -68.50100702885027, -140.1775371782054, -105.14493667388398, -108.29977580438617, -128.58374013653886, -109.75557378712918, -135.80315654027675, -110.97934508427046, -115.237382071505, -105.05871098732328, -111.93862545374161, -130.3178459243245, -107.05992151164823, -105.02368306042752, -105.97857513435993, -106.09090342071902, -108.4072053827035, -118.79263029582488, -108.31162806450887, -120.40559612334266, -106.56776184486785, -114.46149354648654, -103.58749061410937, -109.43185440131589, -102.3319802166354, -147.20888539672137, -113.92220041706413, -111.29559258890711, -114.47405552487758, -131.13543118011938, -109.60201140976201, -107.34037035808154, -105.2531035514238, -114.56658118286046, -115.919567731884, -106.12499932804518, -135.4520866801453, -119.73250339419644, -108.8972056200821, -114.00207814536058, -116.04492230889042, -125.3953688067707, -112.99181449688102, -108.90788428806204, -101.36193440639165, -82.74018697735794, -110.32834343545264, -108.44999907075739, -111.82046425366961, -82.65581324347407, -109.00157471701131, -105.48914757838598, -103.83510714341887, -129.16959454146448, -111.15420099039811, -106.57041528891462, -108.80447647278446, -117.80663254004158, -105.85348760820429, -120.72173031863531, -194.32339084698253, -123.84743354289047, -107.90513500382318, -107.60758833826334, -122.78584688601333, -112.94065315830832, -79.31654056420992, -105.86337975599618, -75.21473035828602], "episode_lengths": [1600, 68, 66, 64, 63, 192, 1600, 1600, 70, 94, 146, 64, 67, 44, 1600, 42, 143, 58, 1600, 89, 107, 103, 1600, 43, 59, 1600, 1600, 72, 77, 74, 64, 1600, 1600, 44, 54, 1600, 65, 1600, 55, 58, 108, 48, 1600, 62, 59, 68, 77, 45, 57, 48, 1600, 60, 93, 52, 68, 69, 456, 88, 42, 105, 1600, 65, 57, 76, 47, 61, 75, 177, 61, 66, 61, 1600, 104, 83, 80, 75, 1600, 47, 52, 65, 1600, 93, 90, 56, 1600, 45, 54, 59, 60, 70, 1600, 1315, 85, 39, 90, 84, 63, 1600, 77, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2891204823984824, "mean_inference_ms": 0.9587864833361298, "mean_action_processing_ms": 0.18741068314843506, "mean_env_wait_ms": 0.38864179832464624, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006339311599731445, "StateBufferConnector_ms": 0.004649639129638672, "ViewRequirementAgentConnector_ms": 0.12337136268615723}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 397.22580520057704, "num_env_steps_trained_throughput_per_sec": 397.22580520057704, "timesteps_total": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 10223.684, "restore_workers_time_ms": 0.015, "training_step_time_ms": 10223.639, "sample_time_ms": 3919.686, "load_time_ms": 0.473, "load_throughput": 8449018.482, "learn_time_ms": 6294.554, "learn_throughput": 635.47, "synch_weights_time_ms": 8.306}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 342, "training_iteration": 45, "trial_id": "4bb30_00000", "date": "2024-04-27_18-34-00", "timestamp": 1714268040, "time_this_iter_s": 10.074671030044556, "time_total_s": 441.2266802787781, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 441.2266802787781, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 31.100000000000005, "ram_util_percent": 63.81333333333331}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.374676472140898, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.061572734795646, "policy_loss": -0.03831553504031192, "vf_loss": 2.093356347757001, "vf_explained_var": 0.28258442846677634, "kl": 0.009676945771979004, "entropy": 8.413398132016582, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 42315.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "sampler_results": {"episode_reward_max": -68.50100702885027, "episode_reward_min": -194.32339084698253, "episode_reward_mean": -111.65762720084709, "episode_len_mean": 454.29, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 45429, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-135.07952144929695, -75.47727183077906, -112.98674648764171, -106.68817867885033, -131.5757485454958, -112.05600380511147, -118.60056792966711, -116.99882845008125, -74.79165308243324, -106.8970903844939, -139.27869205051599, -116.83294683099973, -134.93468967143133, -103.2133028934865, -125.02396694940948, -106.94857649453171, -70.87234399098405, -114.4429390068762, -107.97819470685535, -74.42999420536307, -128.41387730589562, -108.5314804589941, -115.91059448132354, -115.42542596427165, -106.80094522391819, -68.50100702885027, -140.1775371782054, -105.14493667388398, -108.29977580438617, -128.58374013653886, -109.75557378712918, -135.80315654027675, -110.97934508427046, -115.237382071505, -105.05871098732328, -111.93862545374161, -130.3178459243245, -107.05992151164823, -105.02368306042752, -105.97857513435993, -106.09090342071902, -108.4072053827035, -118.79263029582488, -108.31162806450887, -120.40559612334266, -106.56776184486785, -114.46149354648654, -103.58749061410937, -109.43185440131589, -102.3319802166354, -147.20888539672137, -113.92220041706413, -111.29559258890711, -114.47405552487758, -131.13543118011938, -109.60201140976201, -107.34037035808154, -105.2531035514238, -114.56658118286046, -115.919567731884, -106.12499932804518, -135.4520866801453, -119.73250339419644, -108.8972056200821, -114.00207814536058, -116.04492230889042, -125.3953688067707, -112.99181449688102, -108.90788428806204, -101.36193440639165, -82.74018697735794, -110.32834343545264, -108.44999907075739, -111.82046425366961, -82.65581324347407, -109.00157471701131, -105.48914757838598, -103.83510714341887, -129.16959454146448, -111.15420099039811, -106.57041528891462, -108.80447647278446, -117.80663254004158, -105.85348760820429, -120.72173031863531, -194.32339084698253, -123.84743354289047, -107.90513500382318, -107.60758833826334, -122.78584688601333, -112.94065315830832, -79.31654056420992, -105.86337975599618, -75.21473035828602, -104.07371726521275, -104.15195112087515, -113.94316373250012, -142.1401249247553, -119.49946157418253, -71.68189084982127], "episode_lengths": [1600, 1600, 70, 94, 146, 64, 67, 44, 1600, 42, 143, 58, 1600, 89, 107, 103, 1600, 43, 59, 1600, 1600, 72, 77, 74, 64, 1600, 1600, 44, 54, 1600, 65, 1600, 55, 58, 108, 48, 1600, 62, 59, 68, 77, 45, 57, 48, 1600, 60, 93, 52, 68, 69, 456, 88, 42, 105, 1600, 65, 57, 76, 47, 61, 75, 177, 61, 66, 61, 1600, 104, 83, 80, 75, 1600, 47, 52, 65, 1600, 93, 90, 56, 1600, 45, 54, 59, 60, 70, 1600, 1315, 85, 39, 90, 84, 63, 1600, 77, 1600, 1600, 80, 60, 1600, 60, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2893936862024314, "mean_inference_ms": 0.9600320322727753, "mean_action_processing_ms": 0.18758512529724594, "mean_env_wait_ms": 0.38881005601896823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00631403923034668, "StateBufferConnector_ms": 0.0046422481536865234, "ViewRequirementAgentConnector_ms": 0.12380576133728027}}, "episode_reward_max": -68.50100702885027, "episode_reward_min": -194.32339084698253, "episode_reward_mean": -111.65762720084709, "episode_len_mean": 454.29, "episodes_this_iter": 6, "episodes_timesteps_total": 45429, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-135.07952144929695, -75.47727183077906, -112.98674648764171, -106.68817867885033, -131.5757485454958, -112.05600380511147, -118.60056792966711, -116.99882845008125, -74.79165308243324, -106.8970903844939, -139.27869205051599, -116.83294683099973, -134.93468967143133, -103.2133028934865, -125.02396694940948, -106.94857649453171, -70.87234399098405, -114.4429390068762, -107.97819470685535, -74.42999420536307, -128.41387730589562, -108.5314804589941, -115.91059448132354, -115.42542596427165, -106.80094522391819, -68.50100702885027, -140.1775371782054, -105.14493667388398, -108.29977580438617, -128.58374013653886, -109.75557378712918, -135.80315654027675, -110.97934508427046, -115.237382071505, -105.05871098732328, -111.93862545374161, -130.3178459243245, -107.05992151164823, -105.02368306042752, -105.97857513435993, -106.09090342071902, -108.4072053827035, -118.79263029582488, -108.31162806450887, -120.40559612334266, -106.56776184486785, -114.46149354648654, -103.58749061410937, -109.43185440131589, -102.3319802166354, -147.20888539672137, -113.92220041706413, -111.29559258890711, -114.47405552487758, -131.13543118011938, -109.60201140976201, -107.34037035808154, -105.2531035514238, -114.56658118286046, -115.919567731884, -106.12499932804518, -135.4520866801453, -119.73250339419644, -108.8972056200821, -114.00207814536058, -116.04492230889042, -125.3953688067707, -112.99181449688102, -108.90788428806204, -101.36193440639165, -82.74018697735794, -110.32834343545264, -108.44999907075739, -111.82046425366961, -82.65581324347407, -109.00157471701131, -105.48914757838598, -103.83510714341887, -129.16959454146448, -111.15420099039811, -106.57041528891462, -108.80447647278446, -117.80663254004158, -105.85348760820429, -120.72173031863531, -194.32339084698253, -123.84743354289047, -107.90513500382318, -107.60758833826334, -122.78584688601333, -112.94065315830832, -79.31654056420992, -105.86337975599618, -75.21473035828602, -104.07371726521275, -104.15195112087515, -113.94316373250012, -142.1401249247553, -119.49946157418253, -71.68189084982127], "episode_lengths": [1600, 1600, 70, 94, 146, 64, 67, 44, 1600, 42, 143, 58, 1600, 89, 107, 103, 1600, 43, 59, 1600, 1600, 72, 77, 74, 64, 1600, 1600, 44, 54, 1600, 65, 1600, 55, 58, 108, 48, 1600, 62, 59, 68, 77, 45, 57, 48, 1600, 60, 93, 52, 68, 69, 456, 88, 42, 105, 1600, 65, 57, 76, 47, 61, 75, 177, 61, 66, 61, 1600, 104, 83, 80, 75, 1600, 47, 52, 65, 1600, 93, 90, 56, 1600, 45, 54, 59, 60, 70, 1600, 1315, 85, 39, 90, 84, 63, 1600, 77, 1600, 1600, 80, 60, 1600, 60, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2893936862024314, "mean_inference_ms": 0.9600320322727753, "mean_action_processing_ms": 0.18758512529724594, "mean_env_wait_ms": 0.38881005601896823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00631403923034668, "StateBufferConnector_ms": 0.0046422481536865234, "ViewRequirementAgentConnector_ms": 0.12380576133728027}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 401.58283402814544, "num_env_steps_trained_throughput_per_sec": 401.58283402814544, "timesteps_total": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 10123.82, "restore_workers_time_ms": 0.015, "training_step_time_ms": 10123.772, "sample_time_ms": 3858.696, "load_time_ms": 0.508, "load_throughput": 7876997.042, "learn_time_ms": 6255.432, "learn_throughput": 639.444, "synch_weights_time_ms": 8.47}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "episodes_total": 348, "training_iteration": 46, "trial_id": "4bb30_00000", "date": "2024-04-27_18-34-10", "timestamp": 1714268050, "time_this_iter_s": 9.965095043182373, "time_total_s": 451.19177532196045, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 451.19177532196045, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 31.642857142857142, "ram_util_percent": 63.79999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.87850396171693, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.7280928632354624, "policy_loss": -0.043191260227593044, "vf_loss": 3.762321010488336, "vf_explained_var": 0.21488256640331718, "kl": 0.01327866919302884, "entropy": 10.643756996688023, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 43245.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "sampler_results": {"episode_reward_max": -68.50100702885027, "episode_reward_min": -194.32339084698253, "episode_reward_mean": -112.61396307960617, "episode_len_mean": 455.37, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 45537, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-116.83294683099973, -134.93468967143133, -103.2133028934865, -125.02396694940948, -106.94857649453171, -70.87234399098405, -114.4429390068762, -107.97819470685535, -74.42999420536307, -128.41387730589562, -108.5314804589941, -115.91059448132354, -115.42542596427165, -106.80094522391819, -68.50100702885027, -140.1775371782054, -105.14493667388398, -108.29977580438617, -128.58374013653886, -109.75557378712918, -135.80315654027675, -110.97934508427046, -115.237382071505, -105.05871098732328, -111.93862545374161, -130.3178459243245, -107.05992151164823, -105.02368306042752, -105.97857513435993, -106.09090342071902, -108.4072053827035, -118.79263029582488, -108.31162806450887, -120.40559612334266, -106.56776184486785, -114.46149354648654, -103.58749061410937, -109.43185440131589, -102.3319802166354, -147.20888539672137, -113.92220041706413, -111.29559258890711, -114.47405552487758, -131.13543118011938, -109.60201140976201, -107.34037035808154, -105.2531035514238, -114.56658118286046, -115.919567731884, -106.12499932804518, -135.4520866801453, -119.73250339419644, -108.8972056200821, -114.00207814536058, -116.04492230889042, -125.3953688067707, -112.99181449688102, -108.90788428806204, -101.36193440639165, -82.74018697735794, -110.32834343545264, -108.44999907075739, -111.82046425366961, -82.65581324347407, -109.00157471701131, -105.48914757838598, -103.83510714341887, -129.16959454146448, -111.15420099039811, -106.57041528891462, -108.80447647278446, -117.80663254004158, -105.85348760820429, -120.72173031863531, -194.32339084698253, -123.84743354289047, -107.90513500382318, -107.60758833826334, -122.78584688601333, -112.94065315830832, -79.31654056420992, -105.86337975599618, -75.21473035828602, -104.07371726521275, -104.15195112087515, -113.94316373250012, -142.1401249247553, -119.49946157418253, -71.68189084982127, -127.4077298487154, -104.22469015577435, -135.25513430602098, -106.48931538720058, -105.46927715086441, -123.13518638017449, -135.84190664967358, -117.81027904600589, -109.85173654468792, -116.45519471728988, -144.12344038386703], "episode_lengths": [58, 1600, 89, 107, 103, 1600, 43, 59, 1600, 1600, 72, 77, 74, 64, 1600, 1600, 44, 54, 1600, 65, 1600, 55, 58, 108, 48, 1600, 62, 59, 68, 77, 45, 57, 48, 1600, 60, 93, 52, 68, 69, 456, 88, 42, 105, 1600, 65, 57, 76, 47, 61, 75, 177, 61, 66, 61, 1600, 104, 83, 80, 75, 1600, 47, 52, 65, 1600, 93, 90, 56, 1600, 45, 54, 59, 60, 70, 1600, 1315, 85, 39, 90, 84, 63, 1600, 77, 1600, 1600, 80, 60, 1600, 60, 1600, 1600, 73, 168, 68, 57, 1600, 1600, 77, 38, 51, 246]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28982075851664996, "mean_inference_ms": 0.9614904173332337, "mean_action_processing_ms": 0.18786471742616723, "mean_env_wait_ms": 0.3891458814725526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006288290023803711, "StateBufferConnector_ms": 0.004466056823730469, "ViewRequirementAgentConnector_ms": 0.12173914909362793}}, "episode_reward_max": -68.50100702885027, "episode_reward_min": -194.32339084698253, "episode_reward_mean": -112.61396307960617, "episode_len_mean": 455.37, "episodes_this_iter": 11, "episodes_timesteps_total": 45537, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-116.83294683099973, -134.93468967143133, -103.2133028934865, -125.02396694940948, -106.94857649453171, -70.87234399098405, -114.4429390068762, -107.97819470685535, -74.42999420536307, -128.41387730589562, -108.5314804589941, -115.91059448132354, -115.42542596427165, -106.80094522391819, -68.50100702885027, -140.1775371782054, -105.14493667388398, -108.29977580438617, -128.58374013653886, -109.75557378712918, -135.80315654027675, -110.97934508427046, -115.237382071505, -105.05871098732328, -111.93862545374161, -130.3178459243245, -107.05992151164823, -105.02368306042752, -105.97857513435993, -106.09090342071902, -108.4072053827035, -118.79263029582488, -108.31162806450887, -120.40559612334266, -106.56776184486785, -114.46149354648654, -103.58749061410937, -109.43185440131589, -102.3319802166354, -147.20888539672137, -113.92220041706413, -111.29559258890711, -114.47405552487758, -131.13543118011938, -109.60201140976201, -107.34037035808154, -105.2531035514238, -114.56658118286046, -115.919567731884, -106.12499932804518, -135.4520866801453, -119.73250339419644, -108.8972056200821, -114.00207814536058, -116.04492230889042, -125.3953688067707, -112.99181449688102, -108.90788428806204, -101.36193440639165, -82.74018697735794, -110.32834343545264, -108.44999907075739, -111.82046425366961, -82.65581324347407, -109.00157471701131, -105.48914757838598, -103.83510714341887, -129.16959454146448, -111.15420099039811, -106.57041528891462, -108.80447647278446, -117.80663254004158, -105.85348760820429, -120.72173031863531, -194.32339084698253, -123.84743354289047, -107.90513500382318, -107.60758833826334, -122.78584688601333, -112.94065315830832, -79.31654056420992, -105.86337975599618, -75.21473035828602, -104.07371726521275, -104.15195112087515, -113.94316373250012, -142.1401249247553, -119.49946157418253, -71.68189084982127, -127.4077298487154, -104.22469015577435, -135.25513430602098, -106.48931538720058, -105.46927715086441, -123.13518638017449, -135.84190664967358, -117.81027904600589, -109.85173654468792, -116.45519471728988, -144.12344038386703], "episode_lengths": [58, 1600, 89, 107, 103, 1600, 43, 59, 1600, 1600, 72, 77, 74, 64, 1600, 1600, 44, 54, 1600, 65, 1600, 55, 58, 108, 48, 1600, 62, 59, 68, 77, 45, 57, 48, 1600, 60, 93, 52, 68, 69, 456, 88, 42, 105, 1600, 65, 57, 76, 47, 61, 75, 177, 61, 66, 61, 1600, 104, 83, 80, 75, 1600, 47, 52, 65, 1600, 93, 90, 56, 1600, 45, 54, 59, 60, 70, 1600, 1315, 85, 39, 90, 84, 63, 1600, 77, 1600, 1600, 80, 60, 1600, 60, 1600, 1600, 73, 168, 68, 57, 1600, 1600, 77, 38, 51, 246]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28982075851664996, "mean_inference_ms": 0.9614904173332337, "mean_action_processing_ms": 0.18786471742616723, "mean_env_wait_ms": 0.3891458814725526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006288290023803711, "StateBufferConnector_ms": 0.004466056823730469, "ViewRequirementAgentConnector_ms": 0.12173914909362793}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 401.23487968800464, "num_env_steps_trained_throughput_per_sec": 401.23487968800464, "timesteps_total": 188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 188000, "timers": {"training_iteration_time_ms": 10111.095, "restore_workers_time_ms": 0.015, "training_step_time_ms": 10111.046, "sample_time_ms": 3860.804, "load_time_ms": 0.511, "load_throughput": 7829210.882, "learn_time_ms": 6240.943, "learn_throughput": 640.929, "synch_weights_time_ms": 8.157}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "done": false, "episodes_total": 359, "training_iteration": 47, "trial_id": "4bb30_00000", "date": "2024-04-27_18-34-20", "timestamp": 1714268060, "time_this_iter_s": 9.974165201187134, "time_total_s": 461.1659405231476, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 461.1659405231476, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 32.66428571428572, "ram_util_percent": 63.85714285714284}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.429345708380463, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.99603018364118, "policy_loss": -0.04185177805202622, "vf_loss": 3.0259150183128734, "vf_explained_var": 0.23707420261957313, "kl": 0.01772879431122897, "entropy": 9.47777702423834, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 44175.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "sampler_results": {"episode_reward_max": -68.50100702885027, "episode_reward_min": -194.32339084698253, "episode_reward_mean": -112.82219736676167, "episode_len_mean": 410.19, "episode_media": {}, "episodes_this_iter": 14, "episodes_timesteps_total": 41019, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-68.50100702885027, -140.1775371782054, -105.14493667388398, -108.29977580438617, -128.58374013653886, -109.75557378712918, -135.80315654027675, -110.97934508427046, -115.237382071505, -105.05871098732328, -111.93862545374161, -130.3178459243245, -107.05992151164823, -105.02368306042752, -105.97857513435993, -106.09090342071902, -108.4072053827035, -118.79263029582488, -108.31162806450887, -120.40559612334266, -106.56776184486785, -114.46149354648654, -103.58749061410937, -109.43185440131589, -102.3319802166354, -147.20888539672137, -113.92220041706413, -111.29559258890711, -114.47405552487758, -131.13543118011938, -109.60201140976201, -107.34037035808154, -105.2531035514238, -114.56658118286046, -115.919567731884, -106.12499932804518, -135.4520866801453, -119.73250339419644, -108.8972056200821, -114.00207814536058, -116.04492230889042, -125.3953688067707, -112.99181449688102, -108.90788428806204, -101.36193440639165, -82.74018697735794, -110.32834343545264, -108.44999907075739, -111.82046425366961, -82.65581324347407, -109.00157471701131, -105.48914757838598, -103.83510714341887, -129.16959454146448, -111.15420099039811, -106.57041528891462, -108.80447647278446, -117.80663254004158, -105.85348760820429, -120.72173031863531, -194.32339084698253, -123.84743354289047, -107.90513500382318, -107.60758833826334, -122.78584688601333, -112.94065315830832, -79.31654056420992, -105.86337975599618, -75.21473035828602, -104.07371726521275, -104.15195112087515, -113.94316373250012, -142.1401249247553, -119.49946157418253, -71.68189084982127, -127.4077298487154, -104.22469015577435, -135.25513430602098, -106.48931538720058, -105.46927715086441, -123.13518638017449, -135.84190664967358, -117.81027904600589, -109.85173654468792, -116.45519471728988, -144.12344038386703, -109.5010015869091, -112.59304169055012, -106.88099847922288, -104.99902512108412, -116.97286871387189, -107.72949738825051, -132.38890899702648, -106.6413203956547, -85.43775501473179, -120.41935443517255, -107.02163737601725, -111.23635936427179, -119.918512470151, -108.84242586697391], "episode_lengths": [1600, 1600, 44, 54, 1600, 65, 1600, 55, 58, 108, 48, 1600, 62, 59, 68, 77, 45, 57, 48, 1600, 60, 93, 52, 68, 69, 456, 88, 42, 105, 1600, 65, 57, 76, 47, 61, 75, 177, 61, 66, 61, 1600, 104, 83, 80, 75, 1600, 47, 52, 65, 1600, 93, 90, 56, 1600, 45, 54, 59, 60, 70, 1600, 1315, 85, 39, 90, 84, 63, 1600, 77, 1600, 1600, 80, 60, 1600, 60, 1600, 1600, 73, 168, 68, 57, 1600, 1600, 77, 38, 51, 246, 63, 48, 63, 88, 49, 55, 185, 68, 1600, 123, 71, 43, 76, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29037721365171093, "mean_inference_ms": 0.9629420220423844, "mean_action_processing_ms": 0.18819559876696892, "mean_env_wait_ms": 0.38960388922460887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006307840347290039, "StateBufferConnector_ms": 0.004403591156005859, "ViewRequirementAgentConnector_ms": 0.12285280227661133}}, "episode_reward_max": -68.50100702885027, "episode_reward_min": -194.32339084698253, "episode_reward_mean": -112.82219736676167, "episode_len_mean": 410.19, "episodes_this_iter": 14, "episodes_timesteps_total": 41019, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-68.50100702885027, -140.1775371782054, -105.14493667388398, -108.29977580438617, -128.58374013653886, -109.75557378712918, -135.80315654027675, -110.97934508427046, -115.237382071505, -105.05871098732328, -111.93862545374161, -130.3178459243245, -107.05992151164823, -105.02368306042752, -105.97857513435993, -106.09090342071902, -108.4072053827035, -118.79263029582488, -108.31162806450887, -120.40559612334266, -106.56776184486785, -114.46149354648654, -103.58749061410937, -109.43185440131589, -102.3319802166354, -147.20888539672137, -113.92220041706413, -111.29559258890711, -114.47405552487758, -131.13543118011938, -109.60201140976201, -107.34037035808154, -105.2531035514238, -114.56658118286046, -115.919567731884, -106.12499932804518, -135.4520866801453, -119.73250339419644, -108.8972056200821, -114.00207814536058, -116.04492230889042, -125.3953688067707, -112.99181449688102, -108.90788428806204, -101.36193440639165, -82.74018697735794, -110.32834343545264, -108.44999907075739, -111.82046425366961, -82.65581324347407, -109.00157471701131, -105.48914757838598, -103.83510714341887, -129.16959454146448, -111.15420099039811, -106.57041528891462, -108.80447647278446, -117.80663254004158, -105.85348760820429, -120.72173031863531, -194.32339084698253, -123.84743354289047, -107.90513500382318, -107.60758833826334, -122.78584688601333, -112.94065315830832, -79.31654056420992, -105.86337975599618, -75.21473035828602, -104.07371726521275, -104.15195112087515, -113.94316373250012, -142.1401249247553, -119.49946157418253, -71.68189084982127, -127.4077298487154, -104.22469015577435, -135.25513430602098, -106.48931538720058, -105.46927715086441, -123.13518638017449, -135.84190664967358, -117.81027904600589, -109.85173654468792, -116.45519471728988, -144.12344038386703, -109.5010015869091, -112.59304169055012, -106.88099847922288, -104.99902512108412, -116.97286871387189, -107.72949738825051, -132.38890899702648, -106.6413203956547, -85.43775501473179, -120.41935443517255, -107.02163737601725, -111.23635936427179, -119.918512470151, -108.84242586697391], "episode_lengths": [1600, 1600, 44, 54, 1600, 65, 1600, 55, 58, 108, 48, 1600, 62, 59, 68, 77, 45, 57, 48, 1600, 60, 93, 52, 68, 69, 456, 88, 42, 105, 1600, 65, 57, 76, 47, 61, 75, 177, 61, 66, 61, 1600, 104, 83, 80, 75, 1600, 47, 52, 65, 1600, 93, 90, 56, 1600, 45, 54, 59, 60, 70, 1600, 1315, 85, 39, 90, 84, 63, 1600, 77, 1600, 1600, 80, 60, 1600, 60, 1600, 1600, 73, 168, 68, 57, 1600, 1600, 77, 38, 51, 246, 63, 48, 63, 88, 49, 55, 185, 68, 1600, 123, 71, 43, 76, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29037721365171093, "mean_inference_ms": 0.9629420220423844, "mean_action_processing_ms": 0.18819559876696892, "mean_env_wait_ms": 0.38960388922460887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006307840347290039, "StateBufferConnector_ms": 0.004403591156005859, "ViewRequirementAgentConnector_ms": 0.12285280227661133}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 402.8478529736882, "num_env_steps_trained_throughput_per_sec": 402.8478529736882, "timesteps_total": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 10112.827, "restore_workers_time_ms": 0.015, "training_step_time_ms": 10112.778, "sample_time_ms": 3864.022, "load_time_ms": 0.505, "load_throughput": 7920880.034, "learn_time_ms": 6239.448, "learn_throughput": 641.082, "synch_weights_time_ms": 8.174}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "episodes_total": 373, "training_iteration": 48, "trial_id": "4bb30_00000", "date": "2024-04-27_18-34-30", "timestamp": 1714268070, "time_this_iter_s": 9.93453598022461, "time_total_s": 471.1004765033722, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 471.1004765033722, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 31.56428571428571, "ram_util_percent": 63.807142857142836}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.542197111665562, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.9376559542494536, "policy_loss": -0.030753017160841212, "vf_loss": 2.963451597286809, "vf_explained_var": 0.3102758458865586, "kl": 0.007344255453617772, "entropy": 10.133760213339201, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 45105.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "sampler_results": {"episode_reward_max": -71.68189084982127, "episode_reward_min": -194.32339084698253, "episode_reward_mean": -113.01119726471825, "episode_len_mean": 395.25, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 39525, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-111.93862545374161, -130.3178459243245, -107.05992151164823, -105.02368306042752, -105.97857513435993, -106.09090342071902, -108.4072053827035, -118.79263029582488, -108.31162806450887, -120.40559612334266, -106.56776184486785, -114.46149354648654, -103.58749061410937, -109.43185440131589, -102.3319802166354, -147.20888539672137, -113.92220041706413, -111.29559258890711, -114.47405552487758, -131.13543118011938, -109.60201140976201, -107.34037035808154, -105.2531035514238, -114.56658118286046, -115.919567731884, -106.12499932804518, -135.4520866801453, -119.73250339419644, -108.8972056200821, -114.00207814536058, -116.04492230889042, -125.3953688067707, -112.99181449688102, -108.90788428806204, -101.36193440639165, -82.74018697735794, -110.32834343545264, -108.44999907075739, -111.82046425366961, -82.65581324347407, -109.00157471701131, -105.48914757838598, -103.83510714341887, -129.16959454146448, -111.15420099039811, -106.57041528891462, -108.80447647278446, -117.80663254004158, -105.85348760820429, -120.72173031863531, -194.32339084698253, -123.84743354289047, -107.90513500382318, -107.60758833826334, -122.78584688601333, -112.94065315830832, -79.31654056420992, -105.86337975599618, -75.21473035828602, -104.07371726521275, -104.15195112087515, -113.94316373250012, -142.1401249247553, -119.49946157418253, -71.68189084982127, -127.4077298487154, -104.22469015577435, -135.25513430602098, -106.48931538720058, -105.46927715086441, -123.13518638017449, -135.84190664967358, -117.81027904600589, -109.85173654468792, -116.45519471728988, -144.12344038386703, -109.5010015869091, -112.59304169055012, -106.88099847922288, -104.99902512108412, -116.97286871387189, -107.72949738825051, -132.38890899702648, -106.6413203956547, -85.43775501473179, -120.41935443517255, -107.02163737601725, -111.23635936427179, -119.918512470151, -108.84242586697391, -84.34828797295629, -108.47606817803283, -133.13893411616758, -108.70058738060855, -115.33707291548575, -123.79102404567973, -142.01141749789235, -116.54825406421784, -107.75149732037137, -106.33801159661884], "episode_lengths": [48, 1600, 62, 59, 68, 77, 45, 57, 48, 1600, 60, 93, 52, 68, 69, 456, 88, 42, 105, 1600, 65, 57, 76, 47, 61, 75, 177, 61, 66, 61, 1600, 104, 83, 80, 75, 1600, 47, 52, 65, 1600, 93, 90, 56, 1600, 45, 54, 59, 60, 70, 1600, 1315, 85, 39, 90, 84, 63, 1600, 77, 1600, 1600, 80, 60, 1600, 60, 1600, 1600, 73, 168, 68, 57, 1600, 1600, 77, 38, 51, 246, 63, 48, 63, 88, 49, 55, 185, 68, 1600, 123, 71, 43, 76, 96, 1600, 53, 1600, 80, 46, 106, 1600, 56, 81, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.290702269054975, "mean_inference_ms": 0.9640787623962419, "mean_action_processing_ms": 0.18837985532784132, "mean_env_wait_ms": 0.38979769308084683, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006307125091552734, "StateBufferConnector_ms": 0.004417896270751953, "ViewRequirementAgentConnector_ms": 0.1231989860534668}}, "episode_reward_max": -71.68189084982127, "episode_reward_min": -194.32339084698253, "episode_reward_mean": -113.01119726471825, "episode_len_mean": 395.25, "episodes_this_iter": 10, "episodes_timesteps_total": 39525, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-111.93862545374161, -130.3178459243245, -107.05992151164823, -105.02368306042752, -105.97857513435993, -106.09090342071902, -108.4072053827035, -118.79263029582488, -108.31162806450887, -120.40559612334266, -106.56776184486785, -114.46149354648654, -103.58749061410937, -109.43185440131589, -102.3319802166354, -147.20888539672137, -113.92220041706413, -111.29559258890711, -114.47405552487758, -131.13543118011938, -109.60201140976201, -107.34037035808154, -105.2531035514238, -114.56658118286046, -115.919567731884, -106.12499932804518, -135.4520866801453, -119.73250339419644, -108.8972056200821, -114.00207814536058, -116.04492230889042, -125.3953688067707, -112.99181449688102, -108.90788428806204, -101.36193440639165, -82.74018697735794, -110.32834343545264, -108.44999907075739, -111.82046425366961, -82.65581324347407, -109.00157471701131, -105.48914757838598, -103.83510714341887, -129.16959454146448, -111.15420099039811, -106.57041528891462, -108.80447647278446, -117.80663254004158, -105.85348760820429, -120.72173031863531, -194.32339084698253, -123.84743354289047, -107.90513500382318, -107.60758833826334, -122.78584688601333, -112.94065315830832, -79.31654056420992, -105.86337975599618, -75.21473035828602, -104.07371726521275, -104.15195112087515, -113.94316373250012, -142.1401249247553, -119.49946157418253, -71.68189084982127, -127.4077298487154, -104.22469015577435, -135.25513430602098, -106.48931538720058, -105.46927715086441, -123.13518638017449, -135.84190664967358, -117.81027904600589, -109.85173654468792, -116.45519471728988, -144.12344038386703, -109.5010015869091, -112.59304169055012, -106.88099847922288, -104.99902512108412, -116.97286871387189, -107.72949738825051, -132.38890899702648, -106.6413203956547, -85.43775501473179, -120.41935443517255, -107.02163737601725, -111.23635936427179, -119.918512470151, -108.84242586697391, -84.34828797295629, -108.47606817803283, -133.13893411616758, -108.70058738060855, -115.33707291548575, -123.79102404567973, -142.01141749789235, -116.54825406421784, -107.75149732037137, -106.33801159661884], "episode_lengths": [48, 1600, 62, 59, 68, 77, 45, 57, 48, 1600, 60, 93, 52, 68, 69, 456, 88, 42, 105, 1600, 65, 57, 76, 47, 61, 75, 177, 61, 66, 61, 1600, 104, 83, 80, 75, 1600, 47, 52, 65, 1600, 93, 90, 56, 1600, 45, 54, 59, 60, 70, 1600, 1315, 85, 39, 90, 84, 63, 1600, 77, 1600, 1600, 80, 60, 1600, 60, 1600, 1600, 73, 168, 68, 57, 1600, 1600, 77, 38, 51, 246, 63, 48, 63, 88, 49, 55, 185, 68, 1600, 123, 71, 43, 76, 96, 1600, 53, 1600, 80, 46, 106, 1600, 56, 81, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.290702269054975, "mean_inference_ms": 0.9640787623962419, "mean_action_processing_ms": 0.18837985532784132, "mean_env_wait_ms": 0.38979769308084683, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006307125091552734, "StateBufferConnector_ms": 0.004417896270751953, "ViewRequirementAgentConnector_ms": 0.1231989860534668}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 402.3021351568621, "num_env_steps_trained_throughput_per_sec": 402.3021351568621, "timesteps_total": 196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 196000, "timers": {"training_iteration_time_ms": 10118.33, "restore_workers_time_ms": 0.015, "training_step_time_ms": 10118.281, "sample_time_ms": 3870.987, "load_time_ms": 0.479, "load_throughput": 8356019.524, "learn_time_ms": 6238.052, "learn_throughput": 641.226, "synch_weights_time_ms": 8.137}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "done": false, "episodes_total": 383, "training_iteration": 49, "trial_id": "4bb30_00000", "date": "2024-04-27_18-34-40", "timestamp": 1714268080, "time_this_iter_s": 9.947712898254395, "time_total_s": 481.0481894016266, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 481.0481894016266, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 32.285714285714285, "ram_util_percent": 63.828571428571415}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.262235775301534, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.245299435127464, "policy_loss": -0.020919727533054287, "vf_loss": 1.263412063472694, "vf_explained_var": 0.3251189188931578, "kl": 0.004158683605018948, "entropy": 7.819088048319663, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 46035.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "sampler_results": {"episode_reward_max": -71.68189084982127, "episode_reward_min": -194.32339084698253, "episode_reward_mean": -112.66748555436423, "episode_len_mean": 410.72, "episode_media": {}, "episodes_this_iter": 3, "episodes_timesteps_total": 41072, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-105.02368306042752, -105.97857513435993, -106.09090342071902, -108.4072053827035, -118.79263029582488, -108.31162806450887, -120.40559612334266, -106.56776184486785, -114.46149354648654, -103.58749061410937, -109.43185440131589, -102.3319802166354, -147.20888539672137, -113.92220041706413, -111.29559258890711, -114.47405552487758, -131.13543118011938, -109.60201140976201, -107.34037035808154, -105.2531035514238, -114.56658118286046, -115.919567731884, -106.12499932804518, -135.4520866801453, -119.73250339419644, -108.8972056200821, -114.00207814536058, -116.04492230889042, -125.3953688067707, -112.99181449688102, -108.90788428806204, -101.36193440639165, -82.74018697735794, -110.32834343545264, -108.44999907075739, -111.82046425366961, -82.65581324347407, -109.00157471701131, -105.48914757838598, -103.83510714341887, -129.16959454146448, -111.15420099039811, -106.57041528891462, -108.80447647278446, -117.80663254004158, -105.85348760820429, -120.72173031863531, -194.32339084698253, -123.84743354289047, -107.90513500382318, -107.60758833826334, -122.78584688601333, -112.94065315830832, -79.31654056420992, -105.86337975599618, -75.21473035828602, -104.07371726521275, -104.15195112087515, -113.94316373250012, -142.1401249247553, -119.49946157418253, -71.68189084982127, -127.4077298487154, -104.22469015577435, -135.25513430602098, -106.48931538720058, -105.46927715086441, -123.13518638017449, -135.84190664967358, -117.81027904600589, -109.85173654468792, -116.45519471728988, -144.12344038386703, -109.5010015869091, -112.59304169055012, -106.88099847922288, -104.99902512108412, -116.97286871387189, -107.72949738825051, -132.38890899702648, -106.6413203956547, -85.43775501473179, -120.41935443517255, -107.02163737601725, -111.23635936427179, -119.918512470151, -108.84242586697391, -84.34828797295629, -108.47606817803283, -133.13893411616758, -108.70058738060855, -115.33707291548575, -123.79102404567973, -142.01141749789235, -116.54825406421784, -107.75149732037137, -106.33801159661884, -105.91336169075656, -135.45944015112764, -73.57242001242322], "episode_lengths": [59, 68, 77, 45, 57, 48, 1600, 60, 93, 52, 68, 69, 456, 88, 42, 105, 1600, 65, 57, 76, 47, 61, 75, 177, 61, 66, 61, 1600, 104, 83, 80, 75, 1600, 47, 52, 65, 1600, 93, 90, 56, 1600, 45, 54, 59, 60, 70, 1600, 1315, 85, 39, 90, 84, 63, 1600, 77, 1600, 1600, 80, 60, 1600, 60, 1600, 1600, 73, 168, 68, 57, 1600, 1600, 77, 38, 51, 246, 63, 48, 63, 88, 49, 55, 185, 68, 1600, 123, 71, 43, 76, 96, 1600, 53, 1600, 80, 46, 106, 1600, 56, 81, 68, 57, 1600, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29082403482199004, "mean_inference_ms": 0.9642895370173095, "mean_action_processing_ms": 0.1884498773984976, "mean_env_wait_ms": 0.38991669088696423, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006317853927612305, "StateBufferConnector_ms": 0.0044176578521728516, "ViewRequirementAgentConnector_ms": 0.12332653999328613}}, "episode_reward_max": -71.68189084982127, "episode_reward_min": -194.32339084698253, "episode_reward_mean": -112.66748555436423, "episode_len_mean": 410.72, "episodes_this_iter": 3, "episodes_timesteps_total": 41072, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-105.02368306042752, -105.97857513435993, -106.09090342071902, -108.4072053827035, -118.79263029582488, -108.31162806450887, -120.40559612334266, -106.56776184486785, -114.46149354648654, -103.58749061410937, -109.43185440131589, -102.3319802166354, -147.20888539672137, -113.92220041706413, -111.29559258890711, -114.47405552487758, -131.13543118011938, -109.60201140976201, -107.34037035808154, -105.2531035514238, -114.56658118286046, -115.919567731884, -106.12499932804518, -135.4520866801453, -119.73250339419644, -108.8972056200821, -114.00207814536058, -116.04492230889042, -125.3953688067707, -112.99181449688102, -108.90788428806204, -101.36193440639165, -82.74018697735794, -110.32834343545264, -108.44999907075739, -111.82046425366961, -82.65581324347407, -109.00157471701131, -105.48914757838598, -103.83510714341887, -129.16959454146448, -111.15420099039811, -106.57041528891462, -108.80447647278446, -117.80663254004158, -105.85348760820429, -120.72173031863531, -194.32339084698253, -123.84743354289047, -107.90513500382318, -107.60758833826334, -122.78584688601333, -112.94065315830832, -79.31654056420992, -105.86337975599618, -75.21473035828602, -104.07371726521275, -104.15195112087515, -113.94316373250012, -142.1401249247553, -119.49946157418253, -71.68189084982127, -127.4077298487154, -104.22469015577435, -135.25513430602098, -106.48931538720058, -105.46927715086441, -123.13518638017449, -135.84190664967358, -117.81027904600589, -109.85173654468792, -116.45519471728988, -144.12344038386703, -109.5010015869091, -112.59304169055012, -106.88099847922288, -104.99902512108412, -116.97286871387189, -107.72949738825051, -132.38890899702648, -106.6413203956547, -85.43775501473179, -120.41935443517255, -107.02163737601725, -111.23635936427179, -119.918512470151, -108.84242586697391, -84.34828797295629, -108.47606817803283, -133.13893411616758, -108.70058738060855, -115.33707291548575, -123.79102404567973, -142.01141749789235, -116.54825406421784, -107.75149732037137, -106.33801159661884, -105.91336169075656, -135.45944015112764, -73.57242001242322], "episode_lengths": [59, 68, 77, 45, 57, 48, 1600, 60, 93, 52, 68, 69, 456, 88, 42, 105, 1600, 65, 57, 76, 47, 61, 75, 177, 61, 66, 61, 1600, 104, 83, 80, 75, 1600, 47, 52, 65, 1600, 93, 90, 56, 1600, 45, 54, 59, 60, 70, 1600, 1315, 85, 39, 90, 84, 63, 1600, 77, 1600, 1600, 80, 60, 1600, 60, 1600, 1600, 73, 168, 68, 57, 1600, 1600, 77, 38, 51, 246, 63, 48, 63, 88, 49, 55, 185, 68, 1600, 123, 71, 43, 76, 96, 1600, 53, 1600, 80, 46, 106, 1600, 56, 81, 68, 57, 1600, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29082403482199004, "mean_inference_ms": 0.9642895370173095, "mean_action_processing_ms": 0.1884498773984976, "mean_env_wait_ms": 0.38991669088696423, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006317853927612305, "StateBufferConnector_ms": 0.0044176578521728516, "ViewRequirementAgentConnector_ms": 0.12332653999328613}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 400.62377778129064, "num_env_steps_trained_throughput_per_sec": 400.62377778129064, "timesteps_total": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 10114.107, "restore_workers_time_ms": 0.014, "training_step_time_ms": 10114.058, "sample_time_ms": 3860.881, "load_time_ms": 0.48, "load_throughput": 8327814.951, "learn_time_ms": 6244.082, "learn_throughput": 640.607, "synch_weights_time_ms": 7.998}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "episodes_total": 386, "training_iteration": 50, "trial_id": "4bb30_00000", "date": "2024-04-27_18-34-50", "timestamp": 1714268090, "time_this_iter_s": 9.989435911178589, "time_total_s": 491.0376253128052, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 491.0376253128052, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 35.24285714285714, "ram_util_percent": 63.8642857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.176737224671148, "cur_kl_coeff": 0.3375000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.48507594133386767, "policy_loss": -0.02286504835906809, "vf_loss": 0.5035610826665996, "vf_explained_var": 0.37254266835028127, "kl": 0.012977497336905085, "entropy": 6.0998698121757915, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 46965.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "sampler_results": {"episode_reward_max": -71.68189084982127, "episode_reward_min": -194.32339084698253, "episode_reward_mean": -112.1956896056628, "episode_len_mean": 441.45, "episode_media": {}, "episodes_this_iter": 2, "episodes_timesteps_total": 44145, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-106.09090342071902, -108.4072053827035, -118.79263029582488, -108.31162806450887, -120.40559612334266, -106.56776184486785, -114.46149354648654, -103.58749061410937, -109.43185440131589, -102.3319802166354, -147.20888539672137, -113.92220041706413, -111.29559258890711, -114.47405552487758, -131.13543118011938, -109.60201140976201, -107.34037035808154, -105.2531035514238, -114.56658118286046, -115.919567731884, -106.12499932804518, -135.4520866801453, -119.73250339419644, -108.8972056200821, -114.00207814536058, -116.04492230889042, -125.3953688067707, -112.99181449688102, -108.90788428806204, -101.36193440639165, -82.74018697735794, -110.32834343545264, -108.44999907075739, -111.82046425366961, -82.65581324347407, -109.00157471701131, -105.48914757838598, -103.83510714341887, -129.16959454146448, -111.15420099039811, -106.57041528891462, -108.80447647278446, -117.80663254004158, -105.85348760820429, -120.72173031863531, -194.32339084698253, -123.84743354289047, -107.90513500382318, -107.60758833826334, -122.78584688601333, -112.94065315830832, -79.31654056420992, -105.86337975599618, -75.21473035828602, -104.07371726521275, -104.15195112087515, -113.94316373250012, -142.1401249247553, -119.49946157418253, -71.68189084982127, -127.4077298487154, -104.22469015577435, -135.25513430602098, -106.48931538720058, -105.46927715086441, -123.13518638017449, -135.84190664967358, -117.81027904600589, -109.85173654468792, -116.45519471728988, -144.12344038386703, -109.5010015869091, -112.59304169055012, -106.88099847922288, -104.99902512108412, -116.97286871387189, -107.72949738825051, -132.38890899702648, -106.6413203956547, -85.43775501473179, -120.41935443517255, -107.02163737601725, -111.23635936427179, -119.918512470151, -108.84242586697391, -84.34828797295629, -108.47606817803283, -133.13893411616758, -108.70058738060855, -115.33707291548575, -123.79102404567973, -142.01141749789235, -116.54825406421784, -107.75149732037137, -106.33801159661884, -105.91336169075656, -135.45944015112764, -73.57242001242322, -79.48607322502706, -84.33659009961904], "episode_lengths": [77, 45, 57, 48, 1600, 60, 93, 52, 68, 69, 456, 88, 42, 105, 1600, 65, 57, 76, 47, 61, 75, 177, 61, 66, 61, 1600, 104, 83, 80, 75, 1600, 47, 52, 65, 1600, 93, 90, 56, 1600, 45, 54, 59, 60, 70, 1600, 1315, 85, 39, 90, 84, 63, 1600, 77, 1600, 1600, 80, 60, 1600, 60, 1600, 1600, 73, 168, 68, 57, 1600, 1600, 77, 38, 51, 246, 63, 48, 63, 88, 49, 55, 185, 68, 1600, 123, 71, 43, 76, 96, 1600, 53, 1600, 80, 46, 106, 1600, 56, 81, 68, 57, 1600, 1600, 1600, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2909096846472339, "mean_inference_ms": 0.9644076062032242, "mean_action_processing_ms": 0.1885009911357799, "mean_env_wait_ms": 0.39001213908417504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006318569183349609, "StateBufferConnector_ms": 0.00439906120300293, "ViewRequirementAgentConnector_ms": 0.12265729904174805}}, "episode_reward_max": -71.68189084982127, "episode_reward_min": -194.32339084698253, "episode_reward_mean": -112.1956896056628, "episode_len_mean": 441.45, "episodes_this_iter": 2, "episodes_timesteps_total": 44145, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-106.09090342071902, -108.4072053827035, -118.79263029582488, -108.31162806450887, -120.40559612334266, -106.56776184486785, -114.46149354648654, -103.58749061410937, -109.43185440131589, -102.3319802166354, -147.20888539672137, -113.92220041706413, -111.29559258890711, -114.47405552487758, -131.13543118011938, -109.60201140976201, -107.34037035808154, -105.2531035514238, -114.56658118286046, -115.919567731884, -106.12499932804518, -135.4520866801453, -119.73250339419644, -108.8972056200821, -114.00207814536058, -116.04492230889042, -125.3953688067707, -112.99181449688102, -108.90788428806204, -101.36193440639165, -82.74018697735794, -110.32834343545264, -108.44999907075739, -111.82046425366961, -82.65581324347407, -109.00157471701131, -105.48914757838598, -103.83510714341887, -129.16959454146448, -111.15420099039811, -106.57041528891462, -108.80447647278446, -117.80663254004158, -105.85348760820429, -120.72173031863531, -194.32339084698253, -123.84743354289047, -107.90513500382318, -107.60758833826334, -122.78584688601333, -112.94065315830832, -79.31654056420992, -105.86337975599618, -75.21473035828602, -104.07371726521275, -104.15195112087515, -113.94316373250012, -142.1401249247553, -119.49946157418253, -71.68189084982127, -127.4077298487154, -104.22469015577435, -135.25513430602098, -106.48931538720058, -105.46927715086441, -123.13518638017449, -135.84190664967358, -117.81027904600589, -109.85173654468792, -116.45519471728988, -144.12344038386703, -109.5010015869091, -112.59304169055012, -106.88099847922288, -104.99902512108412, -116.97286871387189, -107.72949738825051, -132.38890899702648, -106.6413203956547, -85.43775501473179, -120.41935443517255, -107.02163737601725, -111.23635936427179, -119.918512470151, -108.84242586697391, -84.34828797295629, -108.47606817803283, -133.13893411616758, -108.70058738060855, -115.33707291548575, -123.79102404567973, -142.01141749789235, -116.54825406421784, -107.75149732037137, -106.33801159661884, -105.91336169075656, -135.45944015112764, -73.57242001242322, -79.48607322502706, -84.33659009961904], "episode_lengths": [77, 45, 57, 48, 1600, 60, 93, 52, 68, 69, 456, 88, 42, 105, 1600, 65, 57, 76, 47, 61, 75, 177, 61, 66, 61, 1600, 104, 83, 80, 75, 1600, 47, 52, 65, 1600, 93, 90, 56, 1600, 45, 54, 59, 60, 70, 1600, 1315, 85, 39, 90, 84, 63, 1600, 77, 1600, 1600, 80, 60, 1600, 60, 1600, 1600, 73, 168, 68, 57, 1600, 1600, 77, 38, 51, 246, 63, 48, 63, 88, 49, 55, 185, 68, 1600, 123, 71, 43, 76, 96, 1600, 53, 1600, 80, 46, 106, 1600, 56, 81, 68, 57, 1600, 1600, 1600, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2909096846472339, "mean_inference_ms": 0.9644076062032242, "mean_action_processing_ms": 0.1885009911357799, "mean_env_wait_ms": 0.39001213908417504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006318569183349609, "StateBufferConnector_ms": 0.00439906120300293, "ViewRequirementAgentConnector_ms": 0.12265729904174805}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 402.7389448418704, "num_env_steps_trained_throughput_per_sec": 402.7389448418704, "timesteps_total": 204000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 204000, "timers": {"training_iteration_time_ms": 10124.927, "restore_workers_time_ms": 0.014, "training_step_time_ms": 10124.88, "sample_time_ms": 3858.573, "load_time_ms": 0.482, "load_throughput": 8300210.755, "learn_time_ms": 6257.085, "learn_throughput": 639.275, "synch_weights_time_ms": 8.091}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "done": false, "episodes_total": 388, "training_iteration": 51, "trial_id": "4bb30_00000", "date": "2024-04-27_18-35-00", "timestamp": 1714268100, "time_this_iter_s": 9.936949014663696, "time_total_s": 500.9745743274689, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 500.9745743274689, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 31.22857142857143, "ram_util_percent": 63.8642857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.116215266335395, "cur_kl_coeff": 0.3375000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8676564324709777, "policy_loss": -0.02307453668095492, "vf_loss": 0.8864616652329763, "vf_explained_var": 0.3613973755349395, "kl": 0.012649802793756569, "entropy": 6.169118173148043, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 47895.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "sampler_results": {"episode_reward_max": -71.68189084982127, "episode_reward_min": -194.32339084698253, "episode_reward_mean": -111.9163601967832, "episode_len_mean": 472.23, "episode_media": {}, "episodes_this_iter": 2, "episodes_timesteps_total": 47223, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-118.79263029582488, -108.31162806450887, -120.40559612334266, -106.56776184486785, -114.46149354648654, -103.58749061410937, -109.43185440131589, -102.3319802166354, -147.20888539672137, -113.92220041706413, -111.29559258890711, -114.47405552487758, -131.13543118011938, -109.60201140976201, -107.34037035808154, -105.2531035514238, -114.56658118286046, -115.919567731884, -106.12499932804518, -135.4520866801453, -119.73250339419644, -108.8972056200821, -114.00207814536058, -116.04492230889042, -125.3953688067707, -112.99181449688102, -108.90788428806204, -101.36193440639165, -82.74018697735794, -110.32834343545264, -108.44999907075739, -111.82046425366961, -82.65581324347407, -109.00157471701131, -105.48914757838598, -103.83510714341887, -129.16959454146448, -111.15420099039811, -106.57041528891462, -108.80447647278446, -117.80663254004158, -105.85348760820429, -120.72173031863531, -194.32339084698253, -123.84743354289047, -107.90513500382318, -107.60758833826334, -122.78584688601333, -112.94065315830832, -79.31654056420992, -105.86337975599618, -75.21473035828602, -104.07371726521275, -104.15195112087515, -113.94316373250012, -142.1401249247553, -119.49946157418253, -71.68189084982127, -127.4077298487154, -104.22469015577435, -135.25513430602098, -106.48931538720058, -105.46927715086441, -123.13518638017449, -135.84190664967358, -117.81027904600589, -109.85173654468792, -116.45519471728988, -144.12344038386703, -109.5010015869091, -112.59304169055012, -106.88099847922288, -104.99902512108412, -116.97286871387189, -107.72949738825051, -132.38890899702648, -106.6413203956547, -85.43775501473179, -120.41935443517255, -107.02163737601725, -111.23635936427179, -119.918512470151, -108.84242586697391, -84.34828797295629, -108.47606817803283, -133.13893411616758, -108.70058738060855, -115.33707291548575, -123.79102404567973, -142.01141749789235, -116.54825406421784, -107.75149732037137, -106.33801159661884, -105.91336169075656, -135.45944015112764, -73.57242001242322, -79.48607322502706, -84.33659009961904, -89.57854080046147, -96.98662711500242], "episode_lengths": [57, 48, 1600, 60, 93, 52, 68, 69, 456, 88, 42, 105, 1600, 65, 57, 76, 47, 61, 75, 177, 61, 66, 61, 1600, 104, 83, 80, 75, 1600, 47, 52, 65, 1600, 93, 90, 56, 1600, 45, 54, 59, 60, 70, 1600, 1315, 85, 39, 90, 84, 63, 1600, 77, 1600, 1600, 80, 60, 1600, 60, 1600, 1600, 73, 168, 68, 57, 1600, 1600, 77, 38, 51, 246, 63, 48, 63, 88, 49, 55, 185, 68, 1600, 123, 71, 43, 76, 96, 1600, 53, 1600, 80, 46, 106, 1600, 56, 81, 68, 57, 1600, 1600, 1600, 1600, 1600, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2909946540673267, "mean_inference_ms": 0.9645337619839789, "mean_action_processing_ms": 0.18855385636134195, "mean_env_wait_ms": 0.3901102166609814, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006238460540771484, "StateBufferConnector_ms": 0.004378557205200195, "ViewRequirementAgentConnector_ms": 0.12225484848022461}}, "episode_reward_max": -71.68189084982127, "episode_reward_min": -194.32339084698253, "episode_reward_mean": -111.9163601967832, "episode_len_mean": 472.23, "episodes_this_iter": 2, "episodes_timesteps_total": 47223, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-118.79263029582488, -108.31162806450887, -120.40559612334266, -106.56776184486785, -114.46149354648654, -103.58749061410937, -109.43185440131589, -102.3319802166354, -147.20888539672137, -113.92220041706413, -111.29559258890711, -114.47405552487758, -131.13543118011938, -109.60201140976201, -107.34037035808154, -105.2531035514238, -114.56658118286046, -115.919567731884, -106.12499932804518, -135.4520866801453, -119.73250339419644, -108.8972056200821, -114.00207814536058, -116.04492230889042, -125.3953688067707, -112.99181449688102, -108.90788428806204, -101.36193440639165, -82.74018697735794, -110.32834343545264, -108.44999907075739, -111.82046425366961, -82.65581324347407, -109.00157471701131, -105.48914757838598, -103.83510714341887, -129.16959454146448, -111.15420099039811, -106.57041528891462, -108.80447647278446, -117.80663254004158, -105.85348760820429, -120.72173031863531, -194.32339084698253, -123.84743354289047, -107.90513500382318, -107.60758833826334, -122.78584688601333, -112.94065315830832, -79.31654056420992, -105.86337975599618, -75.21473035828602, -104.07371726521275, -104.15195112087515, -113.94316373250012, -142.1401249247553, -119.49946157418253, -71.68189084982127, -127.4077298487154, -104.22469015577435, -135.25513430602098, -106.48931538720058, -105.46927715086441, -123.13518638017449, -135.84190664967358, -117.81027904600589, -109.85173654468792, -116.45519471728988, -144.12344038386703, -109.5010015869091, -112.59304169055012, -106.88099847922288, -104.99902512108412, -116.97286871387189, -107.72949738825051, -132.38890899702648, -106.6413203956547, -85.43775501473179, -120.41935443517255, -107.02163737601725, -111.23635936427179, -119.918512470151, -108.84242586697391, -84.34828797295629, -108.47606817803283, -133.13893411616758, -108.70058738060855, -115.33707291548575, -123.79102404567973, -142.01141749789235, -116.54825406421784, -107.75149732037137, -106.33801159661884, -105.91336169075656, -135.45944015112764, -73.57242001242322, -79.48607322502706, -84.33659009961904, -89.57854080046147, -96.98662711500242], "episode_lengths": [57, 48, 1600, 60, 93, 52, 68, 69, 456, 88, 42, 105, 1600, 65, 57, 76, 47, 61, 75, 177, 61, 66, 61, 1600, 104, 83, 80, 75, 1600, 47, 52, 65, 1600, 93, 90, 56, 1600, 45, 54, 59, 60, 70, 1600, 1315, 85, 39, 90, 84, 63, 1600, 77, 1600, 1600, 80, 60, 1600, 60, 1600, 1600, 73, 168, 68, 57, 1600, 1600, 77, 38, 51, 246, 63, 48, 63, 88, 49, 55, 185, 68, 1600, 123, 71, 43, 76, 96, 1600, 53, 1600, 80, 46, 106, 1600, 56, 81, 68, 57, 1600, 1600, 1600, 1600, 1600, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2909946540673267, "mean_inference_ms": 0.9645337619839789, "mean_action_processing_ms": 0.18855385636134195, "mean_env_wait_ms": 0.3901102166609814, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006238460540771484, "StateBufferConnector_ms": 0.004378557205200195, "ViewRequirementAgentConnector_ms": 0.12225484848022461}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 403.5370042902043, "num_env_steps_trained_throughput_per_sec": 403.5370042902043, "timesteps_total": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 10095.456, "restore_workers_time_ms": 0.014, "training_step_time_ms": 10095.409, "sample_time_ms": 3860.971, "load_time_ms": 0.478, "load_throughput": 8371446.535, "learn_time_ms": 6225.288, "learn_throughput": 642.541, "synch_weights_time_ms": 8.037}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "episodes_total": 390, "training_iteration": 52, "trial_id": "4bb30_00000", "date": "2024-04-27_18-35-10", "timestamp": 1714268110, "time_this_iter_s": 9.916500091552734, "time_total_s": 510.8910744190216, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 510.8910744190216, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 31.764285714285716, "ram_util_percent": 63.87142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.05657966111296, "cur_kl_coeff": 0.3375000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.160441833278302, "policy_loss": -0.0378067103444889, "vf_loss": 2.193512742005048, "vf_explained_var": 0.21711045990708053, "kl": 0.014032025216866263, "entropy": 9.982201312177924, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 48825.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "sampler_results": {"episode_reward_max": -71.68189084982127, "episode_reward_min": -194.32339084698253, "episode_reward_mean": -111.21393531043195, "episode_len_mean": 487.59, "episode_media": {}, "episodes_this_iter": 8, "episodes_timesteps_total": 48759, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-147.20888539672137, -113.92220041706413, -111.29559258890711, -114.47405552487758, -131.13543118011938, -109.60201140976201, -107.34037035808154, -105.2531035514238, -114.56658118286046, -115.919567731884, -106.12499932804518, -135.4520866801453, -119.73250339419644, -108.8972056200821, -114.00207814536058, -116.04492230889042, -125.3953688067707, -112.99181449688102, -108.90788428806204, -101.36193440639165, -82.74018697735794, -110.32834343545264, -108.44999907075739, -111.82046425366961, -82.65581324347407, -109.00157471701131, -105.48914757838598, -103.83510714341887, -129.16959454146448, -111.15420099039811, -106.57041528891462, -108.80447647278446, -117.80663254004158, -105.85348760820429, -120.72173031863531, -194.32339084698253, -123.84743354289047, -107.90513500382318, -107.60758833826334, -122.78584688601333, -112.94065315830832, -79.31654056420992, -105.86337975599618, -75.21473035828602, -104.07371726521275, -104.15195112087515, -113.94316373250012, -142.1401249247553, -119.49946157418253, -71.68189084982127, -127.4077298487154, -104.22469015577435, -135.25513430602098, -106.48931538720058, -105.46927715086441, -123.13518638017449, -135.84190664967358, -117.81027904600589, -109.85173654468792, -116.45519471728988, -144.12344038386703, -109.5010015869091, -112.59304169055012, -106.88099847922288, -104.99902512108412, -116.97286871387189, -107.72949738825051, -132.38890899702648, -106.6413203956547, -85.43775501473179, -120.41935443517255, -107.02163737601725, -111.23635936427179, -119.918512470151, -108.84242586697391, -84.34828797295629, -108.47606817803283, -133.13893411616758, -108.70058738060855, -115.33707291548575, -123.79102404567973, -142.01141749789235, -116.54825406421784, -107.75149732037137, -106.33801159661884, -105.91336169075656, -135.45944015112764, -73.57242001242322, -79.48607322502706, -84.33659009961904, -89.57854080046147, -96.98662711500242, -74.48033455020187, -78.71513056871729, -122.21994188169515, -100.67730562980474, -106.85288879845167, -104.28540795155243, -106.88622486308032, -119.53071222846086], "episode_lengths": [456, 88, 42, 105, 1600, 65, 57, 76, 47, 61, 75, 177, 61, 66, 61, 1600, 104, 83, 80, 75, 1600, 47, 52, 65, 1600, 93, 90, 56, 1600, 45, 54, 59, 60, 70, 1600, 1315, 85, 39, 90, 84, 63, 1600, 77, 1600, 1600, 80, 60, 1600, 60, 1600, 1600, 73, 168, 68, 57, 1600, 1600, 77, 38, 51, 246, 63, 48, 63, 88, 49, 55, 185, 68, 1600, 123, 71, 43, 76, 96, 1600, 53, 1600, 80, 46, 106, 1600, 56, 81, 68, 57, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 92, 57, 58, 57, 47, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29113179967127706, "mean_inference_ms": 0.9656992822643599, "mean_action_processing_ms": 0.1886637363539625, "mean_env_wait_ms": 0.3901509107573131, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006218433380126953, "StateBufferConnector_ms": 0.0043718814849853516, "ViewRequirementAgentConnector_ms": 0.12259054183959961}}, "episode_reward_max": -71.68189084982127, "episode_reward_min": -194.32339084698253, "episode_reward_mean": -111.21393531043195, "episode_len_mean": 487.59, "episodes_this_iter": 8, "episodes_timesteps_total": 48759, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-147.20888539672137, -113.92220041706413, -111.29559258890711, -114.47405552487758, -131.13543118011938, -109.60201140976201, -107.34037035808154, -105.2531035514238, -114.56658118286046, -115.919567731884, -106.12499932804518, -135.4520866801453, -119.73250339419644, -108.8972056200821, -114.00207814536058, -116.04492230889042, -125.3953688067707, -112.99181449688102, -108.90788428806204, -101.36193440639165, -82.74018697735794, -110.32834343545264, -108.44999907075739, -111.82046425366961, -82.65581324347407, -109.00157471701131, -105.48914757838598, -103.83510714341887, -129.16959454146448, -111.15420099039811, -106.57041528891462, -108.80447647278446, -117.80663254004158, -105.85348760820429, -120.72173031863531, -194.32339084698253, -123.84743354289047, -107.90513500382318, -107.60758833826334, -122.78584688601333, -112.94065315830832, -79.31654056420992, -105.86337975599618, -75.21473035828602, -104.07371726521275, -104.15195112087515, -113.94316373250012, -142.1401249247553, -119.49946157418253, -71.68189084982127, -127.4077298487154, -104.22469015577435, -135.25513430602098, -106.48931538720058, -105.46927715086441, -123.13518638017449, -135.84190664967358, -117.81027904600589, -109.85173654468792, -116.45519471728988, -144.12344038386703, -109.5010015869091, -112.59304169055012, -106.88099847922288, -104.99902512108412, -116.97286871387189, -107.72949738825051, -132.38890899702648, -106.6413203956547, -85.43775501473179, -120.41935443517255, -107.02163737601725, -111.23635936427179, -119.918512470151, -108.84242586697391, -84.34828797295629, -108.47606817803283, -133.13893411616758, -108.70058738060855, -115.33707291548575, -123.79102404567973, -142.01141749789235, -116.54825406421784, -107.75149732037137, -106.33801159661884, -105.91336169075656, -135.45944015112764, -73.57242001242322, -79.48607322502706, -84.33659009961904, -89.57854080046147, -96.98662711500242, -74.48033455020187, -78.71513056871729, -122.21994188169515, -100.67730562980474, -106.85288879845167, -104.28540795155243, -106.88622486308032, -119.53071222846086], "episode_lengths": [456, 88, 42, 105, 1600, 65, 57, 76, 47, 61, 75, 177, 61, 66, 61, 1600, 104, 83, 80, 75, 1600, 47, 52, 65, 1600, 93, 90, 56, 1600, 45, 54, 59, 60, 70, 1600, 1315, 85, 39, 90, 84, 63, 1600, 77, 1600, 1600, 80, 60, 1600, 60, 1600, 1600, 73, 168, 68, 57, 1600, 1600, 77, 38, 51, 246, 63, 48, 63, 88, 49, 55, 185, 68, 1600, 123, 71, 43, 76, 96, 1600, 53, 1600, 80, 46, 106, 1600, 56, 81, 68, 57, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 92, 57, 58, 57, 47, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29113179967127706, "mean_inference_ms": 0.9656992822643599, "mean_action_processing_ms": 0.1886637363539625, "mean_env_wait_ms": 0.3901509107573131, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006218433380126953, "StateBufferConnector_ms": 0.0043718814849853516, "ViewRequirementAgentConnector_ms": 0.12259054183959961}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 404.32379168461483, "num_env_steps_trained_throughput_per_sec": 404.32379168461483, "timesteps_total": 212000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 212000, "timers": {"training_iteration_time_ms": 9954.716, "restore_workers_time_ms": 0.014, "training_step_time_ms": 9954.67, "sample_time_ms": 3791.641, "load_time_ms": 0.471, "load_throughput": 8490493.927, "learn_time_ms": 6153.979, "learn_throughput": 649.986, "synch_weights_time_ms": 7.953}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "done": false, "episodes_total": 398, "training_iteration": 53, "trial_id": "4bb30_00000", "date": "2024-04-27_18-35-20", "timestamp": 1714268120, "time_this_iter_s": 9.898056983947754, "time_total_s": 520.7891314029694, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 520.7891314029694, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 31.44285714285714, "ram_util_percent": 63.84285714285712}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.90859011994895, "cur_kl_coeff": 0.3375000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1866259897747378, "policy_loss": -0.02941742516973967, "vf_loss": 1.2123624673774165, "vf_explained_var": 0.3438785877919966, "kl": 0.010906512356765529, "entropy": 7.446573265649939, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 49755.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "sampler_results": {"episode_reward_max": -71.68189084982127, "episode_reward_min": -194.32339084698253, "episode_reward_mean": -110.04159206963025, "episode_len_mean": 529.37, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 52937, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-105.2531035514238, -114.56658118286046, -115.919567731884, -106.12499932804518, -135.4520866801453, -119.73250339419644, -108.8972056200821, -114.00207814536058, -116.04492230889042, -125.3953688067707, -112.99181449688102, -108.90788428806204, -101.36193440639165, -82.74018697735794, -110.32834343545264, -108.44999907075739, -111.82046425366961, -82.65581324347407, -109.00157471701131, -105.48914757838598, -103.83510714341887, -129.16959454146448, -111.15420099039811, -106.57041528891462, -108.80447647278446, -117.80663254004158, -105.85348760820429, -120.72173031863531, -194.32339084698253, -123.84743354289047, -107.90513500382318, -107.60758833826334, -122.78584688601333, -112.94065315830832, -79.31654056420992, -105.86337975599618, -75.21473035828602, -104.07371726521275, -104.15195112087515, -113.94316373250012, -142.1401249247553, -119.49946157418253, -71.68189084982127, -127.4077298487154, -104.22469015577435, -135.25513430602098, -106.48931538720058, -105.46927715086441, -123.13518638017449, -135.84190664967358, -117.81027904600589, -109.85173654468792, -116.45519471728988, -144.12344038386703, -109.5010015869091, -112.59304169055012, -106.88099847922288, -104.99902512108412, -116.97286871387189, -107.72949738825051, -132.38890899702648, -106.6413203956547, -85.43775501473179, -120.41935443517255, -107.02163737601725, -111.23635936427179, -119.918512470151, -108.84242586697391, -84.34828797295629, -108.47606817803283, -133.13893411616758, -108.70058738060855, -115.33707291548575, -123.79102404567973, -142.01141749789235, -116.54825406421784, -107.75149732037137, -106.33801159661884, -105.91336169075656, -135.45944015112764, -73.57242001242322, -79.48607322502706, -84.33659009961904, -89.57854080046147, -96.98662711500242, -74.48033455020187, -78.71513056871729, -122.21994188169515, -100.67730562980474, -106.85288879845167, -104.28540795155243, -106.88622486308032, -119.53071222846086, -128.35822362820699, -75.56917029478025, -107.30527319482653, -111.91288345215993, -107.02769602312458, -78.17303149392953, -109.39794470833925], "episode_lengths": [76, 47, 61, 75, 177, 61, 66, 61, 1600, 104, 83, 80, 75, 1600, 47, 52, 65, 1600, 93, 90, 56, 1600, 45, 54, 59, 60, 70, 1600, 1315, 85, 39, 90, 84, 63, 1600, 77, 1600, 1600, 80, 60, 1600, 60, 1600, 1600, 73, 168, 68, 57, 1600, 1600, 77, 38, 51, 246, 63, 48, 63, 88, 49, 55, 185, 68, 1600, 123, 71, 43, 76, 96, 1600, 53, 1600, 80, 46, 106, 1600, 56, 81, 68, 57, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 92, 57, 58, 57, 47, 72, 1600, 1600, 57, 1600, 47, 1600, 87]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2913163834474968, "mean_inference_ms": 0.9664985218880449, "mean_action_processing_ms": 0.1888041955582493, "mean_env_wait_ms": 0.3903428419598998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006226301193237305, "StateBufferConnector_ms": 0.004378080368041992, "ViewRequirementAgentConnector_ms": 0.12251782417297363}}, "episode_reward_max": -71.68189084982127, "episode_reward_min": -194.32339084698253, "episode_reward_mean": -110.04159206963025, "episode_len_mean": 529.37, "episodes_this_iter": 7, "episodes_timesteps_total": 52937, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-105.2531035514238, -114.56658118286046, -115.919567731884, -106.12499932804518, -135.4520866801453, -119.73250339419644, -108.8972056200821, -114.00207814536058, -116.04492230889042, -125.3953688067707, -112.99181449688102, -108.90788428806204, -101.36193440639165, -82.74018697735794, -110.32834343545264, -108.44999907075739, -111.82046425366961, -82.65581324347407, -109.00157471701131, -105.48914757838598, -103.83510714341887, -129.16959454146448, -111.15420099039811, -106.57041528891462, -108.80447647278446, -117.80663254004158, -105.85348760820429, -120.72173031863531, -194.32339084698253, -123.84743354289047, -107.90513500382318, -107.60758833826334, -122.78584688601333, -112.94065315830832, -79.31654056420992, -105.86337975599618, -75.21473035828602, -104.07371726521275, -104.15195112087515, -113.94316373250012, -142.1401249247553, -119.49946157418253, -71.68189084982127, -127.4077298487154, -104.22469015577435, -135.25513430602098, -106.48931538720058, -105.46927715086441, -123.13518638017449, -135.84190664967358, -117.81027904600589, -109.85173654468792, -116.45519471728988, -144.12344038386703, -109.5010015869091, -112.59304169055012, -106.88099847922288, -104.99902512108412, -116.97286871387189, -107.72949738825051, -132.38890899702648, -106.6413203956547, -85.43775501473179, -120.41935443517255, -107.02163737601725, -111.23635936427179, -119.918512470151, -108.84242586697391, -84.34828797295629, -108.47606817803283, -133.13893411616758, -108.70058738060855, -115.33707291548575, -123.79102404567973, -142.01141749789235, -116.54825406421784, -107.75149732037137, -106.33801159661884, -105.91336169075656, -135.45944015112764, -73.57242001242322, -79.48607322502706, -84.33659009961904, -89.57854080046147, -96.98662711500242, -74.48033455020187, -78.71513056871729, -122.21994188169515, -100.67730562980474, -106.85288879845167, -104.28540795155243, -106.88622486308032, -119.53071222846086, -128.35822362820699, -75.56917029478025, -107.30527319482653, -111.91288345215993, -107.02769602312458, -78.17303149392953, -109.39794470833925], "episode_lengths": [76, 47, 61, 75, 177, 61, 66, 61, 1600, 104, 83, 80, 75, 1600, 47, 52, 65, 1600, 93, 90, 56, 1600, 45, 54, 59, 60, 70, 1600, 1315, 85, 39, 90, 84, 63, 1600, 77, 1600, 1600, 80, 60, 1600, 60, 1600, 1600, 73, 168, 68, 57, 1600, 1600, 77, 38, 51, 246, 63, 48, 63, 88, 49, 55, 185, 68, 1600, 123, 71, 43, 76, 96, 1600, 53, 1600, 80, 46, 106, 1600, 56, 81, 68, 57, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 92, 57, 58, 57, 47, 72, 1600, 1600, 57, 1600, 47, 1600, 87]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2913163834474968, "mean_inference_ms": 0.9664985218880449, "mean_action_processing_ms": 0.1888041955582493, "mean_env_wait_ms": 0.3903428419598998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006226301193237305, "StateBufferConnector_ms": 0.004378080368041992, "ViewRequirementAgentConnector_ms": 0.12251782417297363}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 401.47408992760256, "num_env_steps_trained_throughput_per_sec": 401.47408992760256, "timesteps_total": 216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 9955.695, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9955.652, "sample_time_ms": 3795.874, "load_time_ms": 0.477, "load_throughput": 8377298.647, "learn_time_ms": 6150.686, "learn_throughput": 650.334, "synch_weights_time_ms": 8.008}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "episodes_total": 405, "training_iteration": 54, "trial_id": "4bb30_00000", "date": "2024-04-27_18-35-30", "timestamp": 1714268130, "time_this_iter_s": 9.968258142471313, "time_total_s": 530.7573895454407, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 530.7573895454407, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 31.921428571428574, "ram_util_percent": 63.77142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.727147173496984, "cur_kl_coeff": 0.3375000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.715585984341595, "policy_loss": -0.04304366687773376, "vf_loss": 2.751269003308268, "vf_explained_var": 0.2533144138833528, "kl": 0.02180935179945984, "entropy": 10.015154273022887, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 50685.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "sampler_results": {"episode_reward_max": -71.68189084982127, "episode_reward_min": -194.32339084698253, "episode_reward_mean": -109.43773284423195, "episode_len_mean": 542.92, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 54292, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-82.74018697735794, -110.32834343545264, -108.44999907075739, -111.82046425366961, -82.65581324347407, -109.00157471701131, -105.48914757838598, -103.83510714341887, -129.16959454146448, -111.15420099039811, -106.57041528891462, -108.80447647278446, -117.80663254004158, -105.85348760820429, -120.72173031863531, -194.32339084698253, -123.84743354289047, -107.90513500382318, -107.60758833826334, -122.78584688601333, -112.94065315830832, -79.31654056420992, -105.86337975599618, -75.21473035828602, -104.07371726521275, -104.15195112087515, -113.94316373250012, -142.1401249247553, -119.49946157418253, -71.68189084982127, -127.4077298487154, -104.22469015577435, -135.25513430602098, -106.48931538720058, -105.46927715086441, -123.13518638017449, -135.84190664967358, -117.81027904600589, -109.85173654468792, -116.45519471728988, -144.12344038386703, -109.5010015869091, -112.59304169055012, -106.88099847922288, -104.99902512108412, -116.97286871387189, -107.72949738825051, -132.38890899702648, -106.6413203956547, -85.43775501473179, -120.41935443517255, -107.02163737601725, -111.23635936427179, -119.918512470151, -108.84242586697391, -84.34828797295629, -108.47606817803283, -133.13893411616758, -108.70058738060855, -115.33707291548575, -123.79102404567973, -142.01141749789235, -116.54825406421784, -107.75149732037137, -106.33801159661884, -105.91336169075656, -135.45944015112764, -73.57242001242322, -79.48607322502706, -84.33659009961904, -89.57854080046147, -96.98662711500242, -74.48033455020187, -78.71513056871729, -122.21994188169515, -100.67730562980474, -106.85288879845167, -104.28540795155243, -106.88622486308032, -119.53071222846086, -128.35822362820699, -75.56917029478025, -107.30527319482653, -111.91288345215993, -107.02769602312458, -78.17303149392953, -109.39794470833925, -116.2600874169907, -116.71471895037406, -107.59075862218316, -107.71610303293603, -115.45543451212968, -105.06716977176382, -109.96821037217727, -73.4393374019546, -106.82699249696297, -120.11636533528318, -116.847273539152, -121.54306854843536, -106.71860740081904], "episode_lengths": [1600, 47, 52, 65, 1600, 93, 90, 56, 1600, 45, 54, 59, 60, 70, 1600, 1315, 85, 39, 90, 84, 63, 1600, 77, 1600, 1600, 80, 60, 1600, 60, 1600, 1600, 73, 168, 68, 57, 1600, 1600, 77, 38, 51, 246, 63, 48, 63, 88, 49, 55, 185, 68, 1600, 123, 71, 43, 76, 96, 1600, 53, 1600, 80, 46, 106, 1600, 56, 81, 68, 57, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 92, 57, 58, 57, 47, 72, 1600, 1600, 57, 1600, 47, 1600, 87, 1600, 56, 64, 65, 63, 80, 38, 1600, 67, 69, 53, 109, 57]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2917564267223922, "mean_inference_ms": 0.9677125594185424, "mean_action_processing_ms": 0.18911441389109893, "mean_env_wait_ms": 0.3908527049754904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006242036819458008, "StateBufferConnector_ms": 0.004454851150512695, "ViewRequirementAgentConnector_ms": 0.12193942070007324}}, "episode_reward_max": -71.68189084982127, "episode_reward_min": -194.32339084698253, "episode_reward_mean": -109.43773284423195, "episode_len_mean": 542.92, "episodes_this_iter": 13, "episodes_timesteps_total": 54292, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-82.74018697735794, -110.32834343545264, -108.44999907075739, -111.82046425366961, -82.65581324347407, -109.00157471701131, -105.48914757838598, -103.83510714341887, -129.16959454146448, -111.15420099039811, -106.57041528891462, -108.80447647278446, -117.80663254004158, -105.85348760820429, -120.72173031863531, -194.32339084698253, -123.84743354289047, -107.90513500382318, -107.60758833826334, -122.78584688601333, -112.94065315830832, -79.31654056420992, -105.86337975599618, -75.21473035828602, -104.07371726521275, -104.15195112087515, -113.94316373250012, -142.1401249247553, -119.49946157418253, -71.68189084982127, -127.4077298487154, -104.22469015577435, -135.25513430602098, -106.48931538720058, -105.46927715086441, -123.13518638017449, -135.84190664967358, -117.81027904600589, -109.85173654468792, -116.45519471728988, -144.12344038386703, -109.5010015869091, -112.59304169055012, -106.88099847922288, -104.99902512108412, -116.97286871387189, -107.72949738825051, -132.38890899702648, -106.6413203956547, -85.43775501473179, -120.41935443517255, -107.02163737601725, -111.23635936427179, -119.918512470151, -108.84242586697391, -84.34828797295629, -108.47606817803283, -133.13893411616758, -108.70058738060855, -115.33707291548575, -123.79102404567973, -142.01141749789235, -116.54825406421784, -107.75149732037137, -106.33801159661884, -105.91336169075656, -135.45944015112764, -73.57242001242322, -79.48607322502706, -84.33659009961904, -89.57854080046147, -96.98662711500242, -74.48033455020187, -78.71513056871729, -122.21994188169515, -100.67730562980474, -106.85288879845167, -104.28540795155243, -106.88622486308032, -119.53071222846086, -128.35822362820699, -75.56917029478025, -107.30527319482653, -111.91288345215993, -107.02769602312458, -78.17303149392953, -109.39794470833925, -116.2600874169907, -116.71471895037406, -107.59075862218316, -107.71610303293603, -115.45543451212968, -105.06716977176382, -109.96821037217727, -73.4393374019546, -106.82699249696297, -120.11636533528318, -116.847273539152, -121.54306854843536, -106.71860740081904], "episode_lengths": [1600, 47, 52, 65, 1600, 93, 90, 56, 1600, 45, 54, 59, 60, 70, 1600, 1315, 85, 39, 90, 84, 63, 1600, 77, 1600, 1600, 80, 60, 1600, 60, 1600, 1600, 73, 168, 68, 57, 1600, 1600, 77, 38, 51, 246, 63, 48, 63, 88, 49, 55, 185, 68, 1600, 123, 71, 43, 76, 96, 1600, 53, 1600, 80, 46, 106, 1600, 56, 81, 68, 57, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 92, 57, 58, 57, 47, 72, 1600, 1600, 57, 1600, 47, 1600, 87, 1600, 56, 64, 65, 63, 80, 38, 1600, 67, 69, 53, 109, 57]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2917564267223922, "mean_inference_ms": 0.9677125594185424, "mean_action_processing_ms": 0.18911441389109893, "mean_env_wait_ms": 0.3908527049754904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006242036819458008, "StateBufferConnector_ms": 0.004454851150512695, "ViewRequirementAgentConnector_ms": 0.12193942070007324}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 404.04831110004466, "num_env_steps_trained_throughput_per_sec": 404.04831110004466, "timesteps_total": 220000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 220000, "timers": {"training_iteration_time_ms": 9938.692, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9938.649, "sample_time_ms": 3800.069, "load_time_ms": 0.465, "load_throughput": 8594885.246, "learn_time_ms": 6129.488, "learn_throughput": 652.583, "synch_weights_time_ms": 8.015}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "done": false, "episodes_total": 418, "training_iteration": 55, "trial_id": "4bb30_00000", "date": "2024-04-27_18-35-40", "timestamp": 1714268140, "time_this_iter_s": 9.90496015548706, "time_total_s": 540.6623497009277, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 540.6623497009277, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 31.735714285714284, "ram_util_percent": 63.8642857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.174621842304866, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.1022803345680114, "policy_loss": -0.04031629797912413, "vf_loss": 3.134911823945661, "vf_explained_var": 0.22499093849171875, "kl": 0.015179864549213396, "entropy": 8.637788126545567, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 51615.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "sampler_results": {"episode_reward_max": -71.68189084982127, "episode_reward_min": -194.32339084698253, "episode_reward_mean": -110.70657972123365, "episode_len_mean": 521.64, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 52164, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-111.15420099039811, -106.57041528891462, -108.80447647278446, -117.80663254004158, -105.85348760820429, -120.72173031863531, -194.32339084698253, -123.84743354289047, -107.90513500382318, -107.60758833826334, -122.78584688601333, -112.94065315830832, -79.31654056420992, -105.86337975599618, -75.21473035828602, -104.07371726521275, -104.15195112087515, -113.94316373250012, -142.1401249247553, -119.49946157418253, -71.68189084982127, -127.4077298487154, -104.22469015577435, -135.25513430602098, -106.48931538720058, -105.46927715086441, -123.13518638017449, -135.84190664967358, -117.81027904600589, -109.85173654468792, -116.45519471728988, -144.12344038386703, -109.5010015869091, -112.59304169055012, -106.88099847922288, -104.99902512108412, -116.97286871387189, -107.72949738825051, -132.38890899702648, -106.6413203956547, -85.43775501473179, -120.41935443517255, -107.02163737601725, -111.23635936427179, -119.918512470151, -108.84242586697391, -84.34828797295629, -108.47606817803283, -133.13893411616758, -108.70058738060855, -115.33707291548575, -123.79102404567973, -142.01141749789235, -116.54825406421784, -107.75149732037137, -106.33801159661884, -105.91336169075656, -135.45944015112764, -73.57242001242322, -79.48607322502706, -84.33659009961904, -89.57854080046147, -96.98662711500242, -74.48033455020187, -78.71513056871729, -122.21994188169515, -100.67730562980474, -106.85288879845167, -104.28540795155243, -106.88622486308032, -119.53071222846086, -128.35822362820699, -75.56917029478025, -107.30527319482653, -111.91288345215993, -107.02769602312458, -78.17303149392953, -109.39794470833925, -116.2600874169907, -116.71471895037406, -107.59075862218316, -107.71610303293603, -115.45543451212968, -105.06716977176382, -109.96821037217727, -73.4393374019546, -106.82699249696297, -120.11636533528318, -116.847273539152, -121.54306854843536, -106.71860740081904, -154.2586291712276, -110.06188124985124, -114.61988645679442, -106.09845927045868, -121.54650888100454, -128.554702435807, -84.04940842538012, -131.0094327377019, -120.17601003293444], "episode_lengths": [45, 54, 59, 60, 70, 1600, 1315, 85, 39, 90, 84, 63, 1600, 77, 1600, 1600, 80, 60, 1600, 60, 1600, 1600, 73, 168, 68, 57, 1600, 1600, 77, 38, 51, 246, 63, 48, 63, 88, 49, 55, 185, 68, 1600, 123, 71, 43, 76, 96, 1600, 53, 1600, 80, 46, 106, 1600, 56, 81, 68, 57, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 92, 57, 58, 57, 47, 72, 1600, 1600, 57, 1600, 47, 1600, 87, 1600, 56, 64, 65, 63, 80, 38, 1600, 67, 69, 53, 109, 57, 797, 48, 76, 98, 92, 88, 1600, 151, 125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2919487469255774, "mean_inference_ms": 0.9684145817186809, "mean_action_processing_ms": 0.18926683147708914, "mean_env_wait_ms": 0.3910632487738488, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006204843521118164, "StateBufferConnector_ms": 0.0044519901275634766, "ViewRequirementAgentConnector_ms": 0.12096810340881348}}, "episode_reward_max": -71.68189084982127, "episode_reward_min": -194.32339084698253, "episode_reward_mean": -110.70657972123365, "episode_len_mean": 521.64, "episodes_this_iter": 9, "episodes_timesteps_total": 52164, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-111.15420099039811, -106.57041528891462, -108.80447647278446, -117.80663254004158, -105.85348760820429, -120.72173031863531, -194.32339084698253, -123.84743354289047, -107.90513500382318, -107.60758833826334, -122.78584688601333, -112.94065315830832, -79.31654056420992, -105.86337975599618, -75.21473035828602, -104.07371726521275, -104.15195112087515, -113.94316373250012, -142.1401249247553, -119.49946157418253, -71.68189084982127, -127.4077298487154, -104.22469015577435, -135.25513430602098, -106.48931538720058, -105.46927715086441, -123.13518638017449, -135.84190664967358, -117.81027904600589, -109.85173654468792, -116.45519471728988, -144.12344038386703, -109.5010015869091, -112.59304169055012, -106.88099847922288, -104.99902512108412, -116.97286871387189, -107.72949738825051, -132.38890899702648, -106.6413203956547, -85.43775501473179, -120.41935443517255, -107.02163737601725, -111.23635936427179, -119.918512470151, -108.84242586697391, -84.34828797295629, -108.47606817803283, -133.13893411616758, -108.70058738060855, -115.33707291548575, -123.79102404567973, -142.01141749789235, -116.54825406421784, -107.75149732037137, -106.33801159661884, -105.91336169075656, -135.45944015112764, -73.57242001242322, -79.48607322502706, -84.33659009961904, -89.57854080046147, -96.98662711500242, -74.48033455020187, -78.71513056871729, -122.21994188169515, -100.67730562980474, -106.85288879845167, -104.28540795155243, -106.88622486308032, -119.53071222846086, -128.35822362820699, -75.56917029478025, -107.30527319482653, -111.91288345215993, -107.02769602312458, -78.17303149392953, -109.39794470833925, -116.2600874169907, -116.71471895037406, -107.59075862218316, -107.71610303293603, -115.45543451212968, -105.06716977176382, -109.96821037217727, -73.4393374019546, -106.82699249696297, -120.11636533528318, -116.847273539152, -121.54306854843536, -106.71860740081904, -154.2586291712276, -110.06188124985124, -114.61988645679442, -106.09845927045868, -121.54650888100454, -128.554702435807, -84.04940842538012, -131.0094327377019, -120.17601003293444], "episode_lengths": [45, 54, 59, 60, 70, 1600, 1315, 85, 39, 90, 84, 63, 1600, 77, 1600, 1600, 80, 60, 1600, 60, 1600, 1600, 73, 168, 68, 57, 1600, 1600, 77, 38, 51, 246, 63, 48, 63, 88, 49, 55, 185, 68, 1600, 123, 71, 43, 76, 96, 1600, 53, 1600, 80, 46, 106, 1600, 56, 81, 68, 57, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 92, 57, 58, 57, 47, 72, 1600, 1600, 57, 1600, 47, 1600, 87, 1600, 56, 64, 65, 63, 80, 38, 1600, 67, 69, 53, 109, 57, 797, 48, 76, 98, 92, 88, 1600, 151, 125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2919487469255774, "mean_inference_ms": 0.9684145817186809, "mean_action_processing_ms": 0.18926683147708914, "mean_env_wait_ms": 0.3910632487738488, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006204843521118164, "StateBufferConnector_ms": 0.0044519901275634766, "ViewRequirementAgentConnector_ms": 0.12096810340881348}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 403.0855722810436, "num_env_steps_trained_throughput_per_sec": 403.0855722810436, "timesteps_total": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 9934.982, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9934.938, "sample_time_ms": 3796.893, "load_time_ms": 0.429, "load_throughput": 9313431.775, "learn_time_ms": 6129.125, "learn_throughput": 652.622, "synch_weights_time_ms": 7.901}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "episodes_total": 427, "training_iteration": 56, "trial_id": "4bb30_00000", "date": "2024-04-27_18-35-50", "timestamp": 1714268150, "time_this_iter_s": 9.927597045898438, "time_total_s": 550.5899467468262, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 550.5899467468262, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 31.378571428571426, "ram_util_percent": 63.864285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.399922534150463, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4245898421956427, "policy_loss": -0.03668292904352789, "vf_loss": 2.455397033603281, "vf_explained_var": 0.2350832938507039, "kl": 0.011606391917592688, "entropy": 8.719294648016653, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 52545.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "sampler_results": {"episode_reward_max": -65.67449337833312, "episode_reward_min": -176.18388133334116, "episode_reward_mean": -110.32432149665067, "episode_len_mean": 538.5, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 53850, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-123.84743354289047, -107.90513500382318, -107.60758833826334, -122.78584688601333, -112.94065315830832, -79.31654056420992, -105.86337975599618, -75.21473035828602, -104.07371726521275, -104.15195112087515, -113.94316373250012, -142.1401249247553, -119.49946157418253, -71.68189084982127, -127.4077298487154, -104.22469015577435, -135.25513430602098, -106.48931538720058, -105.46927715086441, -123.13518638017449, -135.84190664967358, -117.81027904600589, -109.85173654468792, -116.45519471728988, -144.12344038386703, -109.5010015869091, -112.59304169055012, -106.88099847922288, -104.99902512108412, -116.97286871387189, -107.72949738825051, -132.38890899702648, -106.6413203956547, -85.43775501473179, -120.41935443517255, -107.02163737601725, -111.23635936427179, -119.918512470151, -108.84242586697391, -84.34828797295629, -108.47606817803283, -133.13893411616758, -108.70058738060855, -115.33707291548575, -123.79102404567973, -142.01141749789235, -116.54825406421784, -107.75149732037137, -106.33801159661884, -105.91336169075656, -135.45944015112764, -73.57242001242322, -79.48607322502706, -84.33659009961904, -89.57854080046147, -96.98662711500242, -74.48033455020187, -78.71513056871729, -122.21994188169515, -100.67730562980474, -106.85288879845167, -104.28540795155243, -106.88622486308032, -119.53071222846086, -128.35822362820699, -75.56917029478025, -107.30527319482653, -111.91288345215993, -107.02769602312458, -78.17303149392953, -109.39794470833925, -116.2600874169907, -116.71471895037406, -107.59075862218316, -107.71610303293603, -115.45543451212968, -105.06716977176382, -109.96821037217727, -73.4393374019546, -106.82699249696297, -120.11636533528318, -116.847273539152, -121.54306854843536, -106.71860740081904, -154.2586291712276, -110.06188124985124, -114.61988645679442, -106.09845927045868, -121.54650888100454, -128.554702435807, -84.04940842538012, -131.0094327377019, -120.17601003293444, -65.67449337833312, -110.74174561887098, -111.73956501606666, -123.41101249076861, -176.18388133334116, -109.5265405728637, -129.73127319741747], "episode_lengths": [85, 39, 90, 84, 63, 1600, 77, 1600, 1600, 80, 60, 1600, 60, 1600, 1600, 73, 168, 68, 57, 1600, 1600, 77, 38, 51, 246, 63, 48, 63, 88, 49, 55, 185, 68, 1600, 123, 71, 43, 76, 96, 1600, 53, 1600, 80, 46, 106, 1600, 56, 81, 68, 57, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 92, 57, 58, 57, 47, 72, 1600, 1600, 57, 1600, 47, 1600, 87, 1600, 56, 64, 65, 63, 80, 38, 1600, 67, 69, 53, 109, 57, 797, 48, 76, 98, 92, 88, 1600, 151, 125, 1600, 1600, 38, 69, 1440, 46, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29214520765549246, "mean_inference_ms": 0.9687013205412334, "mean_action_processing_ms": 0.1894115064293795, "mean_env_wait_ms": 0.3913286368789879, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006159067153930664, "StateBufferConnector_ms": 0.004420042037963867, "ViewRequirementAgentConnector_ms": 0.12083673477172852}}, "episode_reward_max": -65.67449337833312, "episode_reward_min": -176.18388133334116, "episode_reward_mean": -110.32432149665067, "episode_len_mean": 538.5, "episodes_this_iter": 7, "episodes_timesteps_total": 53850, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-123.84743354289047, -107.90513500382318, -107.60758833826334, -122.78584688601333, -112.94065315830832, -79.31654056420992, -105.86337975599618, -75.21473035828602, -104.07371726521275, -104.15195112087515, -113.94316373250012, -142.1401249247553, -119.49946157418253, -71.68189084982127, -127.4077298487154, -104.22469015577435, -135.25513430602098, -106.48931538720058, -105.46927715086441, -123.13518638017449, -135.84190664967358, -117.81027904600589, -109.85173654468792, -116.45519471728988, -144.12344038386703, -109.5010015869091, -112.59304169055012, -106.88099847922288, -104.99902512108412, -116.97286871387189, -107.72949738825051, -132.38890899702648, -106.6413203956547, -85.43775501473179, -120.41935443517255, -107.02163737601725, -111.23635936427179, -119.918512470151, -108.84242586697391, -84.34828797295629, -108.47606817803283, -133.13893411616758, -108.70058738060855, -115.33707291548575, -123.79102404567973, -142.01141749789235, -116.54825406421784, -107.75149732037137, -106.33801159661884, -105.91336169075656, -135.45944015112764, -73.57242001242322, -79.48607322502706, -84.33659009961904, -89.57854080046147, -96.98662711500242, -74.48033455020187, -78.71513056871729, -122.21994188169515, -100.67730562980474, -106.85288879845167, -104.28540795155243, -106.88622486308032, -119.53071222846086, -128.35822362820699, -75.56917029478025, -107.30527319482653, -111.91288345215993, -107.02769602312458, -78.17303149392953, -109.39794470833925, -116.2600874169907, -116.71471895037406, -107.59075862218316, -107.71610303293603, -115.45543451212968, -105.06716977176382, -109.96821037217727, -73.4393374019546, -106.82699249696297, -120.11636533528318, -116.847273539152, -121.54306854843536, -106.71860740081904, -154.2586291712276, -110.06188124985124, -114.61988645679442, -106.09845927045868, -121.54650888100454, -128.554702435807, -84.04940842538012, -131.0094327377019, -120.17601003293444, -65.67449337833312, -110.74174561887098, -111.73956501606666, -123.41101249076861, -176.18388133334116, -109.5265405728637, -129.73127319741747], "episode_lengths": [85, 39, 90, 84, 63, 1600, 77, 1600, 1600, 80, 60, 1600, 60, 1600, 1600, 73, 168, 68, 57, 1600, 1600, 77, 38, 51, 246, 63, 48, 63, 88, 49, 55, 185, 68, 1600, 123, 71, 43, 76, 96, 1600, 53, 1600, 80, 46, 106, 1600, 56, 81, 68, 57, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 92, 57, 58, 57, 47, 72, 1600, 1600, 57, 1600, 47, 1600, 87, 1600, 56, 64, 65, 63, 80, 38, 1600, 67, 69, 53, 109, 57, 797, 48, 76, 98, 92, 88, 1600, 151, 125, 1600, 1600, 38, 69, 1440, 46, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29214520765549246, "mean_inference_ms": 0.9687013205412334, "mean_action_processing_ms": 0.1894115064293795, "mean_env_wait_ms": 0.3913286368789879, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006159067153930664, "StateBufferConnector_ms": 0.004420042037963867, "ViewRequirementAgentConnector_ms": 0.12083673477172852}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 395.4527269658352, "num_env_steps_trained_throughput_per_sec": 395.4527269658352, "timesteps_total": 228000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 228000, "timers": {"training_iteration_time_ms": 9949.558, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9949.516, "sample_time_ms": 3821.102, "load_time_ms": 0.442, "load_throughput": 9057993.737, "learn_time_ms": 6119.571, "learn_throughput": 653.641, "synch_weights_time_ms": 7.805}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "done": false, "episodes_total": 434, "training_iteration": 57, "trial_id": "4bb30_00000", "date": "2024-04-27_18-36-00", "timestamp": 1714268160, "time_this_iter_s": 10.119340896606445, "time_total_s": 560.7092876434326, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 560.7092876434326, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 29.55333333333333, "ram_util_percent": 63.76666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.337994793538126, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1057959997518267, "policy_loss": -0.038068274962365305, "vf_loss": 2.136535334150477, "vf_explained_var": 0.3698670012976534, "kl": 0.014476901836466721, "entropy": 8.891441600553451, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 53475.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "sampler_results": {"episode_reward_max": -65.67449337833312, "episode_reward_min": -176.18388133334116, "episode_reward_mean": -110.23075880761213, "episode_len_mean": 522.31, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 52231, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-104.15195112087515, -113.94316373250012, -142.1401249247553, -119.49946157418253, -71.68189084982127, -127.4077298487154, -104.22469015577435, -135.25513430602098, -106.48931538720058, -105.46927715086441, -123.13518638017449, -135.84190664967358, -117.81027904600589, -109.85173654468792, -116.45519471728988, -144.12344038386703, -109.5010015869091, -112.59304169055012, -106.88099847922288, -104.99902512108412, -116.97286871387189, -107.72949738825051, -132.38890899702648, -106.6413203956547, -85.43775501473179, -120.41935443517255, -107.02163737601725, -111.23635936427179, -119.918512470151, -108.84242586697391, -84.34828797295629, -108.47606817803283, -133.13893411616758, -108.70058738060855, -115.33707291548575, -123.79102404567973, -142.01141749789235, -116.54825406421784, -107.75149732037137, -106.33801159661884, -105.91336169075656, -135.45944015112764, -73.57242001242322, -79.48607322502706, -84.33659009961904, -89.57854080046147, -96.98662711500242, -74.48033455020187, -78.71513056871729, -122.21994188169515, -100.67730562980474, -106.85288879845167, -104.28540795155243, -106.88622486308032, -119.53071222846086, -128.35822362820699, -75.56917029478025, -107.30527319482653, -111.91288345215993, -107.02769602312458, -78.17303149392953, -109.39794470833925, -116.2600874169907, -116.71471895037406, -107.59075862218316, -107.71610303293603, -115.45543451212968, -105.06716977176382, -109.96821037217727, -73.4393374019546, -106.82699249696297, -120.11636533528318, -116.847273539152, -121.54306854843536, -106.71860740081904, -154.2586291712276, -110.06188124985124, -114.61988645679442, -106.09845927045868, -121.54650888100454, -128.554702435807, -84.04940842538012, -131.0094327377019, -120.17601003293444, -65.67449337833312, -110.74174561887098, -111.73956501606666, -123.41101249076861, -176.18388133334116, -109.5265405728637, -129.73127319741747, -103.03236883307808, -74.9974941049738, -108.52297227593698, -108.26833275536013, -108.27843242647313, -115.29762847051894, -102.59858856051788, -101.03747800984921, -108.16546053244174], "episode_lengths": [80, 60, 1600, 60, 1600, 1600, 73, 168, 68, 57, 1600, 1600, 77, 38, 51, 246, 63, 48, 63, 88, 49, 55, 185, 68, 1600, 123, 71, 43, 76, 96, 1600, 53, 1600, 80, 46, 106, 1600, 56, 81, 68, 57, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 92, 57, 58, 57, 47, 72, 1600, 1600, 57, 1600, 47, 1600, 87, 1600, 56, 64, 65, 63, 80, 38, 1600, 67, 69, 53, 109, 57, 797, 48, 76, 98, 92, 88, 1600, 151, 125, 1600, 1600, 38, 69, 1440, 46, 96, 62, 1600, 56, 44, 45, 59, 79, 1600, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29234622630988893, "mean_inference_ms": 0.9688065184507408, "mean_action_processing_ms": 0.1895478570301671, "mean_env_wait_ms": 0.3915920782399017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006134748458862305, "StateBufferConnector_ms": 0.0043735504150390625, "ViewRequirementAgentConnector_ms": 0.11945843696594238}}, "episode_reward_max": -65.67449337833312, "episode_reward_min": -176.18388133334116, "episode_reward_mean": -110.23075880761213, "episode_len_mean": 522.31, "episodes_this_iter": 9, "episodes_timesteps_total": 52231, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-104.15195112087515, -113.94316373250012, -142.1401249247553, -119.49946157418253, -71.68189084982127, -127.4077298487154, -104.22469015577435, -135.25513430602098, -106.48931538720058, -105.46927715086441, -123.13518638017449, -135.84190664967358, -117.81027904600589, -109.85173654468792, -116.45519471728988, -144.12344038386703, -109.5010015869091, -112.59304169055012, -106.88099847922288, -104.99902512108412, -116.97286871387189, -107.72949738825051, -132.38890899702648, -106.6413203956547, -85.43775501473179, -120.41935443517255, -107.02163737601725, -111.23635936427179, -119.918512470151, -108.84242586697391, -84.34828797295629, -108.47606817803283, -133.13893411616758, -108.70058738060855, -115.33707291548575, -123.79102404567973, -142.01141749789235, -116.54825406421784, -107.75149732037137, -106.33801159661884, -105.91336169075656, -135.45944015112764, -73.57242001242322, -79.48607322502706, -84.33659009961904, -89.57854080046147, -96.98662711500242, -74.48033455020187, -78.71513056871729, -122.21994188169515, -100.67730562980474, -106.85288879845167, -104.28540795155243, -106.88622486308032, -119.53071222846086, -128.35822362820699, -75.56917029478025, -107.30527319482653, -111.91288345215993, -107.02769602312458, -78.17303149392953, -109.39794470833925, -116.2600874169907, -116.71471895037406, -107.59075862218316, -107.71610303293603, -115.45543451212968, -105.06716977176382, -109.96821037217727, -73.4393374019546, -106.82699249696297, -120.11636533528318, -116.847273539152, -121.54306854843536, -106.71860740081904, -154.2586291712276, -110.06188124985124, -114.61988645679442, -106.09845927045868, -121.54650888100454, -128.554702435807, -84.04940842538012, -131.0094327377019, -120.17601003293444, -65.67449337833312, -110.74174561887098, -111.73956501606666, -123.41101249076861, -176.18388133334116, -109.5265405728637, -129.73127319741747, -103.03236883307808, -74.9974941049738, -108.52297227593698, -108.26833275536013, -108.27843242647313, -115.29762847051894, -102.59858856051788, -101.03747800984921, -108.16546053244174], "episode_lengths": [80, 60, 1600, 60, 1600, 1600, 73, 168, 68, 57, 1600, 1600, 77, 38, 51, 246, 63, 48, 63, 88, 49, 55, 185, 68, 1600, 123, 71, 43, 76, 96, 1600, 53, 1600, 80, 46, 106, 1600, 56, 81, 68, 57, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 92, 57, 58, 57, 47, 72, 1600, 1600, 57, 1600, 47, 1600, 87, 1600, 56, 64, 65, 63, 80, 38, 1600, 67, 69, 53, 109, 57, 797, 48, 76, 98, 92, 88, 1600, 151, 125, 1600, 1600, 38, 69, 1440, 46, 96, 62, 1600, 56, 44, 45, 59, 79, 1600, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29234622630988893, "mean_inference_ms": 0.9688065184507408, "mean_action_processing_ms": 0.1895478570301671, "mean_env_wait_ms": 0.3915920782399017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006134748458862305, "StateBufferConnector_ms": 0.0043735504150390625, "ViewRequirementAgentConnector_ms": 0.11945843696594238}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 420.37098006790194, "num_env_steps_trained_throughput_per_sec": 420.37098006790194, "timesteps_total": 232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 232000, "timers": {"training_iteration_time_ms": 9908.167, "restore_workers_time_ms": 0.012, "training_step_time_ms": 9908.127, "sample_time_ms": 3767.736, "load_time_ms": 0.438, "load_throughput": 9126484.252, "learn_time_ms": 6131.445, "learn_throughput": 652.375, "synch_weights_time_ms": 7.918}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "done": false, "episodes_total": 443, "training_iteration": 58, "trial_id": "4bb30_00000", "date": "2024-04-27_18-36-09", "timestamp": 1714268169, "time_this_iter_s": 9.520088911056519, "time_total_s": 570.2293765544891, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 570.2293765544891, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 24.423076923076923, "ram_util_percent": 63.50000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.007685977028261, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9993792703490383, "policy_loss": -0.03884802137010841, "vf_loss": 2.0321102338292265, "vf_explained_var": 0.3515632818463028, "kl": 0.012083090152741957, "entropy": 8.228659384225004, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 54405.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000}, "sampler_results": {"episode_reward_max": -62.02563957487113, "episode_reward_min": -176.18388133334116, "episode_reward_mean": -109.43899514549534, "episode_len_mean": 507.45, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 50745, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-135.25513430602098, -106.48931538720058, -105.46927715086441, -123.13518638017449, -135.84190664967358, -117.81027904600589, -109.85173654468792, -116.45519471728988, -144.12344038386703, -109.5010015869091, -112.59304169055012, -106.88099847922288, -104.99902512108412, -116.97286871387189, -107.72949738825051, -132.38890899702648, -106.6413203956547, -85.43775501473179, -120.41935443517255, -107.02163737601725, -111.23635936427179, -119.918512470151, -108.84242586697391, -84.34828797295629, -108.47606817803283, -133.13893411616758, -108.70058738060855, -115.33707291548575, -123.79102404567973, -142.01141749789235, -116.54825406421784, -107.75149732037137, -106.33801159661884, -105.91336169075656, -135.45944015112764, -73.57242001242322, -79.48607322502706, -84.33659009961904, -89.57854080046147, -96.98662711500242, -74.48033455020187, -78.71513056871729, -122.21994188169515, -100.67730562980474, -106.85288879845167, -104.28540795155243, -106.88622486308032, -119.53071222846086, -128.35822362820699, -75.56917029478025, -107.30527319482653, -111.91288345215993, -107.02769602312458, -78.17303149392953, -109.39794470833925, -116.2600874169907, -116.71471895037406, -107.59075862218316, -107.71610303293603, -115.45543451212968, -105.06716977176382, -109.96821037217727, -73.4393374019546, -106.82699249696297, -120.11636533528318, -116.847273539152, -121.54306854843536, -106.71860740081904, -154.2586291712276, -110.06188124985124, -114.61988645679442, -106.09845927045868, -121.54650888100454, -128.554702435807, -84.04940842538012, -131.0094327377019, -120.17601003293444, -65.67449337833312, -110.74174561887098, -111.73956501606666, -123.41101249076861, -176.18388133334116, -109.5265405728637, -129.73127319741747, -103.03236883307808, -74.9974941049738, -108.52297227593698, -108.26833275536013, -108.27843242647313, -115.29762847051894, -102.59858856051788, -101.03747800984921, -108.16546053244174, -108.79698331776262, -79.46073879942034, -108.99416081028184, -109.99547840765803, -111.19550401165337, -62.02563957487113, -123.40414107329957], "episode_lengths": [168, 68, 57, 1600, 1600, 77, 38, 51, 246, 63, 48, 63, 88, 49, 55, 185, 68, 1600, 123, 71, 43, 76, 96, 1600, 53, 1600, 80, 46, 106, 1600, 56, 81, 68, 57, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 92, 57, 58, 57, 47, 72, 1600, 1600, 57, 1600, 47, 1600, 87, 1600, 56, 64, 65, 63, 80, 38, 1600, 67, 69, 53, 109, 57, 797, 48, 76, 98, 92, 88, 1600, 151, 125, 1600, 1600, 38, 69, 1440, 46, 96, 62, 1600, 56, 44, 45, 59, 79, 1600, 74, 81, 1600, 35, 49, 147, 1600, 75]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29256255474593174, "mean_inference_ms": 0.9694559152430929, "mean_action_processing_ms": 0.18968520872230052, "mean_env_wait_ms": 0.3918096897405256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0062406063079833984, "StateBufferConnector_ms": 0.004456758499145508, "ViewRequirementAgentConnector_ms": 0.12109804153442383}}, "episode_reward_max": -62.02563957487113, "episode_reward_min": -176.18388133334116, "episode_reward_mean": -109.43899514549534, "episode_len_mean": 507.45, "episodes_this_iter": 7, "episodes_timesteps_total": 50745, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-135.25513430602098, -106.48931538720058, -105.46927715086441, -123.13518638017449, -135.84190664967358, -117.81027904600589, -109.85173654468792, -116.45519471728988, -144.12344038386703, -109.5010015869091, -112.59304169055012, -106.88099847922288, -104.99902512108412, -116.97286871387189, -107.72949738825051, -132.38890899702648, -106.6413203956547, -85.43775501473179, -120.41935443517255, -107.02163737601725, -111.23635936427179, -119.918512470151, -108.84242586697391, -84.34828797295629, -108.47606817803283, -133.13893411616758, -108.70058738060855, -115.33707291548575, -123.79102404567973, -142.01141749789235, -116.54825406421784, -107.75149732037137, -106.33801159661884, -105.91336169075656, -135.45944015112764, -73.57242001242322, -79.48607322502706, -84.33659009961904, -89.57854080046147, -96.98662711500242, -74.48033455020187, -78.71513056871729, -122.21994188169515, -100.67730562980474, -106.85288879845167, -104.28540795155243, -106.88622486308032, -119.53071222846086, -128.35822362820699, -75.56917029478025, -107.30527319482653, -111.91288345215993, -107.02769602312458, -78.17303149392953, -109.39794470833925, -116.2600874169907, -116.71471895037406, -107.59075862218316, -107.71610303293603, -115.45543451212968, -105.06716977176382, -109.96821037217727, -73.4393374019546, -106.82699249696297, -120.11636533528318, -116.847273539152, -121.54306854843536, -106.71860740081904, -154.2586291712276, -110.06188124985124, -114.61988645679442, -106.09845927045868, -121.54650888100454, -128.554702435807, -84.04940842538012, -131.0094327377019, -120.17601003293444, -65.67449337833312, -110.74174561887098, -111.73956501606666, -123.41101249076861, -176.18388133334116, -109.5265405728637, -129.73127319741747, -103.03236883307808, -74.9974941049738, -108.52297227593698, -108.26833275536013, -108.27843242647313, -115.29762847051894, -102.59858856051788, -101.03747800984921, -108.16546053244174, -108.79698331776262, -79.46073879942034, -108.99416081028184, -109.99547840765803, -111.19550401165337, -62.02563957487113, -123.40414107329957], "episode_lengths": [168, 68, 57, 1600, 1600, 77, 38, 51, 246, 63, 48, 63, 88, 49, 55, 185, 68, 1600, 123, 71, 43, 76, 96, 1600, 53, 1600, 80, 46, 106, 1600, 56, 81, 68, 57, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 92, 57, 58, 57, 47, 72, 1600, 1600, 57, 1600, 47, 1600, 87, 1600, 56, 64, 65, 63, 80, 38, 1600, 67, 69, 53, 109, 57, 797, 48, 76, 98, 92, 88, 1600, 151, 125, 1600, 1600, 38, 69, 1440, 46, 96, 62, 1600, 56, 44, 45, 59, 79, 1600, 74, 81, 1600, 35, 49, 147, 1600, 75]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29256255474593174, "mean_inference_ms": 0.9694559152430929, "mean_action_processing_ms": 0.18968520872230052, "mean_env_wait_ms": 0.3918096897405256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0062406063079833984, "StateBufferConnector_ms": 0.004456758499145508, "ViewRequirementAgentConnector_ms": 0.12109804153442383}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 319.6744648041555, "num_env_steps_trained_throughput_per_sec": 319.6744648041555, "timesteps_total": 236000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 236000, "timers": {"training_iteration_time_ms": 10165.163, "restore_workers_time_ms": 0.013, "training_step_time_ms": 10165.122, "sample_time_ms": 3893.087, "load_time_ms": 0.46, "load_throughput": 8688356.292, "learn_time_ms": 6263.206, "learn_throughput": 638.651, "synch_weights_time_ms": 7.778}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000}, "done": false, "episodes_total": 450, "training_iteration": 59, "trial_id": "4bb30_00000", "date": "2024-04-27_18-36-22", "timestamp": 1714268182, "time_this_iter_s": 12.516801118850708, "time_total_s": 582.7461776733398, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 582.7461776733398, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 42.48888888888889, "ram_util_percent": 64.11666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.434333625403784, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.9976456970649883, "policy_loss": -0.03933436450778797, "vf_loss": 3.0290339039298155, "vf_explained_var": 0.36126238755000534, "kl": 0.01569614486981026, "entropy": 9.372821778635824, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 55335.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "sampler_results": {"episode_reward_max": -62.02563957487113, "episode_reward_min": -176.18388133334116, "episode_reward_mean": -107.84964979748862, "episode_len_mean": 506.38, "episode_media": {}, "episodes_this_iter": 15, "episodes_timesteps_total": 50638, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-132.38890899702648, -106.6413203956547, -85.43775501473179, -120.41935443517255, -107.02163737601725, -111.23635936427179, -119.918512470151, -108.84242586697391, -84.34828797295629, -108.47606817803283, -133.13893411616758, -108.70058738060855, -115.33707291548575, -123.79102404567973, -142.01141749789235, -116.54825406421784, -107.75149732037137, -106.33801159661884, -105.91336169075656, -135.45944015112764, -73.57242001242322, -79.48607322502706, -84.33659009961904, -89.57854080046147, -96.98662711500242, -74.48033455020187, -78.71513056871729, -122.21994188169515, -100.67730562980474, -106.85288879845167, -104.28540795155243, -106.88622486308032, -119.53071222846086, -128.35822362820699, -75.56917029478025, -107.30527319482653, -111.91288345215993, -107.02769602312458, -78.17303149392953, -109.39794470833925, -116.2600874169907, -116.71471895037406, -107.59075862218316, -107.71610303293603, -115.45543451212968, -105.06716977176382, -109.96821037217727, -73.4393374019546, -106.82699249696297, -120.11636533528318, -116.847273539152, -121.54306854843536, -106.71860740081904, -154.2586291712276, -110.06188124985124, -114.61988645679442, -106.09845927045868, -121.54650888100454, -128.554702435807, -84.04940842538012, -131.0094327377019, -120.17601003293444, -65.67449337833312, -110.74174561887098, -111.73956501606666, -123.41101249076861, -176.18388133334116, -109.5265405728637, -129.73127319741747, -103.03236883307808, -74.9974941049738, -108.52297227593698, -108.26833275536013, -108.27843242647313, -115.29762847051894, -102.59858856051788, -101.03747800984921, -108.16546053244174, -108.79698331776262, -79.46073879942034, -108.99416081028184, -109.99547840765803, -111.19550401165337, -62.02563957487113, -123.40414107329957, -126.40278438924122, -114.30841763524836, -109.1379362348523, -106.97170917322859, -106.26435395386194, -109.99399084321286, -102.65821466388802, -78.49639845490259, -109.99923036843973, -74.69592106413853, -108.6076338212099, -112.73882689832152, -110.5017166631942, -108.75180003585666, -114.6444345454077], "episode_lengths": [185, 68, 1600, 123, 71, 43, 76, 96, 1600, 53, 1600, 80, 46, 106, 1600, 56, 81, 68, 57, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 92, 57, 58, 57, 47, 72, 1600, 1600, 57, 1600, 47, 1600, 87, 1600, 56, 64, 65, 63, 80, 38, 1600, 67, 69, 53, 109, 57, 797, 48, 76, 98, 92, 88, 1600, 151, 125, 1600, 1600, 38, 69, 1440, 46, 96, 62, 1600, 56, 44, 45, 59, 79, 1600, 74, 81, 1600, 35, 49, 147, 1600, 75, 193, 52, 45, 36, 63, 50, 57, 1600, 49, 1600, 91, 154, 58, 61, 55]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2929706674874942, "mean_inference_ms": 0.971170212432959, "mean_action_processing_ms": 0.1899570043889868, "mean_env_wait_ms": 0.39219471493816127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006293058395385742, "StateBufferConnector_ms": 0.0045223236083984375, "ViewRequirementAgentConnector_ms": 0.12197351455688477}}, "episode_reward_max": -62.02563957487113, "episode_reward_min": -176.18388133334116, "episode_reward_mean": -107.84964979748862, "episode_len_mean": 506.38, "episodes_this_iter": 15, "episodes_timesteps_total": 50638, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-132.38890899702648, -106.6413203956547, -85.43775501473179, -120.41935443517255, -107.02163737601725, -111.23635936427179, -119.918512470151, -108.84242586697391, -84.34828797295629, -108.47606817803283, -133.13893411616758, -108.70058738060855, -115.33707291548575, -123.79102404567973, -142.01141749789235, -116.54825406421784, -107.75149732037137, -106.33801159661884, -105.91336169075656, -135.45944015112764, -73.57242001242322, -79.48607322502706, -84.33659009961904, -89.57854080046147, -96.98662711500242, -74.48033455020187, -78.71513056871729, -122.21994188169515, -100.67730562980474, -106.85288879845167, -104.28540795155243, -106.88622486308032, -119.53071222846086, -128.35822362820699, -75.56917029478025, -107.30527319482653, -111.91288345215993, -107.02769602312458, -78.17303149392953, -109.39794470833925, -116.2600874169907, -116.71471895037406, -107.59075862218316, -107.71610303293603, -115.45543451212968, -105.06716977176382, -109.96821037217727, -73.4393374019546, -106.82699249696297, -120.11636533528318, -116.847273539152, -121.54306854843536, -106.71860740081904, -154.2586291712276, -110.06188124985124, -114.61988645679442, -106.09845927045868, -121.54650888100454, -128.554702435807, -84.04940842538012, -131.0094327377019, -120.17601003293444, -65.67449337833312, -110.74174561887098, -111.73956501606666, -123.41101249076861, -176.18388133334116, -109.5265405728637, -129.73127319741747, -103.03236883307808, -74.9974941049738, -108.52297227593698, -108.26833275536013, -108.27843242647313, -115.29762847051894, -102.59858856051788, -101.03747800984921, -108.16546053244174, -108.79698331776262, -79.46073879942034, -108.99416081028184, -109.99547840765803, -111.19550401165337, -62.02563957487113, -123.40414107329957, -126.40278438924122, -114.30841763524836, -109.1379362348523, -106.97170917322859, -106.26435395386194, -109.99399084321286, -102.65821466388802, -78.49639845490259, -109.99923036843973, -74.69592106413853, -108.6076338212099, -112.73882689832152, -110.5017166631942, -108.75180003585666, -114.6444345454077], "episode_lengths": [185, 68, 1600, 123, 71, 43, 76, 96, 1600, 53, 1600, 80, 46, 106, 1600, 56, 81, 68, 57, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 92, 57, 58, 57, 47, 72, 1600, 1600, 57, 1600, 47, 1600, 87, 1600, 56, 64, 65, 63, 80, 38, 1600, 67, 69, 53, 109, 57, 797, 48, 76, 98, 92, 88, 1600, 151, 125, 1600, 1600, 38, 69, 1440, 46, 96, 62, 1600, 56, 44, 45, 59, 79, 1600, 74, 81, 1600, 35, 49, 147, 1600, 75, 193, 52, 45, 36, 63, 50, 57, 1600, 49, 1600, 91, 154, 58, 61, 55]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2929706674874942, "mean_inference_ms": 0.971170212432959, "mean_action_processing_ms": 0.1899570043889868, "mean_env_wait_ms": 0.39219471493816127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006293058395385742, "StateBufferConnector_ms": 0.0045223236083984375, "ViewRequirementAgentConnector_ms": 0.12197351455688477}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 385.7160763434412, "num_env_steps_trained_throughput_per_sec": 385.7160763434412, "timesteps_total": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 10203.752, "restore_workers_time_ms": 0.013, "training_step_time_ms": 10203.712, "sample_time_ms": 3920.488, "load_time_ms": 0.457, "load_throughput": 8760948.303, "learn_time_ms": 6274.374, "learn_throughput": 637.514, "synch_weights_time_ms": 7.808}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "episodes_total": 465, "training_iteration": 60, "trial_id": "4bb30_00000", "date": "2024-04-27_18-36-32", "timestamp": 1714268192, "time_this_iter_s": 10.374484062194824, "time_total_s": 593.1206617355347, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 593.1206617355347, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 26.83333333333333, "ram_util_percent": 63.96666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.49164850993823, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0500052521201801, "policy_loss": -0.04332855137926276, "vf_loss": 1.086306504632837, "vf_explained_var": 0.3973251711937689, "kl": 0.013881093500939756, "entropy": 7.5484079535289474, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 56265.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000}, "sampler_results": {"episode_reward_max": -62.02563957487113, "episode_reward_min": -176.18388133334116, "episode_reward_mean": -107.17706906305462, "episode_len_mean": 519.97, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 51997, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-119.918512470151, -108.84242586697391, -84.34828797295629, -108.47606817803283, -133.13893411616758, -108.70058738060855, -115.33707291548575, -123.79102404567973, -142.01141749789235, -116.54825406421784, -107.75149732037137, -106.33801159661884, -105.91336169075656, -135.45944015112764, -73.57242001242322, -79.48607322502706, -84.33659009961904, -89.57854080046147, -96.98662711500242, -74.48033455020187, -78.71513056871729, -122.21994188169515, -100.67730562980474, -106.85288879845167, -104.28540795155243, -106.88622486308032, -119.53071222846086, -128.35822362820699, -75.56917029478025, -107.30527319482653, -111.91288345215993, -107.02769602312458, -78.17303149392953, -109.39794470833925, -116.2600874169907, -116.71471895037406, -107.59075862218316, -107.71610303293603, -115.45543451212968, -105.06716977176382, -109.96821037217727, -73.4393374019546, -106.82699249696297, -120.11636533528318, -116.847273539152, -121.54306854843536, -106.71860740081904, -154.2586291712276, -110.06188124985124, -114.61988645679442, -106.09845927045868, -121.54650888100454, -128.554702435807, -84.04940842538012, -131.0094327377019, -120.17601003293444, -65.67449337833312, -110.74174561887098, -111.73956501606666, -123.41101249076861, -176.18388133334116, -109.5265405728637, -129.73127319741747, -103.03236883307808, -74.9974941049738, -108.52297227593698, -108.26833275536013, -108.27843242647313, -115.29762847051894, -102.59858856051788, -101.03747800984921, -108.16546053244174, -108.79698331776262, -79.46073879942034, -108.99416081028184, -109.99547840765803, -111.19550401165337, -62.02563957487113, -123.40414107329957, -126.40278438924122, -114.30841763524836, -109.1379362348523, -106.97170917322859, -106.26435395386194, -109.99399084321286, -102.65821466388802, -78.49639845490259, -109.99923036843973, -74.69592106413853, -108.6076338212099, -112.73882689832152, -110.5017166631942, -108.75180003585666, -114.6444345454077, -111.47938685474483, -110.54928514025548, -110.43445571094068, -78.5375765003631, -113.95549376625382, -70.93106416691413], "episode_lengths": [76, 96, 1600, 53, 1600, 80, 46, 106, 1600, 56, 81, 68, 57, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 92, 57, 58, 57, 47, 72, 1600, 1600, 57, 1600, 47, 1600, 87, 1600, 56, 64, 65, 63, 80, 38, 1600, 67, 69, 53, 109, 57, 797, 48, 76, 98, 92, 88, 1600, 151, 125, 1600, 1600, 38, 69, 1440, 46, 96, 62, 1600, 56, 44, 45, 59, 79, 1600, 74, 81, 1600, 35, 49, 147, 1600, 75, 193, 52, 45, 36, 63, 50, 57, 1600, 49, 1600, 91, 154, 58, 61, 55, 55, 81, 54, 1600, 59, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2932514980156461, "mean_inference_ms": 0.971792799010709, "mean_action_processing_ms": 0.19014767012640774, "mean_env_wait_ms": 0.3925332474835306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006227970123291016, "StateBufferConnector_ms": 0.004561185836791992, "ViewRequirementAgentConnector_ms": 0.12257838249206543}}, "episode_reward_max": -62.02563957487113, "episode_reward_min": -176.18388133334116, "episode_reward_mean": -107.17706906305462, "episode_len_mean": 519.97, "episodes_this_iter": 6, "episodes_timesteps_total": 51997, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-119.918512470151, -108.84242586697391, -84.34828797295629, -108.47606817803283, -133.13893411616758, -108.70058738060855, -115.33707291548575, -123.79102404567973, -142.01141749789235, -116.54825406421784, -107.75149732037137, -106.33801159661884, -105.91336169075656, -135.45944015112764, -73.57242001242322, -79.48607322502706, -84.33659009961904, -89.57854080046147, -96.98662711500242, -74.48033455020187, -78.71513056871729, -122.21994188169515, -100.67730562980474, -106.85288879845167, -104.28540795155243, -106.88622486308032, -119.53071222846086, -128.35822362820699, -75.56917029478025, -107.30527319482653, -111.91288345215993, -107.02769602312458, -78.17303149392953, -109.39794470833925, -116.2600874169907, -116.71471895037406, -107.59075862218316, -107.71610303293603, -115.45543451212968, -105.06716977176382, -109.96821037217727, -73.4393374019546, -106.82699249696297, -120.11636533528318, -116.847273539152, -121.54306854843536, -106.71860740081904, -154.2586291712276, -110.06188124985124, -114.61988645679442, -106.09845927045868, -121.54650888100454, -128.554702435807, -84.04940842538012, -131.0094327377019, -120.17601003293444, -65.67449337833312, -110.74174561887098, -111.73956501606666, -123.41101249076861, -176.18388133334116, -109.5265405728637, -129.73127319741747, -103.03236883307808, -74.9974941049738, -108.52297227593698, -108.26833275536013, -108.27843242647313, -115.29762847051894, -102.59858856051788, -101.03747800984921, -108.16546053244174, -108.79698331776262, -79.46073879942034, -108.99416081028184, -109.99547840765803, -111.19550401165337, -62.02563957487113, -123.40414107329957, -126.40278438924122, -114.30841763524836, -109.1379362348523, -106.97170917322859, -106.26435395386194, -109.99399084321286, -102.65821466388802, -78.49639845490259, -109.99923036843973, -74.69592106413853, -108.6076338212099, -112.73882689832152, -110.5017166631942, -108.75180003585666, -114.6444345454077, -111.47938685474483, -110.54928514025548, -110.43445571094068, -78.5375765003631, -113.95549376625382, -70.93106416691413], "episode_lengths": [76, 96, 1600, 53, 1600, 80, 46, 106, 1600, 56, 81, 68, 57, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 1600, 92, 57, 58, 57, 47, 72, 1600, 1600, 57, 1600, 47, 1600, 87, 1600, 56, 64, 65, 63, 80, 38, 1600, 67, 69, 53, 109, 57, 797, 48, 76, 98, 92, 88, 1600, 151, 125, 1600, 1600, 38, 69, 1440, 46, 96, 62, 1600, 56, 44, 45, 59, 79, 1600, 74, 81, 1600, 35, 49, 147, 1600, 75, 193, 52, 45, 36, 63, 50, 57, 1600, 49, 1600, 91, 154, 58, 61, 55, 55, 81, 54, 1600, 59, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2932514980156461, "mean_inference_ms": 0.971792799010709, "mean_action_processing_ms": 0.19014767012640774, "mean_env_wait_ms": 0.3925332474835306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006227970123291016, "StateBufferConnector_ms": 0.004561185836791992, "ViewRequirementAgentConnector_ms": 0.12257838249206543}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 359.2904202997052, "num_env_steps_trained_throughput_per_sec": 359.2904202997052, "timesteps_total": 244000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 244000, "timers": {"training_iteration_time_ms": 10323.858, "restore_workers_time_ms": 0.013, "training_step_time_ms": 10323.819, "sample_time_ms": 3993.477, "load_time_ms": 0.456, "load_throughput": 8780205.15, "learn_time_ms": 6321.445, "learn_throughput": 632.767, "synch_weights_time_ms": 7.886}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000}, "done": false, "episodes_total": 471, "training_iteration": 61, "trial_id": "4bb30_00000", "date": "2024-04-27_18-36-44", "timestamp": 1714268204, "time_this_iter_s": 11.137842178344727, "time_total_s": 604.2585039138794, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 604.2585039138794, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 31.525, "ram_util_percent": 64.4125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.67526546652599, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.494452261291344, "policy_loss": -0.03746749313287837, "vf_loss": 3.5242502966875673, "vf_explained_var": 0.3995672802771291, "kl": 0.01514955910030548, "entropy": 11.01681517067776, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 57195.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "sampler_results": {"episode_reward_max": -62.02563957487113, "episode_reward_min": -176.18388133334116, "episode_reward_mean": -106.55466482583967, "episode_len_mean": 471.83, "episode_media": {}, "episodes_this_iter": 16, "episodes_timesteps_total": 47183, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-84.33659009961904, -89.57854080046147, -96.98662711500242, -74.48033455020187, -78.71513056871729, -122.21994188169515, -100.67730562980474, -106.85288879845167, -104.28540795155243, -106.88622486308032, -119.53071222846086, -128.35822362820699, -75.56917029478025, -107.30527319482653, -111.91288345215993, -107.02769602312458, -78.17303149392953, -109.39794470833925, -116.2600874169907, -116.71471895037406, -107.59075862218316, -107.71610303293603, -115.45543451212968, -105.06716977176382, -109.96821037217727, -73.4393374019546, -106.82699249696297, -120.11636533528318, -116.847273539152, -121.54306854843536, -106.71860740081904, -154.2586291712276, -110.06188124985124, -114.61988645679442, -106.09845927045868, -121.54650888100454, -128.554702435807, -84.04940842538012, -131.0094327377019, -120.17601003293444, -65.67449337833312, -110.74174561887098, -111.73956501606666, -123.41101249076861, -176.18388133334116, -109.5265405728637, -129.73127319741747, -103.03236883307808, -74.9974941049738, -108.52297227593698, -108.26833275536013, -108.27843242647313, -115.29762847051894, -102.59858856051788, -101.03747800984921, -108.16546053244174, -108.79698331776262, -79.46073879942034, -108.99416081028184, -109.99547840765803, -111.19550401165337, -62.02563957487113, -123.40414107329957, -126.40278438924122, -114.30841763524836, -109.1379362348523, -106.97170917322859, -106.26435395386194, -109.99399084321286, -102.65821466388802, -78.49639845490259, -109.99923036843973, -74.69592106413853, -108.6076338212099, -112.73882689832152, -110.5017166631942, -108.75180003585666, -114.6444345454077, -111.47938685474483, -110.54928514025548, -110.43445571094068, -78.5375765003631, -113.95549376625382, -70.93106416691413, -137.09042201359347, -102.8709063558262, -111.92751865371503, -108.29689528576533, -103.73928500534842, -111.6479583377205, -106.6629477698536, -111.99088536242023, -109.68906993036407, -110.44882440219013, -74.41440267914408, -108.6675504360733, -76.82895113550535, -113.06569087399232, -110.11977234408633, -109.93188419739778], "episode_lengths": [1600, 1600, 1600, 1600, 1600, 92, 57, 58, 57, 47, 72, 1600, 1600, 57, 1600, 47, 1600, 87, 1600, 56, 64, 65, 63, 80, 38, 1600, 67, 69, 53, 109, 57, 797, 48, 76, 98, 92, 88, 1600, 151, 125, 1600, 1600, 38, 69, 1440, 46, 96, 62, 1600, 56, 44, 45, 59, 79, 1600, 74, 81, 1600, 35, 49, 147, 1600, 75, 193, 52, 45, 36, 63, 50, 57, 1600, 49, 1600, 91, 154, 58, 61, 55, 55, 81, 54, 1600, 59, 1600, 1600, 59, 45, 46, 65, 69, 48, 49, 53, 34, 1600, 45, 1600, 74, 59, 59]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29393456760381165, "mean_inference_ms": 0.9740378012459885, "mean_action_processing_ms": 0.19061086289656293, "mean_env_wait_ms": 0.3932700319040109, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006335258483886719, "StateBufferConnector_ms": 0.0046079158782958984, "ViewRequirementAgentConnector_ms": 0.12593603134155273}}, "episode_reward_max": -62.02563957487113, "episode_reward_min": -176.18388133334116, "episode_reward_mean": -106.55466482583967, "episode_len_mean": 471.83, "episodes_this_iter": 16, "episodes_timesteps_total": 47183, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-84.33659009961904, -89.57854080046147, -96.98662711500242, -74.48033455020187, -78.71513056871729, -122.21994188169515, -100.67730562980474, -106.85288879845167, -104.28540795155243, -106.88622486308032, -119.53071222846086, -128.35822362820699, -75.56917029478025, -107.30527319482653, -111.91288345215993, -107.02769602312458, -78.17303149392953, -109.39794470833925, -116.2600874169907, -116.71471895037406, -107.59075862218316, -107.71610303293603, -115.45543451212968, -105.06716977176382, -109.96821037217727, -73.4393374019546, -106.82699249696297, -120.11636533528318, -116.847273539152, -121.54306854843536, -106.71860740081904, -154.2586291712276, -110.06188124985124, -114.61988645679442, -106.09845927045868, -121.54650888100454, -128.554702435807, -84.04940842538012, -131.0094327377019, -120.17601003293444, -65.67449337833312, -110.74174561887098, -111.73956501606666, -123.41101249076861, -176.18388133334116, -109.5265405728637, -129.73127319741747, -103.03236883307808, -74.9974941049738, -108.52297227593698, -108.26833275536013, -108.27843242647313, -115.29762847051894, -102.59858856051788, -101.03747800984921, -108.16546053244174, -108.79698331776262, -79.46073879942034, -108.99416081028184, -109.99547840765803, -111.19550401165337, -62.02563957487113, -123.40414107329957, -126.40278438924122, -114.30841763524836, -109.1379362348523, -106.97170917322859, -106.26435395386194, -109.99399084321286, -102.65821466388802, -78.49639845490259, -109.99923036843973, -74.69592106413853, -108.6076338212099, -112.73882689832152, -110.5017166631942, -108.75180003585666, -114.6444345454077, -111.47938685474483, -110.54928514025548, -110.43445571094068, -78.5375765003631, -113.95549376625382, -70.93106416691413, -137.09042201359347, -102.8709063558262, -111.92751865371503, -108.29689528576533, -103.73928500534842, -111.6479583377205, -106.6629477698536, -111.99088536242023, -109.68906993036407, -110.44882440219013, -74.41440267914408, -108.6675504360733, -76.82895113550535, -113.06569087399232, -110.11977234408633, -109.93188419739778], "episode_lengths": [1600, 1600, 1600, 1600, 1600, 92, 57, 58, 57, 47, 72, 1600, 1600, 57, 1600, 47, 1600, 87, 1600, 56, 64, 65, 63, 80, 38, 1600, 67, 69, 53, 109, 57, 797, 48, 76, 98, 92, 88, 1600, 151, 125, 1600, 1600, 38, 69, 1440, 46, 96, 62, 1600, 56, 44, 45, 59, 79, 1600, 74, 81, 1600, 35, 49, 147, 1600, 75, 193, 52, 45, 36, 63, 50, 57, 1600, 49, 1600, 91, 154, 58, 61, 55, 55, 81, 54, 1600, 59, 1600, 1600, 59, 45, 46, 65, 69, 48, 49, 53, 34, 1600, 45, 1600, 74, 59, 59]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29393456760381165, "mean_inference_ms": 0.9740378012459885, "mean_action_processing_ms": 0.19061086289656293, "mean_env_wait_ms": 0.3932700319040109, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006335258483886719, "StateBufferConnector_ms": 0.0046079158782958984, "ViewRequirementAgentConnector_ms": 0.12593603134155273}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 368.5553672345426, "num_env_steps_trained_throughput_per_sec": 368.5553672345426, "timesteps_total": 248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 248000, "timers": {"training_iteration_time_ms": 10417.941, "restore_workers_time_ms": 0.013, "training_step_time_ms": 10417.903, "sample_time_ms": 4029.751, "load_time_ms": 0.465, "load_throughput": 8602377.07, "learn_time_ms": 6379.369, "learn_throughput": 627.021, "synch_weights_time_ms": 7.772}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "done": false, "episodes_total": 487, "training_iteration": 62, "trial_id": "4bb30_00000", "date": "2024-04-27_18-36-54", "timestamp": 1714268214, "time_this_iter_s": 10.857765197753906, "time_total_s": 615.1162691116333, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 615.1162691116333, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 28.953333333333333, "ram_util_percent": 63.93333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.017778231892535, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.61316156953771, "policy_loss": -0.03250773677261927, "vf_loss": 2.640679547551178, "vf_explained_var": 0.2770007639162002, "kl": 0.009856318449117548, "entropy": 9.499425367642475, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 58125.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "sampler_results": {"episode_reward_max": -62.02563957487113, "episode_reward_min": -176.18388133334116, "episode_reward_mean": -107.61476550994344, "episode_len_mean": 415.23, "episode_media": {}, "episodes_this_iter": 8, "episodes_timesteps_total": 41523, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-104.28540795155243, -106.88622486308032, -119.53071222846086, -128.35822362820699, -75.56917029478025, -107.30527319482653, -111.91288345215993, -107.02769602312458, -78.17303149392953, -109.39794470833925, -116.2600874169907, -116.71471895037406, -107.59075862218316, -107.71610303293603, -115.45543451212968, -105.06716977176382, -109.96821037217727, -73.4393374019546, -106.82699249696297, -120.11636533528318, -116.847273539152, -121.54306854843536, -106.71860740081904, -154.2586291712276, -110.06188124985124, -114.61988645679442, -106.09845927045868, -121.54650888100454, -128.554702435807, -84.04940842538012, -131.0094327377019, -120.17601003293444, -65.67449337833312, -110.74174561887098, -111.73956501606666, -123.41101249076861, -176.18388133334116, -109.5265405728637, -129.73127319741747, -103.03236883307808, -74.9974941049738, -108.52297227593698, -108.26833275536013, -108.27843242647313, -115.29762847051894, -102.59858856051788, -101.03747800984921, -108.16546053244174, -108.79698331776262, -79.46073879942034, -108.99416081028184, -109.99547840765803, -111.19550401165337, -62.02563957487113, -123.40414107329957, -126.40278438924122, -114.30841763524836, -109.1379362348523, -106.97170917322859, -106.26435395386194, -109.99399084321286, -102.65821466388802, -78.49639845490259, -109.99923036843973, -74.69592106413853, -108.6076338212099, -112.73882689832152, -110.5017166631942, -108.75180003585666, -114.6444345454077, -111.47938685474483, -110.54928514025548, -110.43445571094068, -78.5375765003631, -113.95549376625382, -70.93106416691413, -137.09042201359347, -102.8709063558262, -111.92751865371503, -108.29689528576533, -103.73928500534842, -111.6479583377205, -106.6629477698536, -111.99088536242023, -109.68906993036407, -110.44882440219013, -74.41440267914408, -108.6675504360733, -76.82895113550535, -113.06569087399232, -110.11977234408633, -109.93188419739778, -65.42756405847643, -110.42287064306873, -109.10965899438287, -122.39505045056211, -124.82169415359387, -106.10864869830944, -109.52625074266395, -112.045690113275], "episode_lengths": [57, 47, 72, 1600, 1600, 57, 1600, 47, 1600, 87, 1600, 56, 64, 65, 63, 80, 38, 1600, 67, 69, 53, 109, 57, 797, 48, 76, 98, 92, 88, 1600, 151, 125, 1600, 1600, 38, 69, 1440, 46, 96, 62, 1600, 56, 44, 45, 59, 79, 1600, 74, 81, 1600, 35, 49, 147, 1600, 75, 193, 52, 45, 36, 63, 50, 57, 1600, 49, 1600, 91, 154, 58, 61, 55, 55, 81, 54, 1600, 59, 1600, 1600, 59, 45, 46, 65, 69, 48, 49, 53, 34, 1600, 45, 1600, 74, 59, 59, 1600, 59, 41, 593, 73, 47, 82, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2942442076702706, "mean_inference_ms": 0.975412342938258, "mean_action_processing_ms": 0.1908272326532694, "mean_env_wait_ms": 0.3936079650966168, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0063860416412353516, "StateBufferConnector_ms": 0.004697084426879883, "ViewRequirementAgentConnector_ms": 0.12833380699157715}}, "episode_reward_max": -62.02563957487113, "episode_reward_min": -176.18388133334116, "episode_reward_mean": -107.61476550994344, "episode_len_mean": 415.23, "episodes_this_iter": 8, "episodes_timesteps_total": 41523, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-104.28540795155243, -106.88622486308032, -119.53071222846086, -128.35822362820699, -75.56917029478025, -107.30527319482653, -111.91288345215993, -107.02769602312458, -78.17303149392953, -109.39794470833925, -116.2600874169907, -116.71471895037406, -107.59075862218316, -107.71610303293603, -115.45543451212968, -105.06716977176382, -109.96821037217727, -73.4393374019546, -106.82699249696297, -120.11636533528318, -116.847273539152, -121.54306854843536, -106.71860740081904, -154.2586291712276, -110.06188124985124, -114.61988645679442, -106.09845927045868, -121.54650888100454, -128.554702435807, -84.04940842538012, -131.0094327377019, -120.17601003293444, -65.67449337833312, -110.74174561887098, -111.73956501606666, -123.41101249076861, -176.18388133334116, -109.5265405728637, -129.73127319741747, -103.03236883307808, -74.9974941049738, -108.52297227593698, -108.26833275536013, -108.27843242647313, -115.29762847051894, -102.59858856051788, -101.03747800984921, -108.16546053244174, -108.79698331776262, -79.46073879942034, -108.99416081028184, -109.99547840765803, -111.19550401165337, -62.02563957487113, -123.40414107329957, -126.40278438924122, -114.30841763524836, -109.1379362348523, -106.97170917322859, -106.26435395386194, -109.99399084321286, -102.65821466388802, -78.49639845490259, -109.99923036843973, -74.69592106413853, -108.6076338212099, -112.73882689832152, -110.5017166631942, -108.75180003585666, -114.6444345454077, -111.47938685474483, -110.54928514025548, -110.43445571094068, -78.5375765003631, -113.95549376625382, -70.93106416691413, -137.09042201359347, -102.8709063558262, -111.92751865371503, -108.29689528576533, -103.73928500534842, -111.6479583377205, -106.6629477698536, -111.99088536242023, -109.68906993036407, -110.44882440219013, -74.41440267914408, -108.6675504360733, -76.82895113550535, -113.06569087399232, -110.11977234408633, -109.93188419739778, -65.42756405847643, -110.42287064306873, -109.10965899438287, -122.39505045056211, -124.82169415359387, -106.10864869830944, -109.52625074266395, -112.045690113275], "episode_lengths": [57, 47, 72, 1600, 1600, 57, 1600, 47, 1600, 87, 1600, 56, 64, 65, 63, 80, 38, 1600, 67, 69, 53, 109, 57, 797, 48, 76, 98, 92, 88, 1600, 151, 125, 1600, 1600, 38, 69, 1440, 46, 96, 62, 1600, 56, 44, 45, 59, 79, 1600, 74, 81, 1600, 35, 49, 147, 1600, 75, 193, 52, 45, 36, 63, 50, 57, 1600, 49, 1600, 91, 154, 58, 61, 55, 55, 81, 54, 1600, 59, 1600, 1600, 59, 45, 46, 65, 69, 48, 49, 53, 34, 1600, 45, 1600, 74, 59, 59, 1600, 59, 41, 593, 73, 47, 82, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2942442076702706, "mean_inference_ms": 0.975412342938258, "mean_action_processing_ms": 0.1908272326532694, "mean_env_wait_ms": 0.3936079650966168, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0063860416412353516, "StateBufferConnector_ms": 0.004697084426879883, "ViewRequirementAgentConnector_ms": 0.12833380699157715}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 378.79526999015104, "num_env_steps_trained_throughput_per_sec": 378.79526999015104, "timesteps_total": 252000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 10484.614, "restore_workers_time_ms": 0.013, "training_step_time_ms": 10484.576, "sample_time_ms": 4074.318, "load_time_ms": 0.465, "load_throughput": 8608556.622, "learn_time_ms": 6401.502, "learn_throughput": 624.853, "synch_weights_time_ms": 7.728}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": true, "episodes_total": 495, "training_iteration": 63, "trial_id": "4bb30_00000", "date": "2024-04-27_18-37-05", "timestamp": 1714268225, "time_this_iter_s": 10.564173221588135, "time_total_s": 625.6804423332214, "pid": 61297, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14e117560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 625.6804423332214, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 28.359999999999996, "ram_util_percent": 63.78666666666668}}
