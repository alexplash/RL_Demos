{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.455927110583551, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.070596559201517, "policy_loss": -0.01741733039899539, "vf_loss": 9.085106258238515, "vf_explained_var": -0.002462997744160314, "kl": 0.014537965457241635, "entropy": 5.668728040367045, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 465.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": -100.27526515570464, "episode_reward_min": -191.06248919875478, "episode_reward_mean": -115.5083709449435, "episode_len_mean": 289.54545454545456, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 3185, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-106.03109033026485, -114.28360098956463, -112.38861879900719, -114.50104494536792, -114.81237550882994, -100.85279933880952, -191.06248919875478, -105.66801867639708, -108.88840011176715, -100.27526515570464, -101.82837733991072], "episode_lengths": [67, 62, 59, 92, 103, 74, 941, 84, 40, 1600, 63]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33726233364987535, "mean_inference_ms": 1.1663374606843033, "mean_action_processing_ms": 0.2301661940393495, "mean_env_wait_ms": 0.44962834599157714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0064026225696910515, "StateBufferConnector_ms": 0.0048160552978515625, "ViewRequirementAgentConnector_ms": 0.1330180601640181}}, "episode_reward_max": -100.27526515570464, "episode_reward_min": -191.06248919875478, "episode_reward_mean": -115.5083709449435, "episode_len_mean": 289.54545454545456, "episodes_this_iter": 11, "episodes_timesteps_total": 3185, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-106.03109033026485, -114.28360098956463, -112.38861879900719, -114.50104494536792, -114.81237550882994, -100.85279933880952, -191.06248919875478, -105.66801867639708, -108.88840011176715, -100.27526515570464, -101.82837733991072], "episode_lengths": [67, 62, 59, 92, 103, 74, 941, 84, 40, 1600, 63]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33726233364987535, "mean_inference_ms": 1.1663374606843033, "mean_action_processing_ms": 0.2301661940393495, "mean_env_wait_ms": 0.44962834599157714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0064026225696910515, "StateBufferConnector_ms": 0.0048160552978515625, "ViewRequirementAgentConnector_ms": 0.1330180601640181}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 350.86205196468404, "num_env_steps_trained_throughput_per_sec": 350.86205196468404, "timesteps_total": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 11400.502, "restore_workers_time_ms": 0.017, "training_step_time_ms": 11400.454, "sample_time_ms": 4425.989, "load_time_ms": 0.354, "load_throughput": 11297788.552, "learn_time_ms": 6965.177, "learn_throughput": 574.285, "synch_weights_time_ms": 8.191}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 11, "training_iteration": 1, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-00-57", "timestamp": 1714269657, "time_this_iter_s": 11.404778957366943, "time_total_s": 11.404778957366943, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 11.404778957366943, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 32.91764705882353, "ram_util_percent": 66.15294117647058}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.51105769782938, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.0968763417714547, "policy_loss": -0.025924042824615714, "vf_loss": 3.119900151991075, "vf_explained_var": 0.02560522376850087, "kl": 0.014501114846445484, "entropy": 5.6447078827888735, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1395.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": -100.27526515570464, "episode_reward_min": -191.06248919875478, "episode_reward_mean": -114.42412377329589, "episode_len_mean": 409.875, "episode_media": {}, "episodes_this_iter": 5, "episodes_timesteps_total": 6558, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-106.03109033026485, -114.28360098956463, -112.38861879900719, -114.50104494536792, -114.81237550882994, -100.85279933880952, -191.06248919875478, -105.66801867639708, -108.88840011176715, -100.27526515570464, -101.82837733991072, -119.79881443125504, -117.9712382101621, -106.38200467609987, -113.67037118018852, -102.3714714806502], "episode_lengths": [67, 62, 59, 92, 103, 74, 941, 84, 40, 1600, 63, 1600, 1600, 84, 38, 51]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33067346174762147, "mean_inference_ms": 1.146974321989605, "mean_action_processing_ms": 0.22573076638514727, "mean_env_wait_ms": 0.44148555676691903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006596744060516357, "StateBufferConnector_ms": 0.004647672176361084, "ViewRequirementAgentConnector_ms": 0.1292690634727478}}, "episode_reward_max": -100.27526515570464, "episode_reward_min": -191.06248919875478, "episode_reward_mean": -114.42412377329589, "episode_len_mean": 409.875, "episodes_this_iter": 5, "episodes_timesteps_total": 6558, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-106.03109033026485, -114.28360098956463, -112.38861879900719, -114.50104494536792, -114.81237550882994, -100.85279933880952, -191.06248919875478, -105.66801867639708, -108.88840011176715, -100.27526515570464, -101.82837733991072, -119.79881443125504, -117.9712382101621, -106.38200467609987, -113.67037118018852, -102.3714714806502], "episode_lengths": [67, 62, 59, 92, 103, 74, 941, 84, 40, 1600, 63, 1600, 1600, 84, 38, 51]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33067346174762147, "mean_inference_ms": 1.146974321989605, "mean_action_processing_ms": 0.22573076638514727, "mean_env_wait_ms": 0.44148555676691903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006596744060516357, "StateBufferConnector_ms": 0.004647672176361084, "ViewRequirementAgentConnector_ms": 0.1292690634727478}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 397.56775176281127, "num_env_steps_trained_throughput_per_sec": 397.56775176281127, "timesteps_total": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 10730.845, "restore_workers_time_ms": 0.017, "training_step_time_ms": 10730.797, "sample_time_ms": 4176.268, "load_time_ms": 0.322, "load_throughput": 12404595.933, "learn_time_ms": 6545.745, "learn_throughput": 611.084, "synch_weights_time_ms": 7.858}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 16, "training_iteration": 2, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-01-07", "timestamp": 1714269667, "time_this_iter_s": 10.06606125831604, "time_total_s": 21.470840215682983, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 21.470840215682983, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 26.70714285714286, "ram_util_percent": 66.46428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.56442986867761, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.455375750158583, "policy_loss": -0.02583437231118961, "vf_loss": 1.4787648843100636, "vf_explained_var": 0.15174497058314662, "kl": 0.012226200461223706, "entropy": 5.719086635753673, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2325.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": -100.27526515570464, "episode_reward_min": -191.06248919875478, "episode_reward_mean": -114.24910114605125, "episode_len_mean": 542.1111111111111, "episode_media": {}, "episodes_this_iter": 2, "episodes_timesteps_total": 9758, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-106.03109033026485, -114.28360098956463, -112.38861879900719, -114.50104494536792, -114.81237550882994, -100.85279933880952, -191.06248919875478, -105.66801867639708, -108.88840011176715, -100.27526515570464, -101.82837733991072, -119.79881443125504, -117.9712382101621, -106.38200467609987, -113.67037118018852, -102.3714714806502, -110.45926046397304, -115.23857979221516], "episode_lengths": [67, 62, 59, 92, 103, 74, 941, 84, 40, 1600, 63, 1600, 1600, 84, 38, 51, 1600, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3283323515230616, "mean_inference_ms": 1.1388553296212387, "mean_action_processing_ms": 0.22387386568417295, "mean_env_wait_ms": 0.4388064343397479, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006645255618625217, "StateBufferConnector_ms": 0.004737906985812717, "ViewRequirementAgentConnector_ms": 0.12753009796142578}}, "episode_reward_max": -100.27526515570464, "episode_reward_min": -191.06248919875478, "episode_reward_mean": -114.24910114605125, "episode_len_mean": 542.1111111111111, "episodes_this_iter": 2, "episodes_timesteps_total": 9758, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-106.03109033026485, -114.28360098956463, -112.38861879900719, -114.50104494536792, -114.81237550882994, -100.85279933880952, -191.06248919875478, -105.66801867639708, -108.88840011176715, -100.27526515570464, -101.82837733991072, -119.79881443125504, -117.9712382101621, -106.38200467609987, -113.67037118018852, -102.3714714806502, -110.45926046397304, -115.23857979221516], "episode_lengths": [67, 62, 59, 92, 103, 74, 941, 84, 40, 1600, 63, 1600, 1600, 84, 38, 51, 1600, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3283323515230616, "mean_inference_ms": 1.1388553296212387, "mean_action_processing_ms": 0.22387386568417295, "mean_env_wait_ms": 0.4388064343397479, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006645255618625217, "StateBufferConnector_ms": 0.004737906985812717, "ViewRequirementAgentConnector_ms": 0.12753009796142578}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 354.17791776296025, "num_env_steps_trained_throughput_per_sec": 354.17791776296025, "timesteps_total": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 10918.487, "restore_workers_time_ms": 0.017, "training_step_time_ms": 10918.44, "sample_time_ms": 4067.336, "load_time_ms": 0.379, "load_throughput": 10556134.228, "learn_time_ms": 6842.062, "learn_throughput": 584.619, "synch_weights_time_ms": 8.096}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 18, "training_iteration": 3, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-01-18", "timestamp": 1714269678, "time_this_iter_s": 11.297456741333008, "time_total_s": 32.76829695701599, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 32.76829695701599, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 34.193749999999994, "ram_util_percent": 66.71875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.750564740742407, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7829414713638334, "policy_loss": -0.027640182933499735, "vf_loss": 1.8076643502119407, "vf_explained_var": 0.1494609748804441, "kl": 0.0145865219921229, "entropy": 5.763301305873419, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3255.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": -85.47368125462144, "episode_reward_min": -191.06248919875478, "episode_reward_mean": -111.79102620498006, "episode_len_mean": 591.16, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 14779, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-106.03109033026485, -114.28360098956463, -112.38861879900719, -114.50104494536792, -114.81237550882994, -100.85279933880952, -191.06248919875478, -105.66801867639708, -108.88840011176715, -100.27526515570464, -101.82837733991072, -119.79881443125504, -117.9712382101621, -106.38200467609987, -113.67037118018852, -102.3714714806502, -110.45926046397304, -115.23857979221516, -106.1584936505848, -99.98645677616322, -115.5268234165896, -85.47368125462144, -104.18303367963868, -109.95593781627156, -117.00740790170991], "episode_lengths": [67, 62, 59, 92, 103, 74, 941, 84, 40, 1600, 63, 1600, 1600, 84, 38, 51, 1600, 1600, 1600, 58, 1600, 1600, 49, 58, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3229566549411138, "mean_inference_ms": 1.1184564386862956, "mean_action_processing_ms": 0.21929739494391298, "mean_env_wait_ms": 0.4322526821107029, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006465911865234375, "StateBufferConnector_ms": 0.0050830841064453125, "ViewRequirementAgentConnector_ms": 0.12875843048095703}}, "episode_reward_max": -85.47368125462144, "episode_reward_min": -191.06248919875478, "episode_reward_mean": -111.79102620498006, "episode_len_mean": 591.16, "episodes_this_iter": 7, "episodes_timesteps_total": 14779, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-106.03109033026485, -114.28360098956463, -112.38861879900719, -114.50104494536792, -114.81237550882994, -100.85279933880952, -191.06248919875478, -105.66801867639708, -108.88840011176715, -100.27526515570464, -101.82837733991072, -119.79881443125504, -117.9712382101621, -106.38200467609987, -113.67037118018852, -102.3714714806502, -110.45926046397304, -115.23857979221516, -106.1584936505848, -99.98645677616322, -115.5268234165896, -85.47368125462144, -104.18303367963868, -109.95593781627156, -117.00740790170991], "episode_lengths": [67, 62, 59, 92, 103, 74, 941, 84, 40, 1600, 63, 1600, 1600, 84, 38, 51, 1600, 1600, 1600, 58, 1600, 1600, 49, 58, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3229566549411138, "mean_inference_ms": 1.1184564386862956, "mean_action_processing_ms": 0.21929739494391298, "mean_env_wait_ms": 0.4322526821107029, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006465911865234375, "StateBufferConnector_ms": 0.0050830841064453125, "ViewRequirementAgentConnector_ms": 0.12875843048095703}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 389.3449921670189, "num_env_steps_trained_throughput_per_sec": 389.3449921670189, "timesteps_total": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 10757.284, "restore_workers_time_ms": 0.019, "training_step_time_ms": 10757.235, "sample_time_ms": 4041.929, "load_time_ms": 0.381, "load_throughput": 10505457.733, "learn_time_ms": 6706.424, "learn_throughput": 596.443, "synch_weights_time_ms": 7.954}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 25, "training_iteration": 4, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-01-28", "timestamp": 1714269688, "time_this_iter_s": 10.27871322631836, "time_total_s": 43.04701018333435, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 43.04701018333435, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 28.9, "ram_util_percent": 67.21999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.921065641026344, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0497462949257403, "policy_loss": -0.028345451311719033, "vf_loss": 1.0747785221785306, "vf_explained_var": 0.17544005205554347, "kl": 0.016566079482808176, "entropy": 5.686126035259616, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4185.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": -82.17189284069737, "episode_reward_min": -191.06248919875478, "episode_reward_mean": -109.67445616655274, "episode_len_mean": 624.9655172413793, "episode_media": {}, "episodes_this_iter": 4, "episodes_timesteps_total": 18124, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-106.03109033026485, -114.28360098956463, -112.38861879900719, -114.50104494536792, -114.81237550882994, -100.85279933880952, -191.06248919875478, -105.66801867639708, -108.88840011176715, -100.27526515570464, -101.82837733991072, -119.79881443125504, -117.9712382101621, -106.38200467609987, -113.67037118018852, -102.3714714806502, -110.45926046397304, -115.23857979221516, -106.1584936505848, -99.98645677616322, -115.5268234165896, -85.47368125462144, -104.18303367963868, -109.95593781627156, -117.00740790170991, -82.17189284069737, -93.23788182555253, -105.90702924623464, -104.46676979304354], "episode_lengths": [67, 62, 59, 92, 103, 74, 941, 84, 40, 1600, 63, 1600, 1600, 84, 38, 51, 1600, 1600, 1600, 58, 1600, 1600, 49, 58, 56, 1600, 1600, 67, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3202021780821871, "mean_inference_ms": 1.1085506866315242, "mean_action_processing_ms": 0.21706404986337405, "mean_env_wait_ms": 0.4288411554473975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006605838907176051, "StateBufferConnector_ms": 0.004894157935833109, "ViewRequirementAgentConnector_ms": 0.12609547582165948}}, "episode_reward_max": -82.17189284069737, "episode_reward_min": -191.06248919875478, "episode_reward_mean": -109.67445616655274, "episode_len_mean": 624.9655172413793, "episodes_this_iter": 4, "episodes_timesteps_total": 18124, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-106.03109033026485, -114.28360098956463, -112.38861879900719, -114.50104494536792, -114.81237550882994, -100.85279933880952, -191.06248919875478, -105.66801867639708, -108.88840011176715, -100.27526515570464, -101.82837733991072, -119.79881443125504, -117.9712382101621, -106.38200467609987, -113.67037118018852, -102.3714714806502, -110.45926046397304, -115.23857979221516, -106.1584936505848, -99.98645677616322, -115.5268234165896, -85.47368125462144, -104.18303367963868, -109.95593781627156, -117.00740790170991, -82.17189284069737, -93.23788182555253, -105.90702924623464, -104.46676979304354], "episode_lengths": [67, 62, 59, 92, 103, 74, 941, 84, 40, 1600, 63, 1600, 1600, 84, 38, 51, 1600, 1600, 1600, 58, 1600, 1600, 49, 58, 56, 1600, 1600, 67, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3202021780821871, "mean_inference_ms": 1.1085506866315242, "mean_action_processing_ms": 0.21706404986337405, "mean_env_wait_ms": 0.4288411554473975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006605838907176051, "StateBufferConnector_ms": 0.004894157935833109, "ViewRequirementAgentConnector_ms": 0.12609547582165948}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 393.1418773990057, "num_env_steps_trained_throughput_per_sec": 393.1418773990057, "timesteps_total": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 10640.718, "restore_workers_time_ms": 0.018, "training_step_time_ms": 10640.67, "sample_time_ms": 3966.566, "load_time_ms": 0.398, "load_throughput": 10051052.001, "learn_time_ms": 6665.226, "learn_throughput": 600.13, "synch_weights_time_ms": 7.942}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 29, "training_iteration": 5, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-01-38", "timestamp": 1714269698, "time_this_iter_s": 10.178838014602661, "time_total_s": 53.22584819793701, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 53.22584819793701, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 29.88571428571429, "ram_util_percent": 66.67857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.385127215656222, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.720581133292127, "policy_loss": -0.05988053938020922, "vf_loss": 2.7781011761356424, "vf_explained_var": 0.16892251718428827, "kl": 0.011802399390996234, "entropy": 5.793992537836875, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5115.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": -82.17189284069737, "episode_reward_min": -191.06248919875478, "episode_reward_mean": -109.30361300978792, "episode_len_mean": 659.9428571428572, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 23098, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-106.03109033026485, -114.28360098956463, -112.38861879900719, -114.50104494536792, -114.81237550882994, -100.85279933880952, -191.06248919875478, -105.66801867639708, -108.88840011176715, -100.27526515570464, -101.82837733991072, -119.79881443125504, -117.9712382101621, -106.38200467609987, -113.67037118018852, -102.3714714806502, -110.45926046397304, -115.23857979221516, -106.1584936505848, -99.98645677616322, -115.5268234165896, -85.47368125462144, -104.18303367963868, -109.95593781627156, -117.00740790170991, -82.17189284069737, -93.23788182555253, -105.90702924623464, -104.46676979304354, -105.6391147629719, -107.59551447696984, -114.04718956068228, -113.33805177474147, -96.35776919549184, -108.08958674169021], "episode_lengths": [67, 62, 59, 92, 103, 74, 941, 84, 40, 1600, 63, 1600, 1600, 84, 38, 51, 1600, 1600, 1600, 58, 1600, 1600, 49, 58, 56, 1600, 1600, 67, 78, 1600, 46, 1600, 83, 1600, 45]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31696468153500557, "mean_inference_ms": 1.0962419707872064, "mean_action_processing_ms": 0.21439858497916586, "mean_env_wait_ms": 0.4248728632016741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0065135955810546875, "StateBufferConnector_ms": 0.004899842398507255, "ViewRequirementAgentConnector_ms": 0.1266493116106306}}, "episode_reward_max": -82.17189284069737, "episode_reward_min": -191.06248919875478, "episode_reward_mean": -109.30361300978792, "episode_len_mean": 659.9428571428572, "episodes_this_iter": 6, "episodes_timesteps_total": 23098, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-106.03109033026485, -114.28360098956463, -112.38861879900719, -114.50104494536792, -114.81237550882994, -100.85279933880952, -191.06248919875478, -105.66801867639708, -108.88840011176715, -100.27526515570464, -101.82837733991072, -119.79881443125504, -117.9712382101621, -106.38200467609987, -113.67037118018852, -102.3714714806502, -110.45926046397304, -115.23857979221516, -106.1584936505848, -99.98645677616322, -115.5268234165896, -85.47368125462144, -104.18303367963868, -109.95593781627156, -117.00740790170991, -82.17189284069737, -93.23788182555253, -105.90702924623464, -104.46676979304354, -105.6391147629719, -107.59551447696984, -114.04718956068228, -113.33805177474147, -96.35776919549184, -108.08958674169021], "episode_lengths": [67, 62, 59, 92, 103, 74, 941, 84, 40, 1600, 63, 1600, 1600, 84, 38, 51, 1600, 1600, 1600, 58, 1600, 1600, 49, 58, 56, 1600, 1600, 67, 78, 1600, 46, 1600, 83, 1600, 45]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31696468153500557, "mean_inference_ms": 1.0962419707872064, "mean_action_processing_ms": 0.21439858497916586, "mean_env_wait_ms": 0.4248728632016741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0065135955810546875, "StateBufferConnector_ms": 0.004899842398507255, "ViewRequirementAgentConnector_ms": 0.1266493116106306}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 389.9695099231633, "num_env_steps_trained_throughput_per_sec": 389.9695099231633, "timesteps_total": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 10576.802, "restore_workers_time_ms": 0.018, "training_step_time_ms": 10576.755, "sample_time_ms": 3935.621, "load_time_ms": 0.395, "load_throughput": 10122000.603, "learn_time_ms": 6632.124, "learn_throughput": 603.125, "synch_weights_time_ms": 8.091}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 35, "training_iteration": 6, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-01-49", "timestamp": 1714269709, "time_this_iter_s": 10.261749029159546, "time_total_s": 63.48759722709656, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 63.48759722709656, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 30.420000000000005, "ram_util_percent": 66.41333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.372699730562907, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.333530635597505, "policy_loss": -0.03170835452695047, "vf_loss": 2.361568787257357, "vf_explained_var": 0.18316698151250038, "kl": 0.01835101851340703, "entropy": 5.783955805788758, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6045.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": -82.17189284069737, "episode_reward_min": -191.06248919875478, "episode_reward_mean": -110.59097420836063, "episode_len_mean": 642.5116279069767, "episode_media": {}, "episodes_this_iter": 8, "episodes_timesteps_total": 27628, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-106.03109033026485, -114.28360098956463, -112.38861879900719, -114.50104494536792, -114.81237550882994, -100.85279933880952, -191.06248919875478, -105.66801867639708, -108.88840011176715, -100.27526515570464, -101.82837733991072, -119.79881443125504, -117.9712382101621, -106.38200467609987, -113.67037118018852, -102.3714714806502, -110.45926046397304, -115.23857979221516, -106.1584936505848, -99.98645677616322, -115.5268234165896, -85.47368125462144, -104.18303367963868, -109.95593781627156, -117.00740790170991, -82.17189284069737, -93.23788182555253, -105.90702924623464, -104.46676979304354, -105.6391147629719, -107.59551447696984, -114.04718956068228, -113.33805177474147, -96.35776919549184, -108.08958674169021, -189.2307974797488, -107.77688434873025, -104.21218206179391, -105.63208521384125, -102.25345442987854, -105.18705326224796, -109.74655774765284, -105.74642107303565], "episode_lengths": [67, 62, 59, 92, 103, 74, 941, 84, 40, 1600, 63, 1600, 1600, 84, 38, 51, 1600, 1600, 1600, 58, 1600, 1600, 49, 58, 56, 1600, 1600, 67, 78, 1600, 46, 1600, 83, 1600, 45, 972, 63, 55, 54, 113, 1600, 1600, 73]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3155688905487903, "mean_inference_ms": 1.0895677154044654, "mean_action_processing_ms": 0.2126398371845573, "mean_env_wait_ms": 0.42477224082768306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006547085074491279, "StateBufferConnector_ms": 0.0050666720368141354, "ViewRequirementAgentConnector_ms": 0.1318310582360556}}, "episode_reward_max": -82.17189284069737, "episode_reward_min": -191.06248919875478, "episode_reward_mean": -110.59097420836063, "episode_len_mean": 642.5116279069767, "episodes_this_iter": 8, "episodes_timesteps_total": 27628, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-106.03109033026485, -114.28360098956463, -112.38861879900719, -114.50104494536792, -114.81237550882994, -100.85279933880952, -191.06248919875478, -105.66801867639708, -108.88840011176715, -100.27526515570464, -101.82837733991072, -119.79881443125504, -117.9712382101621, -106.38200467609987, -113.67037118018852, -102.3714714806502, -110.45926046397304, -115.23857979221516, -106.1584936505848, -99.98645677616322, -115.5268234165896, -85.47368125462144, -104.18303367963868, -109.95593781627156, -117.00740790170991, -82.17189284069737, -93.23788182555253, -105.90702924623464, -104.46676979304354, -105.6391147629719, -107.59551447696984, -114.04718956068228, -113.33805177474147, -96.35776919549184, -108.08958674169021, -189.2307974797488, -107.77688434873025, -104.21218206179391, -105.63208521384125, -102.25345442987854, -105.18705326224796, -109.74655774765284, -105.74642107303565], "episode_lengths": [67, 62, 59, 92, 103, 74, 941, 84, 40, 1600, 63, 1600, 1600, 84, 38, 51, 1600, 1600, 1600, 58, 1600, 1600, 49, 58, 56, 1600, 1600, 67, 78, 1600, 46, 1600, 83, 1600, 45, 972, 63, 55, 54, 113, 1600, 1600, 73]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3155688905487903, "mean_inference_ms": 1.0895677154044654, "mean_action_processing_ms": 0.2126398371845573, "mean_env_wait_ms": 0.42477224082768306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006547085074491279, "StateBufferConnector_ms": 0.0050666720368141354, "ViewRequirementAgentConnector_ms": 0.1318310582360556}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 364.2449893674051, "num_env_steps_trained_throughput_per_sec": 364.2449893674051, "timesteps_total": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 10634.635, "restore_workers_time_ms": 0.018, "training_step_time_ms": 10634.588, "sample_time_ms": 4039.666, "load_time_ms": 0.392, "load_throughput": 10203345.96, "learn_time_ms": 6586.056, "learn_throughput": 607.344, "synch_weights_time_ms": 7.954}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 43, "training_iteration": 7, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-02-00", "timestamp": 1714269720, "time_this_iter_s": 10.988121747970581, "time_total_s": 74.47571897506714, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 74.47571897506714, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 36.65, "ram_util_percent": 62.125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.151038898960238, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3704929731309323, "policy_loss": -0.02924233431256907, "vf_loss": 2.3961954646533536, "vf_explained_var": 0.10614120806417157, "kl": 0.01769927219878268, "entropy": 5.662030828127297, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6975.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": -82.17189284069737, "episode_reward_min": -191.06248919875478, "episode_reward_mean": -110.938576407996, "episode_len_mean": 659.3404255319149, "episode_media": {}, "episodes_this_iter": 4, "episodes_timesteps_total": 30989, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-106.03109033026485, -114.28360098956463, -112.38861879900719, -114.50104494536792, -114.81237550882994, -100.85279933880952, -191.06248919875478, -105.66801867639708, -108.88840011176715, -100.27526515570464, -101.82837733991072, -119.79881443125504, -117.9712382101621, -106.38200467609987, -113.67037118018852, -102.3714714806502, -110.45926046397304, -115.23857979221516, -106.1584936505848, -99.98645677616322, -115.5268234165896, -85.47368125462144, -104.18303367963868, -109.95593781627156, -117.00740790170991, -82.17189284069737, -93.23788182555253, -105.90702924623464, -104.46676979304354, -105.6391147629719, -107.59551447696984, -114.04718956068228, -113.33805177474147, -96.35776919549184, -108.08958674169021, -189.2307974797488, -107.77688434873025, -104.21218206179391, -105.63208521384125, -102.25345442987854, -105.18705326224796, -109.74655774765284, -105.74642107303565, -95.74877264735359, -115.48749781705327, -123.11756407958953, -124.34736567230895], "episode_lengths": [67, 62, 59, 92, 103, 74, 941, 84, 40, 1600, 63, 1600, 1600, 84, 38, 51, 1600, 1600, 1600, 58, 1600, 1600, 49, 58, 56, 1600, 1600, 67, 78, 1600, 46, 1600, 83, 1600, 45, 972, 63, 55, 54, 113, 1600, 1600, 73, 1600, 1600, 70, 91]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3148844350446523, "mean_inference_ms": 1.0877728357867307, "mean_action_processing_ms": 0.21209190146693802, "mean_env_wait_ms": 0.42405249610813955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006501725379456865, "StateBufferConnector_ms": 0.005063097527686586, "ViewRequirementAgentConnector_ms": 0.1327291448065575}}, "episode_reward_max": -82.17189284069737, "episode_reward_min": -191.06248919875478, "episode_reward_mean": -110.938576407996, "episode_len_mean": 659.3404255319149, "episodes_this_iter": 4, "episodes_timesteps_total": 30989, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-106.03109033026485, -114.28360098956463, -112.38861879900719, -114.50104494536792, -114.81237550882994, -100.85279933880952, -191.06248919875478, -105.66801867639708, -108.88840011176715, -100.27526515570464, -101.82837733991072, -119.79881443125504, -117.9712382101621, -106.38200467609987, -113.67037118018852, -102.3714714806502, -110.45926046397304, -115.23857979221516, -106.1584936505848, -99.98645677616322, -115.5268234165896, -85.47368125462144, -104.18303367963868, -109.95593781627156, -117.00740790170991, -82.17189284069737, -93.23788182555253, -105.90702924623464, -104.46676979304354, -105.6391147629719, -107.59551447696984, -114.04718956068228, -113.33805177474147, -96.35776919549184, -108.08958674169021, -189.2307974797488, -107.77688434873025, -104.21218206179391, -105.63208521384125, -102.25345442987854, -105.18705326224796, -109.74655774765284, -105.74642107303565, -95.74877264735359, -115.48749781705327, -123.11756407958953, -124.34736567230895], "episode_lengths": [67, 62, 59, 92, 103, 74, 941, 84, 40, 1600, 63, 1600, 1600, 84, 38, 51, 1600, 1600, 1600, 58, 1600, 1600, 49, 58, 56, 1600, 1600, 67, 78, 1600, 46, 1600, 83, 1600, 45, 972, 63, 55, 54, 113, 1600, 1600, 73, 1600, 1600, 70, 91]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3148844350446523, "mean_inference_ms": 1.0877728357867307, "mean_action_processing_ms": 0.21209190146693802, "mean_env_wait_ms": 0.42405249610813955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006501725379456865, "StateBufferConnector_ms": 0.005063097527686586, "ViewRequirementAgentConnector_ms": 0.1327291448065575}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 348.8791002150163, "num_env_steps_trained_throughput_per_sec": 348.8791002150163, "timesteps_total": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 10738.469, "restore_workers_time_ms": 0.019, "training_step_time_ms": 10738.419, "sample_time_ms": 4047.938, "load_time_ms": 0.39, "load_throughput": 10249540.13, "learn_time_ms": 6681.563, "learn_throughput": 598.662, "synch_weights_time_ms": 7.994}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 47, "training_iteration": 8, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-02-11", "timestamp": 1714269731, "time_this_iter_s": 11.470728158950806, "time_total_s": 85.94644713401794, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 85.94644713401794, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 37.7625, "ram_util_percent": 62.1375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.201576459664171, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0912622062577015, "policy_loss": -0.030592947765203413, "vf_loss": 2.1184960238154855, "vf_explained_var": 0.21593419582613052, "kl": 0.016795666823767798, "entropy": 5.594880447080058, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7905.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": -82.17189284069737, "episode_reward_min": -227.63697320905524, "episode_reward_mean": -112.86785549484699, "episode_len_mean": 684.16, "episode_media": {}, "episodes_this_iter": 3, "episodes_timesteps_total": 34208, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-106.03109033026485, -114.28360098956463, -112.38861879900719, -114.50104494536792, -114.81237550882994, -100.85279933880952, -191.06248919875478, -105.66801867639708, -108.88840011176715, -100.27526515570464, -101.82837733991072, -119.79881443125504, -117.9712382101621, -106.38200467609987, -113.67037118018852, -102.3714714806502, -110.45926046397304, -115.23857979221516, -106.1584936505848, -99.98645677616322, -115.5268234165896, -85.47368125462144, -104.18303367963868, -109.95593781627156, -117.00740790170991, -82.17189284069737, -93.23788182555253, -105.90702924623464, -104.46676979304354, -105.6391147629719, -107.59551447696984, -114.04718956068228, -113.33805177474147, -96.35776919549184, -108.08958674169021, -189.2307974797488, -107.77688434873025, -104.21218206179391, -105.63208521384125, -102.25345442987854, -105.18705326224796, -109.74655774765284, -105.74642107303565, -95.74877264735359, -115.48749781705327, -123.11756407958953, -124.34736567230895, -98.43422503718101, -227.63697320905524, -103.20848532030111], "episode_lengths": [67, 62, 59, 92, 103, 74, 941, 84, 40, 1600, 63, 1600, 1600, 84, 38, 51, 1600, 1600, 1600, 58, 1600, 1600, 49, 58, 56, 1600, 1600, 67, 78, 1600, 46, 1600, 83, 1600, 45, 972, 63, 55, 54, 113, 1600, 1600, 73, 1600, 1600, 70, 91, 1600, 1561, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31459186332504346, "mean_inference_ms": 1.0871949990069185, "mean_action_processing_ms": 0.21185285696495867, "mean_env_wait_ms": 0.42386942169311337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006461620330810547, "StateBufferConnector_ms": 0.005098819732666016, "ViewRequirementAgentConnector_ms": 0.13291692733764648}}, "episode_reward_max": -82.17189284069737, "episode_reward_min": -227.63697320905524, "episode_reward_mean": -112.86785549484699, "episode_len_mean": 684.16, "episodes_this_iter": 3, "episodes_timesteps_total": 34208, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-106.03109033026485, -114.28360098956463, -112.38861879900719, -114.50104494536792, -114.81237550882994, -100.85279933880952, -191.06248919875478, -105.66801867639708, -108.88840011176715, -100.27526515570464, -101.82837733991072, -119.79881443125504, -117.9712382101621, -106.38200467609987, -113.67037118018852, -102.3714714806502, -110.45926046397304, -115.23857979221516, -106.1584936505848, -99.98645677616322, -115.5268234165896, -85.47368125462144, -104.18303367963868, -109.95593781627156, -117.00740790170991, -82.17189284069737, -93.23788182555253, -105.90702924623464, -104.46676979304354, -105.6391147629719, -107.59551447696984, -114.04718956068228, -113.33805177474147, -96.35776919549184, -108.08958674169021, -189.2307974797488, -107.77688434873025, -104.21218206179391, -105.63208521384125, -102.25345442987854, -105.18705326224796, -109.74655774765284, -105.74642107303565, -95.74877264735359, -115.48749781705327, -123.11756407958953, -124.34736567230895, -98.43422503718101, -227.63697320905524, -103.20848532030111], "episode_lengths": [67, 62, 59, 92, 103, 74, 941, 84, 40, 1600, 63, 1600, 1600, 84, 38, 51, 1600, 1600, 1600, 58, 1600, 1600, 49, 58, 56, 1600, 1600, 67, 78, 1600, 46, 1600, 83, 1600, 45, 972, 63, 55, 54, 113, 1600, 1600, 73, 1600, 1600, 70, 91, 1600, 1561, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31459186332504346, "mean_inference_ms": 1.0871949990069185, "mean_action_processing_ms": 0.21185285696495867, "mean_env_wait_ms": 0.42386942169311337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006461620330810547, "StateBufferConnector_ms": 0.005098819732666016, "ViewRequirementAgentConnector_ms": 0.13291692733764648}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 381.90375420875193, "num_env_steps_trained_throughput_per_sec": 381.90375420875193, "timesteps_total": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 10709.067, "restore_workers_time_ms": 0.018, "training_step_time_ms": 10709.019, "sample_time_ms": 4082.997, "load_time_ms": 0.398, "load_throughput": 10044900.479, "learn_time_ms": 6617.212, "learn_throughput": 604.484, "synch_weights_time_ms": 7.884}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 50, "training_iteration": 9, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-02-22", "timestamp": 1714269742, "time_this_iter_s": 10.477802276611328, "time_total_s": 96.42424941062927, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 96.42424941062927, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 32.6, "ram_util_percent": 62.77333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.399939162115897, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6266868458362296, "policy_loss": -0.02930016046820549, "vf_loss": 0.6524808978681923, "vf_explained_var": 0.22817605035279387, "kl": 0.01753054012001731, "entropy": 5.409983957454722, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8835.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": -82.17189284069737, "episode_reward_min": -227.63697320905524, "episode_reward_mean": -112.42980399526407, "episode_len_mean": 719.3846153846154, "episode_media": {}, "episodes_this_iter": 2, "episodes_timesteps_total": 37408, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-106.03109033026485, -114.28360098956463, -112.38861879900719, -114.50104494536792, -114.81237550882994, -100.85279933880952, -191.06248919875478, -105.66801867639708, -108.88840011176715, -100.27526515570464, -101.82837733991072, -119.79881443125504, -117.9712382101621, -106.38200467609987, -113.67037118018852, -102.3714714806502, -110.45926046397304, -115.23857979221516, -106.1584936505848, -99.98645677616322, -115.5268234165896, -85.47368125462144, -104.18303367963868, -109.95593781627156, -117.00740790170991, -82.17189284069737, -93.23788182555253, -105.90702924623464, -104.46676979304354, -105.6391147629719, -107.59551447696984, -114.04718956068228, -113.33805177474147, -96.35776919549184, -108.08958674169021, -189.2307974797488, -107.77688434873025, -104.21218206179391, -105.63208521384125, -102.25345442987854, -105.18705326224796, -109.74655774765284, -105.74642107303565, -95.74877264735359, -115.48749781705327, -123.11756407958953, -124.34736567230895, -98.43422503718101, -227.63697320905524, -103.20848532030111, -104.74097217605018, -98.2160608353316], "episode_lengths": [67, 62, 59, 92, 103, 74, 941, 84, 40, 1600, 63, 1600, 1600, 84, 38, 51, 1600, 1600, 1600, 58, 1600, 1600, 49, 58, 56, 1600, 1600, 67, 78, 1600, 46, 1600, 83, 1600, 45, 972, 63, 55, 54, 113, 1600, 1600, 73, 1600, 1600, 70, 91, 1600, 1561, 58, 1600, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3144838015144958, "mean_inference_ms": 1.0865632795009428, "mean_action_processing_ms": 0.21164573692419275, "mean_env_wait_ms": 0.42378071467647843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006441428111149714, "StateBufferConnector_ms": 0.005076940243060772, "ViewRequirementAgentConnector_ms": 0.13318428626427284}}, "episode_reward_max": -82.17189284069737, "episode_reward_min": -227.63697320905524, "episode_reward_mean": -112.42980399526407, "episode_len_mean": 719.3846153846154, "episodes_this_iter": 2, "episodes_timesteps_total": 37408, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-106.03109033026485, -114.28360098956463, -112.38861879900719, -114.50104494536792, -114.81237550882994, -100.85279933880952, -191.06248919875478, -105.66801867639708, -108.88840011176715, -100.27526515570464, -101.82837733991072, -119.79881443125504, -117.9712382101621, -106.38200467609987, -113.67037118018852, -102.3714714806502, -110.45926046397304, -115.23857979221516, -106.1584936505848, -99.98645677616322, -115.5268234165896, -85.47368125462144, -104.18303367963868, -109.95593781627156, -117.00740790170991, -82.17189284069737, -93.23788182555253, -105.90702924623464, -104.46676979304354, -105.6391147629719, -107.59551447696984, -114.04718956068228, -113.33805177474147, -96.35776919549184, -108.08958674169021, -189.2307974797488, -107.77688434873025, -104.21218206179391, -105.63208521384125, -102.25345442987854, -105.18705326224796, -109.74655774765284, -105.74642107303565, -95.74877264735359, -115.48749781705327, -123.11756407958953, -124.34736567230895, -98.43422503718101, -227.63697320905524, -103.20848532030111, -104.74097217605018, -98.2160608353316], "episode_lengths": [67, 62, 59, 92, 103, 74, 941, 84, 40, 1600, 63, 1600, 1600, 84, 38, 51, 1600, 1600, 1600, 58, 1600, 1600, 49, 58, 56, 1600, 1600, 67, 78, 1600, 46, 1600, 83, 1600, 45, 972, 63, 55, 54, 113, 1600, 1600, 73, 1600, 1600, 70, 91, 1600, 1561, 58, 1600, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3144838015144958, "mean_inference_ms": 1.0865632795009428, "mean_action_processing_ms": 0.21164573692419275, "mean_env_wait_ms": 0.42378071467647843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006441428111149714, "StateBufferConnector_ms": 0.005076940243060772, "ViewRequirementAgentConnector_ms": 0.13318428626427284}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 378.0415679935747, "num_env_steps_trained_throughput_per_sec": 378.0415679935747, "timesteps_total": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 10696.246, "restore_workers_time_ms": 0.017, "training_step_time_ms": 10696.199, "sample_time_ms": 4066.096, "load_time_ms": 0.433, "load_throughput": 9231946.294, "learn_time_ms": 6621.227, "learn_throughput": 604.118, "synch_weights_time_ms": 7.914}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 52, "training_iteration": 10, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-02-32", "timestamp": 1714269752, "time_this_iter_s": 10.585210084915161, "time_total_s": 107.00945949554443, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 107.00945949554443, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 28.406666666666663, "ram_util_percent": 62.31333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.88443971635193, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1270050792395319, "policy_loss": -0.033441150396741844, "vf_loss": 1.1568965422850783, "vf_explained_var": 0.21230807189018497, "kl": 0.017748445774121994, "entropy": 5.4986059552879745, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9765.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "sampler_results": {"episode_reward_max": -80.97254000151354, "episode_reward_min": -227.63697320905524, "episode_reward_mean": -111.52479518895638, "episode_len_mean": 731.7931034482758, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 42444, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-106.03109033026485, -114.28360098956463, -112.38861879900719, -114.50104494536792, -114.81237550882994, -100.85279933880952, -191.06248919875478, -105.66801867639708, -108.88840011176715, -100.27526515570464, -101.82837733991072, -119.79881443125504, -117.9712382101621, -106.38200467609987, -113.67037118018852, -102.3714714806502, -110.45926046397304, -115.23857979221516, -106.1584936505848, -99.98645677616322, -115.5268234165896, -85.47368125462144, -104.18303367963868, -109.95593781627156, -117.00740790170991, -82.17189284069737, -93.23788182555253, -105.90702924623464, -104.46676979304354, -105.6391147629719, -107.59551447696984, -114.04718956068228, -113.33805177474147, -96.35776919549184, -108.08958674169021, -189.2307974797488, -107.77688434873025, -104.21218206179391, -105.63208521384125, -102.25345442987854, -105.18705326224796, -109.74655774765284, -105.74642107303565, -95.74877264735359, -115.48749781705327, -123.11756407958953, -124.34736567230895, -98.43422503718101, -227.63697320905524, -103.20848532030111, -104.74097217605018, -98.2160608353316, -107.68068003419279, -107.04693271280453, -110.03438186249447, -110.67549925545471, -80.97254000151354, -105.67827933927936], "episode_lengths": [67, 62, 59, 92, 103, 74, 941, 84, 40, 1600, 63, 1600, 1600, 84, 38, 51, 1600, 1600, 1600, 58, 1600, 1600, 49, 58, 56, 1600, 1600, 67, 78, 1600, 46, 1600, 83, 1600, 45, 972, 63, 55, 54, 113, 1600, 1600, 73, 1600, 1600, 70, 91, 1600, 1561, 58, 1600, 1600, 1600, 73, 107, 1600, 1600, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3142743238344028, "mean_inference_ms": 1.085053470750791, "mean_action_processing_ms": 0.2111178034775174, "mean_env_wait_ms": 0.4235797557917033, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006394139651594491, "StateBufferConnector_ms": 0.005018711090087891, "ViewRequirementAgentConnector_ms": 0.13385353417232118}}, "episode_reward_max": -80.97254000151354, "episode_reward_min": -227.63697320905524, "episode_reward_mean": -111.52479518895638, "episode_len_mean": 731.7931034482758, "episodes_this_iter": 6, "episodes_timesteps_total": 42444, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-106.03109033026485, -114.28360098956463, -112.38861879900719, -114.50104494536792, -114.81237550882994, -100.85279933880952, -191.06248919875478, -105.66801867639708, -108.88840011176715, -100.27526515570464, -101.82837733991072, -119.79881443125504, -117.9712382101621, -106.38200467609987, -113.67037118018852, -102.3714714806502, -110.45926046397304, -115.23857979221516, -106.1584936505848, -99.98645677616322, -115.5268234165896, -85.47368125462144, -104.18303367963868, -109.95593781627156, -117.00740790170991, -82.17189284069737, -93.23788182555253, -105.90702924623464, -104.46676979304354, -105.6391147629719, -107.59551447696984, -114.04718956068228, -113.33805177474147, -96.35776919549184, -108.08958674169021, -189.2307974797488, -107.77688434873025, -104.21218206179391, -105.63208521384125, -102.25345442987854, -105.18705326224796, -109.74655774765284, -105.74642107303565, -95.74877264735359, -115.48749781705327, -123.11756407958953, -124.34736567230895, -98.43422503718101, -227.63697320905524, -103.20848532030111, -104.74097217605018, -98.2160608353316, -107.68068003419279, -107.04693271280453, -110.03438186249447, -110.67549925545471, -80.97254000151354, -105.67827933927936], "episode_lengths": [67, 62, 59, 92, 103, 74, 941, 84, 40, 1600, 63, 1600, 1600, 84, 38, 51, 1600, 1600, 1600, 58, 1600, 1600, 49, 58, 56, 1600, 1600, 67, 78, 1600, 46, 1600, 83, 1600, 45, 972, 63, 55, 54, 113, 1600, 1600, 73, 1600, 1600, 70, 91, 1600, 1561, 58, 1600, 1600, 1600, 73, 107, 1600, 1600, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3142743238344028, "mean_inference_ms": 1.085053470750791, "mean_action_processing_ms": 0.2111178034775174, "mean_env_wait_ms": 0.4235797557917033, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006394139651594491, "StateBufferConnector_ms": 0.005018711090087891, "ViewRequirementAgentConnector_ms": 0.13385353417232118}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 378.76424433905214, "num_env_steps_trained_throughput_per_sec": 378.76424433905214, "timesteps_total": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 10612.262, "restore_workers_time_ms": 0.017, "training_step_time_ms": 10612.217, "sample_time_ms": 4034.57, "load_time_ms": 0.431, "load_throughput": 9287652.79, "learn_time_ms": 6568.814, "learn_throughput": 608.938, "synch_weights_time_ms": 7.881}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "episodes_total": 58, "training_iteration": 11, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-02-43", "timestamp": 1714269763, "time_this_iter_s": 10.564838886260986, "time_total_s": 117.57429838180542, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 117.57429838180542, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 29.293333333333337, "ram_util_percent": 62.17333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.445468225979036, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.603237803164439, "policy_loss": -0.021965772117818555, "vf_loss": 0.6221918616003247, "vf_explained_var": 0.4602602526064842, "kl": 0.015058566177196905, "entropy": 5.310157248281663, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10695.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": -80.97254000151354, "episode_reward_min": -227.63697320905524, "episode_reward_mean": -110.27352537101706, "episode_len_mean": 774.4918032786885, "episode_media": {}, "episodes_this_iter": 3, "episodes_timesteps_total": 47244, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-106.03109033026485, -114.28360098956463, -112.38861879900719, -114.50104494536792, -114.81237550882994, -100.85279933880952, -191.06248919875478, -105.66801867639708, -108.88840011176715, -100.27526515570464, -101.82837733991072, -119.79881443125504, -117.9712382101621, -106.38200467609987, -113.67037118018852, -102.3714714806502, -110.45926046397304, -115.23857979221516, -106.1584936505848, -99.98645677616322, -115.5268234165896, -85.47368125462144, -104.18303367963868, -109.95593781627156, -117.00740790170991, -82.17189284069737, -93.23788182555253, -105.90702924623464, -104.46676979304354, -105.6391147629719, -107.59551447696984, -114.04718956068228, -113.33805177474147, -96.35776919549184, -108.08958674169021, -189.2307974797488, -107.77688434873025, -104.21218206179391, -105.63208521384125, -102.25345442987854, -105.18705326224796, -109.74655774765284, -105.74642107303565, -95.74877264735359, -115.48749781705327, -123.11756407958953, -124.34736567230895, -98.43422503718101, -227.63697320905524, -103.20848532030111, -104.74097217605018, -98.2160608353316, -107.68068003419279, -107.04693271280453, -110.03438186249447, -110.67549925545471, -80.97254000151354, -105.67827933927936, -83.27784120548637, -86.1948913044376, -88.77419416264624], "episode_lengths": [67, 62, 59, 92, 103, 74, 941, 84, 40, 1600, 63, 1600, 1600, 84, 38, 51, 1600, 1600, 1600, 58, 1600, 1600, 49, 58, 56, 1600, 1600, 67, 78, 1600, 46, 1600, 83, 1600, 45, 972, 63, 55, 54, 113, 1600, 1600, 73, 1600, 1600, 70, 91, 1600, 1561, 58, 1600, 1600, 1600, 73, 107, 1600, 1600, 56, 1600, 1600, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31413117453192246, "mean_inference_ms": 1.0840164496125066, "mean_action_processing_ms": 0.2108137475616476, "mean_env_wait_ms": 0.42352365601011, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006360695010325948, "StateBufferConnector_ms": 0.00497747640140721, "ViewRequirementAgentConnector_ms": 0.133449523175349}}, "episode_reward_max": -80.97254000151354, "episode_reward_min": -227.63697320905524, "episode_reward_mean": -110.27352537101706, "episode_len_mean": 774.4918032786885, "episodes_this_iter": 3, "episodes_timesteps_total": 47244, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-106.03109033026485, -114.28360098956463, -112.38861879900719, -114.50104494536792, -114.81237550882994, -100.85279933880952, -191.06248919875478, -105.66801867639708, -108.88840011176715, -100.27526515570464, -101.82837733991072, -119.79881443125504, -117.9712382101621, -106.38200467609987, -113.67037118018852, -102.3714714806502, -110.45926046397304, -115.23857979221516, -106.1584936505848, -99.98645677616322, -115.5268234165896, -85.47368125462144, -104.18303367963868, -109.95593781627156, -117.00740790170991, -82.17189284069737, -93.23788182555253, -105.90702924623464, -104.46676979304354, -105.6391147629719, -107.59551447696984, -114.04718956068228, -113.33805177474147, -96.35776919549184, -108.08958674169021, -189.2307974797488, -107.77688434873025, -104.21218206179391, -105.63208521384125, -102.25345442987854, -105.18705326224796, -109.74655774765284, -105.74642107303565, -95.74877264735359, -115.48749781705327, -123.11756407958953, -124.34736567230895, -98.43422503718101, -227.63697320905524, -103.20848532030111, -104.74097217605018, -98.2160608353316, -107.68068003419279, -107.04693271280453, -110.03438186249447, -110.67549925545471, -80.97254000151354, -105.67827933927936, -83.27784120548637, -86.1948913044376, -88.77419416264624], "episode_lengths": [67, 62, 59, 92, 103, 74, 941, 84, 40, 1600, 63, 1600, 1600, 84, 38, 51, 1600, 1600, 1600, 58, 1600, 1600, 49, 58, 56, 1600, 1600, 67, 78, 1600, 46, 1600, 83, 1600, 45, 972, 63, 55, 54, 113, 1600, 1600, 73, 1600, 1600, 70, 91, 1600, 1561, 58, 1600, 1600, 1600, 73, 107, 1600, 1600, 56, 1600, 1600, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31413117453192246, "mean_inference_ms": 1.0840164496125066, "mean_action_processing_ms": 0.2108137475616476, "mean_env_wait_ms": 0.42352365601011, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006360695010325948, "StateBufferConnector_ms": 0.00497747640140721, "ViewRequirementAgentConnector_ms": 0.133449523175349}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 399.7451118642879, "num_env_steps_trained_throughput_per_sec": 399.7451118642879, "timesteps_total": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 10606.783, "restore_workers_time_ms": 0.018, "training_step_time_ms": 10606.736, "sample_time_ms": 4020.433, "load_time_ms": 0.437, "load_throughput": 9147383.458, "learn_time_ms": 6577.488, "learn_throughput": 608.135, "synch_weights_time_ms": 7.839}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 61, "training_iteration": 12, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-02-53", "timestamp": 1714269773, "time_this_iter_s": 10.010249137878418, "time_total_s": 127.58454751968384, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 127.58454751968384, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 24.435714285714287, "ram_util_percent": 62.02857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.721052580366852, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6344758428708319, "policy_loss": -0.0350024321747403, "vf_loss": 0.6660293172644352, "vf_explained_var": 0.4182223082229655, "kl": 0.017244778842563098, "entropy": 5.306959728528095, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11625.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "sampler_results": {"episode_reward_max": -80.78307664520416, "episode_reward_min": -227.63697320905524, "episode_reward_mean": -109.4659854148463, "episode_len_mean": 800.6984126984127, "episode_media": {}, "episodes_this_iter": 2, "episodes_timesteps_total": 50444, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-106.03109033026485, -114.28360098956463, -112.38861879900719, -114.50104494536792, -114.81237550882994, -100.85279933880952, -191.06248919875478, -105.66801867639708, -108.88840011176715, -100.27526515570464, -101.82837733991072, -119.79881443125504, -117.9712382101621, -106.38200467609987, -113.67037118018852, -102.3714714806502, -110.45926046397304, -115.23857979221516, -106.1584936505848, -99.98645677616322, -115.5268234165896, -85.47368125462144, -104.18303367963868, -109.95593781627156, -117.00740790170991, -82.17189284069737, -93.23788182555253, -105.90702924623464, -104.46676979304354, -105.6391147629719, -107.59551447696984, -114.04718956068228, -113.33805177474147, -96.35776919549184, -108.08958674169021, -189.2307974797488, -107.77688434873025, -104.21218206179391, -105.63208521384125, -102.25345442987854, -105.18705326224796, -109.74655774765284, -105.74642107303565, -95.74877264735359, -115.48749781705327, -123.11756407958953, -124.34736567230895, -98.43422503718101, -227.63697320905524, -103.20848532030111, -104.74097217605018, -98.2160608353316, -107.68068003419279, -107.04693271280453, -110.03438186249447, -110.67549925545471, -80.97254000151354, -105.67827933927936, -83.27784120548637, -86.1948913044376, -88.77419416264624, -80.78307664520416, -88.88895685807141], "episode_lengths": [67, 62, 59, 92, 103, 74, 941, 84, 40, 1600, 63, 1600, 1600, 84, 38, 51, 1600, 1600, 1600, 58, 1600, 1600, 49, 58, 56, 1600, 1600, 67, 78, 1600, 46, 1600, 83, 1600, 45, 972, 63, 55, 54, 113, 1600, 1600, 73, 1600, 1600, 70, 91, 1600, 1561, 58, 1600, 1600, 1600, 73, 107, 1600, 1600, 56, 1600, 1600, 1600, 1600, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3139623484308363, "mean_inference_ms": 1.0832462902864002, "mean_action_processing_ms": 0.21060104844470096, "mean_env_wait_ms": 0.4233724587525734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006321498325892857, "StateBufferConnector_ms": 0.0049492669483971975, "ViewRequirementAgentConnector_ms": 0.1329970738244435}}, "episode_reward_max": -80.78307664520416, "episode_reward_min": -227.63697320905524, "episode_reward_mean": -109.4659854148463, "episode_len_mean": 800.6984126984127, "episodes_this_iter": 2, "episodes_timesteps_total": 50444, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-106.03109033026485, -114.28360098956463, -112.38861879900719, -114.50104494536792, -114.81237550882994, -100.85279933880952, -191.06248919875478, -105.66801867639708, -108.88840011176715, -100.27526515570464, -101.82837733991072, -119.79881443125504, -117.9712382101621, -106.38200467609987, -113.67037118018852, -102.3714714806502, -110.45926046397304, -115.23857979221516, -106.1584936505848, -99.98645677616322, -115.5268234165896, -85.47368125462144, -104.18303367963868, -109.95593781627156, -117.00740790170991, -82.17189284069737, -93.23788182555253, -105.90702924623464, -104.46676979304354, -105.6391147629719, -107.59551447696984, -114.04718956068228, -113.33805177474147, -96.35776919549184, -108.08958674169021, -189.2307974797488, -107.77688434873025, -104.21218206179391, -105.63208521384125, -102.25345442987854, -105.18705326224796, -109.74655774765284, -105.74642107303565, -95.74877264735359, -115.48749781705327, -123.11756407958953, -124.34736567230895, -98.43422503718101, -227.63697320905524, -103.20848532030111, -104.74097217605018, -98.2160608353316, -107.68068003419279, -107.04693271280453, -110.03438186249447, -110.67549925545471, -80.97254000151354, -105.67827933927936, -83.27784120548637, -86.1948913044376, -88.77419416264624, -80.78307664520416, -88.88895685807141], "episode_lengths": [67, 62, 59, 92, 103, 74, 941, 84, 40, 1600, 63, 1600, 1600, 84, 38, 51, 1600, 1600, 1600, 58, 1600, 1600, 49, 58, 56, 1600, 1600, 67, 78, 1600, 46, 1600, 83, 1600, 45, 972, 63, 55, 54, 113, 1600, 1600, 73, 1600, 1600, 70, 91, 1600, 1561, 58, 1600, 1600, 1600, 73, 107, 1600, 1600, 56, 1600, 1600, 1600, 1600, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3139623484308363, "mean_inference_ms": 1.0832462902864002, "mean_action_processing_ms": 0.21060104844470096, "mean_env_wait_ms": 0.4233724587525734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006321498325892857, "StateBufferConnector_ms": 0.0049492669483971975, "ViewRequirementAgentConnector_ms": 0.1329970738244435}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 397.77017326382025, "num_env_steps_trained_throughput_per_sec": 397.77017326382025, "timesteps_total": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 10483.013, "restore_workers_time_ms": 0.018, "training_step_time_ms": 10482.967, "sample_time_ms": 4014.089, "load_time_ms": 0.435, "load_throughput": 9195514.388, "learn_time_ms": 6460.165, "learn_throughput": 619.179, "synch_weights_time_ms": 7.742}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "episodes_total": 63, "training_iteration": 13, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-03-03", "timestamp": 1714269783, "time_this_iter_s": 10.060500860214233, "time_total_s": 137.64504837989807, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 137.64504837989807, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 24.466666666666672, "ram_util_percent": 61.726666666666674}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.646128501686999, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.018953035244097, "policy_loss": -0.03310143697646356, "vf_loss": 2.0478186196056747, "vf_explained_var": 0.18052394326015186, "kl": 0.02117926167799648, "entropy": 5.643019646982993, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 12555.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "sampler_results": {"episode_reward_max": -78.30873418525803, "episode_reward_min": -227.63697320905524, "episode_reward_mean": -108.54925859851451, "episode_len_mean": 742.5753424657535, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 54208, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-106.03109033026485, -114.28360098956463, -112.38861879900719, -114.50104494536792, -114.81237550882994, -100.85279933880952, -191.06248919875478, -105.66801867639708, -108.88840011176715, -100.27526515570464, -101.82837733991072, -119.79881443125504, -117.9712382101621, -106.38200467609987, -113.67037118018852, -102.3714714806502, -110.45926046397304, -115.23857979221516, -106.1584936505848, -99.98645677616322, -115.5268234165896, -85.47368125462144, -104.18303367963868, -109.95593781627156, -117.00740790170991, -82.17189284069737, -93.23788182555253, -105.90702924623464, -104.46676979304354, -105.6391147629719, -107.59551447696984, -114.04718956068228, -113.33805177474147, -96.35776919549184, -108.08958674169021, -189.2307974797488, -107.77688434873025, -104.21218206179391, -105.63208521384125, -102.25345442987854, -105.18705326224796, -109.74655774765284, -105.74642107303565, -95.74877264735359, -115.48749781705327, -123.11756407958953, -124.34736567230895, -98.43422503718101, -227.63697320905524, -103.20848532030111, -104.74097217605018, -98.2160608353316, -107.68068003419279, -107.04693271280453, -110.03438186249447, -110.67549925545471, -80.97254000151354, -105.67827933927936, -83.27784120548637, -86.1948913044376, -88.77419416264624, -80.78307664520416, -88.88895685807141, -78.30873418525803, -105.40570149411386, -113.43598028733706, -105.25767036241479, -104.36103860098807, -121.76541226746576, -81.23777308003359, -104.25385369370133, -111.15731429203599, -102.55531829289409], "episode_lengths": [67, 62, 59, 92, 103, 74, 941, 84, 40, 1600, 63, 1600, 1600, 84, 38, 51, 1600, 1600, 1600, 58, 1600, 1600, 49, 58, 56, 1600, 1600, 67, 78, 1600, 46, 1600, 83, 1600, 45, 972, 63, 55, 54, 113, 1600, 1600, 73, 1600, 1600, 70, 91, 1600, 1561, 58, 1600, 1600, 1600, 73, 107, 1600, 1600, 56, 1600, 1600, 1600, 1600, 1600, 1600, 55, 42, 84, 59, 104, 1600, 102, 59, 59]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31324432683122055, "mean_inference_ms": 1.079398607031641, "mean_action_processing_ms": 0.20959242027962946, "mean_env_wait_ms": 0.42281115342711206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006171121989210991, "StateBufferConnector_ms": 0.004806910475639448, "ViewRequirementAgentConnector_ms": 0.12997241869364698}}, "episode_reward_max": -78.30873418525803, "episode_reward_min": -227.63697320905524, "episode_reward_mean": -108.54925859851451, "episode_len_mean": 742.5753424657535, "episodes_this_iter": 10, "episodes_timesteps_total": 54208, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-106.03109033026485, -114.28360098956463, -112.38861879900719, -114.50104494536792, -114.81237550882994, -100.85279933880952, -191.06248919875478, -105.66801867639708, -108.88840011176715, -100.27526515570464, -101.82837733991072, -119.79881443125504, -117.9712382101621, -106.38200467609987, -113.67037118018852, -102.3714714806502, -110.45926046397304, -115.23857979221516, -106.1584936505848, -99.98645677616322, -115.5268234165896, -85.47368125462144, -104.18303367963868, -109.95593781627156, -117.00740790170991, -82.17189284069737, -93.23788182555253, -105.90702924623464, -104.46676979304354, -105.6391147629719, -107.59551447696984, -114.04718956068228, -113.33805177474147, -96.35776919549184, -108.08958674169021, -189.2307974797488, -107.77688434873025, -104.21218206179391, -105.63208521384125, -102.25345442987854, -105.18705326224796, -109.74655774765284, -105.74642107303565, -95.74877264735359, -115.48749781705327, -123.11756407958953, -124.34736567230895, -98.43422503718101, -227.63697320905524, -103.20848532030111, -104.74097217605018, -98.2160608353316, -107.68068003419279, -107.04693271280453, -110.03438186249447, -110.67549925545471, -80.97254000151354, -105.67827933927936, -83.27784120548637, -86.1948913044376, -88.77419416264624, -80.78307664520416, -88.88895685807141, -78.30873418525803, -105.40570149411386, -113.43598028733706, -105.25767036241479, -104.36103860098807, -121.76541226746576, -81.23777308003359, -104.25385369370133, -111.15731429203599, -102.55531829289409], "episode_lengths": [67, 62, 59, 92, 103, 74, 941, 84, 40, 1600, 63, 1600, 1600, 84, 38, 51, 1600, 1600, 1600, 58, 1600, 1600, 49, 58, 56, 1600, 1600, 67, 78, 1600, 46, 1600, 83, 1600, 45, 972, 63, 55, 54, 113, 1600, 1600, 73, 1600, 1600, 70, 91, 1600, 1561, 58, 1600, 1600, 1600, 73, 107, 1600, 1600, 56, 1600, 1600, 1600, 1600, 1600, 1600, 55, 42, 84, 59, 104, 1600, 102, 59, 59]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31324432683122055, "mean_inference_ms": 1.079398607031641, "mean_action_processing_ms": 0.20959242027962946, "mean_env_wait_ms": 0.42281115342711206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006171121989210991, "StateBufferConnector_ms": 0.004806910475639448, "ViewRequirementAgentConnector_ms": 0.12997241869364698}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 397.9363835593408, "num_env_steps_trained_throughput_per_sec": 397.9363835593408, "timesteps_total": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 10460.832, "restore_workers_time_ms": 0.017, "training_step_time_ms": 10460.788, "sample_time_ms": 4003.737, "load_time_ms": 0.439, "load_throughput": 9121026.422, "learn_time_ms": 6448.284, "learn_throughput": 620.32, "synch_weights_time_ms": 7.776}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "episodes_total": 73, "training_iteration": 14, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-03-13", "timestamp": 1714269793, "time_this_iter_s": 10.056535959243774, "time_total_s": 147.70158433914185, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 147.70158433914185, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 27.328571428571433, "ram_util_percent": 61.550000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.617834363765613, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.173000788955789, "policy_loss": -0.02498336394307434, "vf_loss": 1.1944572288262587, "vf_explained_var": 0.11817128523703545, "kl": 0.011756406140658125, "entropy": 5.433510458341209, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13485.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": -65.11193457511747, "episode_reward_min": -227.63697320905524, "episode_reward_mean": -107.60802250134572, "episode_len_mean": 747.7792207792207, "episode_media": {}, "episodes_this_iter": 4, "episodes_timesteps_total": 57579, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-106.03109033026485, -114.28360098956463, -112.38861879900719, -114.50104494536792, -114.81237550882994, -100.85279933880952, -191.06248919875478, -105.66801867639708, -108.88840011176715, -100.27526515570464, -101.82837733991072, -119.79881443125504, -117.9712382101621, -106.38200467609987, -113.67037118018852, -102.3714714806502, -110.45926046397304, -115.23857979221516, -106.1584936505848, -99.98645677616322, -115.5268234165896, -85.47368125462144, -104.18303367963868, -109.95593781627156, -117.00740790170991, -82.17189284069737, -93.23788182555253, -105.90702924623464, -104.46676979304354, -105.6391147629719, -107.59551447696984, -114.04718956068228, -113.33805177474147, -96.35776919549184, -108.08958674169021, -189.2307974797488, -107.77688434873025, -104.21218206179391, -105.63208521384125, -102.25345442987854, -105.18705326224796, -109.74655774765284, -105.74642107303565, -95.74877264735359, -115.48749781705327, -123.11756407958953, -124.34736567230895, -98.43422503718101, -227.63697320905524, -103.20848532030111, -104.74097217605018, -98.2160608353316, -107.68068003419279, -107.04693271280453, -110.03438186249447, -110.67549925545471, -80.97254000151354, -105.67827933927936, -83.27784120548637, -86.1948913044376, -88.77419416264624, -80.78307664520416, -88.88895685807141, -78.30873418525803, -105.40570149411386, -113.43598028733706, -105.25767036241479, -104.36103860098807, -121.76541226746576, -81.23777308003359, -104.25385369370133, -111.15731429203599, -102.55531829289409, -65.11193457511747, -122.04911535369854, -70.12050803955002, -104.44029694369497], "episode_lengths": [67, 62, 59, 92, 103, 74, 941, 84, 40, 1600, 63, 1600, 1600, 84, 38, 51, 1600, 1600, 1600, 58, 1600, 1600, 49, 58, 56, 1600, 1600, 67, 78, 1600, 46, 1600, 83, 1600, 45, 972, 63, 55, 54, 113, 1600, 1600, 73, 1600, 1600, 70, 91, 1600, 1561, 58, 1600, 1600, 1600, 73, 107, 1600, 1600, 56, 1600, 1600, 1600, 1600, 1600, 1600, 55, 42, 84, 59, 104, 1600, 102, 59, 59, 1600, 122, 1600, 49]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3129134463826216, "mean_inference_ms": 1.0779531053376856, "mean_action_processing_ms": 0.209226577039944, "mean_env_wait_ms": 0.42248417344732386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006125499675800274, "StateBufferConnector_ms": 0.004857546323305601, "ViewRequirementAgentConnector_ms": 0.1295331236603972}}, "episode_reward_max": -65.11193457511747, "episode_reward_min": -227.63697320905524, "episode_reward_mean": -107.60802250134572, "episode_len_mean": 747.7792207792207, "episodes_this_iter": 4, "episodes_timesteps_total": 57579, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-106.03109033026485, -114.28360098956463, -112.38861879900719, -114.50104494536792, -114.81237550882994, -100.85279933880952, -191.06248919875478, -105.66801867639708, -108.88840011176715, -100.27526515570464, -101.82837733991072, -119.79881443125504, -117.9712382101621, -106.38200467609987, -113.67037118018852, -102.3714714806502, -110.45926046397304, -115.23857979221516, -106.1584936505848, -99.98645677616322, -115.5268234165896, -85.47368125462144, -104.18303367963868, -109.95593781627156, -117.00740790170991, -82.17189284069737, -93.23788182555253, -105.90702924623464, -104.46676979304354, -105.6391147629719, -107.59551447696984, -114.04718956068228, -113.33805177474147, -96.35776919549184, -108.08958674169021, -189.2307974797488, -107.77688434873025, -104.21218206179391, -105.63208521384125, -102.25345442987854, -105.18705326224796, -109.74655774765284, -105.74642107303565, -95.74877264735359, -115.48749781705327, -123.11756407958953, -124.34736567230895, -98.43422503718101, -227.63697320905524, -103.20848532030111, -104.74097217605018, -98.2160608353316, -107.68068003419279, -107.04693271280453, -110.03438186249447, -110.67549925545471, -80.97254000151354, -105.67827933927936, -83.27784120548637, -86.1948913044376, -88.77419416264624, -80.78307664520416, -88.88895685807141, -78.30873418525803, -105.40570149411386, -113.43598028733706, -105.25767036241479, -104.36103860098807, -121.76541226746576, -81.23777308003359, -104.25385369370133, -111.15731429203599, -102.55531829289409, -65.11193457511747, -122.04911535369854, -70.12050803955002, -104.44029694369497], "episode_lengths": [67, 62, 59, 92, 103, 74, 941, 84, 40, 1600, 63, 1600, 1600, 84, 38, 51, 1600, 1600, 1600, 58, 1600, 1600, 49, 58, 56, 1600, 1600, 67, 78, 1600, 46, 1600, 83, 1600, 45, 972, 63, 55, 54, 113, 1600, 1600, 73, 1600, 1600, 70, 91, 1600, 1561, 58, 1600, 1600, 1600, 73, 107, 1600, 1600, 56, 1600, 1600, 1600, 1600, 1600, 1600, 55, 42, 84, 59, 104, 1600, 102, 59, 59, 1600, 122, 1600, 49]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3129134463826216, "mean_inference_ms": 1.0779531053376856, "mean_action_processing_ms": 0.209226577039944, "mean_env_wait_ms": 0.42248417344732386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006125499675800274, "StateBufferConnector_ms": 0.004857546323305601, "ViewRequirementAgentConnector_ms": 0.1295331236603972}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 398.7658265057518, "num_env_steps_trained_throughput_per_sec": 398.7658265057518, "timesteps_total": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 10446.482, "restore_workers_time_ms": 0.016, "training_step_time_ms": 10446.436, "sample_time_ms": 4014.896, "load_time_ms": 0.427, "load_throughput": 9357586.034, "learn_time_ms": 6422.714, "learn_throughput": 622.79, "synch_weights_time_ms": 7.827}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 77, "training_iteration": 15, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-03-23", "timestamp": 1714269803, "time_this_iter_s": 10.035531997680664, "time_total_s": 157.7371163368225, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 157.7371163368225, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 24.778571428571432, "ram_util_percent": 61.550000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.280981272266757, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2150404289087546, "policy_loss": -0.03361115421979658, "vf_loss": 1.2448291399065525, "vf_explained_var": 0.35460356576468355, "kl": 0.012741465233891879, "entropy": 5.39509095581629, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 14415.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": -65.11193457511747, "episode_reward_min": -227.63697320905524, "episode_reward_mean": -106.4203440267038, "episode_len_mean": 754.6024096385543, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 62632, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-106.03109033026485, -114.28360098956463, -112.38861879900719, -114.50104494536792, -114.81237550882994, -100.85279933880952, -191.06248919875478, -105.66801867639708, -108.88840011176715, -100.27526515570464, -101.82837733991072, -119.79881443125504, -117.9712382101621, -106.38200467609987, -113.67037118018852, -102.3714714806502, -110.45926046397304, -115.23857979221516, -106.1584936505848, -99.98645677616322, -115.5268234165896, -85.47368125462144, -104.18303367963868, -109.95593781627156, -117.00740790170991, -82.17189284069737, -93.23788182555253, -105.90702924623464, -104.46676979304354, -105.6391147629719, -107.59551447696984, -114.04718956068228, -113.33805177474147, -96.35776919549184, -108.08958674169021, -189.2307974797488, -107.77688434873025, -104.21218206179391, -105.63208521384125, -102.25345442987854, -105.18705326224796, -109.74655774765284, -105.74642107303565, -95.74877264735359, -115.48749781705327, -123.11756407958953, -124.34736567230895, -98.43422503718101, -227.63697320905524, -103.20848532030111, -104.74097217605018, -98.2160608353316, -107.68068003419279, -107.04693271280453, -110.03438186249447, -110.67549925545471, -80.97254000151354, -105.67827933927936, -83.27784120548637, -86.1948913044376, -88.77419416264624, -80.78307664520416, -88.88895685807141, -78.30873418525803, -105.40570149411386, -113.43598028733706, -105.25767036241479, -104.36103860098807, -121.76541226746576, -81.23777308003359, -104.25385369370133, -111.15731429203599, -102.55531829289409, -65.11193457511747, -122.04911535369854, -70.12050803955002, -104.44029694369497, -86.87933463910709, -116.27684495819733, -112.56296487266012, -68.49217507766443, -95.8202291980808, -67.03927286708544], "episode_lengths": [67, 62, 59, 92, 103, 74, 941, 84, 40, 1600, 63, 1600, 1600, 84, 38, 51, 1600, 1600, 1600, 58, 1600, 1600, 49, 58, 56, 1600, 1600, 67, 78, 1600, 46, 1600, 83, 1600, 45, 972, 63, 55, 54, 113, 1600, 1600, 73, 1600, 1600, 70, 91, 1600, 1561, 58, 1600, 1600, 1600, 73, 107, 1600, 1600, 56, 1600, 1600, 1600, 1600, 1600, 1600, 55, 42, 84, 59, 104, 1600, 102, 59, 59, 1600, 122, 1600, 49, 1600, 59, 69, 1600, 125, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.312404504622987, "mean_inference_ms": 1.0757686980449415, "mean_action_processing_ms": 0.2086878698416447, "mean_env_wait_ms": 0.42196515399818124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0062267464327524944, "StateBufferConnector_ms": 0.004849376448665757, "ViewRequirementAgentConnector_ms": 0.12840793793459973}}, "episode_reward_max": -65.11193457511747, "episode_reward_min": -227.63697320905524, "episode_reward_mean": -106.4203440267038, "episode_len_mean": 754.6024096385543, "episodes_this_iter": 6, "episodes_timesteps_total": 62632, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-106.03109033026485, -114.28360098956463, -112.38861879900719, -114.50104494536792, -114.81237550882994, -100.85279933880952, -191.06248919875478, -105.66801867639708, -108.88840011176715, -100.27526515570464, -101.82837733991072, -119.79881443125504, -117.9712382101621, -106.38200467609987, -113.67037118018852, -102.3714714806502, -110.45926046397304, -115.23857979221516, -106.1584936505848, -99.98645677616322, -115.5268234165896, -85.47368125462144, -104.18303367963868, -109.95593781627156, -117.00740790170991, -82.17189284069737, -93.23788182555253, -105.90702924623464, -104.46676979304354, -105.6391147629719, -107.59551447696984, -114.04718956068228, -113.33805177474147, -96.35776919549184, -108.08958674169021, -189.2307974797488, -107.77688434873025, -104.21218206179391, -105.63208521384125, -102.25345442987854, -105.18705326224796, -109.74655774765284, -105.74642107303565, -95.74877264735359, -115.48749781705327, -123.11756407958953, -124.34736567230895, -98.43422503718101, -227.63697320905524, -103.20848532030111, -104.74097217605018, -98.2160608353316, -107.68068003419279, -107.04693271280453, -110.03438186249447, -110.67549925545471, -80.97254000151354, -105.67827933927936, -83.27784120548637, -86.1948913044376, -88.77419416264624, -80.78307664520416, -88.88895685807141, -78.30873418525803, -105.40570149411386, -113.43598028733706, -105.25767036241479, -104.36103860098807, -121.76541226746576, -81.23777308003359, -104.25385369370133, -111.15731429203599, -102.55531829289409, -65.11193457511747, -122.04911535369854, -70.12050803955002, -104.44029694369497, -86.87933463910709, -116.27684495819733, -112.56296487266012, -68.49217507766443, -95.8202291980808, -67.03927286708544], "episode_lengths": [67, 62, 59, 92, 103, 74, 941, 84, 40, 1600, 63, 1600, 1600, 84, 38, 51, 1600, 1600, 1600, 58, 1600, 1600, 49, 58, 56, 1600, 1600, 67, 78, 1600, 46, 1600, 83, 1600, 45, 972, 63, 55, 54, 113, 1600, 1600, 73, 1600, 1600, 70, 91, 1600, 1561, 58, 1600, 1600, 1600, 73, 107, 1600, 1600, 56, 1600, 1600, 1600, 1600, 1600, 1600, 55, 42, 84, 59, 104, 1600, 102, 59, 59, 1600, 122, 1600, 49, 1600, 59, 69, 1600, 125, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.312404504622987, "mean_inference_ms": 1.0757686980449415, "mean_action_processing_ms": 0.2086878698416447, "mean_env_wait_ms": 0.42196515399818124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0062267464327524944, "StateBufferConnector_ms": 0.004849376448665757, "ViewRequirementAgentConnector_ms": 0.12840793793459973}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 399.4467672787192, "num_env_steps_trained_throughput_per_sec": 399.4467672787192, "timesteps_total": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 10422.146, "restore_workers_time_ms": 0.016, "training_step_time_ms": 10422.101, "sample_time_ms": 4013.941, "load_time_ms": 0.425, "load_throughput": 9405850.76, "learn_time_ms": 6399.447, "learn_throughput": 625.054, "synch_weights_time_ms": 7.714}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "episodes_total": 83, "training_iteration": 16, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-03-33", "timestamp": 1714269813, "time_this_iter_s": 10.017569780349731, "time_total_s": 167.75468611717224, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 167.75468611717224, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 24.253333333333337, "ram_util_percent": 61.573333333333345}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.49104402680551, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9368731472723848, "policy_loss": -0.028792594834881766, "vf_loss": 1.961223796336481, "vf_explained_var": 0.3770275108275875, "kl": 0.014806505034385013, "entropy": 5.818629808836086, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 15345.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "sampler_results": {"episode_reward_max": -61.27193892516752, "episode_reward_min": -227.63697320905524, "episode_reward_mean": -105.59351437950248, "episode_len_mean": 728.7692307692307, "episode_media": {}, "episodes_this_iter": 8, "episodes_timesteps_total": 66318, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-106.03109033026485, -114.28360098956463, -112.38861879900719, -114.50104494536792, -114.81237550882994, -100.85279933880952, -191.06248919875478, -105.66801867639708, -108.88840011176715, -100.27526515570464, -101.82837733991072, -119.79881443125504, -117.9712382101621, -106.38200467609987, -113.67037118018852, -102.3714714806502, -110.45926046397304, -115.23857979221516, -106.1584936505848, -99.98645677616322, -115.5268234165896, -85.47368125462144, -104.18303367963868, -109.95593781627156, -117.00740790170991, -82.17189284069737, -93.23788182555253, -105.90702924623464, -104.46676979304354, -105.6391147629719, -107.59551447696984, -114.04718956068228, -113.33805177474147, -96.35776919549184, -108.08958674169021, -189.2307974797488, -107.77688434873025, -104.21218206179391, -105.63208521384125, -102.25345442987854, -105.18705326224796, -109.74655774765284, -105.74642107303565, -95.74877264735359, -115.48749781705327, -123.11756407958953, -124.34736567230895, -98.43422503718101, -227.63697320905524, -103.20848532030111, -104.74097217605018, -98.2160608353316, -107.68068003419279, -107.04693271280453, -110.03438186249447, -110.67549925545471, -80.97254000151354, -105.67827933927936, -83.27784120548637, -86.1948913044376, -88.77419416264624, -80.78307664520416, -88.88895685807141, -78.30873418525803, -105.40570149411386, -113.43598028733706, -105.25767036241479, -104.36103860098807, -121.76541226746576, -81.23777308003359, -104.25385369370133, -111.15731429203599, -102.55531829289409, -65.11193457511747, -122.04911535369854, -70.12050803955002, -104.44029694369497, -86.87933463910709, -116.27684495819733, -112.56296487266012, -68.49217507766443, -95.8202291980808, -67.03927286708544, -64.9766486377686, -110.31301838187625, -103.44239079739899, -105.37409490066209, -61.27193892516752, -124.17013150861115, -102.78553823652926, -103.7874929302962], "episode_lengths": [67, 62, 59, 92, 103, 74, 941, 84, 40, 1600, 63, 1600, 1600, 84, 38, 51, 1600, 1600, 1600, 58, 1600, 1600, 49, 58, 56, 1600, 1600, 67, 78, 1600, 46, 1600, 83, 1600, 45, 972, 63, 55, 54, 113, 1600, 1600, 73, 1600, 1600, 70, 91, 1600, 1561, 58, 1600, 1600, 1600, 73, 107, 1600, 1600, 56, 1600, 1600, 1600, 1600, 1600, 1600, 55, 42, 84, 59, 104, 1600, 102, 59, 59, 1600, 122, 1600, 49, 1600, 59, 69, 1600, 125, 1600, 1600, 105, 94, 64, 1600, 86, 64, 73]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31176078379174305, "mean_inference_ms": 1.0729977700023083, "mean_action_processing_ms": 0.20802060115233492, "mean_env_wait_ms": 0.4212737605269464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006148841354873154, "StateBufferConnector_ms": 0.004785401480538505, "ViewRequirementAgentConnector_ms": 0.12756651574438746}}, "episode_reward_max": -61.27193892516752, "episode_reward_min": -227.63697320905524, "episode_reward_mean": -105.59351437950248, "episode_len_mean": 728.7692307692307, "episodes_this_iter": 8, "episodes_timesteps_total": 66318, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-106.03109033026485, -114.28360098956463, -112.38861879900719, -114.50104494536792, -114.81237550882994, -100.85279933880952, -191.06248919875478, -105.66801867639708, -108.88840011176715, -100.27526515570464, -101.82837733991072, -119.79881443125504, -117.9712382101621, -106.38200467609987, -113.67037118018852, -102.3714714806502, -110.45926046397304, -115.23857979221516, -106.1584936505848, -99.98645677616322, -115.5268234165896, -85.47368125462144, -104.18303367963868, -109.95593781627156, -117.00740790170991, -82.17189284069737, -93.23788182555253, -105.90702924623464, -104.46676979304354, -105.6391147629719, -107.59551447696984, -114.04718956068228, -113.33805177474147, -96.35776919549184, -108.08958674169021, -189.2307974797488, -107.77688434873025, -104.21218206179391, -105.63208521384125, -102.25345442987854, -105.18705326224796, -109.74655774765284, -105.74642107303565, -95.74877264735359, -115.48749781705327, -123.11756407958953, -124.34736567230895, -98.43422503718101, -227.63697320905524, -103.20848532030111, -104.74097217605018, -98.2160608353316, -107.68068003419279, -107.04693271280453, -110.03438186249447, -110.67549925545471, -80.97254000151354, -105.67827933927936, -83.27784120548637, -86.1948913044376, -88.77419416264624, -80.78307664520416, -88.88895685807141, -78.30873418525803, -105.40570149411386, -113.43598028733706, -105.25767036241479, -104.36103860098807, -121.76541226746576, -81.23777308003359, -104.25385369370133, -111.15731429203599, -102.55531829289409, -65.11193457511747, -122.04911535369854, -70.12050803955002, -104.44029694369497, -86.87933463910709, -116.27684495819733, -112.56296487266012, -68.49217507766443, -95.8202291980808, -67.03927286708544, -64.9766486377686, -110.31301838187625, -103.44239079739899, -105.37409490066209, -61.27193892516752, -124.17013150861115, -102.78553823652926, -103.7874929302962], "episode_lengths": [67, 62, 59, 92, 103, 74, 941, 84, 40, 1600, 63, 1600, 1600, 84, 38, 51, 1600, 1600, 1600, 58, 1600, 1600, 49, 58, 56, 1600, 1600, 67, 78, 1600, 46, 1600, 83, 1600, 45, 972, 63, 55, 54, 113, 1600, 1600, 73, 1600, 1600, 70, 91, 1600, 1561, 58, 1600, 1600, 1600, 73, 107, 1600, 1600, 56, 1600, 1600, 1600, 1600, 1600, 1600, 55, 42, 84, 59, 104, 1600, 102, 59, 59, 1600, 122, 1600, 49, 1600, 59, 69, 1600, 125, 1600, 1600, 105, 94, 64, 1600, 86, 64, 73]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31176078379174305, "mean_inference_ms": 1.0729977700023083, "mean_action_processing_ms": 0.20802060115233492, "mean_env_wait_ms": 0.4212737605269464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006148841354873154, "StateBufferConnector_ms": 0.004785401480538505, "ViewRequirementAgentConnector_ms": 0.12756651574438746}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 326.96610909434474, "num_env_steps_trained_throughput_per_sec": 326.96610909434474, "timesteps_total": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 10547.352, "restore_workers_time_ms": 0.015, "training_step_time_ms": 10547.309, "sample_time_ms": 3924.784, "load_time_ms": 0.424, "load_throughput": 9439189.828, "learn_time_ms": 6613.603, "learn_throughput": 604.814, "synch_weights_time_ms": 7.917}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "episodes_total": 91, "training_iteration": 17, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-03-46", "timestamp": 1714269826, "time_this_iter_s": 12.238492965698242, "time_total_s": 179.99317908287048, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 179.99317908287048, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 39.88235294117647, "ram_util_percent": 63.40588235294117}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.961803487808474, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0987057296629312, "policy_loss": -0.03269057741729162, "vf_loss": 2.1256000205674157, "vf_explained_var": 0.24462914889858614, "kl": 0.01932095372748572, "entropy": 6.132477184008526, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 16275.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": -59.673435735841565, "episode_reward_min": -227.63697320905524, "episode_reward_mean": -105.62941011668804, "episode_len_mean": 703.8, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 70380, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114.28360098956463, -112.38861879900719, -114.50104494536792, -114.81237550882994, -100.85279933880952, -191.06248919875478, -105.66801867639708, -108.88840011176715, -100.27526515570464, -101.82837733991072, -119.79881443125504, -117.9712382101621, -106.38200467609987, -113.67037118018852, -102.3714714806502, -110.45926046397304, -115.23857979221516, -106.1584936505848, -99.98645677616322, -115.5268234165896, -85.47368125462144, -104.18303367963868, -109.95593781627156, -117.00740790170991, -82.17189284069737, -93.23788182555253, -105.90702924623464, -104.46676979304354, -105.6391147629719, -107.59551447696984, -114.04718956068228, -113.33805177474147, -96.35776919549184, -108.08958674169021, -189.2307974797488, -107.77688434873025, -104.21218206179391, -105.63208521384125, -102.25345442987854, -105.18705326224796, -109.74655774765284, -105.74642107303565, -95.74877264735359, -115.48749781705327, -123.11756407958953, -124.34736567230895, -98.43422503718101, -227.63697320905524, -103.20848532030111, -104.74097217605018, -98.2160608353316, -107.68068003419279, -107.04693271280453, -110.03438186249447, -110.67549925545471, -80.97254000151354, -105.67827933927936, -83.27784120548637, -86.1948913044376, -88.77419416264624, -80.78307664520416, -88.88895685807141, -78.30873418525803, -105.40570149411386, -113.43598028733706, -105.25767036241479, -104.36103860098807, -121.76541226746576, -81.23777308003359, -104.25385369370133, -111.15731429203599, -102.55531829289409, -65.11193457511747, -122.04911535369854, -70.12050803955002, -104.44029694369497, -86.87933463910709, -116.27684495819733, -112.56296487266012, -68.49217507766443, -95.8202291980808, -67.03927286708544, -64.9766486377686, -110.31301838187625, -103.44239079739899, -105.37409490066209, -61.27193892516752, -124.17013150861115, -102.78553823652926, -103.7874929302962, -59.673435735841565, -102.54232254654605, -96.61318877905371, -108.22813189239986, -112.97084794946636, -144.51906254358965, -104.74497120212267, -104.30621326431073, -109.10932674631911, -117.25479280469442], "episode_lengths": [62, 59, 92, 103, 74, 941, 84, 40, 1600, 63, 1600, 1600, 84, 38, 51, 1600, 1600, 1600, 58, 1600, 1600, 49, 58, 56, 1600, 1600, 67, 78, 1600, 46, 1600, 83, 1600, 45, 972, 63, 55, 54, 113, 1600, 1600, 73, 1600, 1600, 70, 91, 1600, 1561, 58, 1600, 1600, 1600, 73, 107, 1600, 1600, 56, 1600, 1600, 1600, 1600, 1600, 1600, 55, 42, 84, 59, 104, 1600, 102, 59, 59, 1600, 122, 1600, 49, 1600, 59, 69, 1600, 125, 1600, 1600, 105, 94, 64, 1600, 86, 64, 73, 1600, 54, 1600, 72, 61, 429, 50, 41, 110, 112]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31086579605360654, "mean_inference_ms": 1.0693937958755655, "mean_action_processing_ms": 0.2071658871778727, "mean_env_wait_ms": 0.42037474564765687, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006175994873046875, "StateBufferConnector_ms": 0.004730939865112305, "ViewRequirementAgentConnector_ms": 0.12674975395202637}}, "episode_reward_max": -59.673435735841565, "episode_reward_min": -227.63697320905524, "episode_reward_mean": -105.62941011668804, "episode_len_mean": 703.8, "episodes_this_iter": 10, "episodes_timesteps_total": 70380, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114.28360098956463, -112.38861879900719, -114.50104494536792, -114.81237550882994, -100.85279933880952, -191.06248919875478, -105.66801867639708, -108.88840011176715, -100.27526515570464, -101.82837733991072, -119.79881443125504, -117.9712382101621, -106.38200467609987, -113.67037118018852, -102.3714714806502, -110.45926046397304, -115.23857979221516, -106.1584936505848, -99.98645677616322, -115.5268234165896, -85.47368125462144, -104.18303367963868, -109.95593781627156, -117.00740790170991, -82.17189284069737, -93.23788182555253, -105.90702924623464, -104.46676979304354, -105.6391147629719, -107.59551447696984, -114.04718956068228, -113.33805177474147, -96.35776919549184, -108.08958674169021, -189.2307974797488, -107.77688434873025, -104.21218206179391, -105.63208521384125, -102.25345442987854, -105.18705326224796, -109.74655774765284, -105.74642107303565, -95.74877264735359, -115.48749781705327, -123.11756407958953, -124.34736567230895, -98.43422503718101, -227.63697320905524, -103.20848532030111, -104.74097217605018, -98.2160608353316, -107.68068003419279, -107.04693271280453, -110.03438186249447, -110.67549925545471, -80.97254000151354, -105.67827933927936, -83.27784120548637, -86.1948913044376, -88.77419416264624, -80.78307664520416, -88.88895685807141, -78.30873418525803, -105.40570149411386, -113.43598028733706, -105.25767036241479, -104.36103860098807, -121.76541226746576, -81.23777308003359, -104.25385369370133, -111.15731429203599, -102.55531829289409, -65.11193457511747, -122.04911535369854, -70.12050803955002, -104.44029694369497, -86.87933463910709, -116.27684495819733, -112.56296487266012, -68.49217507766443, -95.8202291980808, -67.03927286708544, -64.9766486377686, -110.31301838187625, -103.44239079739899, -105.37409490066209, -61.27193892516752, -124.17013150861115, -102.78553823652926, -103.7874929302962, -59.673435735841565, -102.54232254654605, -96.61318877905371, -108.22813189239986, -112.97084794946636, -144.51906254358965, -104.74497120212267, -104.30621326431073, -109.10932674631911, -117.25479280469442], "episode_lengths": [62, 59, 92, 103, 74, 941, 84, 40, 1600, 63, 1600, 1600, 84, 38, 51, 1600, 1600, 1600, 58, 1600, 1600, 49, 58, 56, 1600, 1600, 67, 78, 1600, 46, 1600, 83, 1600, 45, 972, 63, 55, 54, 113, 1600, 1600, 73, 1600, 1600, 70, 91, 1600, 1561, 58, 1600, 1600, 1600, 73, 107, 1600, 1600, 56, 1600, 1600, 1600, 1600, 1600, 1600, 55, 42, 84, 59, 104, 1600, 102, 59, 59, 1600, 122, 1600, 49, 1600, 59, 69, 1600, 125, 1600, 1600, 105, 94, 64, 1600, 86, 64, 73, 1600, 54, 1600, 72, 61, 429, 50, 41, 110, 112]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31086579605360654, "mean_inference_ms": 1.0693937958755655, "mean_action_processing_ms": 0.2071658871778727, "mean_env_wait_ms": 0.42037474564765687, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006175994873046875, "StateBufferConnector_ms": 0.004730939865112305, "ViewRequirementAgentConnector_ms": 0.12674975395202637}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 348.6407880738914, "num_env_steps_trained_throughput_per_sec": 348.6407880738914, "timesteps_total": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 10548.135, "restore_workers_time_ms": 0.014, "training_step_time_ms": 10548.096, "sample_time_ms": 3929.191, "load_time_ms": 0.445, "load_throughput": 8997273.556, "learn_time_ms": 6609.957, "learn_throughput": 605.148, "synch_weights_time_ms": 7.927}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 101, "training_iteration": 18, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-03-57", "timestamp": 1714269837, "time_this_iter_s": 11.47780466079712, "time_total_s": 191.4709837436676, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 191.4709837436676, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 34.86875, "ram_util_percent": 63.96249999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.338078220877597, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9328577694342903, "policy_loss": -0.029776903410111705, "vf_loss": 1.956639926752416, "vf_explained_var": 0.29514585201458265, "kl": 0.01998249572806083, "entropy": 5.768087248135639, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 17205.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "sampler_results": {"episode_reward_max": -59.673435735841565, "episode_reward_min": -227.63697320905524, "episode_reward_mean": -103.66184874024859, "episode_len_mean": 727.15, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 72715, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-101.82837733991072, -119.79881443125504, -117.9712382101621, -106.38200467609987, -113.67037118018852, -102.3714714806502, -110.45926046397304, -115.23857979221516, -106.1584936505848, -99.98645677616322, -115.5268234165896, -85.47368125462144, -104.18303367963868, -109.95593781627156, -117.00740790170991, -82.17189284069737, -93.23788182555253, -105.90702924623464, -104.46676979304354, -105.6391147629719, -107.59551447696984, -114.04718956068228, -113.33805177474147, -96.35776919549184, -108.08958674169021, -189.2307974797488, -107.77688434873025, -104.21218206179391, -105.63208521384125, -102.25345442987854, -105.18705326224796, -109.74655774765284, -105.74642107303565, -95.74877264735359, -115.48749781705327, -123.11756407958953, -124.34736567230895, -98.43422503718101, -227.63697320905524, -103.20848532030111, -104.74097217605018, -98.2160608353316, -107.68068003419279, -107.04693271280453, -110.03438186249447, -110.67549925545471, -80.97254000151354, -105.67827933927936, -83.27784120548637, -86.1948913044376, -88.77419416264624, -80.78307664520416, -88.88895685807141, -78.30873418525803, -105.40570149411386, -113.43598028733706, -105.25767036241479, -104.36103860098807, -121.76541226746576, -81.23777308003359, -104.25385369370133, -111.15731429203599, -102.55531829289409, -65.11193457511747, -122.04911535369854, -70.12050803955002, -104.44029694369497, -86.87933463910709, -116.27684495819733, -112.56296487266012, -68.49217507766443, -95.8202291980808, -67.03927286708544, -64.9766486377686, -110.31301838187625, -103.44239079739899, -105.37409490066209, -61.27193892516752, -124.17013150861115, -102.78553823652926, -103.7874929302962, -59.673435735841565, -102.54232254654605, -96.61318877905371, -108.22813189239986, -112.97084794946636, -144.51906254358965, -104.74497120212267, -104.30621326431073, -109.10932674631911, -117.25479280469442, -100.40820006534395, -108.17770361434543, -105.2281934090027, -79.52738256879465, -118.44692863732081, -71.74767393347739, -104.07693684590112, -105.44507307680138, -72.91838292927119], "episode_lengths": [63, 1600, 1600, 84, 38, 51, 1600, 1600, 1600, 58, 1600, 1600, 49, 58, 56, 1600, 1600, 67, 78, 1600, 46, 1600, 83, 1600, 45, 972, 63, 55, 54, 113, 1600, 1600, 73, 1600, 1600, 70, 91, 1600, 1561, 58, 1600, 1600, 1600, 73, 107, 1600, 1600, 56, 1600, 1600, 1600, 1600, 1600, 1600, 55, 42, 84, 59, 104, 1600, 102, 59, 59, 1600, 122, 1600, 49, 1600, 59, 69, 1600, 125, 1600, 1600, 105, 94, 64, 1600, 86, 64, 73, 1600, 54, 1600, 72, 61, 429, 50, 41, 110, 112, 104, 52, 62, 1600, 60, 1600, 63, 249, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30820936555939776, "mean_inference_ms": 1.0591885515499713, "mean_action_processing_ms": 0.20471387359587997, "mean_env_wait_ms": 0.4175737500781614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006098031997680664, "StateBufferConnector_ms": 0.004709005355834961, "ViewRequirementAgentConnector_ms": 0.1282212734222412}}, "episode_reward_max": -59.673435735841565, "episode_reward_min": -227.63697320905524, "episode_reward_mean": -103.66184874024859, "episode_len_mean": 727.15, "episodes_this_iter": 9, "episodes_timesteps_total": 72715, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-101.82837733991072, -119.79881443125504, -117.9712382101621, -106.38200467609987, -113.67037118018852, -102.3714714806502, -110.45926046397304, -115.23857979221516, -106.1584936505848, -99.98645677616322, -115.5268234165896, -85.47368125462144, -104.18303367963868, -109.95593781627156, -117.00740790170991, -82.17189284069737, -93.23788182555253, -105.90702924623464, -104.46676979304354, -105.6391147629719, -107.59551447696984, -114.04718956068228, -113.33805177474147, -96.35776919549184, -108.08958674169021, -189.2307974797488, -107.77688434873025, -104.21218206179391, -105.63208521384125, -102.25345442987854, -105.18705326224796, -109.74655774765284, -105.74642107303565, -95.74877264735359, -115.48749781705327, -123.11756407958953, -124.34736567230895, -98.43422503718101, -227.63697320905524, -103.20848532030111, -104.74097217605018, -98.2160608353316, -107.68068003419279, -107.04693271280453, -110.03438186249447, -110.67549925545471, -80.97254000151354, -105.67827933927936, -83.27784120548637, -86.1948913044376, -88.77419416264624, -80.78307664520416, -88.88895685807141, -78.30873418525803, -105.40570149411386, -113.43598028733706, -105.25767036241479, -104.36103860098807, -121.76541226746576, -81.23777308003359, -104.25385369370133, -111.15731429203599, -102.55531829289409, -65.11193457511747, -122.04911535369854, -70.12050803955002, -104.44029694369497, -86.87933463910709, -116.27684495819733, -112.56296487266012, -68.49217507766443, -95.8202291980808, -67.03927286708544, -64.9766486377686, -110.31301838187625, -103.44239079739899, -105.37409490066209, -61.27193892516752, -124.17013150861115, -102.78553823652926, -103.7874929302962, -59.673435735841565, -102.54232254654605, -96.61318877905371, -108.22813189239986, -112.97084794946636, -144.51906254358965, -104.74497120212267, -104.30621326431073, -109.10932674631911, -117.25479280469442, -100.40820006534395, -108.17770361434543, -105.2281934090027, -79.52738256879465, -118.44692863732081, -71.74767393347739, -104.07693684590112, -105.44507307680138, -72.91838292927119], "episode_lengths": [63, 1600, 1600, 84, 38, 51, 1600, 1600, 1600, 58, 1600, 1600, 49, 58, 56, 1600, 1600, 67, 78, 1600, 46, 1600, 83, 1600, 45, 972, 63, 55, 54, 113, 1600, 1600, 73, 1600, 1600, 70, 91, 1600, 1561, 58, 1600, 1600, 1600, 73, 107, 1600, 1600, 56, 1600, 1600, 1600, 1600, 1600, 1600, 55, 42, 84, 59, 104, 1600, 102, 59, 59, 1600, 122, 1600, 49, 1600, 59, 69, 1600, 125, 1600, 1600, 105, 94, 64, 1600, 86, 64, 73, 1600, 54, 1600, 72, 61, 429, 50, 41, 110, 112, 104, 52, 62, 1600, 60, 1600, 63, 249, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30820936555939776, "mean_inference_ms": 1.0591885515499713, "mean_action_processing_ms": 0.20471387359587997, "mean_env_wait_ms": 0.4175737500781614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006098031997680664, "StateBufferConnector_ms": 0.004709005355834961, "ViewRequirementAgentConnector_ms": 0.1282212734222412}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 348.68585035573625, "num_env_steps_trained_throughput_per_sec": 348.68585035573625, "timesteps_total": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 10647.915, "restore_workers_time_ms": 0.014, "training_step_time_ms": 10647.876, "sample_time_ms": 3941.362, "load_time_ms": 0.458, "load_throughput": 8739498.88, "learn_time_ms": 6697.318, "learn_throughput": 597.254, "synch_weights_time_ms": 8.149}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "episodes_total": 110, "training_iteration": 19, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-04-09", "timestamp": 1714269849, "time_this_iter_s": 11.478063821792603, "time_total_s": 202.9490475654602, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 202.9490475654602, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 33.71764705882352, "ram_util_percent": 65.06470588235294}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.323415690019566, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3152811182189672, "policy_loss": -0.03516854611776209, "vf_loss": 1.3453057735357232, "vf_explained_var": 0.16615359302489988, "kl": 0.017146299018970024, "entropy": 5.449344560664187, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 18135.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "sampler_results": {"episode_reward_max": -59.673435735841565, "episode_reward_min": -227.63697320905524, "episode_reward_mean": -103.21129049304355, "episode_len_mean": 728.12, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 72812, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-110.45926046397304, -115.23857979221516, -106.1584936505848, -99.98645677616322, -115.5268234165896, -85.47368125462144, -104.18303367963868, -109.95593781627156, -117.00740790170991, -82.17189284069737, -93.23788182555253, -105.90702924623464, -104.46676979304354, -105.6391147629719, -107.59551447696984, -114.04718956068228, -113.33805177474147, -96.35776919549184, -108.08958674169021, -189.2307974797488, -107.77688434873025, -104.21218206179391, -105.63208521384125, -102.25345442987854, -105.18705326224796, -109.74655774765284, -105.74642107303565, -95.74877264735359, -115.48749781705327, -123.11756407958953, -124.34736567230895, -98.43422503718101, -227.63697320905524, -103.20848532030111, -104.74097217605018, -98.2160608353316, -107.68068003419279, -107.04693271280453, -110.03438186249447, -110.67549925545471, -80.97254000151354, -105.67827933927936, -83.27784120548637, -86.1948913044376, -88.77419416264624, -80.78307664520416, -88.88895685807141, -78.30873418525803, -105.40570149411386, -113.43598028733706, -105.25767036241479, -104.36103860098807, -121.76541226746576, -81.23777308003359, -104.25385369370133, -111.15731429203599, -102.55531829289409, -65.11193457511747, -122.04911535369854, -70.12050803955002, -104.44029694369497, -86.87933463910709, -116.27684495819733, -112.56296487266012, -68.49217507766443, -95.8202291980808, -67.03927286708544, -64.9766486377686, -110.31301838187625, -103.44239079739899, -105.37409490066209, -61.27193892516752, -124.17013150861115, -102.78553823652926, -103.7874929302962, -59.673435735841565, -102.54232254654605, -96.61318877905371, -108.22813189239986, -112.97084794946636, -144.51906254358965, -104.74497120212267, -104.30621326431073, -109.10932674631911, -117.25479280469442, -100.40820006534395, -108.17770361434543, -105.2281934090027, -79.52738256879465, -118.44692863732081, -71.74767393347739, -104.07693684590112, -105.44507307680138, -72.91838292927119, -73.58729283932355, -102.40682284622764, -125.73742168245775, -120.07757261641324, -122.07998023676251, -73.077362376577], "episode_lengths": [1600, 1600, 1600, 58, 1600, 1600, 49, 58, 56, 1600, 1600, 67, 78, 1600, 46, 1600, 83, 1600, 45, 972, 63, 55, 54, 113, 1600, 1600, 73, 1600, 1600, 70, 91, 1600, 1561, 58, 1600, 1600, 1600, 73, 107, 1600, 1600, 56, 1600, 1600, 1600, 1600, 1600, 1600, 55, 42, 84, 59, 104, 1600, 102, 59, 59, 1600, 122, 1600, 49, 1600, 59, 69, 1600, 125, 1600, 1600, 105, 94, 64, 1600, 86, 64, 73, 1600, 54, 1600, 72, 61, 429, 50, 41, 110, 112, 104, 52, 62, 1600, 60, 1600, 63, 249, 1600, 1600, 70, 90, 77, 96, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3076703559723825, "mean_inference_ms": 1.0552199675956582, "mean_action_processing_ms": 0.20374890049891847, "mean_env_wait_ms": 0.4172528936065196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005994558334350586, "StateBufferConnector_ms": 0.004660606384277344, "ViewRequirementAgentConnector_ms": 0.1269855499267578}}, "episode_reward_max": -59.673435735841565, "episode_reward_min": -227.63697320905524, "episode_reward_mean": -103.21129049304355, "episode_len_mean": 728.12, "episodes_this_iter": 6, "episodes_timesteps_total": 72812, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-110.45926046397304, -115.23857979221516, -106.1584936505848, -99.98645677616322, -115.5268234165896, -85.47368125462144, -104.18303367963868, -109.95593781627156, -117.00740790170991, -82.17189284069737, -93.23788182555253, -105.90702924623464, -104.46676979304354, -105.6391147629719, -107.59551447696984, -114.04718956068228, -113.33805177474147, -96.35776919549184, -108.08958674169021, -189.2307974797488, -107.77688434873025, -104.21218206179391, -105.63208521384125, -102.25345442987854, -105.18705326224796, -109.74655774765284, -105.74642107303565, -95.74877264735359, -115.48749781705327, -123.11756407958953, -124.34736567230895, -98.43422503718101, -227.63697320905524, -103.20848532030111, -104.74097217605018, -98.2160608353316, -107.68068003419279, -107.04693271280453, -110.03438186249447, -110.67549925545471, -80.97254000151354, -105.67827933927936, -83.27784120548637, -86.1948913044376, -88.77419416264624, -80.78307664520416, -88.88895685807141, -78.30873418525803, -105.40570149411386, -113.43598028733706, -105.25767036241479, -104.36103860098807, -121.76541226746576, -81.23777308003359, -104.25385369370133, -111.15731429203599, -102.55531829289409, -65.11193457511747, -122.04911535369854, -70.12050803955002, -104.44029694369497, -86.87933463910709, -116.27684495819733, -112.56296487266012, -68.49217507766443, -95.8202291980808, -67.03927286708544, -64.9766486377686, -110.31301838187625, -103.44239079739899, -105.37409490066209, -61.27193892516752, -124.17013150861115, -102.78553823652926, -103.7874929302962, -59.673435735841565, -102.54232254654605, -96.61318877905371, -108.22813189239986, -112.97084794946636, -144.51906254358965, -104.74497120212267, -104.30621326431073, -109.10932674631911, -117.25479280469442, -100.40820006534395, -108.17770361434543, -105.2281934090027, -79.52738256879465, -118.44692863732081, -71.74767393347739, -104.07693684590112, -105.44507307680138, -72.91838292927119, -73.58729283932355, -102.40682284622764, -125.73742168245775, -120.07757261641324, -122.07998023676251, -73.077362376577], "episode_lengths": [1600, 1600, 1600, 58, 1600, 1600, 49, 58, 56, 1600, 1600, 67, 78, 1600, 46, 1600, 83, 1600, 45, 972, 63, 55, 54, 113, 1600, 1600, 73, 1600, 1600, 70, 91, 1600, 1561, 58, 1600, 1600, 1600, 73, 107, 1600, 1600, 56, 1600, 1600, 1600, 1600, 1600, 1600, 55, 42, 84, 59, 104, 1600, 102, 59, 59, 1600, 122, 1600, 49, 1600, 59, 69, 1600, 125, 1600, 1600, 105, 94, 64, 1600, 86, 64, 73, 1600, 54, 1600, 72, 61, 429, 50, 41, 110, 112, 104, 52, 62, 1600, 60, 1600, 63, 249, 1600, 1600, 70, 90, 77, 96, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3076703559723825, "mean_inference_ms": 1.0552199675956582, "mean_action_processing_ms": 0.20374890049891847, "mean_env_wait_ms": 0.4172528936065196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005994558334350586, "StateBufferConnector_ms": 0.004660606384277344, "ViewRequirementAgentConnector_ms": 0.1269855499267578}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 387.8795411516006, "num_env_steps_trained_throughput_per_sec": 387.8795411516006, "timesteps_total": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 10621.079, "restore_workers_time_ms": 0.014, "training_step_time_ms": 10621.039, "sample_time_ms": 3938.222, "load_time_ms": 0.417, "load_throughput": 9603443.618, "learn_time_ms": 6673.385, "learn_throughput": 599.396, "synch_weights_time_ms": 8.421}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "episodes_total": 116, "training_iteration": 20, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-04-19", "timestamp": 1714269859, "time_this_iter_s": 10.320467948913574, "time_total_s": 213.26951551437378, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 213.26951551437378, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 28.642857142857142, "ram_util_percent": 63.72142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.304081145569842, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4477036206176885, "policy_loss": -0.024295596874529316, "vf_loss": 0.46863948324675203, "vf_explained_var": 0.3094510019466441, "kl": 0.011199129376389068, "entropy": 5.499103943506877, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 19065.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": -59.673435735841565, "episode_reward_min": -227.63697320905524, "episode_reward_mean": -102.70063324922766, "episode_len_mean": 712.78, "episode_media": {}, "episodes_this_iter": 3, "episodes_timesteps_total": 71278, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-99.98645677616322, -115.5268234165896, -85.47368125462144, -104.18303367963868, -109.95593781627156, -117.00740790170991, -82.17189284069737, -93.23788182555253, -105.90702924623464, -104.46676979304354, -105.6391147629719, -107.59551447696984, -114.04718956068228, -113.33805177474147, -96.35776919549184, -108.08958674169021, -189.2307974797488, -107.77688434873025, -104.21218206179391, -105.63208521384125, -102.25345442987854, -105.18705326224796, -109.74655774765284, -105.74642107303565, -95.74877264735359, -115.48749781705327, -123.11756407958953, -124.34736567230895, -98.43422503718101, -227.63697320905524, -103.20848532030111, -104.74097217605018, -98.2160608353316, -107.68068003419279, -107.04693271280453, -110.03438186249447, -110.67549925545471, -80.97254000151354, -105.67827933927936, -83.27784120548637, -86.1948913044376, -88.77419416264624, -80.78307664520416, -88.88895685807141, -78.30873418525803, -105.40570149411386, -113.43598028733706, -105.25767036241479, -104.36103860098807, -121.76541226746576, -81.23777308003359, -104.25385369370133, -111.15731429203599, -102.55531829289409, -65.11193457511747, -122.04911535369854, -70.12050803955002, -104.44029694369497, -86.87933463910709, -116.27684495819733, -112.56296487266012, -68.49217507766443, -95.8202291980808, -67.03927286708544, -64.9766486377686, -110.31301838187625, -103.44239079739899, -105.37409490066209, -61.27193892516752, -124.17013150861115, -102.78553823652926, -103.7874929302962, -59.673435735841565, -102.54232254654605, -96.61318877905371, -108.22813189239986, -112.97084794946636, -144.51906254358965, -104.74497120212267, -104.30621326431073, -109.10932674631911, -117.25479280469442, -100.40820006534395, -108.17770361434543, -105.2281934090027, -79.52738256879465, -118.44692863732081, -71.74767393347739, -104.07693684590112, -105.44507307680138, -72.91838292927119, -73.58729283932355, -102.40682284622764, -125.73742168245775, -120.07757261641324, -122.07998023676251, -73.077362376577, -100.26687651423173, -104.44125932177839, -76.08247368917498], "episode_lengths": [58, 1600, 1600, 49, 58, 56, 1600, 1600, 67, 78, 1600, 46, 1600, 83, 1600, 45, 972, 63, 55, 54, 113, 1600, 1600, 73, 1600, 1600, 70, 91, 1600, 1561, 58, 1600, 1600, 1600, 73, 107, 1600, 1600, 56, 1600, 1600, 1600, 1600, 1600, 1600, 55, 42, 84, 59, 104, 1600, 102, 59, 59, 1600, 122, 1600, 49, 1600, 59, 69, 1600, 125, 1600, 1600, 105, 94, 64, 1600, 86, 64, 73, 1600, 54, 1600, 72, 61, 429, 50, 41, 110, 112, 104, 52, 62, 1600, 60, 1600, 63, 249, 1600, 1600, 70, 90, 77, 96, 1600, 1600, 66, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30759564279069274, "mean_inference_ms": 1.054557128403565, "mean_action_processing_ms": 0.20356384627324708, "mean_env_wait_ms": 0.41727123666444405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005911827087402344, "StateBufferConnector_ms": 0.004630327224731445, "ViewRequirementAgentConnector_ms": 0.12687444686889648}}, "episode_reward_max": -59.673435735841565, "episode_reward_min": -227.63697320905524, "episode_reward_mean": -102.70063324922766, "episode_len_mean": 712.78, "episodes_this_iter": 3, "episodes_timesteps_total": 71278, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-99.98645677616322, -115.5268234165896, -85.47368125462144, -104.18303367963868, -109.95593781627156, -117.00740790170991, -82.17189284069737, -93.23788182555253, -105.90702924623464, -104.46676979304354, -105.6391147629719, -107.59551447696984, -114.04718956068228, -113.33805177474147, -96.35776919549184, -108.08958674169021, -189.2307974797488, -107.77688434873025, -104.21218206179391, -105.63208521384125, -102.25345442987854, -105.18705326224796, -109.74655774765284, -105.74642107303565, -95.74877264735359, -115.48749781705327, -123.11756407958953, -124.34736567230895, -98.43422503718101, -227.63697320905524, -103.20848532030111, -104.74097217605018, -98.2160608353316, -107.68068003419279, -107.04693271280453, -110.03438186249447, -110.67549925545471, -80.97254000151354, -105.67827933927936, -83.27784120548637, -86.1948913044376, -88.77419416264624, -80.78307664520416, -88.88895685807141, -78.30873418525803, -105.40570149411386, -113.43598028733706, -105.25767036241479, -104.36103860098807, -121.76541226746576, -81.23777308003359, -104.25385369370133, -111.15731429203599, -102.55531829289409, -65.11193457511747, -122.04911535369854, -70.12050803955002, -104.44029694369497, -86.87933463910709, -116.27684495819733, -112.56296487266012, -68.49217507766443, -95.8202291980808, -67.03927286708544, -64.9766486377686, -110.31301838187625, -103.44239079739899, -105.37409490066209, -61.27193892516752, -124.17013150861115, -102.78553823652926, -103.7874929302962, -59.673435735841565, -102.54232254654605, -96.61318877905371, -108.22813189239986, -112.97084794946636, -144.51906254358965, -104.74497120212267, -104.30621326431073, -109.10932674631911, -117.25479280469442, -100.40820006534395, -108.17770361434543, -105.2281934090027, -79.52738256879465, -118.44692863732081, -71.74767393347739, -104.07693684590112, -105.44507307680138, -72.91838292927119, -73.58729283932355, -102.40682284622764, -125.73742168245775, -120.07757261641324, -122.07998023676251, -73.077362376577, -100.26687651423173, -104.44125932177839, -76.08247368917498], "episode_lengths": [58, 1600, 1600, 49, 58, 56, 1600, 1600, 67, 78, 1600, 46, 1600, 83, 1600, 45, 972, 63, 55, 54, 113, 1600, 1600, 73, 1600, 1600, 70, 91, 1600, 1561, 58, 1600, 1600, 1600, 73, 107, 1600, 1600, 56, 1600, 1600, 1600, 1600, 1600, 1600, 55, 42, 84, 59, 104, 1600, 102, 59, 59, 1600, 122, 1600, 49, 1600, 59, 69, 1600, 125, 1600, 1600, 105, 94, 64, 1600, 86, 64, 73, 1600, 54, 1600, 72, 61, 429, 50, 41, 110, 112, 104, 52, 62, 1600, 60, 1600, 63, 249, 1600, 1600, 70, 90, 77, 96, 1600, 1600, 66, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30759564279069274, "mean_inference_ms": 1.054557128403565, "mean_action_processing_ms": 0.20356384627324708, "mean_env_wait_ms": 0.41727123666444405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005911827087402344, "StateBufferConnector_ms": 0.004630327224731445, "ViewRequirementAgentConnector_ms": 0.12687444686889648}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 387.22434162842575, "num_env_steps_trained_throughput_per_sec": 387.22434162842575, "timesteps_total": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 10598.006, "restore_workers_time_ms": 0.014, "training_step_time_ms": 10597.966, "sample_time_ms": 3913.29, "load_time_ms": 0.428, "load_throughput": 9354455.534, "learn_time_ms": 6675.365, "learn_throughput": 599.218, "synch_weights_time_ms": 8.304}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 119, "training_iteration": 21, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-04-29", "timestamp": 1714269869, "time_this_iter_s": 10.334200859069824, "time_total_s": 223.6037163734436, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 223.6037163734436, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 28.61333333333333, "ram_util_percent": 62.63999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.669698598372038, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.40164979536546974, "policy_loss": -0.0284306418518686, "vf_loss": 0.42595003258476977, "vf_explained_var": 0.3487916407405689, "kl": 0.013768010822118005, "entropy": 4.948889454462195, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 19995.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "sampler_results": {"episode_reward_max": -59.673435735841565, "episode_reward_min": -227.63697320905524, "episode_reward_mean": -101.8914707652158, "episode_len_mean": 728.2, "episode_media": {}, "episodes_this_iter": 2, "episodes_timesteps_total": 72820, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-85.47368125462144, -104.18303367963868, -109.95593781627156, -117.00740790170991, -82.17189284069737, -93.23788182555253, -105.90702924623464, -104.46676979304354, -105.6391147629719, -107.59551447696984, -114.04718956068228, -113.33805177474147, -96.35776919549184, -108.08958674169021, -189.2307974797488, -107.77688434873025, -104.21218206179391, -105.63208521384125, -102.25345442987854, -105.18705326224796, -109.74655774765284, -105.74642107303565, -95.74877264735359, -115.48749781705327, -123.11756407958953, -124.34736567230895, -98.43422503718101, -227.63697320905524, -103.20848532030111, -104.74097217605018, -98.2160608353316, -107.68068003419279, -107.04693271280453, -110.03438186249447, -110.67549925545471, -80.97254000151354, -105.67827933927936, -83.27784120548637, -86.1948913044376, -88.77419416264624, -80.78307664520416, -88.88895685807141, -78.30873418525803, -105.40570149411386, -113.43598028733706, -105.25767036241479, -104.36103860098807, -121.76541226746576, -81.23777308003359, -104.25385369370133, -111.15731429203599, -102.55531829289409, -65.11193457511747, -122.04911535369854, -70.12050803955002, -104.44029694369497, -86.87933463910709, -116.27684495819733, -112.56296487266012, -68.49217507766443, -95.8202291980808, -67.03927286708544, -64.9766486377686, -110.31301838187625, -103.44239079739899, -105.37409490066209, -61.27193892516752, -124.17013150861115, -102.78553823652926, -103.7874929302962, -59.673435735841565, -102.54232254654605, -96.61318877905371, -108.22813189239986, -112.97084794946636, -144.51906254358965, -104.74497120212267, -104.30621326431073, -109.10932674631911, -117.25479280469442, -100.40820006534395, -108.17770361434543, -105.2281934090027, -79.52738256879465, -118.44692863732081, -71.74767393347739, -104.07693684590112, -105.44507307680138, -72.91838292927119, -73.58729283932355, -102.40682284622764, -125.73742168245775, -120.07757261641324, -122.07998023676251, -73.077362376577, -100.26687651423173, -104.44125932177839, -76.08247368917498, -65.54604603166058, -69.0509857599045], "episode_lengths": [1600, 49, 58, 56, 1600, 1600, 67, 78, 1600, 46, 1600, 83, 1600, 45, 972, 63, 55, 54, 113, 1600, 1600, 73, 1600, 1600, 70, 91, 1600, 1561, 58, 1600, 1600, 1600, 73, 107, 1600, 1600, 56, 1600, 1600, 1600, 1600, 1600, 1600, 55, 42, 84, 59, 104, 1600, 102, 59, 59, 1600, 122, 1600, 49, 1600, 59, 69, 1600, 125, 1600, 1600, 105, 94, 64, 1600, 86, 64, 73, 1600, 54, 1600, 72, 61, 429, 50, 41, 110, 112, 104, 52, 62, 1600, 60, 1600, 63, 249, 1600, 1600, 70, 90, 77, 96, 1600, 1600, 66, 1600, 1600, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30749032627869327, "mean_inference_ms": 1.0542741871661803, "mean_action_processing_ms": 0.203466370151743, "mean_env_wait_ms": 0.41717771984614976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00590062141418457, "StateBufferConnector_ms": 0.004561901092529297, "ViewRequirementAgentConnector_ms": 0.12638020515441895}}, "episode_reward_max": -59.673435735841565, "episode_reward_min": -227.63697320905524, "episode_reward_mean": -101.8914707652158, "episode_len_mean": 728.2, "episodes_this_iter": 2, "episodes_timesteps_total": 72820, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-85.47368125462144, -104.18303367963868, -109.95593781627156, -117.00740790170991, -82.17189284069737, -93.23788182555253, -105.90702924623464, -104.46676979304354, -105.6391147629719, -107.59551447696984, -114.04718956068228, -113.33805177474147, -96.35776919549184, -108.08958674169021, -189.2307974797488, -107.77688434873025, -104.21218206179391, -105.63208521384125, -102.25345442987854, -105.18705326224796, -109.74655774765284, -105.74642107303565, -95.74877264735359, -115.48749781705327, -123.11756407958953, -124.34736567230895, -98.43422503718101, -227.63697320905524, -103.20848532030111, -104.74097217605018, -98.2160608353316, -107.68068003419279, -107.04693271280453, -110.03438186249447, -110.67549925545471, -80.97254000151354, -105.67827933927936, -83.27784120548637, -86.1948913044376, -88.77419416264624, -80.78307664520416, -88.88895685807141, -78.30873418525803, -105.40570149411386, -113.43598028733706, -105.25767036241479, -104.36103860098807, -121.76541226746576, -81.23777308003359, -104.25385369370133, -111.15731429203599, -102.55531829289409, -65.11193457511747, -122.04911535369854, -70.12050803955002, -104.44029694369497, -86.87933463910709, -116.27684495819733, -112.56296487266012, -68.49217507766443, -95.8202291980808, -67.03927286708544, -64.9766486377686, -110.31301838187625, -103.44239079739899, -105.37409490066209, -61.27193892516752, -124.17013150861115, -102.78553823652926, -103.7874929302962, -59.673435735841565, -102.54232254654605, -96.61318877905371, -108.22813189239986, -112.97084794946636, -144.51906254358965, -104.74497120212267, -104.30621326431073, -109.10932674631911, -117.25479280469442, -100.40820006534395, -108.17770361434543, -105.2281934090027, -79.52738256879465, -118.44692863732081, -71.74767393347739, -104.07693684590112, -105.44507307680138, -72.91838292927119, -73.58729283932355, -102.40682284622764, -125.73742168245775, -120.07757261641324, -122.07998023676251, -73.077362376577, -100.26687651423173, -104.44125932177839, -76.08247368917498, -65.54604603166058, -69.0509857599045], "episode_lengths": [1600, 49, 58, 56, 1600, 1600, 67, 78, 1600, 46, 1600, 83, 1600, 45, 972, 63, 55, 54, 113, 1600, 1600, 73, 1600, 1600, 70, 91, 1600, 1561, 58, 1600, 1600, 1600, 73, 107, 1600, 1600, 56, 1600, 1600, 1600, 1600, 1600, 1600, 55, 42, 84, 59, 104, 1600, 102, 59, 59, 1600, 122, 1600, 49, 1600, 59, 69, 1600, 125, 1600, 1600, 105, 94, 64, 1600, 86, 64, 73, 1600, 54, 1600, 72, 61, 429, 50, 41, 110, 112, 104, 52, 62, 1600, 60, 1600, 63, 249, 1600, 1600, 70, 90, 77, 96, 1600, 1600, 66, 1600, 1600, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30749032627869327, "mean_inference_ms": 1.0542741871661803, "mean_action_processing_ms": 0.203466370151743, "mean_env_wait_ms": 0.41717771984614976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00590062141418457, "StateBufferConnector_ms": 0.004561901092529297, "ViewRequirementAgentConnector_ms": 0.12638020515441895}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 395.1841250006625, "num_env_steps_trained_throughput_per_sec": 395.1841250006625, "timesteps_total": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 10609.554, "restore_workers_time_ms": 0.013, "training_step_time_ms": 10609.515, "sample_time_ms": 3922.631, "load_time_ms": 0.431, "load_throughput": 9276355.192, "learn_time_ms": 6677.478, "learn_throughput": 599.029, "synch_weights_time_ms": 8.415}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "episodes_total": 121, "training_iteration": 22, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-04-40", "timestamp": 1714269880, "time_this_iter_s": 10.126061201095581, "time_total_s": 233.72977757453918, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 233.72977757453918, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 25.86428571428571, "ram_util_percent": 62.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.422924303239391, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.055710915358667, "policy_loss": -0.03140139365068046, "vf_loss": 1.0837436402036298, "vf_explained_var": 0.2030645453801719, "kl": 0.011228895996249308, "entropy": 5.246273197153563, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 20925.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "sampler_results": {"episode_reward_max": -57.80284727744514, "episode_reward_min": -227.63697320905524, "episode_reward_mean": -101.22970705103347, "episode_len_mean": 744.36, "episode_media": {}, "episodes_this_iter": 4, "episodes_timesteps_total": 74436, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-82.17189284069737, -93.23788182555253, -105.90702924623464, -104.46676979304354, -105.6391147629719, -107.59551447696984, -114.04718956068228, -113.33805177474147, -96.35776919549184, -108.08958674169021, -189.2307974797488, -107.77688434873025, -104.21218206179391, -105.63208521384125, -102.25345442987854, -105.18705326224796, -109.74655774765284, -105.74642107303565, -95.74877264735359, -115.48749781705327, -123.11756407958953, -124.34736567230895, -98.43422503718101, -227.63697320905524, -103.20848532030111, -104.74097217605018, -98.2160608353316, -107.68068003419279, -107.04693271280453, -110.03438186249447, -110.67549925545471, -80.97254000151354, -105.67827933927936, -83.27784120548637, -86.1948913044376, -88.77419416264624, -80.78307664520416, -88.88895685807141, -78.30873418525803, -105.40570149411386, -113.43598028733706, -105.25767036241479, -104.36103860098807, -121.76541226746576, -81.23777308003359, -104.25385369370133, -111.15731429203599, -102.55531829289409, -65.11193457511747, -122.04911535369854, -70.12050803955002, -104.44029694369497, -86.87933463910709, -116.27684495819733, -112.56296487266012, -68.49217507766443, -95.8202291980808, -67.03927286708544, -64.9766486377686, -110.31301838187625, -103.44239079739899, -105.37409490066209, -61.27193892516752, -124.17013150861115, -102.78553823652926, -103.7874929302962, -59.673435735841565, -102.54232254654605, -96.61318877905371, -108.22813189239986, -112.97084794946636, -144.51906254358965, -104.74497120212267, -104.30621326431073, -109.10932674631911, -117.25479280469442, -100.40820006534395, -108.17770361434543, -105.2281934090027, -79.52738256879465, -118.44692863732081, -71.74767393347739, -104.07693684590112, -105.44507307680138, -72.91838292927119, -73.58729283932355, -102.40682284622764, -125.73742168245775, -120.07757261641324, -122.07998023676251, -73.077362376577, -100.26687651423173, -104.44125932177839, -76.08247368917498, -65.54604603166058, -69.0509857599045, -57.80284727744514, -107.15863585994951, -65.60994399569186, -119.87226210092194], "episode_lengths": [1600, 1600, 67, 78, 1600, 46, 1600, 83, 1600, 45, 972, 63, 55, 54, 113, 1600, 1600, 73, 1600, 1600, 70, 91, 1600, 1561, 58, 1600, 1600, 1600, 73, 107, 1600, 1600, 56, 1600, 1600, 1600, 1600, 1600, 1600, 55, 42, 84, 59, 104, 1600, 102, 59, 59, 1600, 122, 1600, 49, 1600, 59, 69, 1600, 125, 1600, 1600, 105, 94, 64, 1600, 86, 64, 73, 1600, 54, 1600, 72, 61, 429, 50, 41, 110, 112, 104, 52, 62, 1600, 60, 1600, 63, 249, 1600, 1600, 70, 90, 77, 96, 1600, 1600, 66, 1600, 1600, 1600, 1600, 84, 1600, 95]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3074081541431835, "mean_inference_ms": 1.053396667432213, "mean_action_processing_ms": 0.20321594049083788, "mean_env_wait_ms": 0.4173739648821093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005952596664428711, "StateBufferConnector_ms": 0.004528999328613281, "ViewRequirementAgentConnector_ms": 0.12595224380493164}}, "episode_reward_max": -57.80284727744514, "episode_reward_min": -227.63697320905524, "episode_reward_mean": -101.22970705103347, "episode_len_mean": 744.36, "episodes_this_iter": 4, "episodes_timesteps_total": 74436, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-82.17189284069737, -93.23788182555253, -105.90702924623464, -104.46676979304354, -105.6391147629719, -107.59551447696984, -114.04718956068228, -113.33805177474147, -96.35776919549184, -108.08958674169021, -189.2307974797488, -107.77688434873025, -104.21218206179391, -105.63208521384125, -102.25345442987854, -105.18705326224796, -109.74655774765284, -105.74642107303565, -95.74877264735359, -115.48749781705327, -123.11756407958953, -124.34736567230895, -98.43422503718101, -227.63697320905524, -103.20848532030111, -104.74097217605018, -98.2160608353316, -107.68068003419279, -107.04693271280453, -110.03438186249447, -110.67549925545471, -80.97254000151354, -105.67827933927936, -83.27784120548637, -86.1948913044376, -88.77419416264624, -80.78307664520416, -88.88895685807141, -78.30873418525803, -105.40570149411386, -113.43598028733706, -105.25767036241479, -104.36103860098807, -121.76541226746576, -81.23777308003359, -104.25385369370133, -111.15731429203599, -102.55531829289409, -65.11193457511747, -122.04911535369854, -70.12050803955002, -104.44029694369497, -86.87933463910709, -116.27684495819733, -112.56296487266012, -68.49217507766443, -95.8202291980808, -67.03927286708544, -64.9766486377686, -110.31301838187625, -103.44239079739899, -105.37409490066209, -61.27193892516752, -124.17013150861115, -102.78553823652926, -103.7874929302962, -59.673435735841565, -102.54232254654605, -96.61318877905371, -108.22813189239986, -112.97084794946636, -144.51906254358965, -104.74497120212267, -104.30621326431073, -109.10932674631911, -117.25479280469442, -100.40820006534395, -108.17770361434543, -105.2281934090027, -79.52738256879465, -118.44692863732081, -71.74767393347739, -104.07693684590112, -105.44507307680138, -72.91838292927119, -73.58729283932355, -102.40682284622764, -125.73742168245775, -120.07757261641324, -122.07998023676251, -73.077362376577, -100.26687651423173, -104.44125932177839, -76.08247368917498, -65.54604603166058, -69.0509857599045, -57.80284727744514, -107.15863585994951, -65.60994399569186, -119.87226210092194], "episode_lengths": [1600, 1600, 67, 78, 1600, 46, 1600, 83, 1600, 45, 972, 63, 55, 54, 113, 1600, 1600, 73, 1600, 1600, 70, 91, 1600, 1561, 58, 1600, 1600, 1600, 73, 107, 1600, 1600, 56, 1600, 1600, 1600, 1600, 1600, 1600, 55, 42, 84, 59, 104, 1600, 102, 59, 59, 1600, 122, 1600, 49, 1600, 59, 69, 1600, 125, 1600, 1600, 105, 94, 64, 1600, 86, 64, 73, 1600, 54, 1600, 72, 61, 429, 50, 41, 110, 112, 104, 52, 62, 1600, 60, 1600, 63, 249, 1600, 1600, 70, 90, 77, 96, 1600, 1600, 66, 1600, 1600, 1600, 1600, 84, 1600, 95]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3074081541431835, "mean_inference_ms": 1.053396667432213, "mean_action_processing_ms": 0.20321594049083788, "mean_env_wait_ms": 0.4173739648821093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005952596664428711, "StateBufferConnector_ms": 0.004528999328613281, "ViewRequirementAgentConnector_ms": 0.12595224380493164}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 398.67221548258794, "num_env_steps_trained_throughput_per_sec": 398.67221548258794, "timesteps_total": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 10607.278, "restore_workers_time_ms": 0.013, "training_step_time_ms": 10607.24, "sample_time_ms": 3925.958, "load_time_ms": 0.431, "load_throughput": 9287652.79, "learn_time_ms": 6671.92, "learn_throughput": 599.528, "synch_weights_time_ms": 8.366}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "episodes_total": 125, "training_iteration": 23, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-04-50", "timestamp": 1714269890, "time_this_iter_s": 10.037326097488403, "time_total_s": 243.7671036720276, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 243.7671036720276, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 24.366666666666667, "ram_util_percent": 62.16666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.958834051957695, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8406968524161305, "policy_loss": -0.037585658580064775, "vf_loss": 1.8714434921861656, "vf_explained_var": 0.208564926796062, "kl": 0.022796753451570607, "entropy": 5.756917913498417, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 21855.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "sampler_results": {"episode_reward_max": -57.80284727744514, "episode_reward_min": -227.63697320905524, "episode_reward_mean": -101.13823962718556, "episode_len_mean": 698.66, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 69866, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-108.08958674169021, -189.2307974797488, -107.77688434873025, -104.21218206179391, -105.63208521384125, -102.25345442987854, -105.18705326224796, -109.74655774765284, -105.74642107303565, -95.74877264735359, -115.48749781705327, -123.11756407958953, -124.34736567230895, -98.43422503718101, -227.63697320905524, -103.20848532030111, -104.74097217605018, -98.2160608353316, -107.68068003419279, -107.04693271280453, -110.03438186249447, -110.67549925545471, -80.97254000151354, -105.67827933927936, -83.27784120548637, -86.1948913044376, -88.77419416264624, -80.78307664520416, -88.88895685807141, -78.30873418525803, -105.40570149411386, -113.43598028733706, -105.25767036241479, -104.36103860098807, -121.76541226746576, -81.23777308003359, -104.25385369370133, -111.15731429203599, -102.55531829289409, -65.11193457511747, -122.04911535369854, -70.12050803955002, -104.44029694369497, -86.87933463910709, -116.27684495819733, -112.56296487266012, -68.49217507766443, -95.8202291980808, -67.03927286708544, -64.9766486377686, -110.31301838187625, -103.44239079739899, -105.37409490066209, -61.27193892516752, -124.17013150861115, -102.78553823652926, -103.7874929302962, -59.673435735841565, -102.54232254654605, -96.61318877905371, -108.22813189239986, -112.97084794946636, -144.51906254358965, -104.74497120212267, -104.30621326431073, -109.10932674631911, -117.25479280469442, -100.40820006534395, -108.17770361434543, -105.2281934090027, -79.52738256879465, -118.44692863732081, -71.74767393347739, -104.07693684590112, -105.44507307680138, -72.91838292927119, -73.58729283932355, -102.40682284622764, -125.73742168245775, -120.07757261641324, -122.07998023676251, -73.077362376577, -100.26687651423173, -104.44125932177839, -76.08247368917498, -65.54604603166058, -69.0509857599045, -57.80284727744514, -107.15863585994951, -65.60994399569186, -119.87226210092194, -67.85319110878804, -111.73074151834163, -106.52223467564272, -65.72975099817926, -105.58365427381422, -127.07741654054759, -103.75480155031197, -104.1525084811685, -121.21017194479953], "episode_lengths": [45, 972, 63, 55, 54, 113, 1600, 1600, 73, 1600, 1600, 70, 91, 1600, 1561, 58, 1600, 1600, 1600, 73, 107, 1600, 1600, 56, 1600, 1600, 1600, 1600, 1600, 1600, 55, 42, 84, 59, 104, 1600, 102, 59, 59, 1600, 122, 1600, 49, 1600, 59, 69, 1600, 125, 1600, 1600, 105, 94, 64, 1600, 86, 64, 73, 1600, 54, 1600, 72, 61, 429, 50, 41, 110, 112, 104, 52, 62, 1600, 60, 1600, 63, 249, 1600, 1600, 70, 90, 77, 96, 1600, 1600, 66, 1600, 1600, 1600, 1600, 84, 1600, 95, 1600, 63, 66, 1600, 93, 91, 61, 72, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3077066439542795, "mean_inference_ms": 1.0542157686999605, "mean_action_processing_ms": 0.20320797597656728, "mean_env_wait_ms": 0.4180240081416173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005884408950805664, "StateBufferConnector_ms": 0.004486560821533203, "ViewRequirementAgentConnector_ms": 0.12587499618530273}}, "episode_reward_max": -57.80284727744514, "episode_reward_min": -227.63697320905524, "episode_reward_mean": -101.13823962718556, "episode_len_mean": 698.66, "episodes_this_iter": 9, "episodes_timesteps_total": 69866, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-108.08958674169021, -189.2307974797488, -107.77688434873025, -104.21218206179391, -105.63208521384125, -102.25345442987854, -105.18705326224796, -109.74655774765284, -105.74642107303565, -95.74877264735359, -115.48749781705327, -123.11756407958953, -124.34736567230895, -98.43422503718101, -227.63697320905524, -103.20848532030111, -104.74097217605018, -98.2160608353316, -107.68068003419279, -107.04693271280453, -110.03438186249447, -110.67549925545471, -80.97254000151354, -105.67827933927936, -83.27784120548637, -86.1948913044376, -88.77419416264624, -80.78307664520416, -88.88895685807141, -78.30873418525803, -105.40570149411386, -113.43598028733706, -105.25767036241479, -104.36103860098807, -121.76541226746576, -81.23777308003359, -104.25385369370133, -111.15731429203599, -102.55531829289409, -65.11193457511747, -122.04911535369854, -70.12050803955002, -104.44029694369497, -86.87933463910709, -116.27684495819733, -112.56296487266012, -68.49217507766443, -95.8202291980808, -67.03927286708544, -64.9766486377686, -110.31301838187625, -103.44239079739899, -105.37409490066209, -61.27193892516752, -124.17013150861115, -102.78553823652926, -103.7874929302962, -59.673435735841565, -102.54232254654605, -96.61318877905371, -108.22813189239986, -112.97084794946636, -144.51906254358965, -104.74497120212267, -104.30621326431073, -109.10932674631911, -117.25479280469442, -100.40820006534395, -108.17770361434543, -105.2281934090027, -79.52738256879465, -118.44692863732081, -71.74767393347739, -104.07693684590112, -105.44507307680138, -72.91838292927119, -73.58729283932355, -102.40682284622764, -125.73742168245775, -120.07757261641324, -122.07998023676251, -73.077362376577, -100.26687651423173, -104.44125932177839, -76.08247368917498, -65.54604603166058, -69.0509857599045, -57.80284727744514, -107.15863585994951, -65.60994399569186, -119.87226210092194, -67.85319110878804, -111.73074151834163, -106.52223467564272, -65.72975099817926, -105.58365427381422, -127.07741654054759, -103.75480155031197, -104.1525084811685, -121.21017194479953], "episode_lengths": [45, 972, 63, 55, 54, 113, 1600, 1600, 73, 1600, 1600, 70, 91, 1600, 1561, 58, 1600, 1600, 1600, 73, 107, 1600, 1600, 56, 1600, 1600, 1600, 1600, 1600, 1600, 55, 42, 84, 59, 104, 1600, 102, 59, 59, 1600, 122, 1600, 49, 1600, 59, 69, 1600, 125, 1600, 1600, 105, 94, 64, 1600, 86, 64, 73, 1600, 54, 1600, 72, 61, 429, 50, 41, 110, 112, 104, 52, 62, 1600, 60, 1600, 63, 249, 1600, 1600, 70, 90, 77, 96, 1600, 1600, 66, 1600, 1600, 1600, 1600, 84, 1600, 95, 1600, 63, 66, 1600, 93, 91, 61, 72, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3077066439542795, "mean_inference_ms": 1.0542157686999605, "mean_action_processing_ms": 0.20320797597656728, "mean_env_wait_ms": 0.4180240081416173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005884408950805664, "StateBufferConnector_ms": 0.004486560821533203, "ViewRequirementAgentConnector_ms": 0.12587499618530273}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 336.2610739295237, "num_env_steps_trained_throughput_per_sec": 336.2610739295237, "timesteps_total": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 10791.645, "restore_workers_time_ms": 0.013, "training_step_time_ms": 10791.605, "sample_time_ms": 3954.476, "load_time_ms": 0.435, "load_throughput": 9186954.331, "learn_time_ms": 6827.28, "learn_throughput": 585.885, "synch_weights_time_ms": 8.834}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 134, "training_iteration": 24, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-05-02", "timestamp": 1714269902, "time_this_iter_s": 11.902758836746216, "time_total_s": 255.6698625087738, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 255.6698625087738, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 38.07058823529412, "ram_util_percent": 62.7764705882353}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.395033053364806, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2130523863341158, "policy_loss": -0.031195415860863142, "vf_loss": 1.2384217647374958, "vf_explained_var": 0.34116113256382685, "kl": 0.012946743137159074, "entropy": 5.632606987286639, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 22785.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "sampler_results": {"episode_reward_max": -56.44806606942304, "episode_reward_min": -227.63697320905524, "episode_reward_mean": -98.59870034330048, "episode_len_mean": 720.86, "episode_media": {}, "episodes_this_iter": 8, "episodes_timesteps_total": 72086, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-105.74642107303565, -95.74877264735359, -115.48749781705327, -123.11756407958953, -124.34736567230895, -98.43422503718101, -227.63697320905524, -103.20848532030111, -104.74097217605018, -98.2160608353316, -107.68068003419279, -107.04693271280453, -110.03438186249447, -110.67549925545471, -80.97254000151354, -105.67827933927936, -83.27784120548637, -86.1948913044376, -88.77419416264624, -80.78307664520416, -88.88895685807141, -78.30873418525803, -105.40570149411386, -113.43598028733706, -105.25767036241479, -104.36103860098807, -121.76541226746576, -81.23777308003359, -104.25385369370133, -111.15731429203599, -102.55531829289409, -65.11193457511747, -122.04911535369854, -70.12050803955002, -104.44029694369497, -86.87933463910709, -116.27684495819733, -112.56296487266012, -68.49217507766443, -95.8202291980808, -67.03927286708544, -64.9766486377686, -110.31301838187625, -103.44239079739899, -105.37409490066209, -61.27193892516752, -124.17013150861115, -102.78553823652926, -103.7874929302962, -59.673435735841565, -102.54232254654605, -96.61318877905371, -108.22813189239986, -112.97084794946636, -144.51906254358965, -104.74497120212267, -104.30621326431073, -109.10932674631911, -117.25479280469442, -100.40820006534395, -108.17770361434543, -105.2281934090027, -79.52738256879465, -118.44692863732081, -71.74767393347739, -104.07693684590112, -105.44507307680138, -72.91838292927119, -73.58729283932355, -102.40682284622764, -125.73742168245775, -120.07757261641324, -122.07998023676251, -73.077362376577, -100.26687651423173, -104.44125932177839, -76.08247368917498, -65.54604603166058, -69.0509857599045, -57.80284727744514, -107.15863585994951, -65.60994399569186, -119.87226210092194, -67.85319110878804, -111.73074151834163, -106.52223467564272, -65.72975099817926, -105.58365427381422, -127.07741654054759, -103.75480155031197, -104.1525084811685, -121.21017194479953, -57.97779173413159, -56.44806606942304, -70.12273880274329, -104.82508820553434, -67.01423012593271, -109.24905223545619, -106.32081469651064, -106.21689102734501], "episode_lengths": [73, 1600, 1600, 70, 91, 1600, 1561, 58, 1600, 1600, 1600, 73, 107, 1600, 1600, 56, 1600, 1600, 1600, 1600, 1600, 1600, 55, 42, 84, 59, 104, 1600, 102, 59, 59, 1600, 122, 1600, 49, 1600, 59, 69, 1600, 125, 1600, 1600, 105, 94, 64, 1600, 86, 64, 73, 1600, 54, 1600, 72, 61, 429, 50, 41, 110, 112, 104, 52, 62, 1600, 60, 1600, 63, 249, 1600, 1600, 70, 90, 77, 96, 1600, 1600, 66, 1600, 1600, 1600, 1600, 84, 1600, 95, 1600, 63, 66, 1600, 93, 91, 61, 72, 58, 1600, 1600, 1600, 69, 1600, 70, 88, 95]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3074160926783847, "mean_inference_ms": 1.053800378146827, "mean_action_processing_ms": 0.20303534899627862, "mean_env_wait_ms": 0.4172334480984219, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005815029144287109, "StateBufferConnector_ms": 0.004394054412841797, "ViewRequirementAgentConnector_ms": 0.12409543991088867}}, "episode_reward_max": -56.44806606942304, "episode_reward_min": -227.63697320905524, "episode_reward_mean": -98.59870034330048, "episode_len_mean": 720.86, "episodes_this_iter": 8, "episodes_timesteps_total": 72086, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-105.74642107303565, -95.74877264735359, -115.48749781705327, -123.11756407958953, -124.34736567230895, -98.43422503718101, -227.63697320905524, -103.20848532030111, -104.74097217605018, -98.2160608353316, -107.68068003419279, -107.04693271280453, -110.03438186249447, -110.67549925545471, -80.97254000151354, -105.67827933927936, -83.27784120548637, -86.1948913044376, -88.77419416264624, -80.78307664520416, -88.88895685807141, -78.30873418525803, -105.40570149411386, -113.43598028733706, -105.25767036241479, -104.36103860098807, -121.76541226746576, -81.23777308003359, -104.25385369370133, -111.15731429203599, -102.55531829289409, -65.11193457511747, -122.04911535369854, -70.12050803955002, -104.44029694369497, -86.87933463910709, -116.27684495819733, -112.56296487266012, -68.49217507766443, -95.8202291980808, -67.03927286708544, -64.9766486377686, -110.31301838187625, -103.44239079739899, -105.37409490066209, -61.27193892516752, -124.17013150861115, -102.78553823652926, -103.7874929302962, -59.673435735841565, -102.54232254654605, -96.61318877905371, -108.22813189239986, -112.97084794946636, -144.51906254358965, -104.74497120212267, -104.30621326431073, -109.10932674631911, -117.25479280469442, -100.40820006534395, -108.17770361434543, -105.2281934090027, -79.52738256879465, -118.44692863732081, -71.74767393347739, -104.07693684590112, -105.44507307680138, -72.91838292927119, -73.58729283932355, -102.40682284622764, -125.73742168245775, -120.07757261641324, -122.07998023676251, -73.077362376577, -100.26687651423173, -104.44125932177839, -76.08247368917498, -65.54604603166058, -69.0509857599045, -57.80284727744514, -107.15863585994951, -65.60994399569186, -119.87226210092194, -67.85319110878804, -111.73074151834163, -106.52223467564272, -65.72975099817926, -105.58365427381422, -127.07741654054759, -103.75480155031197, -104.1525084811685, -121.21017194479953, -57.97779173413159, -56.44806606942304, -70.12273880274329, -104.82508820553434, -67.01423012593271, -109.24905223545619, -106.32081469651064, -106.21689102734501], "episode_lengths": [73, 1600, 1600, 70, 91, 1600, 1561, 58, 1600, 1600, 1600, 73, 107, 1600, 1600, 56, 1600, 1600, 1600, 1600, 1600, 1600, 55, 42, 84, 59, 104, 1600, 102, 59, 59, 1600, 122, 1600, 49, 1600, 59, 69, 1600, 125, 1600, 1600, 105, 94, 64, 1600, 86, 64, 73, 1600, 54, 1600, 72, 61, 429, 50, 41, 110, 112, 104, 52, 62, 1600, 60, 1600, 63, 249, 1600, 1600, 70, 90, 77, 96, 1600, 1600, 66, 1600, 1600, 1600, 1600, 84, 1600, 95, 1600, 63, 66, 1600, 93, 91, 61, 72, 58, 1600, 1600, 1600, 69, 1600, 70, 88, 95]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3074160926783847, "mean_inference_ms": 1.053800378146827, "mean_action_processing_ms": 0.20303534899627862, "mean_env_wait_ms": 0.4172334480984219, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005815029144287109, "StateBufferConnector_ms": 0.004394054412841797, "ViewRequirementAgentConnector_ms": 0.12409543991088867}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 388.23349923003394, "num_env_steps_trained_throughput_per_sec": 388.23349923003394, "timesteps_total": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 10818.858, "restore_workers_time_ms": 0.036, "training_step_time_ms": 10818.798, "sample_time_ms": 3980.859, "load_time_ms": 0.449, "load_throughput": 8906522.27, "learn_time_ms": 6828.114, "learn_throughput": 585.813, "synch_weights_time_ms": 8.809}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "episodes_total": 142, "training_iteration": 25, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-05-12", "timestamp": 1714269912, "time_this_iter_s": 10.307381868362427, "time_total_s": 265.97724437713623, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 265.97724437713623, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 35.47142857142857, "ram_util_percent": 63.807142857142836}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.974977773171599, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.560059786814275, "policy_loss": -0.0322556453526661, "vf_loss": 1.5867040692157643, "vf_explained_var": 0.19254527309889435, "kl": 0.012469695269111902, "entropy": 5.554199453323118, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 23715.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "sampler_results": {"episode_reward_max": -52.98814861659522, "episode_reward_min": -144.51906254358965, "episode_reward_mean": -96.22921803211831, "episode_len_mean": 690.75, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 69075, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-103.20848532030111, -104.74097217605018, -98.2160608353316, -107.68068003419279, -107.04693271280453, -110.03438186249447, -110.67549925545471, -80.97254000151354, -105.67827933927936, -83.27784120548637, -86.1948913044376, -88.77419416264624, -80.78307664520416, -88.88895685807141, -78.30873418525803, -105.40570149411386, -113.43598028733706, -105.25767036241479, -104.36103860098807, -121.76541226746576, -81.23777308003359, -104.25385369370133, -111.15731429203599, -102.55531829289409, -65.11193457511747, -122.04911535369854, -70.12050803955002, -104.44029694369497, -86.87933463910709, -116.27684495819733, -112.56296487266012, -68.49217507766443, -95.8202291980808, -67.03927286708544, -64.9766486377686, -110.31301838187625, -103.44239079739899, -105.37409490066209, -61.27193892516752, -124.17013150861115, -102.78553823652926, -103.7874929302962, -59.673435735841565, -102.54232254654605, -96.61318877905371, -108.22813189239986, -112.97084794946636, -144.51906254358965, -104.74497120212267, -104.30621326431073, -109.10932674631911, -117.25479280469442, -100.40820006534395, -108.17770361434543, -105.2281934090027, -79.52738256879465, -118.44692863732081, -71.74767393347739, -104.07693684590112, -105.44507307680138, -72.91838292927119, -73.58729283932355, -102.40682284622764, -125.73742168245775, -120.07757261641324, -122.07998023676251, -73.077362376577, -100.26687651423173, -104.44125932177839, -76.08247368917498, -65.54604603166058, -69.0509857599045, -57.80284727744514, -107.15863585994951, -65.60994399569186, -119.87226210092194, -67.85319110878804, -111.73074151834163, -106.52223467564272, -65.72975099817926, -105.58365427381422, -127.07741654054759, -103.75480155031197, -104.1525084811685, -121.21017194479953, -57.97779173413159, -56.44806606942304, -70.12273880274329, -104.82508820553434, -67.01423012593271, -109.24905223545619, -106.32081469651064, -106.21689102734501, -52.98814861659522, -106.62052079490945, -103.19828111346315, -111.64540432366418, -118.75681626889296, -56.09946695951308, -104.2619503403219], "episode_lengths": [58, 1600, 1600, 1600, 73, 107, 1600, 1600, 56, 1600, 1600, 1600, 1600, 1600, 1600, 55, 42, 84, 59, 104, 1600, 102, 59, 59, 1600, 122, 1600, 49, 1600, 59, 69, 1600, 125, 1600, 1600, 105, 94, 64, 1600, 86, 64, 73, 1600, 54, 1600, 72, 61, 429, 50, 41, 110, 112, 104, 52, 62, 1600, 60, 1600, 63, 249, 1600, 1600, 70, 90, 77, 96, 1600, 1600, 66, 1600, 1600, 1600, 1600, 84, 1600, 95, 1600, 63, 66, 1600, 93, 91, 61, 72, 58, 1600, 1600, 1600, 69, 1600, 70, 88, 95, 1600, 46, 72, 102, 76, 1600, 88]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3072622728586732, "mean_inference_ms": 1.0519691338153543, "mean_action_processing_ms": 0.20265559481857343, "mean_env_wait_ms": 0.41711489156116466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005794525146484375, "StateBufferConnector_ms": 0.004445075988769531, "ViewRequirementAgentConnector_ms": 0.12330389022827148}}, "episode_reward_max": -52.98814861659522, "episode_reward_min": -144.51906254358965, "episode_reward_mean": -96.22921803211831, "episode_len_mean": 690.75, "episodes_this_iter": 7, "episodes_timesteps_total": 69075, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-103.20848532030111, -104.74097217605018, -98.2160608353316, -107.68068003419279, -107.04693271280453, -110.03438186249447, -110.67549925545471, -80.97254000151354, -105.67827933927936, -83.27784120548637, -86.1948913044376, -88.77419416264624, -80.78307664520416, -88.88895685807141, -78.30873418525803, -105.40570149411386, -113.43598028733706, -105.25767036241479, -104.36103860098807, -121.76541226746576, -81.23777308003359, -104.25385369370133, -111.15731429203599, -102.55531829289409, -65.11193457511747, -122.04911535369854, -70.12050803955002, -104.44029694369497, -86.87933463910709, -116.27684495819733, -112.56296487266012, -68.49217507766443, -95.8202291980808, -67.03927286708544, -64.9766486377686, -110.31301838187625, -103.44239079739899, -105.37409490066209, -61.27193892516752, -124.17013150861115, -102.78553823652926, -103.7874929302962, -59.673435735841565, -102.54232254654605, -96.61318877905371, -108.22813189239986, -112.97084794946636, -144.51906254358965, -104.74497120212267, -104.30621326431073, -109.10932674631911, -117.25479280469442, -100.40820006534395, -108.17770361434543, -105.2281934090027, -79.52738256879465, -118.44692863732081, -71.74767393347739, -104.07693684590112, -105.44507307680138, -72.91838292927119, -73.58729283932355, -102.40682284622764, -125.73742168245775, -120.07757261641324, -122.07998023676251, -73.077362376577, -100.26687651423173, -104.44125932177839, -76.08247368917498, -65.54604603166058, -69.0509857599045, -57.80284727744514, -107.15863585994951, -65.60994399569186, -119.87226210092194, -67.85319110878804, -111.73074151834163, -106.52223467564272, -65.72975099817926, -105.58365427381422, -127.07741654054759, -103.75480155031197, -104.1525084811685, -121.21017194479953, -57.97779173413159, -56.44806606942304, -70.12273880274329, -104.82508820553434, -67.01423012593271, -109.24905223545619, -106.32081469651064, -106.21689102734501, -52.98814861659522, -106.62052079490945, -103.19828111346315, -111.64540432366418, -118.75681626889296, -56.09946695951308, -104.2619503403219], "episode_lengths": [58, 1600, 1600, 1600, 73, 107, 1600, 1600, 56, 1600, 1600, 1600, 1600, 1600, 1600, 55, 42, 84, 59, 104, 1600, 102, 59, 59, 1600, 122, 1600, 49, 1600, 59, 69, 1600, 125, 1600, 1600, 105, 94, 64, 1600, 86, 64, 73, 1600, 54, 1600, 72, 61, 429, 50, 41, 110, 112, 104, 52, 62, 1600, 60, 1600, 63, 249, 1600, 1600, 70, 90, 77, 96, 1600, 1600, 66, 1600, 1600, 1600, 1600, 84, 1600, 95, 1600, 63, 66, 1600, 93, 91, 61, 72, 58, 1600, 1600, 1600, 69, 1600, 70, 88, 95, 1600, 46, 72, 102, 76, 1600, 88]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3072622728586732, "mean_inference_ms": 1.0519691338153543, "mean_action_processing_ms": 0.20265559481857343, "mean_env_wait_ms": 0.41711489156116466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005794525146484375, "StateBufferConnector_ms": 0.004445075988769531, "ViewRequirementAgentConnector_ms": 0.12330389022827148}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 416.0608170563445, "num_env_steps_trained_throughput_per_sec": 416.0608170563445, "timesteps_total": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 10778.87, "restore_workers_time_ms": 0.036, "training_step_time_ms": 10778.811, "sample_time_ms": 3966.726, "load_time_ms": 0.448, "load_throughput": 8926900.074, "learn_time_ms": 6802.295, "learn_throughput": 588.037, "synch_weights_time_ms": 8.77}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "episodes_total": 149, "training_iteration": 26, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-05-22", "timestamp": 1714269922, "time_this_iter_s": 9.61803913116455, "time_total_s": 275.5952835083008, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 275.5952835083008, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 23.978571428571428, "ram_util_percent": 63.771428571428594}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.825226784777898, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.176150056464167, "policy_loss": -0.03031936178925217, "vf_loss": 2.199781447392638, "vf_explained_var": 0.3141034157045426, "kl": 0.014862174466872016, "entropy": 6.057772316983951, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 24645.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": -52.98814861659522, "episode_reward_min": -144.51906254358965, "episode_reward_mean": -96.345382236738, "episode_len_mean": 598.35, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 59835, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-80.78307664520416, -88.88895685807141, -78.30873418525803, -105.40570149411386, -113.43598028733706, -105.25767036241479, -104.36103860098807, -121.76541226746576, -81.23777308003359, -104.25385369370133, -111.15731429203599, -102.55531829289409, -65.11193457511747, -122.04911535369854, -70.12050803955002, -104.44029694369497, -86.87933463910709, -116.27684495819733, -112.56296487266012, -68.49217507766443, -95.8202291980808, -67.03927286708544, -64.9766486377686, -110.31301838187625, -103.44239079739899, -105.37409490066209, -61.27193892516752, -124.17013150861115, -102.78553823652926, -103.7874929302962, -59.673435735841565, -102.54232254654605, -96.61318877905371, -108.22813189239986, -112.97084794946636, -144.51906254358965, -104.74497120212267, -104.30621326431073, -109.10932674631911, -117.25479280469442, -100.40820006534395, -108.17770361434543, -105.2281934090027, -79.52738256879465, -118.44692863732081, -71.74767393347739, -104.07693684590112, -105.44507307680138, -72.91838292927119, -73.58729283932355, -102.40682284622764, -125.73742168245775, -120.07757261641324, -122.07998023676251, -73.077362376577, -100.26687651423173, -104.44125932177839, -76.08247368917498, -65.54604603166058, -69.0509857599045, -57.80284727744514, -107.15863585994951, -65.60994399569186, -119.87226210092194, -67.85319110878804, -111.73074151834163, -106.52223467564272, -65.72975099817926, -105.58365427381422, -127.07741654054759, -103.75480155031197, -104.1525084811685, -121.21017194479953, -57.97779173413159, -56.44806606942304, -70.12273880274329, -104.82508820553434, -67.01423012593271, -109.24905223545619, -106.32081469651064, -106.21689102734501, -52.98814861659522, -106.62052079490945, -103.19828111346315, -111.64540432366418, -118.75681626889296, -56.09946695951308, -104.2619503403219, -54.506296861901895, -108.90800401239656, -113.0829883581965, -101.37019290915629, -107.20112682009612, -61.88185140875596, -112.20990885074686, -106.76025776533845, -106.88267489650163, -105.39834753325891, -115.24254430767522, -104.67298494793786], "episode_lengths": [1600, 1600, 1600, 55, 42, 84, 59, 104, 1600, 102, 59, 59, 1600, 122, 1600, 49, 1600, 59, 69, 1600, 125, 1600, 1600, 105, 94, 64, 1600, 86, 64, 73, 1600, 54, 1600, 72, 61, 429, 50, 41, 110, 112, 104, 52, 62, 1600, 60, 1600, 63, 249, 1600, 1600, 70, 90, 77, 96, 1600, 1600, 66, 1600, 1600, 1600, 1600, 84, 1600, 95, 1600, 63, 66, 1600, 93, 91, 61, 72, 58, 1600, 1600, 1600, 69, 1600, 70, 88, 95, 1600, 46, 72, 102, 76, 1600, 88, 1600, 64, 59, 69, 49, 1600, 57, 72, 104, 56, 53, 71]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3063883466478415, "mean_inference_ms": 1.0485635620541829, "mean_action_processing_ms": 0.20196682203112054, "mean_env_wait_ms": 0.41606930760927485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0057523250579833984, "StateBufferConnector_ms": 0.004427671432495117, "ViewRequirementAgentConnector_ms": 0.12055754661560059}}, "episode_reward_max": -52.98814861659522, "episode_reward_min": -144.51906254358965, "episode_reward_mean": -96.345382236738, "episode_len_mean": 598.35, "episodes_this_iter": 12, "episodes_timesteps_total": 59835, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-80.78307664520416, -88.88895685807141, -78.30873418525803, -105.40570149411386, -113.43598028733706, -105.25767036241479, -104.36103860098807, -121.76541226746576, -81.23777308003359, -104.25385369370133, -111.15731429203599, -102.55531829289409, -65.11193457511747, -122.04911535369854, -70.12050803955002, -104.44029694369497, -86.87933463910709, -116.27684495819733, -112.56296487266012, -68.49217507766443, -95.8202291980808, -67.03927286708544, -64.9766486377686, -110.31301838187625, -103.44239079739899, -105.37409490066209, -61.27193892516752, -124.17013150861115, -102.78553823652926, -103.7874929302962, -59.673435735841565, -102.54232254654605, -96.61318877905371, -108.22813189239986, -112.97084794946636, -144.51906254358965, -104.74497120212267, -104.30621326431073, -109.10932674631911, -117.25479280469442, -100.40820006534395, -108.17770361434543, -105.2281934090027, -79.52738256879465, -118.44692863732081, -71.74767393347739, -104.07693684590112, -105.44507307680138, -72.91838292927119, -73.58729283932355, -102.40682284622764, -125.73742168245775, -120.07757261641324, -122.07998023676251, -73.077362376577, -100.26687651423173, -104.44125932177839, -76.08247368917498, -65.54604603166058, -69.0509857599045, -57.80284727744514, -107.15863585994951, -65.60994399569186, -119.87226210092194, -67.85319110878804, -111.73074151834163, -106.52223467564272, -65.72975099817926, -105.58365427381422, -127.07741654054759, -103.75480155031197, -104.1525084811685, -121.21017194479953, -57.97779173413159, -56.44806606942304, -70.12273880274329, -104.82508820553434, -67.01423012593271, -109.24905223545619, -106.32081469651064, -106.21689102734501, -52.98814861659522, -106.62052079490945, -103.19828111346315, -111.64540432366418, -118.75681626889296, -56.09946695951308, -104.2619503403219, -54.506296861901895, -108.90800401239656, -113.0829883581965, -101.37019290915629, -107.20112682009612, -61.88185140875596, -112.20990885074686, -106.76025776533845, -106.88267489650163, -105.39834753325891, -115.24254430767522, -104.67298494793786], "episode_lengths": [1600, 1600, 1600, 55, 42, 84, 59, 104, 1600, 102, 59, 59, 1600, 122, 1600, 49, 1600, 59, 69, 1600, 125, 1600, 1600, 105, 94, 64, 1600, 86, 64, 73, 1600, 54, 1600, 72, 61, 429, 50, 41, 110, 112, 104, 52, 62, 1600, 60, 1600, 63, 249, 1600, 1600, 70, 90, 77, 96, 1600, 1600, 66, 1600, 1600, 1600, 1600, 84, 1600, 95, 1600, 63, 66, 1600, 93, 91, 61, 72, 58, 1600, 1600, 1600, 69, 1600, 70, 88, 95, 1600, 46, 72, 102, 76, 1600, 88, 1600, 64, 59, 69, 49, 1600, 57, 72, 104, 56, 53, 71]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3063883466478415, "mean_inference_ms": 1.0485635620541829, "mean_action_processing_ms": 0.20196682203112054, "mean_env_wait_ms": 0.41606930760927485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0057523250579833984, "StateBufferConnector_ms": 0.004427671432495117, "ViewRequirementAgentConnector_ms": 0.12055754661560059}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 411.49490591219103, "num_env_steps_trained_throughput_per_sec": 411.49490591219103, "timesteps_total": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 10527.567, "restore_workers_time_ms": 0.036, "training_step_time_ms": 10527.508, "sample_time_ms": 3950.23, "load_time_ms": 0.449, "load_throughput": 8900852.035, "learn_time_ms": 6567.702, "learn_throughput": 609.041, "synch_weights_time_ms": 8.564}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 161, "training_iteration": 27, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-05-31", "timestamp": 1714269931, "time_this_iter_s": 9.725110054016113, "time_total_s": 285.3203935623169, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 285.3203935623169, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 27.328571428571422, "ram_util_percent": 63.47857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.629957322023248, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2901111321376075, "policy_loss": -0.03255941907284401, "vf_loss": 1.317288494550733, "vf_explained_var": 0.30044439742642065, "kl": 0.01196012011404127, "entropy": 5.3412169712846, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 25575.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "sampler_results": {"episode_reward_max": -52.98814861659522, "episode_reward_min": -144.51906254358965, "episode_reward_mean": -96.24863154912163, "episode_len_mean": 583.15, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 58315, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-121.76541226746576, -81.23777308003359, -104.25385369370133, -111.15731429203599, -102.55531829289409, -65.11193457511747, -122.04911535369854, -70.12050803955002, -104.44029694369497, -86.87933463910709, -116.27684495819733, -112.56296487266012, -68.49217507766443, -95.8202291980808, -67.03927286708544, -64.9766486377686, -110.31301838187625, -103.44239079739899, -105.37409490066209, -61.27193892516752, -124.17013150861115, -102.78553823652926, -103.7874929302962, -59.673435735841565, -102.54232254654605, -96.61318877905371, -108.22813189239986, -112.97084794946636, -144.51906254358965, -104.74497120212267, -104.30621326431073, -109.10932674631911, -117.25479280469442, -100.40820006534395, -108.17770361434543, -105.2281934090027, -79.52738256879465, -118.44692863732081, -71.74767393347739, -104.07693684590112, -105.44507307680138, -72.91838292927119, -73.58729283932355, -102.40682284622764, -125.73742168245775, -120.07757261641324, -122.07998023676251, -73.077362376577, -100.26687651423173, -104.44125932177839, -76.08247368917498, -65.54604603166058, -69.0509857599045, -57.80284727744514, -107.15863585994951, -65.60994399569186, -119.87226210092194, -67.85319110878804, -111.73074151834163, -106.52223467564272, -65.72975099817926, -105.58365427381422, -127.07741654054759, -103.75480155031197, -104.1525084811685, -121.21017194479953, -57.97779173413159, -56.44806606942304, -70.12273880274329, -104.82508820553434, -67.01423012593271, -109.24905223545619, -106.32081469651064, -106.21689102734501, -52.98814861659522, -106.62052079490945, -103.19828111346315, -111.64540432366418, -118.75681626889296, -56.09946695951308, -104.2619503403219, -54.506296861901895, -108.90800401239656, -113.0829883581965, -101.37019290915629, -107.20112682009612, -61.88185140875596, -112.20990885074686, -106.76025776533845, -106.88267489650163, -105.39834753325891, -115.24254430767522, -104.67298494793786, -55.29061250832678, -106.38759793166693, -112.24900408670928, -66.81876834318223, -105.83255050211463, -116.80658959751452, -103.380966702234], "episode_lengths": [104, 1600, 102, 59, 59, 1600, 122, 1600, 49, 1600, 59, 69, 1600, 125, 1600, 1600, 105, 94, 64, 1600, 86, 64, 73, 1600, 54, 1600, 72, 61, 429, 50, 41, 110, 112, 104, 52, 62, 1600, 60, 1600, 63, 249, 1600, 1600, 70, 90, 77, 96, 1600, 1600, 66, 1600, 1600, 1600, 1600, 84, 1600, 95, 1600, 63, 66, 1600, 93, 91, 61, 72, 58, 1600, 1600, 1600, 69, 1600, 70, 88, 95, 1600, 46, 72, 102, 76, 1600, 88, 1600, 64, 59, 69, 49, 1600, 57, 72, 104, 56, 53, 71, 1600, 42, 57, 1600, 79, 71, 71]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3058690643406127, "mean_inference_ms": 1.0472444925371671, "mean_action_processing_ms": 0.20170032206760916, "mean_env_wait_ms": 0.4152118503048408, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005816221237182617, "StateBufferConnector_ms": 0.004407405853271484, "ViewRequirementAgentConnector_ms": 0.11987924575805664}}, "episode_reward_max": -52.98814861659522, "episode_reward_min": -144.51906254358965, "episode_reward_mean": -96.24863154912163, "episode_len_mean": 583.15, "episodes_this_iter": 7, "episodes_timesteps_total": 58315, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-121.76541226746576, -81.23777308003359, -104.25385369370133, -111.15731429203599, -102.55531829289409, -65.11193457511747, -122.04911535369854, -70.12050803955002, -104.44029694369497, -86.87933463910709, -116.27684495819733, -112.56296487266012, -68.49217507766443, -95.8202291980808, -67.03927286708544, -64.9766486377686, -110.31301838187625, -103.44239079739899, -105.37409490066209, -61.27193892516752, -124.17013150861115, -102.78553823652926, -103.7874929302962, -59.673435735841565, -102.54232254654605, -96.61318877905371, -108.22813189239986, -112.97084794946636, -144.51906254358965, -104.74497120212267, -104.30621326431073, -109.10932674631911, -117.25479280469442, -100.40820006534395, -108.17770361434543, -105.2281934090027, -79.52738256879465, -118.44692863732081, -71.74767393347739, -104.07693684590112, -105.44507307680138, -72.91838292927119, -73.58729283932355, -102.40682284622764, -125.73742168245775, -120.07757261641324, -122.07998023676251, -73.077362376577, -100.26687651423173, -104.44125932177839, -76.08247368917498, -65.54604603166058, -69.0509857599045, -57.80284727744514, -107.15863585994951, -65.60994399569186, -119.87226210092194, -67.85319110878804, -111.73074151834163, -106.52223467564272, -65.72975099817926, -105.58365427381422, -127.07741654054759, -103.75480155031197, -104.1525084811685, -121.21017194479953, -57.97779173413159, -56.44806606942304, -70.12273880274329, -104.82508820553434, -67.01423012593271, -109.24905223545619, -106.32081469651064, -106.21689102734501, -52.98814861659522, -106.62052079490945, -103.19828111346315, -111.64540432366418, -118.75681626889296, -56.09946695951308, -104.2619503403219, -54.506296861901895, -108.90800401239656, -113.0829883581965, -101.37019290915629, -107.20112682009612, -61.88185140875596, -112.20990885074686, -106.76025776533845, -106.88267489650163, -105.39834753325891, -115.24254430767522, -104.67298494793786, -55.29061250832678, -106.38759793166693, -112.24900408670928, -66.81876834318223, -105.83255050211463, -116.80658959751452, -103.380966702234], "episode_lengths": [104, 1600, 102, 59, 59, 1600, 122, 1600, 49, 1600, 59, 69, 1600, 125, 1600, 1600, 105, 94, 64, 1600, 86, 64, 73, 1600, 54, 1600, 72, 61, 429, 50, 41, 110, 112, 104, 52, 62, 1600, 60, 1600, 63, 249, 1600, 1600, 70, 90, 77, 96, 1600, 1600, 66, 1600, 1600, 1600, 1600, 84, 1600, 95, 1600, 63, 66, 1600, 93, 91, 61, 72, 58, 1600, 1600, 1600, 69, 1600, 70, 88, 95, 1600, 46, 72, 102, 76, 1600, 88, 1600, 64, 59, 69, 49, 1600, 57, 72, 104, 56, 53, 71, 1600, 42, 57, 1600, 79, 71, 71]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3058690643406127, "mean_inference_ms": 1.0472444925371671, "mean_action_processing_ms": 0.20170032206760916, "mean_env_wait_ms": 0.4152118503048408, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005816221237182617, "StateBufferConnector_ms": 0.004407405853271484, "ViewRequirementAgentConnector_ms": 0.11987924575805664}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 456.55159430569904, "num_env_steps_trained_throughput_per_sec": 456.55159430569904, "timesteps_total": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 10256.388, "restore_workers_time_ms": 0.036, "training_step_time_ms": 10256.325, "sample_time_ms": 3862.817, "load_time_ms": 0.437, "load_throughput": 9159868.967, "learn_time_ms": 6384.016, "learn_throughput": 626.565, "synch_weights_time_ms": 8.495}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "episodes_total": 168, "training_iteration": 28, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-05-40", "timestamp": 1714269940, "time_this_iter_s": 8.766210079193115, "time_total_s": 294.08660364151, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 294.08660364151, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 20.438461538461542, "ram_util_percent": 63.10769230769232}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.245132619462987, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.563644766322117, "policy_loss": -0.039836214338579486, "vf_loss": 2.5923983887558983, "vf_explained_var": 0.23826336629929082, "kl": 0.024627989559246718, "entropy": 6.591856018189461, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 26505.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "sampler_results": {"episode_reward_max": -52.98814861659522, "episode_reward_min": -144.51906254358965, "episode_reward_mean": -96.5861512530707, "episode_len_mean": 568.99, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 56899, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-86.87933463910709, -116.27684495819733, -112.56296487266012, -68.49217507766443, -95.8202291980808, -67.03927286708544, -64.9766486377686, -110.31301838187625, -103.44239079739899, -105.37409490066209, -61.27193892516752, -124.17013150861115, -102.78553823652926, -103.7874929302962, -59.673435735841565, -102.54232254654605, -96.61318877905371, -108.22813189239986, -112.97084794946636, -144.51906254358965, -104.74497120212267, -104.30621326431073, -109.10932674631911, -117.25479280469442, -100.40820006534395, -108.17770361434543, -105.2281934090027, -79.52738256879465, -118.44692863732081, -71.74767393347739, -104.07693684590112, -105.44507307680138, -72.91838292927119, -73.58729283932355, -102.40682284622764, -125.73742168245775, -120.07757261641324, -122.07998023676251, -73.077362376577, -100.26687651423173, -104.44125932177839, -76.08247368917498, -65.54604603166058, -69.0509857599045, -57.80284727744514, -107.15863585994951, -65.60994399569186, -119.87226210092194, -67.85319110878804, -111.73074151834163, -106.52223467564272, -65.72975099817926, -105.58365427381422, -127.07741654054759, -103.75480155031197, -104.1525084811685, -121.21017194479953, -57.97779173413159, -56.44806606942304, -70.12273880274329, -104.82508820553434, -67.01423012593271, -109.24905223545619, -106.32081469651064, -106.21689102734501, -52.98814861659522, -106.62052079490945, -103.19828111346315, -111.64540432366418, -118.75681626889296, -56.09946695951308, -104.2619503403219, -54.506296861901895, -108.90800401239656, -113.0829883581965, -101.37019290915629, -107.20112682009612, -61.88185140875596, -112.20990885074686, -106.76025776533845, -106.88267489650163, -105.39834753325891, -115.24254430767522, -104.67298494793786, -55.29061250832678, -106.38759793166693, -112.24900408670928, -66.81876834318223, -105.83255050211463, -116.80658959751452, -103.380966702234, -61.86113040018831, -112.92608171692552, -122.94975056705499, -105.5069856173123, -103.24927721912911, -127.90938846092422, -104.26512175126311, -117.91406682675395, -59.86169437354865], "episode_lengths": [1600, 59, 69, 1600, 125, 1600, 1600, 105, 94, 64, 1600, 86, 64, 73, 1600, 54, 1600, 72, 61, 429, 50, 41, 110, 112, 104, 52, 62, 1600, 60, 1600, 63, 249, 1600, 1600, 70, 90, 77, 96, 1600, 1600, 66, 1600, 1600, 1600, 1600, 84, 1600, 95, 1600, 63, 66, 1600, 93, 91, 61, 72, 58, 1600, 1600, 1600, 69, 1600, 70, 88, 95, 1600, 46, 72, 102, 76, 1600, 88, 1600, 64, 59, 69, 49, 1600, 57, 72, 104, 56, 53, 71, 1600, 42, 57, 1600, 79, 71, 71, 1600, 41, 154, 74, 58, 215, 72, 65, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3056033202268728, "mean_inference_ms": 1.044480475442279, "mean_action_processing_ms": 0.20121319851998692, "mean_env_wait_ms": 0.41515015422682744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005755424499511719, "StateBufferConnector_ms": 0.00433039665222168, "ViewRequirementAgentConnector_ms": 0.11879777908325195}}, "episode_reward_max": -52.98814861659522, "episode_reward_min": -144.51906254358965, "episode_reward_mean": -96.5861512530707, "episode_len_mean": 568.99, "episodes_this_iter": 9, "episodes_timesteps_total": 56899, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-86.87933463910709, -116.27684495819733, -112.56296487266012, -68.49217507766443, -95.8202291980808, -67.03927286708544, -64.9766486377686, -110.31301838187625, -103.44239079739899, -105.37409490066209, -61.27193892516752, -124.17013150861115, -102.78553823652926, -103.7874929302962, -59.673435735841565, -102.54232254654605, -96.61318877905371, -108.22813189239986, -112.97084794946636, -144.51906254358965, -104.74497120212267, -104.30621326431073, -109.10932674631911, -117.25479280469442, -100.40820006534395, -108.17770361434543, -105.2281934090027, -79.52738256879465, -118.44692863732081, -71.74767393347739, -104.07693684590112, -105.44507307680138, -72.91838292927119, -73.58729283932355, -102.40682284622764, -125.73742168245775, -120.07757261641324, -122.07998023676251, -73.077362376577, -100.26687651423173, -104.44125932177839, -76.08247368917498, -65.54604603166058, -69.0509857599045, -57.80284727744514, -107.15863585994951, -65.60994399569186, -119.87226210092194, -67.85319110878804, -111.73074151834163, -106.52223467564272, -65.72975099817926, -105.58365427381422, -127.07741654054759, -103.75480155031197, -104.1525084811685, -121.21017194479953, -57.97779173413159, -56.44806606942304, -70.12273880274329, -104.82508820553434, -67.01423012593271, -109.24905223545619, -106.32081469651064, -106.21689102734501, -52.98814861659522, -106.62052079490945, -103.19828111346315, -111.64540432366418, -118.75681626889296, -56.09946695951308, -104.2619503403219, -54.506296861901895, -108.90800401239656, -113.0829883581965, -101.37019290915629, -107.20112682009612, -61.88185140875596, -112.20990885074686, -106.76025776533845, -106.88267489650163, -105.39834753325891, -115.24254430767522, -104.67298494793786, -55.29061250832678, -106.38759793166693, -112.24900408670928, -66.81876834318223, -105.83255050211463, -116.80658959751452, -103.380966702234, -61.86113040018831, -112.92608171692552, -122.94975056705499, -105.5069856173123, -103.24927721912911, -127.90938846092422, -104.26512175126311, -117.91406682675395, -59.86169437354865], "episode_lengths": [1600, 59, 69, 1600, 125, 1600, 1600, 105, 94, 64, 1600, 86, 64, 73, 1600, 54, 1600, 72, 61, 429, 50, 41, 110, 112, 104, 52, 62, 1600, 60, 1600, 63, 249, 1600, 1600, 70, 90, 77, 96, 1600, 1600, 66, 1600, 1600, 1600, 1600, 84, 1600, 95, 1600, 63, 66, 1600, 93, 91, 61, 72, 58, 1600, 1600, 1600, 69, 1600, 70, 88, 95, 1600, 46, 72, 102, 76, 1600, 88, 1600, 64, 59, 69, 49, 1600, 57, 72, 104, 56, 53, 71, 1600, 42, 57, 1600, 79, 71, 71, 1600, 41, 154, 74, 58, 215, 72, 65, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3056033202268728, "mean_inference_ms": 1.044480475442279, "mean_action_processing_ms": 0.20121319851998692, "mean_env_wait_ms": 0.41515015422682744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005755424499511719, "StateBufferConnector_ms": 0.00433039665222168, "ViewRequirementAgentConnector_ms": 0.11879777908325195}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 417.2036381618568, "num_env_steps_trained_throughput_per_sec": 417.2036381618568, "timesteps_total": 116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 10067.988, "restore_workers_time_ms": 0.036, "training_step_time_ms": 10067.925, "sample_time_ms": 3746.629, "load_time_ms": 0.422, "load_throughput": 9475976.278, "learn_time_ms": 6311.894, "learn_throughput": 633.724, "synch_weights_time_ms": 8.419}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "done": false, "episodes_total": 177, "training_iteration": 29, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-05-50", "timestamp": 1714269950, "time_this_iter_s": 9.591990947723389, "time_total_s": 303.6785945892334, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 303.6785945892334, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 26.23076923076923, "ram_util_percent": 62.4076923076923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.33049539366076, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5628945611939284, "policy_loss": -0.03147603661993578, "vf_loss": 1.5880138607875955, "vf_explained_var": 0.3092408206514133, "kl": 0.009417399314289615, "entropy": 5.831904511297902, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 27435.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "sampler_results": {"episode_reward_max": -52.98814861659522, "episode_reward_min": -196.16729044471128, "episode_reward_mean": -97.78251093327599, "episode_len_mean": 580.52, "episode_media": {}, "episodes_this_iter": 3, "episodes_timesteps_total": 58052, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-68.49217507766443, -95.8202291980808, -67.03927286708544, -64.9766486377686, -110.31301838187625, -103.44239079739899, -105.37409490066209, -61.27193892516752, -124.17013150861115, -102.78553823652926, -103.7874929302962, -59.673435735841565, -102.54232254654605, -96.61318877905371, -108.22813189239986, -112.97084794946636, -144.51906254358965, -104.74497120212267, -104.30621326431073, -109.10932674631911, -117.25479280469442, -100.40820006534395, -108.17770361434543, -105.2281934090027, -79.52738256879465, -118.44692863732081, -71.74767393347739, -104.07693684590112, -105.44507307680138, -72.91838292927119, -73.58729283932355, -102.40682284622764, -125.73742168245775, -120.07757261641324, -122.07998023676251, -73.077362376577, -100.26687651423173, -104.44125932177839, -76.08247368917498, -65.54604603166058, -69.0509857599045, -57.80284727744514, -107.15863585994951, -65.60994399569186, -119.87226210092194, -67.85319110878804, -111.73074151834163, -106.52223467564272, -65.72975099817926, -105.58365427381422, -127.07741654054759, -103.75480155031197, -104.1525084811685, -121.21017194479953, -57.97779173413159, -56.44806606942304, -70.12273880274329, -104.82508820553434, -67.01423012593271, -109.24905223545619, -106.32081469651064, -106.21689102734501, -52.98814861659522, -106.62052079490945, -103.19828111346315, -111.64540432366418, -118.75681626889296, -56.09946695951308, -104.2619503403219, -54.506296861901895, -108.90800401239656, -113.0829883581965, -101.37019290915629, -107.20112682009612, -61.88185140875596, -112.20990885074686, -106.76025776533845, -106.88267489650163, -105.39834753325891, -115.24254430767522, -104.67298494793786, -55.29061250832678, -106.38759793166693, -112.24900408670928, -66.81876834318223, -105.83255050211463, -116.80658959751452, -103.380966702234, -61.86113040018831, -112.92608171692552, -122.94975056705499, -105.5069856173123, -103.24927721912911, -127.90938846092422, -104.26512175126311, -117.91406682675395, -59.86169437354865, -196.16729044471128, -109.26980316939142, -129.9180188763918], "episode_lengths": [1600, 125, 1600, 1600, 105, 94, 64, 1600, 86, 64, 73, 1600, 54, 1600, 72, 61, 429, 50, 41, 110, 112, 104, 52, 62, 1600, 60, 1600, 63, 249, 1600, 1600, 70, 90, 77, 96, 1600, 1600, 66, 1600, 1600, 1600, 1600, 84, 1600, 95, 1600, 63, 66, 1600, 93, 91, 61, 72, 58, 1600, 1600, 1600, 69, 1600, 70, 88, 95, 1600, 46, 72, 102, 76, 1600, 88, 1600, 64, 59, 69, 49, 1600, 57, 72, 104, 56, 53, 71, 1600, 42, 57, 1600, 79, 71, 71, 1600, 41, 154, 74, 58, 215, 72, 65, 1600, 1228, 53, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3054402029804077, "mean_inference_ms": 1.0440938396497268, "mean_action_processing_ms": 0.20113945724841212, "mean_env_wait_ms": 0.4148824094585587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005686044692993164, "StateBufferConnector_ms": 0.004370450973510742, "ViewRequirementAgentConnector_ms": 0.11933684349060059}}, "episode_reward_max": -52.98814861659522, "episode_reward_min": -196.16729044471128, "episode_reward_mean": -97.78251093327599, "episode_len_mean": 580.52, "episodes_this_iter": 3, "episodes_timesteps_total": 58052, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-68.49217507766443, -95.8202291980808, -67.03927286708544, -64.9766486377686, -110.31301838187625, -103.44239079739899, -105.37409490066209, -61.27193892516752, -124.17013150861115, -102.78553823652926, -103.7874929302962, -59.673435735841565, -102.54232254654605, -96.61318877905371, -108.22813189239986, -112.97084794946636, -144.51906254358965, -104.74497120212267, -104.30621326431073, -109.10932674631911, -117.25479280469442, -100.40820006534395, -108.17770361434543, -105.2281934090027, -79.52738256879465, -118.44692863732081, -71.74767393347739, -104.07693684590112, -105.44507307680138, -72.91838292927119, -73.58729283932355, -102.40682284622764, -125.73742168245775, -120.07757261641324, -122.07998023676251, -73.077362376577, -100.26687651423173, -104.44125932177839, -76.08247368917498, -65.54604603166058, -69.0509857599045, -57.80284727744514, -107.15863585994951, -65.60994399569186, -119.87226210092194, -67.85319110878804, -111.73074151834163, -106.52223467564272, -65.72975099817926, -105.58365427381422, -127.07741654054759, -103.75480155031197, -104.1525084811685, -121.21017194479953, -57.97779173413159, -56.44806606942304, -70.12273880274329, -104.82508820553434, -67.01423012593271, -109.24905223545619, -106.32081469651064, -106.21689102734501, -52.98814861659522, -106.62052079490945, -103.19828111346315, -111.64540432366418, -118.75681626889296, -56.09946695951308, -104.2619503403219, -54.506296861901895, -108.90800401239656, -113.0829883581965, -101.37019290915629, -107.20112682009612, -61.88185140875596, -112.20990885074686, -106.76025776533845, -106.88267489650163, -105.39834753325891, -115.24254430767522, -104.67298494793786, -55.29061250832678, -106.38759793166693, -112.24900408670928, -66.81876834318223, -105.83255050211463, -116.80658959751452, -103.380966702234, -61.86113040018831, -112.92608171692552, -122.94975056705499, -105.5069856173123, -103.24927721912911, -127.90938846092422, -104.26512175126311, -117.91406682675395, -59.86169437354865, -196.16729044471128, -109.26980316939142, -129.9180188763918], "episode_lengths": [1600, 125, 1600, 1600, 105, 94, 64, 1600, 86, 64, 73, 1600, 54, 1600, 72, 61, 429, 50, 41, 110, 112, 104, 52, 62, 1600, 60, 1600, 63, 249, 1600, 1600, 70, 90, 77, 96, 1600, 1600, 66, 1600, 1600, 1600, 1600, 84, 1600, 95, 1600, 63, 66, 1600, 93, 91, 61, 72, 58, 1600, 1600, 1600, 69, 1600, 70, 88, 95, 1600, 46, 72, 102, 76, 1600, 88, 1600, 64, 59, 69, 49, 1600, 57, 72, 104, 56, 53, 71, 1600, 42, 57, 1600, 79, 71, 71, 1600, 41, 154, 74, 58, 215, 72, 65, 1600, 1228, 53, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3054402029804077, "mean_inference_ms": 1.0440938396497268, "mean_action_processing_ms": 0.20113945724841212, "mean_env_wait_ms": 0.4148824094585587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005686044692993164, "StateBufferConnector_ms": 0.004370450973510742, "ViewRequirementAgentConnector_ms": 0.11933684349060059}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 343.9884028377314, "num_env_steps_trained_throughput_per_sec": 343.9884028377314, "timesteps_total": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 10199.57, "restore_workers_time_ms": 0.036, "training_step_time_ms": 10199.507, "sample_time_ms": 3786.136, "load_time_ms": 0.433, "load_throughput": 9228899.279, "learn_time_ms": 6404.273, "learn_throughput": 624.583, "synch_weights_time_ms": 8.101}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "episodes_total": 180, "training_iteration": 30, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-06-01", "timestamp": 1714269961, "time_this_iter_s": 11.632853031158447, "time_total_s": 315.31144762039185, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 315.31144762039185, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 36.800000000000004, "ram_util_percent": 63.905882352941184}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.575917939345041, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0606826097343958, "policy_loss": -0.029670560752512308, "vf_loss": 1.0844525964189602, "vf_explained_var": 0.29327624805511965, "kl": 0.0087415878146135, "entropy": 6.131941538985058, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 28365.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "sampler_results": {"episode_reward_max": -52.98814861659522, "episode_reward_min": -196.16729044471128, "episode_reward_mean": -97.81119722497021, "episode_len_mean": 595.02, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 59502, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-105.37409490066209, -61.27193892516752, -124.17013150861115, -102.78553823652926, -103.7874929302962, -59.673435735841565, -102.54232254654605, -96.61318877905371, -108.22813189239986, -112.97084794946636, -144.51906254358965, -104.74497120212267, -104.30621326431073, -109.10932674631911, -117.25479280469442, -100.40820006534395, -108.17770361434543, -105.2281934090027, -79.52738256879465, -118.44692863732081, -71.74767393347739, -104.07693684590112, -105.44507307680138, -72.91838292927119, -73.58729283932355, -102.40682284622764, -125.73742168245775, -120.07757261641324, -122.07998023676251, -73.077362376577, -100.26687651423173, -104.44125932177839, -76.08247368917498, -65.54604603166058, -69.0509857599045, -57.80284727744514, -107.15863585994951, -65.60994399569186, -119.87226210092194, -67.85319110878804, -111.73074151834163, -106.52223467564272, -65.72975099817926, -105.58365427381422, -127.07741654054759, -103.75480155031197, -104.1525084811685, -121.21017194479953, -57.97779173413159, -56.44806606942304, -70.12273880274329, -104.82508820553434, -67.01423012593271, -109.24905223545619, -106.32081469651064, -106.21689102734501, -52.98814861659522, -106.62052079490945, -103.19828111346315, -111.64540432366418, -118.75681626889296, -56.09946695951308, -104.2619503403219, -54.506296861901895, -108.90800401239656, -113.0829883581965, -101.37019290915629, -107.20112682009612, -61.88185140875596, -112.20990885074686, -106.76025776533845, -106.88267489650163, -105.39834753325891, -115.24254430767522, -104.67298494793786, -55.29061250832678, -106.38759793166693, -112.24900408670928, -66.81876834318223, -105.83255050211463, -116.80658959751452, -103.380966702234, -61.86113040018831, -112.92608171692552, -122.94975056705499, -105.5069856173123, -103.24927721912911, -127.90938846092422, -104.26512175126311, -117.91406682675395, -59.86169437354865, -196.16729044471128, -109.26980316939142, -129.9180188763918, -63.25895245657913, -106.2592519929676, -113.49984367688931, -59.01075682234899, -58.68333346117596, -112.24022571933637], "episode_lengths": [64, 1600, 86, 64, 73, 1600, 54, 1600, 72, 61, 429, 50, 41, 110, 112, 104, 52, 62, 1600, 60, 1600, 63, 249, 1600, 1600, 70, 90, 77, 96, 1600, 1600, 66, 1600, 1600, 1600, 1600, 84, 1600, 95, 1600, 63, 66, 1600, 93, 91, 61, 72, 58, 1600, 1600, 1600, 69, 1600, 70, 88, 95, 1600, 46, 72, 102, 76, 1600, 88, 1600, 64, 59, 69, 49, 1600, 57, 72, 104, 56, 53, 71, 1600, 42, 57, 1600, 79, 71, 71, 1600, 41, 154, 74, 58, 215, 72, 65, 1600, 1228, 53, 1600, 1600, 116, 58, 1600, 1600, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.305364575846369, "mean_inference_ms": 1.0434167156357208, "mean_action_processing_ms": 0.20102709076662983, "mean_env_wait_ms": 0.41486608850236906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005746364593505859, "StateBufferConnector_ms": 0.004419803619384766, "ViewRequirementAgentConnector_ms": 0.12016415596008301}}, "episode_reward_max": -52.98814861659522, "episode_reward_min": -196.16729044471128, "episode_reward_mean": -97.81119722497021, "episode_len_mean": 595.02, "episodes_this_iter": 6, "episodes_timesteps_total": 59502, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-105.37409490066209, -61.27193892516752, -124.17013150861115, -102.78553823652926, -103.7874929302962, -59.673435735841565, -102.54232254654605, -96.61318877905371, -108.22813189239986, -112.97084794946636, -144.51906254358965, -104.74497120212267, -104.30621326431073, -109.10932674631911, -117.25479280469442, -100.40820006534395, -108.17770361434543, -105.2281934090027, -79.52738256879465, -118.44692863732081, -71.74767393347739, -104.07693684590112, -105.44507307680138, -72.91838292927119, -73.58729283932355, -102.40682284622764, -125.73742168245775, -120.07757261641324, -122.07998023676251, -73.077362376577, -100.26687651423173, -104.44125932177839, -76.08247368917498, -65.54604603166058, -69.0509857599045, -57.80284727744514, -107.15863585994951, -65.60994399569186, -119.87226210092194, -67.85319110878804, -111.73074151834163, -106.52223467564272, -65.72975099817926, -105.58365427381422, -127.07741654054759, -103.75480155031197, -104.1525084811685, -121.21017194479953, -57.97779173413159, -56.44806606942304, -70.12273880274329, -104.82508820553434, -67.01423012593271, -109.24905223545619, -106.32081469651064, -106.21689102734501, -52.98814861659522, -106.62052079490945, -103.19828111346315, -111.64540432366418, -118.75681626889296, -56.09946695951308, -104.2619503403219, -54.506296861901895, -108.90800401239656, -113.0829883581965, -101.37019290915629, -107.20112682009612, -61.88185140875596, -112.20990885074686, -106.76025776533845, -106.88267489650163, -105.39834753325891, -115.24254430767522, -104.67298494793786, -55.29061250832678, -106.38759793166693, -112.24900408670928, -66.81876834318223, -105.83255050211463, -116.80658959751452, -103.380966702234, -61.86113040018831, -112.92608171692552, -122.94975056705499, -105.5069856173123, -103.24927721912911, -127.90938846092422, -104.26512175126311, -117.91406682675395, -59.86169437354865, -196.16729044471128, -109.26980316939142, -129.9180188763918, -63.25895245657913, -106.2592519929676, -113.49984367688931, -59.01075682234899, -58.68333346117596, -112.24022571933637], "episode_lengths": [64, 1600, 86, 64, 73, 1600, 54, 1600, 72, 61, 429, 50, 41, 110, 112, 104, 52, 62, 1600, 60, 1600, 63, 249, 1600, 1600, 70, 90, 77, 96, 1600, 1600, 66, 1600, 1600, 1600, 1600, 84, 1600, 95, 1600, 63, 66, 1600, 93, 91, 61, 72, 58, 1600, 1600, 1600, 69, 1600, 70, 88, 95, 1600, 46, 72, 102, 76, 1600, 88, 1600, 64, 59, 69, 49, 1600, 57, 72, 104, 56, 53, 71, 1600, 42, 57, 1600, 79, 71, 71, 1600, 41, 154, 74, 58, 215, 72, 65, 1600, 1228, 53, 1600, 1600, 116, 58, 1600, 1600, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.305364575846369, "mean_inference_ms": 1.0434167156357208, "mean_action_processing_ms": 0.20102709076662983, "mean_env_wait_ms": 0.41486608850236906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005746364593505859, "StateBufferConnector_ms": 0.004419803619384766, "ViewRequirementAgentConnector_ms": 0.12016415596008301}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 364.98855240337747, "num_env_steps_trained_throughput_per_sec": 364.98855240337747, "timesteps_total": 124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 10262.501, "restore_workers_time_ms": 0.036, "training_step_time_ms": 10262.439, "sample_time_ms": 3843.073, "load_time_ms": 0.437, "load_throughput": 9162870.563, "learn_time_ms": 6410.195, "learn_throughput": 624.006, "synch_weights_time_ms": 8.168}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "done": false, "episodes_total": 186, "training_iteration": 31, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-06-12", "timestamp": 1714269972, "time_this_iter_s": 10.964493036270142, "time_total_s": 326.275940656662, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 326.275940656662, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 35.526666666666664, "ram_util_percent": 63.08666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.465219363409986, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.8380901237113543, "policy_loss": -0.02552363761169936, "vf_loss": 3.8561368006131342, "vf_explained_var": 0.22668975796750795, "kl": 0.011076963623962025, "entropy": 7.42741109530131, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "sampler_results": {"episode_reward_max": -52.98814861659522, "episode_reward_min": -220.8774511041596, "episode_reward_mean": -99.92372183001596, "episode_len_mean": 560.99, "episode_media": {}, "episodes_this_iter": 14, "episodes_timesteps_total": 56099, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-117.25479280469442, -100.40820006534395, -108.17770361434543, -105.2281934090027, -79.52738256879465, -118.44692863732081, -71.74767393347739, -104.07693684590112, -105.44507307680138, -72.91838292927119, -73.58729283932355, -102.40682284622764, -125.73742168245775, -120.07757261641324, -122.07998023676251, -73.077362376577, -100.26687651423173, -104.44125932177839, -76.08247368917498, -65.54604603166058, -69.0509857599045, -57.80284727744514, -107.15863585994951, -65.60994399569186, -119.87226210092194, -67.85319110878804, -111.73074151834163, -106.52223467564272, -65.72975099817926, -105.58365427381422, -127.07741654054759, -103.75480155031197, -104.1525084811685, -121.21017194479953, -57.97779173413159, -56.44806606942304, -70.12273880274329, -104.82508820553434, -67.01423012593271, -109.24905223545619, -106.32081469651064, -106.21689102734501, -52.98814861659522, -106.62052079490945, -103.19828111346315, -111.64540432366418, -118.75681626889296, -56.09946695951308, -104.2619503403219, -54.506296861901895, -108.90800401239656, -113.0829883581965, -101.37019290915629, -107.20112682009612, -61.88185140875596, -112.20990885074686, -106.76025776533845, -106.88267489650163, -105.39834753325891, -115.24254430767522, -104.67298494793786, -55.29061250832678, -106.38759793166693, -112.24900408670928, -66.81876834318223, -105.83255050211463, -116.80658959751452, -103.380966702234, -61.86113040018831, -112.92608171692552, -122.94975056705499, -105.5069856173123, -103.24927721912911, -127.90938846092422, -104.26512175126311, -117.91406682675395, -59.86169437354865, -196.16729044471128, -109.26980316939142, -129.9180188763918, -63.25895245657913, -106.2592519929676, -113.49984367688931, -59.01075682234899, -58.68333346117596, -112.24022571933637, -220.8774511041596, -110.83403603542845, -123.49038735897342, -107.7140659441768, -111.72368771849698, -110.43258242979212, -101.1815814720653, -110.05341593973091, -109.18237713497629, -109.1734300020064, -110.7113465946, -113.43985880578867, -102.04390225636773, -110.49103486892767], "episode_lengths": [112, 104, 52, 62, 1600, 60, 1600, 63, 249, 1600, 1600, 70, 90, 77, 96, 1600, 1600, 66, 1600, 1600, 1600, 1600, 84, 1600, 95, 1600, 63, 66, 1600, 93, 91, 61, 72, 58, 1600, 1600, 1600, 69, 1600, 70, 88, 95, 1600, 46, 72, 102, 76, 1600, 88, 1600, 64, 59, 69, 49, 1600, 57, 72, 104, 56, 53, 71, 1600, 42, 57, 1600, 79, 71, 71, 1600, 41, 154, 74, 58, 215, 72, 65, 1600, 1228, 53, 1600, 1600, 116, 58, 1600, 1600, 1600, 1554, 75, 110, 98, 71, 56, 60, 71, 83, 52, 48, 62, 63, 98]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30493384073604884, "mean_inference_ms": 1.0418232010761102, "mean_action_processing_ms": 0.20068162018958036, "mean_env_wait_ms": 0.41422111525856325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005891561508178711, "StateBufferConnector_ms": 0.004431724548339844, "ViewRequirementAgentConnector_ms": 0.11998891830444336}}, "episode_reward_max": -52.98814861659522, "episode_reward_min": -220.8774511041596, "episode_reward_mean": -99.92372183001596, "episode_len_mean": 560.99, "episodes_this_iter": 14, "episodes_timesteps_total": 56099, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-117.25479280469442, -100.40820006534395, -108.17770361434543, -105.2281934090027, -79.52738256879465, -118.44692863732081, -71.74767393347739, -104.07693684590112, -105.44507307680138, -72.91838292927119, -73.58729283932355, -102.40682284622764, -125.73742168245775, -120.07757261641324, -122.07998023676251, -73.077362376577, -100.26687651423173, -104.44125932177839, -76.08247368917498, -65.54604603166058, -69.0509857599045, -57.80284727744514, -107.15863585994951, -65.60994399569186, -119.87226210092194, -67.85319110878804, -111.73074151834163, -106.52223467564272, -65.72975099817926, -105.58365427381422, -127.07741654054759, -103.75480155031197, -104.1525084811685, -121.21017194479953, -57.97779173413159, -56.44806606942304, -70.12273880274329, -104.82508820553434, -67.01423012593271, -109.24905223545619, -106.32081469651064, -106.21689102734501, -52.98814861659522, -106.62052079490945, -103.19828111346315, -111.64540432366418, -118.75681626889296, -56.09946695951308, -104.2619503403219, -54.506296861901895, -108.90800401239656, -113.0829883581965, -101.37019290915629, -107.20112682009612, -61.88185140875596, -112.20990885074686, -106.76025776533845, -106.88267489650163, -105.39834753325891, -115.24254430767522, -104.67298494793786, -55.29061250832678, -106.38759793166693, -112.24900408670928, -66.81876834318223, -105.83255050211463, -116.80658959751452, -103.380966702234, -61.86113040018831, -112.92608171692552, -122.94975056705499, -105.5069856173123, -103.24927721912911, -127.90938846092422, -104.26512175126311, -117.91406682675395, -59.86169437354865, -196.16729044471128, -109.26980316939142, -129.9180188763918, -63.25895245657913, -106.2592519929676, -113.49984367688931, -59.01075682234899, -58.68333346117596, -112.24022571933637, -220.8774511041596, -110.83403603542845, -123.49038735897342, -107.7140659441768, -111.72368771849698, -110.43258242979212, -101.1815814720653, -110.05341593973091, -109.18237713497629, -109.1734300020064, -110.7113465946, -113.43985880578867, -102.04390225636773, -110.49103486892767], "episode_lengths": [112, 104, 52, 62, 1600, 60, 1600, 63, 249, 1600, 1600, 70, 90, 77, 96, 1600, 1600, 66, 1600, 1600, 1600, 1600, 84, 1600, 95, 1600, 63, 66, 1600, 93, 91, 61, 72, 58, 1600, 1600, 1600, 69, 1600, 70, 88, 95, 1600, 46, 72, 102, 76, 1600, 88, 1600, 64, 59, 69, 49, 1600, 57, 72, 104, 56, 53, 71, 1600, 42, 57, 1600, 79, 71, 71, 1600, 41, 154, 74, 58, 215, 72, 65, 1600, 1228, 53, 1600, 1600, 116, 58, 1600, 1600, 1600, 1554, 75, 110, 98, 71, 56, 60, 71, 83, 52, 48, 62, 63, 98]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30493384073604884, "mean_inference_ms": 1.0418232010761102, "mean_action_processing_ms": 0.20068162018958036, "mean_env_wait_ms": 0.41422111525856325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005891561508178711, "StateBufferConnector_ms": 0.004431724548339844, "ViewRequirementAgentConnector_ms": 0.11998891830444336}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 408.08585799913874, "num_env_steps_trained_throughput_per_sec": 408.08585799913874, "timesteps_total": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 10230.501, "restore_workers_time_ms": 0.035, "training_step_time_ms": 10230.44, "sample_time_ms": 3817.286, "load_time_ms": 0.44, "load_throughput": 9087431.481, "learn_time_ms": 6404.075, "learn_throughput": 624.602, "synch_weights_time_ms": 8.061}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "episodes_total": 200, "training_iteration": 32, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-06-22", "timestamp": 1714269982, "time_this_iter_s": 9.806408882141113, "time_total_s": 336.0823495388031, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 336.0823495388031, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 26.028571428571432, "ram_util_percent": 63.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.272191773050574, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2459344630825624, "policy_loss": -0.027746509828714915, "vf_loss": 1.2623197737159908, "vf_explained_var": 0.3400947534268902, "kl": 0.01683140526068716, "entropy": 5.421189713221724, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 30225.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "sampler_results": {"episode_reward_max": -50.02913184951549, "episode_reward_min": -220.8774511041596, "episode_reward_mean": -99.09875161963605, "episode_len_mean": 575.93, "episode_media": {}, "episodes_this_iter": 8, "episodes_timesteps_total": 57593, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-105.44507307680138, -72.91838292927119, -73.58729283932355, -102.40682284622764, -125.73742168245775, -120.07757261641324, -122.07998023676251, -73.077362376577, -100.26687651423173, -104.44125932177839, -76.08247368917498, -65.54604603166058, -69.0509857599045, -57.80284727744514, -107.15863585994951, -65.60994399569186, -119.87226210092194, -67.85319110878804, -111.73074151834163, -106.52223467564272, -65.72975099817926, -105.58365427381422, -127.07741654054759, -103.75480155031197, -104.1525084811685, -121.21017194479953, -57.97779173413159, -56.44806606942304, -70.12273880274329, -104.82508820553434, -67.01423012593271, -109.24905223545619, -106.32081469651064, -106.21689102734501, -52.98814861659522, -106.62052079490945, -103.19828111346315, -111.64540432366418, -118.75681626889296, -56.09946695951308, -104.2619503403219, -54.506296861901895, -108.90800401239656, -113.0829883581965, -101.37019290915629, -107.20112682009612, -61.88185140875596, -112.20990885074686, -106.76025776533845, -106.88267489650163, -105.39834753325891, -115.24254430767522, -104.67298494793786, -55.29061250832678, -106.38759793166693, -112.24900408670928, -66.81876834318223, -105.83255050211463, -116.80658959751452, -103.380966702234, -61.86113040018831, -112.92608171692552, -122.94975056705499, -105.5069856173123, -103.24927721912911, -127.90938846092422, -104.26512175126311, -117.91406682675395, -59.86169437354865, -196.16729044471128, -109.26980316939142, -129.9180188763918, -63.25895245657913, -106.2592519929676, -113.49984367688931, -59.01075682234899, -58.68333346117596, -112.24022571933637, -220.8774511041596, -110.83403603542845, -123.49038735897342, -107.7140659441768, -111.72368771849698, -110.43258242979212, -101.1815814720653, -110.05341593973091, -109.18237713497629, -109.1734300020064, -110.7113465946, -113.43985880578867, -102.04390225636773, -110.49103486892767, -56.3570209189219, -107.79712370495872, -120.03100246530897, -110.56671918536784, -62.25563284729668, -106.96380009263754, -108.37035977688245, -50.02913184951549], "episode_lengths": [249, 1600, 1600, 70, 90, 77, 96, 1600, 1600, 66, 1600, 1600, 1600, 1600, 84, 1600, 95, 1600, 63, 66, 1600, 93, 91, 61, 72, 58, 1600, 1600, 1600, 69, 1600, 70, 88, 95, 1600, 46, 72, 102, 76, 1600, 88, 1600, 64, 59, 69, 49, 1600, 57, 72, 104, 56, 53, 71, 1600, 42, 57, 1600, 79, 71, 71, 1600, 41, 154, 74, 58, 215, 72, 65, 1600, 1228, 53, 1600, 1600, 116, 58, 1600, 1600, 1600, 1554, 75, 110, 98, 71, 56, 60, 71, 83, 52, 48, 62, 63, 98, 1600, 76, 104, 41, 1600, 76, 50, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30442430679814114, "mean_inference_ms": 1.0401022971267768, "mean_action_processing_ms": 0.20033286973470774, "mean_env_wait_ms": 0.4134671056838728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005894660949707031, "StateBufferConnector_ms": 0.004393577575683594, "ViewRequirementAgentConnector_ms": 0.11731576919555664}}, "episode_reward_max": -50.02913184951549, "episode_reward_min": -220.8774511041596, "episode_reward_mean": -99.09875161963605, "episode_len_mean": 575.93, "episodes_this_iter": 8, "episodes_timesteps_total": 57593, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-105.44507307680138, -72.91838292927119, -73.58729283932355, -102.40682284622764, -125.73742168245775, -120.07757261641324, -122.07998023676251, -73.077362376577, -100.26687651423173, -104.44125932177839, -76.08247368917498, -65.54604603166058, -69.0509857599045, -57.80284727744514, -107.15863585994951, -65.60994399569186, -119.87226210092194, -67.85319110878804, -111.73074151834163, -106.52223467564272, -65.72975099817926, -105.58365427381422, -127.07741654054759, -103.75480155031197, -104.1525084811685, -121.21017194479953, -57.97779173413159, -56.44806606942304, -70.12273880274329, -104.82508820553434, -67.01423012593271, -109.24905223545619, -106.32081469651064, -106.21689102734501, -52.98814861659522, -106.62052079490945, -103.19828111346315, -111.64540432366418, -118.75681626889296, -56.09946695951308, -104.2619503403219, -54.506296861901895, -108.90800401239656, -113.0829883581965, -101.37019290915629, -107.20112682009612, -61.88185140875596, -112.20990885074686, -106.76025776533845, -106.88267489650163, -105.39834753325891, -115.24254430767522, -104.67298494793786, -55.29061250832678, -106.38759793166693, -112.24900408670928, -66.81876834318223, -105.83255050211463, -116.80658959751452, -103.380966702234, -61.86113040018831, -112.92608171692552, -122.94975056705499, -105.5069856173123, -103.24927721912911, -127.90938846092422, -104.26512175126311, -117.91406682675395, -59.86169437354865, -196.16729044471128, -109.26980316939142, -129.9180188763918, -63.25895245657913, -106.2592519929676, -113.49984367688931, -59.01075682234899, -58.68333346117596, -112.24022571933637, -220.8774511041596, -110.83403603542845, -123.49038735897342, -107.7140659441768, -111.72368771849698, -110.43258242979212, -101.1815814720653, -110.05341593973091, -109.18237713497629, -109.1734300020064, -110.7113465946, -113.43985880578867, -102.04390225636773, -110.49103486892767, -56.3570209189219, -107.79712370495872, -120.03100246530897, -110.56671918536784, -62.25563284729668, -106.96380009263754, -108.37035977688245, -50.02913184951549], "episode_lengths": [249, 1600, 1600, 70, 90, 77, 96, 1600, 1600, 66, 1600, 1600, 1600, 1600, 84, 1600, 95, 1600, 63, 66, 1600, 93, 91, 61, 72, 58, 1600, 1600, 1600, 69, 1600, 70, 88, 95, 1600, 46, 72, 102, 76, 1600, 88, 1600, 64, 59, 69, 49, 1600, 57, 72, 104, 56, 53, 71, 1600, 42, 57, 1600, 79, 71, 71, 1600, 41, 154, 74, 58, 215, 72, 65, 1600, 1228, 53, 1600, 1600, 116, 58, 1600, 1600, 1600, 1554, 75, 110, 98, 71, 56, 60, 71, 83, 52, 48, 62, 63, 98, 1600, 76, 104, 41, 1600, 76, 50, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30442430679814114, "mean_inference_ms": 1.0401022971267768, "mean_action_processing_ms": 0.20033286973470774, "mean_env_wait_ms": 0.4134671056838728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005894660949707031, "StateBufferConnector_ms": 0.004393577575683594, "ViewRequirementAgentConnector_ms": 0.11731576919555664}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 424.32715660356297, "num_env_steps_trained_throughput_per_sec": 424.32715660356297, "timesteps_total": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 10169.84, "restore_workers_time_ms": 0.035, "training_step_time_ms": 10169.778, "sample_time_ms": 3784.862, "load_time_ms": 0.437, "load_throughput": 9155370.259, "learn_time_ms": 6375.859, "learn_throughput": 627.366, "synch_weights_time_ms": 8.045}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "episodes_total": 208, "training_iteration": 33, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-06-32", "timestamp": 1714269992, "time_this_iter_s": 9.432155847549438, "time_total_s": 345.51450538635254, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 345.51450538635254, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 25.064285714285713, "ram_util_percent": 62.54999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.699796838145103, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6713738924355537, "policy_loss": -0.027529236385899207, "vf_loss": 1.6924993246152837, "vf_explained_var": 0.3210018325236536, "kl": 0.009487122273378105, "entropy": 5.9409631252288815, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 31155.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "sampler_results": {"episode_reward_max": -50.02913184951549, "episode_reward_min": -220.8774511041596, "episode_reward_mean": -98.60906318897746, "episode_len_mean": 575.25, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 57525, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-73.077362376577, -100.26687651423173, -104.44125932177839, -76.08247368917498, -65.54604603166058, -69.0509857599045, -57.80284727744514, -107.15863585994951, -65.60994399569186, -119.87226210092194, -67.85319110878804, -111.73074151834163, -106.52223467564272, -65.72975099817926, -105.58365427381422, -127.07741654054759, -103.75480155031197, -104.1525084811685, -121.21017194479953, -57.97779173413159, -56.44806606942304, -70.12273880274329, -104.82508820553434, -67.01423012593271, -109.24905223545619, -106.32081469651064, -106.21689102734501, -52.98814861659522, -106.62052079490945, -103.19828111346315, -111.64540432366418, -118.75681626889296, -56.09946695951308, -104.2619503403219, -54.506296861901895, -108.90800401239656, -113.0829883581965, -101.37019290915629, -107.20112682009612, -61.88185140875596, -112.20990885074686, -106.76025776533845, -106.88267489650163, -105.39834753325891, -115.24254430767522, -104.67298494793786, -55.29061250832678, -106.38759793166693, -112.24900408670928, -66.81876834318223, -105.83255050211463, -116.80658959751452, -103.380966702234, -61.86113040018831, -112.92608171692552, -122.94975056705499, -105.5069856173123, -103.24927721912911, -127.90938846092422, -104.26512175126311, -117.91406682675395, -59.86169437354865, -196.16729044471128, -109.26980316939142, -129.9180188763918, -63.25895245657913, -106.2592519929676, -113.49984367688931, -59.01075682234899, -58.68333346117596, -112.24022571933637, -220.8774511041596, -110.83403603542845, -123.49038735897342, -107.7140659441768, -111.72368771849698, -110.43258242979212, -101.1815814720653, -110.05341593973091, -109.18237713497629, -109.1734300020064, -110.7113465946, -113.43985880578867, -102.04390225636773, -110.49103486892767, -56.3570209189219, -107.79712370495872, -120.03100246530897, -110.56671918536784, -62.25563284729668, -106.96380009263754, -108.37035977688245, -50.02913184951549, -54.47221205594577, -119.7236814537539, -110.03314156073768, -104.69437728262507, -104.56267581639811, -54.141076347627276, -125.6565386443076], "episode_lengths": [1600, 1600, 66, 1600, 1600, 1600, 1600, 84, 1600, 95, 1600, 63, 66, 1600, 93, 91, 61, 72, 58, 1600, 1600, 1600, 69, 1600, 70, 88, 95, 1600, 46, 72, 102, 76, 1600, 88, 1600, 64, 59, 69, 49, 1600, 57, 72, 104, 56, 53, 71, 1600, 42, 57, 1600, 79, 71, 71, 1600, 41, 154, 74, 58, 215, 72, 65, 1600, 1228, 53, 1600, 1600, 116, 58, 1600, 1600, 1600, 1554, 75, 110, 98, 71, 56, 60, 71, 83, 52, 48, 62, 63, 98, 1600, 76, 104, 41, 1600, 76, 50, 1600, 1600, 190, 110, 56, 73, 1600, 85]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3039979387961588, "mean_inference_ms": 1.0384521030342901, "mean_action_processing_ms": 0.20002393313256803, "mean_env_wait_ms": 0.41288557023742195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006005048751831055, "StateBufferConnector_ms": 0.0044171810150146484, "ViewRequirementAgentConnector_ms": 0.11678838729858398}}, "episode_reward_max": -50.02913184951549, "episode_reward_min": -220.8774511041596, "episode_reward_mean": -98.60906318897746, "episode_len_mean": 575.25, "episodes_this_iter": 7, "episodes_timesteps_total": 57525, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-73.077362376577, -100.26687651423173, -104.44125932177839, -76.08247368917498, -65.54604603166058, -69.0509857599045, -57.80284727744514, -107.15863585994951, -65.60994399569186, -119.87226210092194, -67.85319110878804, -111.73074151834163, -106.52223467564272, -65.72975099817926, -105.58365427381422, -127.07741654054759, -103.75480155031197, -104.1525084811685, -121.21017194479953, -57.97779173413159, -56.44806606942304, -70.12273880274329, -104.82508820553434, -67.01423012593271, -109.24905223545619, -106.32081469651064, -106.21689102734501, -52.98814861659522, -106.62052079490945, -103.19828111346315, -111.64540432366418, -118.75681626889296, -56.09946695951308, -104.2619503403219, -54.506296861901895, -108.90800401239656, -113.0829883581965, -101.37019290915629, -107.20112682009612, -61.88185140875596, -112.20990885074686, -106.76025776533845, -106.88267489650163, -105.39834753325891, -115.24254430767522, -104.67298494793786, -55.29061250832678, -106.38759793166693, -112.24900408670928, -66.81876834318223, -105.83255050211463, -116.80658959751452, -103.380966702234, -61.86113040018831, -112.92608171692552, -122.94975056705499, -105.5069856173123, -103.24927721912911, -127.90938846092422, -104.26512175126311, -117.91406682675395, -59.86169437354865, -196.16729044471128, -109.26980316939142, -129.9180188763918, -63.25895245657913, -106.2592519929676, -113.49984367688931, -59.01075682234899, -58.68333346117596, -112.24022571933637, -220.8774511041596, -110.83403603542845, -123.49038735897342, -107.7140659441768, -111.72368771849698, -110.43258242979212, -101.1815814720653, -110.05341593973091, -109.18237713497629, -109.1734300020064, -110.7113465946, -113.43985880578867, -102.04390225636773, -110.49103486892767, -56.3570209189219, -107.79712370495872, -120.03100246530897, -110.56671918536784, -62.25563284729668, -106.96380009263754, -108.37035977688245, -50.02913184951549, -54.47221205594577, -119.7236814537539, -110.03314156073768, -104.69437728262507, -104.56267581639811, -54.141076347627276, -125.6565386443076], "episode_lengths": [1600, 1600, 66, 1600, 1600, 1600, 1600, 84, 1600, 95, 1600, 63, 66, 1600, 93, 91, 61, 72, 58, 1600, 1600, 1600, 69, 1600, 70, 88, 95, 1600, 46, 72, 102, 76, 1600, 88, 1600, 64, 59, 69, 49, 1600, 57, 72, 104, 56, 53, 71, 1600, 42, 57, 1600, 79, 71, 71, 1600, 41, 154, 74, 58, 215, 72, 65, 1600, 1228, 53, 1600, 1600, 116, 58, 1600, 1600, 1600, 1554, 75, 110, 98, 71, 56, 60, 71, 83, 52, 48, 62, 63, 98, 1600, 76, 104, 41, 1600, 76, 50, 1600, 1600, 190, 110, 56, 73, 1600, 85]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3039979387961588, "mean_inference_ms": 1.0384521030342901, "mean_action_processing_ms": 0.20002393313256803, "mean_env_wait_ms": 0.41288557023742195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006005048751831055, "StateBufferConnector_ms": 0.0044171810150146484, "ViewRequirementAgentConnector_ms": 0.11678838729858398}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 404.1585906853159, "num_env_steps_trained_throughput_per_sec": 404.1585906853159, "timesteps_total": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 9969.998, "restore_workers_time_ms": 0.035, "training_step_time_ms": 9969.937, "sample_time_ms": 3747.051, "load_time_ms": 0.441, "load_throughput": 9061907.745, "learn_time_ms": 6214.416, "learn_throughput": 643.665, "synch_weights_time_ms": 7.49}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "episodes_total": 215, "training_iteration": 34, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-06-42", "timestamp": 1714270002, "time_this_iter_s": 9.9008629322052, "time_total_s": 355.41536831855774, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 355.41536831855774, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 30.1, "ram_util_percent": 62.449999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.098698058500085, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5114202446948928, "policy_loss": -0.03283165049168371, "vf_loss": 1.5384173876415659, "vf_explained_var": 0.1937737996860217, "kl": 0.008643720571979097, "entropy": 6.329930962798416, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 32085.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "sampler_results": {"episode_reward_max": -50.02913184951549, "episode_reward_min": -220.8774511041596, "episode_reward_mean": -100.04784034765242, "episode_len_mean": 513.56, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 51356, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-107.15863585994951, -65.60994399569186, -119.87226210092194, -67.85319110878804, -111.73074151834163, -106.52223467564272, -65.72975099817926, -105.58365427381422, -127.07741654054759, -103.75480155031197, -104.1525084811685, -121.21017194479953, -57.97779173413159, -56.44806606942304, -70.12273880274329, -104.82508820553434, -67.01423012593271, -109.24905223545619, -106.32081469651064, -106.21689102734501, -52.98814861659522, -106.62052079490945, -103.19828111346315, -111.64540432366418, -118.75681626889296, -56.09946695951308, -104.2619503403219, -54.506296861901895, -108.90800401239656, -113.0829883581965, -101.37019290915629, -107.20112682009612, -61.88185140875596, -112.20990885074686, -106.76025776533845, -106.88267489650163, -105.39834753325891, -115.24254430767522, -104.67298494793786, -55.29061250832678, -106.38759793166693, -112.24900408670928, -66.81876834318223, -105.83255050211463, -116.80658959751452, -103.380966702234, -61.86113040018831, -112.92608171692552, -122.94975056705499, -105.5069856173123, -103.24927721912911, -127.90938846092422, -104.26512175126311, -117.91406682675395, -59.86169437354865, -196.16729044471128, -109.26980316939142, -129.9180188763918, -63.25895245657913, -106.2592519929676, -113.49984367688931, -59.01075682234899, -58.68333346117596, -112.24022571933637, -220.8774511041596, -110.83403603542845, -123.49038735897342, -107.7140659441768, -111.72368771849698, -110.43258242979212, -101.1815814720653, -110.05341593973091, -109.18237713497629, -109.1734300020064, -110.7113465946, -113.43985880578867, -102.04390225636773, -110.49103486892767, -56.3570209189219, -107.79712370495872, -120.03100246530897, -110.56671918536784, -62.25563284729668, -106.96380009263754, -108.37035977688245, -50.02913184951549, -54.47221205594577, -119.7236814537539, -110.03314156073768, -104.69437728262507, -104.56267581639811, -54.141076347627276, -125.6565386443076, -58.734719450799794, -107.26860071577877, -113.88728998161294, -105.39712103131352, -104.61032969278159, -105.55543405189738, -94.69207191408589], "episode_lengths": [84, 1600, 95, 1600, 63, 66, 1600, 93, 91, 61, 72, 58, 1600, 1600, 1600, 69, 1600, 70, 88, 95, 1600, 46, 72, 102, 76, 1600, 88, 1600, 64, 59, 69, 49, 1600, 57, 72, 104, 56, 53, 71, 1600, 42, 57, 1600, 79, 71, 71, 1600, 41, 154, 74, 58, 215, 72, 65, 1600, 1228, 53, 1600, 1600, 116, 58, 1600, 1600, 1600, 1554, 75, 110, 98, 71, 56, 60, 71, 83, 52, 48, 62, 63, 98, 1600, 76, 104, 41, 1600, 76, 50, 1600, 1600, 190, 110, 56, 73, 1600, 85, 1600, 62, 62, 52, 84, 37, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30371107595206426, "mean_inference_ms": 1.036566247097425, "mean_action_processing_ms": 0.1996847932551032, "mean_env_wait_ms": 0.41251808205639295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006001472473144531, "StateBufferConnector_ms": 0.00438690185546875, "ViewRequirementAgentConnector_ms": 0.11677670478820801}}, "episode_reward_max": -50.02913184951549, "episode_reward_min": -220.8774511041596, "episode_reward_mean": -100.04784034765242, "episode_len_mean": 513.56, "episodes_this_iter": 7, "episodes_timesteps_total": 51356, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-107.15863585994951, -65.60994399569186, -119.87226210092194, -67.85319110878804, -111.73074151834163, -106.52223467564272, -65.72975099817926, -105.58365427381422, -127.07741654054759, -103.75480155031197, -104.1525084811685, -121.21017194479953, -57.97779173413159, -56.44806606942304, -70.12273880274329, -104.82508820553434, -67.01423012593271, -109.24905223545619, -106.32081469651064, -106.21689102734501, -52.98814861659522, -106.62052079490945, -103.19828111346315, -111.64540432366418, -118.75681626889296, -56.09946695951308, -104.2619503403219, -54.506296861901895, -108.90800401239656, -113.0829883581965, -101.37019290915629, -107.20112682009612, -61.88185140875596, -112.20990885074686, -106.76025776533845, -106.88267489650163, -105.39834753325891, -115.24254430767522, -104.67298494793786, -55.29061250832678, -106.38759793166693, -112.24900408670928, -66.81876834318223, -105.83255050211463, -116.80658959751452, -103.380966702234, -61.86113040018831, -112.92608171692552, -122.94975056705499, -105.5069856173123, -103.24927721912911, -127.90938846092422, -104.26512175126311, -117.91406682675395, -59.86169437354865, -196.16729044471128, -109.26980316939142, -129.9180188763918, -63.25895245657913, -106.2592519929676, -113.49984367688931, -59.01075682234899, -58.68333346117596, -112.24022571933637, -220.8774511041596, -110.83403603542845, -123.49038735897342, -107.7140659441768, -111.72368771849698, -110.43258242979212, -101.1815814720653, -110.05341593973091, -109.18237713497629, -109.1734300020064, -110.7113465946, -113.43985880578867, -102.04390225636773, -110.49103486892767, -56.3570209189219, -107.79712370495872, -120.03100246530897, -110.56671918536784, -62.25563284729668, -106.96380009263754, -108.37035977688245, -50.02913184951549, -54.47221205594577, -119.7236814537539, -110.03314156073768, -104.69437728262507, -104.56267581639811, -54.141076347627276, -125.6565386443076, -58.734719450799794, -107.26860071577877, -113.88728998161294, -105.39712103131352, -104.61032969278159, -105.55543405189738, -94.69207191408589], "episode_lengths": [84, 1600, 95, 1600, 63, 66, 1600, 93, 91, 61, 72, 58, 1600, 1600, 1600, 69, 1600, 70, 88, 95, 1600, 46, 72, 102, 76, 1600, 88, 1600, 64, 59, 69, 49, 1600, 57, 72, 104, 56, 53, 71, 1600, 42, 57, 1600, 79, 71, 71, 1600, 41, 154, 74, 58, 215, 72, 65, 1600, 1228, 53, 1600, 1600, 116, 58, 1600, 1600, 1600, 1554, 75, 110, 98, 71, 56, 60, 71, 83, 52, 48, 62, 63, 98, 1600, 76, 104, 41, 1600, 76, 50, 1600, 1600, 190, 110, 56, 73, 1600, 85, 1600, 62, 62, 52, 84, 37, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30371107595206426, "mean_inference_ms": 1.036566247097425, "mean_action_processing_ms": 0.1996847932551032, "mean_env_wait_ms": 0.41251808205639295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006001472473144531, "StateBufferConnector_ms": 0.00438690185546875, "ViewRequirementAgentConnector_ms": 0.11677670478820801}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 417.7857654450373, "num_env_steps_trained_throughput_per_sec": 417.7857654450373, "timesteps_total": 140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 9897.119, "restore_workers_time_ms": 0.012, "training_step_time_ms": 9897.081, "sample_time_ms": 3688.256, "load_time_ms": 0.428, "load_throughput": 9341434.298, "learn_time_ms": 6200.387, "learn_throughput": 645.121, "synch_weights_time_ms": 7.478}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "episodes_total": 222, "training_iteration": 35, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-06-51", "timestamp": 1714270011, "time_this_iter_s": 9.578927040100098, "time_total_s": 364.99429535865784, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 364.99429535865784, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 27.142857142857142, "ram_util_percent": 62.435714285714276}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.275973233099906, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.491583340524656, "policy_loss": -0.028091977160143597, "vf_loss": 2.511262629910182, "vf_explained_var": 0.09113376525140578, "kl": 0.012463264346313075, "entropy": 6.54538470750214, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 33015.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": -50.02913184951549, "episode_reward_min": -220.8774511041596, "episode_reward_mean": -101.56051198178324, "episode_len_mean": 451.37, "episode_media": {}, "episodes_this_iter": 15, "episodes_timesteps_total": 45137, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-104.82508820553434, -67.01423012593271, -109.24905223545619, -106.32081469651064, -106.21689102734501, -52.98814861659522, -106.62052079490945, -103.19828111346315, -111.64540432366418, -118.75681626889296, -56.09946695951308, -104.2619503403219, -54.506296861901895, -108.90800401239656, -113.0829883581965, -101.37019290915629, -107.20112682009612, -61.88185140875596, -112.20990885074686, -106.76025776533845, -106.88267489650163, -105.39834753325891, -115.24254430767522, -104.67298494793786, -55.29061250832678, -106.38759793166693, -112.24900408670928, -66.81876834318223, -105.83255050211463, -116.80658959751452, -103.380966702234, -61.86113040018831, -112.92608171692552, -122.94975056705499, -105.5069856173123, -103.24927721912911, -127.90938846092422, -104.26512175126311, -117.91406682675395, -59.86169437354865, -196.16729044471128, -109.26980316939142, -129.9180188763918, -63.25895245657913, -106.2592519929676, -113.49984367688931, -59.01075682234899, -58.68333346117596, -112.24022571933637, -220.8774511041596, -110.83403603542845, -123.49038735897342, -107.7140659441768, -111.72368771849698, -110.43258242979212, -101.1815814720653, -110.05341593973091, -109.18237713497629, -109.1734300020064, -110.7113465946, -113.43985880578867, -102.04390225636773, -110.49103486892767, -56.3570209189219, -107.79712370495872, -120.03100246530897, -110.56671918536784, -62.25563284729668, -106.96380009263754, -108.37035977688245, -50.02913184951549, -54.47221205594577, -119.7236814537539, -110.03314156073768, -104.69437728262507, -104.56267581639811, -54.141076347627276, -125.6565386443076, -58.734719450799794, -107.26860071577877, -113.88728998161294, -105.39712103131352, -104.61032969278159, -105.55543405189738, -94.69207191408589, -63.96502647039303, -111.21729339075027, -106.46517853673113, -105.50971071419741, -104.543976779071, -103.98708262562255, -106.85456126161975, -105.52015230913771, -110.34410659328972, -117.95443320296641, -116.52026042183675, -116.11903738848493, -59.16993945014352, -103.67691341047734, -110.22340051281515], "episode_lengths": [69, 1600, 70, 88, 95, 1600, 46, 72, 102, 76, 1600, 88, 1600, 64, 59, 69, 49, 1600, 57, 72, 104, 56, 53, 71, 1600, 42, 57, 1600, 79, 71, 71, 1600, 41, 154, 74, 58, 215, 72, 65, 1600, 1228, 53, 1600, 1600, 116, 58, 1600, 1600, 1600, 1554, 75, 110, 98, 71, 56, 60, 71, 83, 52, 48, 62, 63, 98, 1600, 76, 104, 41, 1600, 76, 50, 1600, 1600, 190, 110, 56, 73, 1600, 85, 1600, 62, 62, 52, 84, 37, 1600, 1600, 47, 62, 54, 51, 64, 77, 58, 63, 95, 101, 68, 1600, 81, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30328092789503724, "mean_inference_ms": 1.0323221930249498, "mean_action_processing_ms": 0.19895423894556874, "mean_env_wait_ms": 0.41194058731215577, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0059413909912109375, "StateBufferConnector_ms": 0.0043926239013671875, "ViewRequirementAgentConnector_ms": 0.11670374870300293}}, "episode_reward_max": -50.02913184951549, "episode_reward_min": -220.8774511041596, "episode_reward_mean": -101.56051198178324, "episode_len_mean": 451.37, "episodes_this_iter": 15, "episodes_timesteps_total": 45137, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-104.82508820553434, -67.01423012593271, -109.24905223545619, -106.32081469651064, -106.21689102734501, -52.98814861659522, -106.62052079490945, -103.19828111346315, -111.64540432366418, -118.75681626889296, -56.09946695951308, -104.2619503403219, -54.506296861901895, -108.90800401239656, -113.0829883581965, -101.37019290915629, -107.20112682009612, -61.88185140875596, -112.20990885074686, -106.76025776533845, -106.88267489650163, -105.39834753325891, -115.24254430767522, -104.67298494793786, -55.29061250832678, -106.38759793166693, -112.24900408670928, -66.81876834318223, -105.83255050211463, -116.80658959751452, -103.380966702234, -61.86113040018831, -112.92608171692552, -122.94975056705499, -105.5069856173123, -103.24927721912911, -127.90938846092422, -104.26512175126311, -117.91406682675395, -59.86169437354865, -196.16729044471128, -109.26980316939142, -129.9180188763918, -63.25895245657913, -106.2592519929676, -113.49984367688931, -59.01075682234899, -58.68333346117596, -112.24022571933637, -220.8774511041596, -110.83403603542845, -123.49038735897342, -107.7140659441768, -111.72368771849698, -110.43258242979212, -101.1815814720653, -110.05341593973091, -109.18237713497629, -109.1734300020064, -110.7113465946, -113.43985880578867, -102.04390225636773, -110.49103486892767, -56.3570209189219, -107.79712370495872, -120.03100246530897, -110.56671918536784, -62.25563284729668, -106.96380009263754, -108.37035977688245, -50.02913184951549, -54.47221205594577, -119.7236814537539, -110.03314156073768, -104.69437728262507, -104.56267581639811, -54.141076347627276, -125.6565386443076, -58.734719450799794, -107.26860071577877, -113.88728998161294, -105.39712103131352, -104.61032969278159, -105.55543405189738, -94.69207191408589, -63.96502647039303, -111.21729339075027, -106.46517853673113, -105.50971071419741, -104.543976779071, -103.98708262562255, -106.85456126161975, -105.52015230913771, -110.34410659328972, -117.95443320296641, -116.52026042183675, -116.11903738848493, -59.16993945014352, -103.67691341047734, -110.22340051281515], "episode_lengths": [69, 1600, 70, 88, 95, 1600, 46, 72, 102, 76, 1600, 88, 1600, 64, 59, 69, 49, 1600, 57, 72, 104, 56, 53, 71, 1600, 42, 57, 1600, 79, 71, 71, 1600, 41, 154, 74, 58, 215, 72, 65, 1600, 1228, 53, 1600, 1600, 116, 58, 1600, 1600, 1600, 1554, 75, 110, 98, 71, 56, 60, 71, 83, 52, 48, 62, 63, 98, 1600, 76, 104, 41, 1600, 76, 50, 1600, 1600, 190, 110, 56, 73, 1600, 85, 1600, 62, 62, 52, 84, 37, 1600, 1600, 47, 62, 54, 51, 64, 77, 58, 63, 95, 101, 68, 1600, 81, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30328092789503724, "mean_inference_ms": 1.0323221930249498, "mean_action_processing_ms": 0.19895423894556874, "mean_env_wait_ms": 0.41194058731215577, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0059413909912109375, "StateBufferConnector_ms": 0.0043926239013671875, "ViewRequirementAgentConnector_ms": 0.11670374870300293}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 384.701500862271, "num_env_steps_trained_throughput_per_sec": 384.701500862271, "timesteps_total": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 9975.488, "restore_workers_time_ms": 0.012, "training_step_time_ms": 9975.45, "sample_time_ms": 3703.684, "load_time_ms": 0.429, "load_throughput": 9330524.442, "learn_time_ms": 6263.197, "learn_throughput": 638.651, "synch_weights_time_ms": 7.604}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 237, "training_iteration": 36, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-07-02", "timestamp": 1714270022, "time_this_iter_s": 10.402349948883057, "time_total_s": 375.3966453075409, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 375.3966453075409, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 32.00714285714286, "ram_util_percent": 62.585714285714296}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.9213824206142, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8822498396932779, "policy_loss": -0.03562234151427464, "vf_loss": 0.9107291767033198, "vf_explained_var": 0.15473857733511157, "kl": 0.010582220704209151, "entropy": 5.276044779439126, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 33945.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "sampler_results": {"episode_reward_max": -50.02913184951549, "episode_reward_min": -220.8774511041596, "episode_reward_mean": -101.74090893286167, "episode_len_mean": 450.39, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 45039, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-106.62052079490945, -103.19828111346315, -111.64540432366418, -118.75681626889296, -56.09946695951308, -104.2619503403219, -54.506296861901895, -108.90800401239656, -113.0829883581965, -101.37019290915629, -107.20112682009612, -61.88185140875596, -112.20990885074686, -106.76025776533845, -106.88267489650163, -105.39834753325891, -115.24254430767522, -104.67298494793786, -55.29061250832678, -106.38759793166693, -112.24900408670928, -66.81876834318223, -105.83255050211463, -116.80658959751452, -103.380966702234, -61.86113040018831, -112.92608171692552, -122.94975056705499, -105.5069856173123, -103.24927721912911, -127.90938846092422, -104.26512175126311, -117.91406682675395, -59.86169437354865, -196.16729044471128, -109.26980316939142, -129.9180188763918, -63.25895245657913, -106.2592519929676, -113.49984367688931, -59.01075682234899, -58.68333346117596, -112.24022571933637, -220.8774511041596, -110.83403603542845, -123.49038735897342, -107.7140659441768, -111.72368771849698, -110.43258242979212, -101.1815814720653, -110.05341593973091, -109.18237713497629, -109.1734300020064, -110.7113465946, -113.43985880578867, -102.04390225636773, -110.49103486892767, -56.3570209189219, -107.79712370495872, -120.03100246530897, -110.56671918536784, -62.25563284729668, -106.96380009263754, -108.37035977688245, -50.02913184951549, -54.47221205594577, -119.7236814537539, -110.03314156073768, -104.69437728262507, -104.56267581639811, -54.141076347627276, -125.6565386443076, -58.734719450799794, -107.26860071577877, -113.88728998161294, -105.39712103131352, -104.61032969278159, -105.55543405189738, -94.69207191408589, -63.96502647039303, -111.21729339075027, -106.46517853673113, -105.50971071419741, -104.543976779071, -103.98708262562255, -106.85456126161975, -105.52015230913771, -110.34410659328972, -117.95443320296641, -116.52026042183675, -116.11903738848493, -59.16993945014352, -103.67691341047734, -110.22340051281515, -63.14091483816129, -107.25278824937902, -116.67541523982709, -60.32811049813404, -110.37014558175703, -106.88654560795612], "episode_lengths": [46, 72, 102, 76, 1600, 88, 1600, 64, 59, 69, 49, 1600, 57, 72, 104, 56, 53, 71, 1600, 42, 57, 1600, 79, 71, 71, 1600, 41, 154, 74, 58, 215, 72, 65, 1600, 1228, 53, 1600, 1600, 116, 58, 1600, 1600, 1600, 1554, 75, 110, 98, 71, 56, 60, 71, 83, 52, 48, 62, 63, 98, 1600, 76, 104, 41, 1600, 76, 50, 1600, 1600, 190, 110, 56, 73, 1600, 85, 1600, 62, 62, 52, 84, 37, 1600, 1600, 47, 62, 54, 51, 64, 77, 58, 63, 95, 101, 68, 1600, 81, 43, 1600, 38, 80, 1600, 58, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3030701469865416, "mean_inference_ms": 1.0307542656070887, "mean_action_processing_ms": 0.19867934590643388, "mean_env_wait_ms": 0.41171583337051776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005979299545288086, "StateBufferConnector_ms": 0.0043904781341552734, "ViewRequirementAgentConnector_ms": 0.11623764038085938}}, "episode_reward_max": -50.02913184951549, "episode_reward_min": -220.8774511041596, "episode_reward_mean": -101.74090893286167, "episode_len_mean": 450.39, "episodes_this_iter": 6, "episodes_timesteps_total": 45039, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-106.62052079490945, -103.19828111346315, -111.64540432366418, -118.75681626889296, -56.09946695951308, -104.2619503403219, -54.506296861901895, -108.90800401239656, -113.0829883581965, -101.37019290915629, -107.20112682009612, -61.88185140875596, -112.20990885074686, -106.76025776533845, -106.88267489650163, -105.39834753325891, -115.24254430767522, -104.67298494793786, -55.29061250832678, -106.38759793166693, -112.24900408670928, -66.81876834318223, -105.83255050211463, -116.80658959751452, -103.380966702234, -61.86113040018831, -112.92608171692552, -122.94975056705499, -105.5069856173123, -103.24927721912911, -127.90938846092422, -104.26512175126311, -117.91406682675395, -59.86169437354865, -196.16729044471128, -109.26980316939142, -129.9180188763918, -63.25895245657913, -106.2592519929676, -113.49984367688931, -59.01075682234899, -58.68333346117596, -112.24022571933637, -220.8774511041596, -110.83403603542845, -123.49038735897342, -107.7140659441768, -111.72368771849698, -110.43258242979212, -101.1815814720653, -110.05341593973091, -109.18237713497629, -109.1734300020064, -110.7113465946, -113.43985880578867, -102.04390225636773, -110.49103486892767, -56.3570209189219, -107.79712370495872, -120.03100246530897, -110.56671918536784, -62.25563284729668, -106.96380009263754, -108.37035977688245, -50.02913184951549, -54.47221205594577, -119.7236814537539, -110.03314156073768, -104.69437728262507, -104.56267581639811, -54.141076347627276, -125.6565386443076, -58.734719450799794, -107.26860071577877, -113.88728998161294, -105.39712103131352, -104.61032969278159, -105.55543405189738, -94.69207191408589, -63.96502647039303, -111.21729339075027, -106.46517853673113, -105.50971071419741, -104.543976779071, -103.98708262562255, -106.85456126161975, -105.52015230913771, -110.34410659328972, -117.95443320296641, -116.52026042183675, -116.11903738848493, -59.16993945014352, -103.67691341047734, -110.22340051281515, -63.14091483816129, -107.25278824937902, -116.67541523982709, -60.32811049813404, -110.37014558175703, -106.88654560795612], "episode_lengths": [46, 72, 102, 76, 1600, 88, 1600, 64, 59, 69, 49, 1600, 57, 72, 104, 56, 53, 71, 1600, 42, 57, 1600, 79, 71, 71, 1600, 41, 154, 74, 58, 215, 72, 65, 1600, 1228, 53, 1600, 1600, 116, 58, 1600, 1600, 1600, 1554, 75, 110, 98, 71, 56, 60, 71, 83, 52, 48, 62, 63, 98, 1600, 76, 104, 41, 1600, 76, 50, 1600, 1600, 190, 110, 56, 73, 1600, 85, 1600, 62, 62, 52, 84, 37, 1600, 1600, 47, 62, 54, 51, 64, 77, 58, 63, 95, 101, 68, 1600, 81, 43, 1600, 38, 80, 1600, 58, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3030701469865416, "mean_inference_ms": 1.0307542656070887, "mean_action_processing_ms": 0.19867934590643388, "mean_env_wait_ms": 0.41171583337051776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005979299545288086, "StateBufferConnector_ms": 0.0043904781341552734, "ViewRequirementAgentConnector_ms": 0.11623764038085938}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 383.24810891754123, "num_env_steps_trained_throughput_per_sec": 383.24810891754123, "timesteps_total": 148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 10047.133, "restore_workers_time_ms": 0.012, "training_step_time_ms": 10047.095, "sample_time_ms": 3755.726, "load_time_ms": 0.44, "load_throughput": 9093342.005, "learn_time_ms": 6282.767, "learn_throughput": 636.662, "synch_weights_time_ms": 7.627}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "done": false, "episodes_total": 243, "training_iteration": 37, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-07-12", "timestamp": 1714270032, "time_this_iter_s": 10.441272974014282, "time_total_s": 385.8379182815552, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 385.8379182815552, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 31.893333333333334, "ram_util_percent": 62.79999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.710200065662784, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4721347880434563, "policy_loss": -0.030706051152239563, "vf_loss": 2.494549254736593, "vf_explained_var": 0.09110802854261091, "kl": 0.012283814978872964, "entropy": 8.019693124935191, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 34875.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "sampler_results": {"episode_reward_max": -50.02913184951549, "episode_reward_min": -220.8774511041596, "episode_reward_mean": -102.75041216037988, "episode_len_mean": 478.88, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 47888, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-54.506296861901895, -108.90800401239656, -113.0829883581965, -101.37019290915629, -107.20112682009612, -61.88185140875596, -112.20990885074686, -106.76025776533845, -106.88267489650163, -105.39834753325891, -115.24254430767522, -104.67298494793786, -55.29061250832678, -106.38759793166693, -112.24900408670928, -66.81876834318223, -105.83255050211463, -116.80658959751452, -103.380966702234, -61.86113040018831, -112.92608171692552, -122.94975056705499, -105.5069856173123, -103.24927721912911, -127.90938846092422, -104.26512175126311, -117.91406682675395, -59.86169437354865, -196.16729044471128, -109.26980316939142, -129.9180188763918, -63.25895245657913, -106.2592519929676, -113.49984367688931, -59.01075682234899, -58.68333346117596, -112.24022571933637, -220.8774511041596, -110.83403603542845, -123.49038735897342, -107.7140659441768, -111.72368771849698, -110.43258242979212, -101.1815814720653, -110.05341593973091, -109.18237713497629, -109.1734300020064, -110.7113465946, -113.43985880578867, -102.04390225636773, -110.49103486892767, -56.3570209189219, -107.79712370495872, -120.03100246530897, -110.56671918536784, -62.25563284729668, -106.96380009263754, -108.37035977688245, -50.02913184951549, -54.47221205594577, -119.7236814537539, -110.03314156073768, -104.69437728262507, -104.56267581639811, -54.141076347627276, -125.6565386443076, -58.734719450799794, -107.26860071577877, -113.88728998161294, -105.39712103131352, -104.61032969278159, -105.55543405189738, -94.69207191408589, -63.96502647039303, -111.21729339075027, -106.46517853673113, -105.50971071419741, -104.543976779071, -103.98708262562255, -106.85456126161975, -105.52015230913771, -110.34410659328972, -117.95443320296641, -116.52026042183675, -116.11903738848493, -59.16993945014352, -103.67691341047734, -110.22340051281515, -63.14091483816129, -107.25278824937902, -116.67541523982709, -60.32811049813404, -110.37014558175703, -106.88654560795612, -106.37628278559448, -105.90087862090145, -64.18428156733701, -203.20911796192976, -108.97736825882147, -112.8848333580047], "episode_lengths": [1600, 64, 59, 69, 49, 1600, 57, 72, 104, 56, 53, 71, 1600, 42, 57, 1600, 79, 71, 71, 1600, 41, 154, 74, 58, 215, 72, 65, 1600, 1228, 53, 1600, 1600, 116, 58, 1600, 1600, 1600, 1554, 75, 110, 98, 71, 56, 60, 71, 83, 52, 48, 62, 63, 98, 1600, 76, 104, 41, 1600, 76, 50, 1600, 1600, 190, 110, 56, 73, 1600, 85, 1600, 62, 62, 52, 84, 37, 1600, 1600, 47, 62, 54, 51, 64, 77, 58, 63, 95, 101, 68, 1600, 81, 43, 1600, 38, 80, 1600, 58, 48, 1600, 47, 1600, 1439, 57, 90]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3027216598583735, "mean_inference_ms": 1.02961149050141, "mean_action_processing_ms": 0.1984508685576985, "mean_env_wait_ms": 0.4111510896205317, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005999326705932617, "StateBufferConnector_ms": 0.004273414611816406, "ViewRequirementAgentConnector_ms": 0.11613321304321289}}, "episode_reward_max": -50.02913184951549, "episode_reward_min": -220.8774511041596, "episode_reward_mean": -102.75041216037988, "episode_len_mean": 478.88, "episodes_this_iter": 6, "episodes_timesteps_total": 47888, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-54.506296861901895, -108.90800401239656, -113.0829883581965, -101.37019290915629, -107.20112682009612, -61.88185140875596, -112.20990885074686, -106.76025776533845, -106.88267489650163, -105.39834753325891, -115.24254430767522, -104.67298494793786, -55.29061250832678, -106.38759793166693, -112.24900408670928, -66.81876834318223, -105.83255050211463, -116.80658959751452, -103.380966702234, -61.86113040018831, -112.92608171692552, -122.94975056705499, -105.5069856173123, -103.24927721912911, -127.90938846092422, -104.26512175126311, -117.91406682675395, -59.86169437354865, -196.16729044471128, -109.26980316939142, -129.9180188763918, -63.25895245657913, -106.2592519929676, -113.49984367688931, -59.01075682234899, -58.68333346117596, -112.24022571933637, -220.8774511041596, -110.83403603542845, -123.49038735897342, -107.7140659441768, -111.72368771849698, -110.43258242979212, -101.1815814720653, -110.05341593973091, -109.18237713497629, -109.1734300020064, -110.7113465946, -113.43985880578867, -102.04390225636773, -110.49103486892767, -56.3570209189219, -107.79712370495872, -120.03100246530897, -110.56671918536784, -62.25563284729668, -106.96380009263754, -108.37035977688245, -50.02913184951549, -54.47221205594577, -119.7236814537539, -110.03314156073768, -104.69437728262507, -104.56267581639811, -54.141076347627276, -125.6565386443076, -58.734719450799794, -107.26860071577877, -113.88728998161294, -105.39712103131352, -104.61032969278159, -105.55543405189738, -94.69207191408589, -63.96502647039303, -111.21729339075027, -106.46517853673113, -105.50971071419741, -104.543976779071, -103.98708262562255, -106.85456126161975, -105.52015230913771, -110.34410659328972, -117.95443320296641, -116.52026042183675, -116.11903738848493, -59.16993945014352, -103.67691341047734, -110.22340051281515, -63.14091483816129, -107.25278824937902, -116.67541523982709, -60.32811049813404, -110.37014558175703, -106.88654560795612, -106.37628278559448, -105.90087862090145, -64.18428156733701, -203.20911796192976, -108.97736825882147, -112.8848333580047], "episode_lengths": [1600, 64, 59, 69, 49, 1600, 57, 72, 104, 56, 53, 71, 1600, 42, 57, 1600, 79, 71, 71, 1600, 41, 154, 74, 58, 215, 72, 65, 1600, 1228, 53, 1600, 1600, 116, 58, 1600, 1600, 1600, 1554, 75, 110, 98, 71, 56, 60, 71, 83, 52, 48, 62, 63, 98, 1600, 76, 104, 41, 1600, 76, 50, 1600, 1600, 190, 110, 56, 73, 1600, 85, 1600, 62, 62, 52, 84, 37, 1600, 1600, 47, 62, 54, 51, 64, 77, 58, 63, 95, 101, 68, 1600, 81, 43, 1600, 38, 80, 1600, 58, 48, 1600, 47, 1600, 1439, 57, 90]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3027216598583735, "mean_inference_ms": 1.02961149050141, "mean_action_processing_ms": 0.1984508685576985, "mean_env_wait_ms": 0.4111510896205317, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005999326705932617, "StateBufferConnector_ms": 0.004273414611816406, "ViewRequirementAgentConnector_ms": 0.11613321304321289}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 409.3606898994228, "num_env_steps_trained_throughput_per_sec": 409.3606898994228, "timesteps_total": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 10148.133, "restore_workers_time_ms": 0.012, "training_step_time_ms": 10148.099, "sample_time_ms": 3803.253, "load_time_ms": 0.439, "load_throughput": 9106174.555, "learn_time_ms": 6336.234, "learn_throughput": 631.29, "synch_weights_time_ms": 7.631}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "episodes_total": 249, "training_iteration": 38, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-07-22", "timestamp": 1714270042, "time_this_iter_s": 9.776150226593018, "time_total_s": 395.6140685081482, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 395.6140685081482, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 28.05714285714286, "ram_util_percent": 62.73571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.22792350739561, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8171005140113774, "policy_loss": -0.02403922632176389, "vf_loss": 0.837146841718625, "vf_explained_var": 0.21502239531086337, "kl": 0.005915412703231447, "entropy": 5.027984951901179, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 35805.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "sampler_results": {"episode_reward_max": -50.02913184951549, "episode_reward_min": -220.8774511041596, "episode_reward_mean": -102.4994999321151, "episode_len_mean": 494.93, "episode_media": {}, "episodes_this_iter": 3, "episodes_timesteps_total": 49493, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-101.37019290915629, -107.20112682009612, -61.88185140875596, -112.20990885074686, -106.76025776533845, -106.88267489650163, -105.39834753325891, -115.24254430767522, -104.67298494793786, -55.29061250832678, -106.38759793166693, -112.24900408670928, -66.81876834318223, -105.83255050211463, -116.80658959751452, -103.380966702234, -61.86113040018831, -112.92608171692552, -122.94975056705499, -105.5069856173123, -103.24927721912911, -127.90938846092422, -104.26512175126311, -117.91406682675395, -59.86169437354865, -196.16729044471128, -109.26980316939142, -129.9180188763918, -63.25895245657913, -106.2592519929676, -113.49984367688931, -59.01075682234899, -58.68333346117596, -112.24022571933637, -220.8774511041596, -110.83403603542845, -123.49038735897342, -107.7140659441768, -111.72368771849698, -110.43258242979212, -101.1815814720653, -110.05341593973091, -109.18237713497629, -109.1734300020064, -110.7113465946, -113.43985880578867, -102.04390225636773, -110.49103486892767, -56.3570209189219, -107.79712370495872, -120.03100246530897, -110.56671918536784, -62.25563284729668, -106.96380009263754, -108.37035977688245, -50.02913184951549, -54.47221205594577, -119.7236814537539, -110.03314156073768, -104.69437728262507, -104.56267581639811, -54.141076347627276, -125.6565386443076, -58.734719450799794, -107.26860071577877, -113.88728998161294, -105.39712103131352, -104.61032969278159, -105.55543405189738, -94.69207191408589, -63.96502647039303, -111.21729339075027, -106.46517853673113, -105.50971071419741, -104.543976779071, -103.98708262562255, -106.85456126161975, -105.52015230913771, -110.34410659328972, -117.95443320296641, -116.52026042183675, -116.11903738848493, -59.16993945014352, -103.67691341047734, -110.22340051281515, -63.14091483816129, -107.25278824937902, -116.67541523982709, -60.32811049813404, -110.37014558175703, -106.88654560795612, -106.37628278559448, -105.90087862090145, -64.18428156733701, -203.20911796192976, -108.97736825882147, -112.8848333580047, -64.55263185197252, -62.03511045092715, -124.8183241031176], "episode_lengths": [69, 49, 1600, 57, 72, 104, 56, 53, 71, 1600, 42, 57, 1600, 79, 71, 71, 1600, 41, 154, 74, 58, 215, 72, 65, 1600, 1228, 53, 1600, 1600, 116, 58, 1600, 1600, 1600, 1554, 75, 110, 98, 71, 56, 60, 71, 83, 52, 48, 62, 63, 98, 1600, 76, 104, 41, 1600, 76, 50, 1600, 1600, 190, 110, 56, 73, 1600, 85, 1600, 62, 62, 52, 84, 37, 1600, 1600, 47, 62, 54, 51, 64, 77, 58, 63, 95, 101, 68, 1600, 81, 43, 1600, 38, 80, 1600, 58, 48, 1600, 47, 1600, 1439, 57, 90, 1600, 1600, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30247435181262916, "mean_inference_ms": 1.0292367586514823, "mean_action_processing_ms": 0.1983595650694893, "mean_env_wait_ms": 0.41069865631179636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006106138229370117, "StateBufferConnector_ms": 0.004321575164794922, "ViewRequirementAgentConnector_ms": 0.11655259132385254}}, "episode_reward_max": -50.02913184951549, "episode_reward_min": -220.8774511041596, "episode_reward_mean": -102.4994999321151, "episode_len_mean": 494.93, "episodes_this_iter": 3, "episodes_timesteps_total": 49493, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-101.37019290915629, -107.20112682009612, -61.88185140875596, -112.20990885074686, -106.76025776533845, -106.88267489650163, -105.39834753325891, -115.24254430767522, -104.67298494793786, -55.29061250832678, -106.38759793166693, -112.24900408670928, -66.81876834318223, -105.83255050211463, -116.80658959751452, -103.380966702234, -61.86113040018831, -112.92608171692552, -122.94975056705499, -105.5069856173123, -103.24927721912911, -127.90938846092422, -104.26512175126311, -117.91406682675395, -59.86169437354865, -196.16729044471128, -109.26980316939142, -129.9180188763918, -63.25895245657913, -106.2592519929676, -113.49984367688931, -59.01075682234899, -58.68333346117596, -112.24022571933637, -220.8774511041596, -110.83403603542845, -123.49038735897342, -107.7140659441768, -111.72368771849698, -110.43258242979212, -101.1815814720653, -110.05341593973091, -109.18237713497629, -109.1734300020064, -110.7113465946, -113.43985880578867, -102.04390225636773, -110.49103486892767, -56.3570209189219, -107.79712370495872, -120.03100246530897, -110.56671918536784, -62.25563284729668, -106.96380009263754, -108.37035977688245, -50.02913184951549, -54.47221205594577, -119.7236814537539, -110.03314156073768, -104.69437728262507, -104.56267581639811, -54.141076347627276, -125.6565386443076, -58.734719450799794, -107.26860071577877, -113.88728998161294, -105.39712103131352, -104.61032969278159, -105.55543405189738, -94.69207191408589, -63.96502647039303, -111.21729339075027, -106.46517853673113, -105.50971071419741, -104.543976779071, -103.98708262562255, -106.85456126161975, -105.52015230913771, -110.34410659328972, -117.95443320296641, -116.52026042183675, -116.11903738848493, -59.16993945014352, -103.67691341047734, -110.22340051281515, -63.14091483816129, -107.25278824937902, -116.67541523982709, -60.32811049813404, -110.37014558175703, -106.88654560795612, -106.37628278559448, -105.90087862090145, -64.18428156733701, -203.20911796192976, -108.97736825882147, -112.8848333580047, -64.55263185197252, -62.03511045092715, -124.8183241031176], "episode_lengths": [69, 49, 1600, 57, 72, 104, 56, 53, 71, 1600, 42, 57, 1600, 79, 71, 71, 1600, 41, 154, 74, 58, 215, 72, 65, 1600, 1228, 53, 1600, 1600, 116, 58, 1600, 1600, 1600, 1554, 75, 110, 98, 71, 56, 60, 71, 83, 52, 48, 62, 63, 98, 1600, 76, 104, 41, 1600, 76, 50, 1600, 1600, 190, 110, 56, 73, 1600, 85, 1600, 62, 62, 52, 84, 37, 1600, 1600, 47, 62, 54, 51, 64, 77, 58, 63, 95, 101, 68, 1600, 81, 43, 1600, 38, 80, 1600, 58, 48, 1600, 47, 1600, 1439, 57, 90, 1600, 1600, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30247435181262916, "mean_inference_ms": 1.0292367586514823, "mean_action_processing_ms": 0.1983595650694893, "mean_env_wait_ms": 0.41069865631179636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006106138229370117, "StateBufferConnector_ms": 0.004321575164794922, "ViewRequirementAgentConnector_ms": 0.11655259132385254}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 434.9429671299137, "num_env_steps_trained_throughput_per_sec": 434.9429671299137, "timesteps_total": 156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 10109.03, "restore_workers_time_ms": 0.012, "training_step_time_ms": 10108.995, "sample_time_ms": 3832.694, "load_time_ms": 0.43, "load_throughput": 9305683.066, "learn_time_ms": 6267.846, "learn_throughput": 638.178, "synch_weights_time_ms": 7.491}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "episodes_total": 252, "training_iteration": 39, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-07-31", "timestamp": 1714270051, "time_this_iter_s": 9.200561761856079, "time_total_s": 404.8146302700043, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 404.8146302700043, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 24.15384615384615, "ram_util_percent": 62.5923076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.521589849809164, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1921413142922566, "policy_loss": -0.0276874383891462, "vf_loss": 1.2151504706911822, "vf_explained_var": 0.35863389097234255, "kl": 0.006930791907719879, "entropy": 7.316330154480473, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 36735.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "sampler_results": {"episode_reward_max": -50.02913184951549, "episode_reward_min": -220.8774511041596, "episode_reward_mean": -102.12060561750678, "episode_len_mean": 510.37, "episode_media": {}, "episodes_this_iter": 4, "episodes_timesteps_total": 51037, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-106.76025776533845, -106.88267489650163, -105.39834753325891, -115.24254430767522, -104.67298494793786, -55.29061250832678, -106.38759793166693, -112.24900408670928, -66.81876834318223, -105.83255050211463, -116.80658959751452, -103.380966702234, -61.86113040018831, -112.92608171692552, -122.94975056705499, -105.5069856173123, -103.24927721912911, -127.90938846092422, -104.26512175126311, -117.91406682675395, -59.86169437354865, -196.16729044471128, -109.26980316939142, -129.9180188763918, -63.25895245657913, -106.2592519929676, -113.49984367688931, -59.01075682234899, -58.68333346117596, -112.24022571933637, -220.8774511041596, -110.83403603542845, -123.49038735897342, -107.7140659441768, -111.72368771849698, -110.43258242979212, -101.1815814720653, -110.05341593973091, -109.18237713497629, -109.1734300020064, -110.7113465946, -113.43985880578867, -102.04390225636773, -110.49103486892767, -56.3570209189219, -107.79712370495872, -120.03100246530897, -110.56671918536784, -62.25563284729668, -106.96380009263754, -108.37035977688245, -50.02913184951549, -54.47221205594577, -119.7236814537539, -110.03314156073768, -104.69437728262507, -104.56267581639811, -54.141076347627276, -125.6565386443076, -58.734719450799794, -107.26860071577877, -113.88728998161294, -105.39712103131352, -104.61032969278159, -105.55543405189738, -94.69207191408589, -63.96502647039303, -111.21729339075027, -106.46517853673113, -105.50971071419741, -104.543976779071, -103.98708262562255, -106.85456126161975, -105.52015230913771, -110.34410659328972, -117.95443320296641, -116.52026042183675, -116.11903738848493, -59.16993945014352, -103.67691341047734, -110.22340051281515, -63.14091483816129, -107.25278824937902, -116.67541523982709, -60.32811049813404, -110.37014558175703, -106.88654560795612, -106.37628278559448, -105.90087862090145, -64.18428156733701, -203.20911796192976, -108.97736825882147, -112.8848333580047, -64.55263185197252, -62.03511045092715, -124.8183241031176, -61.42595226556003, -53.363377638731755, -108.92969663540089, -121.05462198823069], "episode_lengths": [72, 104, 56, 53, 71, 1600, 42, 57, 1600, 79, 71, 71, 1600, 41, 154, 74, 58, 215, 72, 65, 1600, 1228, 53, 1600, 1600, 116, 58, 1600, 1600, 1600, 1554, 75, 110, 98, 71, 56, 60, 71, 83, 52, 48, 62, 63, 98, 1600, 76, 104, 41, 1600, 76, 50, 1600, 1600, 190, 110, 56, 73, 1600, 85, 1600, 62, 62, 52, 84, 37, 1600, 1600, 47, 62, 54, 51, 64, 77, 58, 63, 95, 101, 68, 1600, 81, 43, 1600, 38, 80, 1600, 58, 48, 1600, 47, 1600, 1439, 57, 90, 1600, 1600, 128, 1600, 1600, 73, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3021990610554054, "mean_inference_ms": 1.0284851415180576, "mean_action_processing_ms": 0.1982071376378548, "mean_env_wait_ms": 0.4102811542100163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006121158599853516, "StateBufferConnector_ms": 0.0043256282806396484, "ViewRequirementAgentConnector_ms": 0.11644554138183594}}, "episode_reward_max": -50.02913184951549, "episode_reward_min": -220.8774511041596, "episode_reward_mean": -102.12060561750678, "episode_len_mean": 510.37, "episodes_this_iter": 4, "episodes_timesteps_total": 51037, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-106.76025776533845, -106.88267489650163, -105.39834753325891, -115.24254430767522, -104.67298494793786, -55.29061250832678, -106.38759793166693, -112.24900408670928, -66.81876834318223, -105.83255050211463, -116.80658959751452, -103.380966702234, -61.86113040018831, -112.92608171692552, -122.94975056705499, -105.5069856173123, -103.24927721912911, -127.90938846092422, -104.26512175126311, -117.91406682675395, -59.86169437354865, -196.16729044471128, -109.26980316939142, -129.9180188763918, -63.25895245657913, -106.2592519929676, -113.49984367688931, -59.01075682234899, -58.68333346117596, -112.24022571933637, -220.8774511041596, -110.83403603542845, -123.49038735897342, -107.7140659441768, -111.72368771849698, -110.43258242979212, -101.1815814720653, -110.05341593973091, -109.18237713497629, -109.1734300020064, -110.7113465946, -113.43985880578867, -102.04390225636773, -110.49103486892767, -56.3570209189219, -107.79712370495872, -120.03100246530897, -110.56671918536784, -62.25563284729668, -106.96380009263754, -108.37035977688245, -50.02913184951549, -54.47221205594577, -119.7236814537539, -110.03314156073768, -104.69437728262507, -104.56267581639811, -54.141076347627276, -125.6565386443076, -58.734719450799794, -107.26860071577877, -113.88728998161294, -105.39712103131352, -104.61032969278159, -105.55543405189738, -94.69207191408589, -63.96502647039303, -111.21729339075027, -106.46517853673113, -105.50971071419741, -104.543976779071, -103.98708262562255, -106.85456126161975, -105.52015230913771, -110.34410659328972, -117.95443320296641, -116.52026042183675, -116.11903738848493, -59.16993945014352, -103.67691341047734, -110.22340051281515, -63.14091483816129, -107.25278824937902, -116.67541523982709, -60.32811049813404, -110.37014558175703, -106.88654560795612, -106.37628278559448, -105.90087862090145, -64.18428156733701, -203.20911796192976, -108.97736825882147, -112.8848333580047, -64.55263185197252, -62.03511045092715, -124.8183241031176, -61.42595226556003, -53.363377638731755, -108.92969663540089, -121.05462198823069], "episode_lengths": [72, 104, 56, 53, 71, 1600, 42, 57, 1600, 79, 71, 71, 1600, 41, 154, 74, 58, 215, 72, 65, 1600, 1228, 53, 1600, 1600, 116, 58, 1600, 1600, 1600, 1554, 75, 110, 98, 71, 56, 60, 71, 83, 52, 48, 62, 63, 98, 1600, 76, 104, 41, 1600, 76, 50, 1600, 1600, 190, 110, 56, 73, 1600, 85, 1600, 62, 62, 52, 84, 37, 1600, 1600, 47, 62, 54, 51, 64, 77, 58, 63, 95, 101, 68, 1600, 81, 43, 1600, 38, 80, 1600, 58, 48, 1600, 47, 1600, 1439, 57, 90, 1600, 1600, 128, 1600, 1600, 73, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3021990610554054, "mean_inference_ms": 1.0284851415180576, "mean_action_processing_ms": 0.1982071376378548, "mean_env_wait_ms": 0.4102811542100163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006121158599853516, "StateBufferConnector_ms": 0.0043256282806396484, "ViewRequirementAgentConnector_ms": 0.11644554138183594}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 413.00277584904495, "num_env_steps_trained_throughput_per_sec": 413.00277584904495, "timesteps_total": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 9914.716, "restore_workers_time_ms": 0.012, "training_step_time_ms": 9914.682, "sample_time_ms": 3759.472, "load_time_ms": 0.424, "load_throughput": 9431230.536, "learn_time_ms": 6146.809, "learn_throughput": 650.744, "synch_weights_time_ms": 7.454}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "episodes_total": 256, "training_iteration": 40, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-07-41", "timestamp": 1714270061, "time_this_iter_s": 9.689879894256592, "time_total_s": 414.50451016426086, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 414.50451016426086, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 25.37142857142857, "ram_util_percent": 62.50714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.482237061633858, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6681564714654438, "policy_loss": -0.03635230903984398, "vf_loss": 2.6948331299247923, "vf_explained_var": 0.14354982453007853, "kl": 0.014334290991524135, "entropy": 7.790634971023888, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 37665.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "sampler_results": {"episode_reward_max": -50.02913184951549, "episode_reward_min": -220.8774511041596, "episode_reward_mean": -102.69059082670414, "episode_len_mean": 510.49, "episode_media": {}, "episodes_this_iter": 15, "episodes_timesteps_total": 51049, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-105.5069856173123, -103.24927721912911, -127.90938846092422, -104.26512175126311, -117.91406682675395, -59.86169437354865, -196.16729044471128, -109.26980316939142, -129.9180188763918, -63.25895245657913, -106.2592519929676, -113.49984367688931, -59.01075682234899, -58.68333346117596, -112.24022571933637, -220.8774511041596, -110.83403603542845, -123.49038735897342, -107.7140659441768, -111.72368771849698, -110.43258242979212, -101.1815814720653, -110.05341593973091, -109.18237713497629, -109.1734300020064, -110.7113465946, -113.43985880578867, -102.04390225636773, -110.49103486892767, -56.3570209189219, -107.79712370495872, -120.03100246530897, -110.56671918536784, -62.25563284729668, -106.96380009263754, -108.37035977688245, -50.02913184951549, -54.47221205594577, -119.7236814537539, -110.03314156073768, -104.69437728262507, -104.56267581639811, -54.141076347627276, -125.6565386443076, -58.734719450799794, -107.26860071577877, -113.88728998161294, -105.39712103131352, -104.61032969278159, -105.55543405189738, -94.69207191408589, -63.96502647039303, -111.21729339075027, -106.46517853673113, -105.50971071419741, -104.543976779071, -103.98708262562255, -106.85456126161975, -105.52015230913771, -110.34410659328972, -117.95443320296641, -116.52026042183675, -116.11903738848493, -59.16993945014352, -103.67691341047734, -110.22340051281515, -63.14091483816129, -107.25278824937902, -116.67541523982709, -60.32811049813404, -110.37014558175703, -106.88654560795612, -106.37628278559448, -105.90087862090145, -64.18428156733701, -203.20911796192976, -108.97736825882147, -112.8848333580047, -64.55263185197252, -62.03511045092715, -124.8183241031176, -61.42595226556003, -53.363377638731755, -108.92969663540089, -121.05462198823069, -90.53824864410774, -58.5035349681738, -109.90187249338503, -112.43772811047113, -111.49252700748667, -111.20310336533561, -98.53543142232927, -106.9659355833245, -113.62634108222463, -106.12998456388526, -108.69949044298754, -105.64094471606985, -107.0787436091397, -107.86320138770404, -111.84129532973965], "episode_lengths": [74, 58, 215, 72, 65, 1600, 1228, 53, 1600, 1600, 116, 58, 1600, 1600, 1600, 1554, 75, 110, 98, 71, 56, 60, 71, 83, 52, 48, 62, 63, 98, 1600, 76, 104, 41, 1600, 76, 50, 1600, 1600, 190, 110, 56, 73, 1600, 85, 1600, 62, 62, 52, 84, 37, 1600, 1600, 47, 62, 54, 51, 64, 77, 58, 63, 95, 101, 68, 1600, 81, 43, 1600, 38, 80, 1600, 58, 48, 1600, 47, 1600, 1439, 57, 90, 1600, 1600, 128, 1600, 1600, 73, 46, 1600, 1600, 74, 54, 86, 49, 1600, 75, 123, 95, 85, 60, 77, 46, 59]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3015133302987472, "mean_inference_ms": 1.025732313778059, "mean_action_processing_ms": 0.1976910570849787, "mean_env_wait_ms": 0.4092908420733788, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006055355072021484, "StateBufferConnector_ms": 0.004337787628173828, "ViewRequirementAgentConnector_ms": 0.11627769470214844}}, "episode_reward_max": -50.02913184951549, "episode_reward_min": -220.8774511041596, "episode_reward_mean": -102.69059082670414, "episode_len_mean": 510.49, "episodes_this_iter": 15, "episodes_timesteps_total": 51049, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-105.5069856173123, -103.24927721912911, -127.90938846092422, -104.26512175126311, -117.91406682675395, -59.86169437354865, -196.16729044471128, -109.26980316939142, -129.9180188763918, -63.25895245657913, -106.2592519929676, -113.49984367688931, -59.01075682234899, -58.68333346117596, -112.24022571933637, -220.8774511041596, -110.83403603542845, -123.49038735897342, -107.7140659441768, -111.72368771849698, -110.43258242979212, -101.1815814720653, -110.05341593973091, -109.18237713497629, -109.1734300020064, -110.7113465946, -113.43985880578867, -102.04390225636773, -110.49103486892767, -56.3570209189219, -107.79712370495872, -120.03100246530897, -110.56671918536784, -62.25563284729668, -106.96380009263754, -108.37035977688245, -50.02913184951549, -54.47221205594577, -119.7236814537539, -110.03314156073768, -104.69437728262507, -104.56267581639811, -54.141076347627276, -125.6565386443076, -58.734719450799794, -107.26860071577877, -113.88728998161294, -105.39712103131352, -104.61032969278159, -105.55543405189738, -94.69207191408589, -63.96502647039303, -111.21729339075027, -106.46517853673113, -105.50971071419741, -104.543976779071, -103.98708262562255, -106.85456126161975, -105.52015230913771, -110.34410659328972, -117.95443320296641, -116.52026042183675, -116.11903738848493, -59.16993945014352, -103.67691341047734, -110.22340051281515, -63.14091483816129, -107.25278824937902, -116.67541523982709, -60.32811049813404, -110.37014558175703, -106.88654560795612, -106.37628278559448, -105.90087862090145, -64.18428156733701, -203.20911796192976, -108.97736825882147, -112.8848333580047, -64.55263185197252, -62.03511045092715, -124.8183241031176, -61.42595226556003, -53.363377638731755, -108.92969663540089, -121.05462198823069, -90.53824864410774, -58.5035349681738, -109.90187249338503, -112.43772811047113, -111.49252700748667, -111.20310336533561, -98.53543142232927, -106.9659355833245, -113.62634108222463, -106.12998456388526, -108.69949044298754, -105.64094471606985, -107.0787436091397, -107.86320138770404, -111.84129532973965], "episode_lengths": [74, 58, 215, 72, 65, 1600, 1228, 53, 1600, 1600, 116, 58, 1600, 1600, 1600, 1554, 75, 110, 98, 71, 56, 60, 71, 83, 52, 48, 62, 63, 98, 1600, 76, 104, 41, 1600, 76, 50, 1600, 1600, 190, 110, 56, 73, 1600, 85, 1600, 62, 62, 52, 84, 37, 1600, 1600, 47, 62, 54, 51, 64, 77, 58, 63, 95, 101, 68, 1600, 81, 43, 1600, 38, 80, 1600, 58, 48, 1600, 47, 1600, 1439, 57, 90, 1600, 1600, 128, 1600, 1600, 73, 46, 1600, 1600, 74, 54, 86, 49, 1600, 75, 123, 95, 85, 60, 77, 46, 59]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3015133302987472, "mean_inference_ms": 1.025732313778059, "mean_action_processing_ms": 0.1976910570849787, "mean_env_wait_ms": 0.4092908420733788, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006055355072021484, "StateBufferConnector_ms": 0.004337787628173828, "ViewRequirementAgentConnector_ms": 0.11627769470214844}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 426.5623844349779, "num_env_steps_trained_throughput_per_sec": 426.5623844349779, "timesteps_total": 164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 164000, "timers": {"training_iteration_time_ms": 9756.52, "restore_workers_time_ms": 0.012, "training_step_time_ms": 9756.486, "sample_time_ms": 3661.767, "load_time_ms": 0.421, "load_throughput": 9492597.035, "learn_time_ms": 6086.311, "learn_throughput": 657.213, "synch_weights_time_ms": 7.467}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "done": false, "episodes_total": 271, "training_iteration": 41, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-07-50", "timestamp": 1714270070, "time_this_iter_s": 9.382174015045166, "time_total_s": 423.88668417930603, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 423.88668417930603, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 25.069230769230767, "ram_util_percent": 62.50769230769231}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.60392104489829, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6443377830198296, "policy_loss": -0.03340958816710339, "vf_loss": 2.6689433937111207, "vf_explained_var": 0.17548456416335156, "kl": 0.01304292539868512, "entropy": 6.280090672482727, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 38595.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "sampler_results": {"episode_reward_max": -50.02913184951549, "episode_reward_min": -220.8774511041596, "episode_reward_mean": -102.33350132980941, "episode_len_mean": 467.99, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 46799, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-59.01075682234899, -58.68333346117596, -112.24022571933637, -220.8774511041596, -110.83403603542845, -123.49038735897342, -107.7140659441768, -111.72368771849698, -110.43258242979212, -101.1815814720653, -110.05341593973091, -109.18237713497629, -109.1734300020064, -110.7113465946, -113.43985880578867, -102.04390225636773, -110.49103486892767, -56.3570209189219, -107.79712370495872, -120.03100246530897, -110.56671918536784, -62.25563284729668, -106.96380009263754, -108.37035977688245, -50.02913184951549, -54.47221205594577, -119.7236814537539, -110.03314156073768, -104.69437728262507, -104.56267581639811, -54.141076347627276, -125.6565386443076, -58.734719450799794, -107.26860071577877, -113.88728998161294, -105.39712103131352, -104.61032969278159, -105.55543405189738, -94.69207191408589, -63.96502647039303, -111.21729339075027, -106.46517853673113, -105.50971071419741, -104.543976779071, -103.98708262562255, -106.85456126161975, -105.52015230913771, -110.34410659328972, -117.95443320296641, -116.52026042183675, -116.11903738848493, -59.16993945014352, -103.67691341047734, -110.22340051281515, -63.14091483816129, -107.25278824937902, -116.67541523982709, -60.32811049813404, -110.37014558175703, -106.88654560795612, -106.37628278559448, -105.90087862090145, -64.18428156733701, -203.20911796192976, -108.97736825882147, -112.8848333580047, -64.55263185197252, -62.03511045092715, -124.8183241031176, -61.42595226556003, -53.363377638731755, -108.92969663540089, -121.05462198823069, -90.53824864410774, -58.5035349681738, -109.90187249338503, -112.43772811047113, -111.49252700748667, -111.20310336533561, -98.53543142232927, -106.9659355833245, -113.62634108222463, -106.12998456388526, -108.69949044298754, -105.64094471606985, -107.0787436091397, -107.86320138770404, -111.84129532973965, -112.86016110944563, -111.80238976557243, -112.03253556749536, -110.69271845383011, -113.28176382522658, -110.27023149123353, -113.73793326770266, -113.92354816624646, -107.7750883827967, -66.21922176056971, -112.26377994458936, -116.5113734416794], "episode_lengths": [1600, 1600, 1600, 1554, 75, 110, 98, 71, 56, 60, 71, 83, 52, 48, 62, 63, 98, 1600, 76, 104, 41, 1600, 76, 50, 1600, 1600, 190, 110, 56, 73, 1600, 85, 1600, 62, 62, 52, 84, 37, 1600, 1600, 47, 62, 54, 51, 64, 77, 58, 63, 95, 101, 68, 1600, 81, 43, 1600, 38, 80, 1600, 58, 48, 1600, 47, 1600, 1439, 57, 90, 1600, 1600, 128, 1600, 1600, 73, 46, 1600, 1600, 74, 54, 86, 49, 1600, 75, 123, 95, 85, 60, 77, 46, 59, 156, 95, 60, 51, 61, 115, 54, 72, 69, 1600, 78, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3010213285954453, "mean_inference_ms": 1.0238002887254594, "mean_action_processing_ms": 0.19732059259153695, "mean_env_wait_ms": 0.4083666529778223, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0059206485748291016, "StateBufferConnector_ms": 0.004244565963745117, "ViewRequirementAgentConnector_ms": 0.1148366928100586}}, "episode_reward_max": -50.02913184951549, "episode_reward_min": -220.8774511041596, "episode_reward_mean": -102.33350132980941, "episode_len_mean": 467.99, "episodes_this_iter": 12, "episodes_timesteps_total": 46799, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-59.01075682234899, -58.68333346117596, -112.24022571933637, -220.8774511041596, -110.83403603542845, -123.49038735897342, -107.7140659441768, -111.72368771849698, -110.43258242979212, -101.1815814720653, -110.05341593973091, -109.18237713497629, -109.1734300020064, -110.7113465946, -113.43985880578867, -102.04390225636773, -110.49103486892767, -56.3570209189219, -107.79712370495872, -120.03100246530897, -110.56671918536784, -62.25563284729668, -106.96380009263754, -108.37035977688245, -50.02913184951549, -54.47221205594577, -119.7236814537539, -110.03314156073768, -104.69437728262507, -104.56267581639811, -54.141076347627276, -125.6565386443076, -58.734719450799794, -107.26860071577877, -113.88728998161294, -105.39712103131352, -104.61032969278159, -105.55543405189738, -94.69207191408589, -63.96502647039303, -111.21729339075027, -106.46517853673113, -105.50971071419741, -104.543976779071, -103.98708262562255, -106.85456126161975, -105.52015230913771, -110.34410659328972, -117.95443320296641, -116.52026042183675, -116.11903738848493, -59.16993945014352, -103.67691341047734, -110.22340051281515, -63.14091483816129, -107.25278824937902, -116.67541523982709, -60.32811049813404, -110.37014558175703, -106.88654560795612, -106.37628278559448, -105.90087862090145, -64.18428156733701, -203.20911796192976, -108.97736825882147, -112.8848333580047, -64.55263185197252, -62.03511045092715, -124.8183241031176, -61.42595226556003, -53.363377638731755, -108.92969663540089, -121.05462198823069, -90.53824864410774, -58.5035349681738, -109.90187249338503, -112.43772811047113, -111.49252700748667, -111.20310336533561, -98.53543142232927, -106.9659355833245, -113.62634108222463, -106.12998456388526, -108.69949044298754, -105.64094471606985, -107.0787436091397, -107.86320138770404, -111.84129532973965, -112.86016110944563, -111.80238976557243, -112.03253556749536, -110.69271845383011, -113.28176382522658, -110.27023149123353, -113.73793326770266, -113.92354816624646, -107.7750883827967, -66.21922176056971, -112.26377994458936, -116.5113734416794], "episode_lengths": [1600, 1600, 1600, 1554, 75, 110, 98, 71, 56, 60, 71, 83, 52, 48, 62, 63, 98, 1600, 76, 104, 41, 1600, 76, 50, 1600, 1600, 190, 110, 56, 73, 1600, 85, 1600, 62, 62, 52, 84, 37, 1600, 1600, 47, 62, 54, 51, 64, 77, 58, 63, 95, 101, 68, 1600, 81, 43, 1600, 38, 80, 1600, 58, 48, 1600, 47, 1600, 1439, 57, 90, 1600, 1600, 128, 1600, 1600, 73, 46, 1600, 1600, 74, 54, 86, 49, 1600, 75, 123, 95, 85, 60, 77, 46, 59, 156, 95, 60, 51, 61, 115, 54, 72, 69, 1600, 78, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3010213285954453, "mean_inference_ms": 1.0238002887254594, "mean_action_processing_ms": 0.19732059259153695, "mean_env_wait_ms": 0.4083666529778223, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0059206485748291016, "StateBufferConnector_ms": 0.004244565963745117, "ViewRequirementAgentConnector_ms": 0.1148366928100586}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 428.2874486818581, "num_env_steps_trained_throughput_per_sec": 428.2874486818581, "timesteps_total": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 9710.286, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9710.252, "sample_time_ms": 3645.817, "load_time_ms": 0.426, "load_throughput": 9386380.217, "learn_time_ms": 6055.814, "learn_throughput": 660.522, "synch_weights_time_ms": 7.677}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "episodes_total": 283, "training_iteration": 42, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-08-00", "timestamp": 1714270080, "time_this_iter_s": 9.344150066375732, "time_total_s": 433.23083424568176, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 433.23083424568176, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 24.39285714285714, "ram_util_percent": 62.442857142857136}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.678304301282411, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.166336901340338, "policy_loss": -0.03396907844530639, "vf_loss": 3.1913108624838373, "vf_explained_var": 0.18379200716172495, "kl": 0.013326116685650148, "entropy": 7.352483370483562, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 39525.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "sampler_results": {"episode_reward_max": -50.02913184951549, "episode_reward_min": -203.20911796192976, "episode_reward_mean": -101.98873930893045, "episode_len_mean": 440.4, "episode_media": {}, "episodes_this_iter": 15, "episodes_timesteps_total": 44040, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-102.04390225636773, -110.49103486892767, -56.3570209189219, -107.79712370495872, -120.03100246530897, -110.56671918536784, -62.25563284729668, -106.96380009263754, -108.37035977688245, -50.02913184951549, -54.47221205594577, -119.7236814537539, -110.03314156073768, -104.69437728262507, -104.56267581639811, -54.141076347627276, -125.6565386443076, -58.734719450799794, -107.26860071577877, -113.88728998161294, -105.39712103131352, -104.61032969278159, -105.55543405189738, -94.69207191408589, -63.96502647039303, -111.21729339075027, -106.46517853673113, -105.50971071419741, -104.543976779071, -103.98708262562255, -106.85456126161975, -105.52015230913771, -110.34410659328972, -117.95443320296641, -116.52026042183675, -116.11903738848493, -59.16993945014352, -103.67691341047734, -110.22340051281515, -63.14091483816129, -107.25278824937902, -116.67541523982709, -60.32811049813404, -110.37014558175703, -106.88654560795612, -106.37628278559448, -105.90087862090145, -64.18428156733701, -203.20911796192976, -108.97736825882147, -112.8848333580047, -64.55263185197252, -62.03511045092715, -124.8183241031176, -61.42595226556003, -53.363377638731755, -108.92969663540089, -121.05462198823069, -90.53824864410774, -58.5035349681738, -109.90187249338503, -112.43772811047113, -111.49252700748667, -111.20310336533561, -98.53543142232927, -106.9659355833245, -113.62634108222463, -106.12998456388526, -108.69949044298754, -105.64094471606985, -107.0787436091397, -107.86320138770404, -111.84129532973965, -112.86016110944563, -111.80238976557243, -112.03253556749536, -110.69271845383011, -113.28176382522658, -110.27023149123353, -113.73793326770266, -113.92354816624646, -107.7750883827967, -66.21922176056971, -112.26377994458936, -116.5113734416794, -50.618513977153285, -103.99487027988894, -105.06891900899883, -126.94428606494392, -140.9447966452967, -110.52650568409575, -117.33568381134421, -111.71076670781152, -123.81420907253772, -62.35645416628753, -110.65595546768482, -114.42134048365554, -113.66934152454635, -124.27796856063102, -117.93272300028677], "episode_lengths": [63, 98, 1600, 76, 104, 41, 1600, 76, 50, 1600, 1600, 190, 110, 56, 73, 1600, 85, 1600, 62, 62, 52, 84, 37, 1600, 1600, 47, 62, 54, 51, 64, 77, 58, 63, 95, 101, 68, 1600, 81, 43, 1600, 38, 80, 1600, 58, 48, 1600, 47, 1600, 1439, 57, 90, 1600, 1600, 128, 1600, 1600, 73, 46, 1600, 1600, 74, 54, 86, 49, 1600, 75, 123, 95, 85, 60, 77, 46, 59, 156, 95, 60, 51, 61, 115, 54, 72, 69, 1600, 78, 78, 1600, 89, 66, 94, 221, 47, 91, 79, 83, 1600, 55, 63, 53, 140, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30048530524661027, "mean_inference_ms": 1.0203553585538203, "mean_action_processing_ms": 0.19670457821166693, "mean_env_wait_ms": 0.4075360415946838, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005606651306152344, "StateBufferConnector_ms": 0.004194498062133789, "ViewRequirementAgentConnector_ms": 0.11313462257385254}}, "episode_reward_max": -50.02913184951549, "episode_reward_min": -203.20911796192976, "episode_reward_mean": -101.98873930893045, "episode_len_mean": 440.4, "episodes_this_iter": 15, "episodes_timesteps_total": 44040, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-102.04390225636773, -110.49103486892767, -56.3570209189219, -107.79712370495872, -120.03100246530897, -110.56671918536784, -62.25563284729668, -106.96380009263754, -108.37035977688245, -50.02913184951549, -54.47221205594577, -119.7236814537539, -110.03314156073768, -104.69437728262507, -104.56267581639811, -54.141076347627276, -125.6565386443076, -58.734719450799794, -107.26860071577877, -113.88728998161294, -105.39712103131352, -104.61032969278159, -105.55543405189738, -94.69207191408589, -63.96502647039303, -111.21729339075027, -106.46517853673113, -105.50971071419741, -104.543976779071, -103.98708262562255, -106.85456126161975, -105.52015230913771, -110.34410659328972, -117.95443320296641, -116.52026042183675, -116.11903738848493, -59.16993945014352, -103.67691341047734, -110.22340051281515, -63.14091483816129, -107.25278824937902, -116.67541523982709, -60.32811049813404, -110.37014558175703, -106.88654560795612, -106.37628278559448, -105.90087862090145, -64.18428156733701, -203.20911796192976, -108.97736825882147, -112.8848333580047, -64.55263185197252, -62.03511045092715, -124.8183241031176, -61.42595226556003, -53.363377638731755, -108.92969663540089, -121.05462198823069, -90.53824864410774, -58.5035349681738, -109.90187249338503, -112.43772811047113, -111.49252700748667, -111.20310336533561, -98.53543142232927, -106.9659355833245, -113.62634108222463, -106.12998456388526, -108.69949044298754, -105.64094471606985, -107.0787436091397, -107.86320138770404, -111.84129532973965, -112.86016110944563, -111.80238976557243, -112.03253556749536, -110.69271845383011, -113.28176382522658, -110.27023149123353, -113.73793326770266, -113.92354816624646, -107.7750883827967, -66.21922176056971, -112.26377994458936, -116.5113734416794, -50.618513977153285, -103.99487027988894, -105.06891900899883, -126.94428606494392, -140.9447966452967, -110.52650568409575, -117.33568381134421, -111.71076670781152, -123.81420907253772, -62.35645416628753, -110.65595546768482, -114.42134048365554, -113.66934152454635, -124.27796856063102, -117.93272300028677], "episode_lengths": [63, 98, 1600, 76, 104, 41, 1600, 76, 50, 1600, 1600, 190, 110, 56, 73, 1600, 85, 1600, 62, 62, 52, 84, 37, 1600, 1600, 47, 62, 54, 51, 64, 77, 58, 63, 95, 101, 68, 1600, 81, 43, 1600, 38, 80, 1600, 58, 48, 1600, 47, 1600, 1439, 57, 90, 1600, 1600, 128, 1600, 1600, 73, 46, 1600, 1600, 74, 54, 86, 49, 1600, 75, 123, 95, 85, 60, 77, 46, 59, 156, 95, 60, 51, 61, 115, 54, 72, 69, 1600, 78, 78, 1600, 89, 66, 94, 221, 47, 91, 79, 83, 1600, 55, 63, 53, 140, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30048530524661027, "mean_inference_ms": 1.0203553585538203, "mean_action_processing_ms": 0.19670457821166693, "mean_env_wait_ms": 0.4075360415946838, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005606651306152344, "StateBufferConnector_ms": 0.004194498062133789, "ViewRequirementAgentConnector_ms": 0.11313462257385254}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 416.9949099537966, "num_env_steps_trained_throughput_per_sec": 416.9949099537966, "timesteps_total": 172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 172000, "timers": {"training_iteration_time_ms": 9726.862, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9726.828, "sample_time_ms": 3660.141, "load_time_ms": 0.429, "load_throughput": 9321193.4, "learn_time_ms": 6058.068, "learn_throughput": 660.276, "synch_weights_time_ms": 7.669}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "done": false, "episodes_total": 298, "training_iteration": 43, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-08-09", "timestamp": 1714270089, "time_this_iter_s": 9.596765041351318, "time_total_s": 442.8275992870331, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 442.8275992870331, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 28.884615384615383, "ram_util_percent": 62.39999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.00865256254391, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8470479366653072, "policy_loss": -0.024497831280478426, "vf_loss": 1.86669090495555, "vf_explained_var": 0.27019118596148745, "kl": 0.007192403687252982, "entropy": 6.528581826404858, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 40455.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "sampler_results": {"episode_reward_max": -50.02913184951549, "episode_reward_min": -203.20911796192976, "episode_reward_mean": -101.65012970827392, "episode_len_mean": 455.56, "episode_media": {}, "episodes_this_iter": 4, "episodes_timesteps_total": 45556, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-120.03100246530897, -110.56671918536784, -62.25563284729668, -106.96380009263754, -108.37035977688245, -50.02913184951549, -54.47221205594577, -119.7236814537539, -110.03314156073768, -104.69437728262507, -104.56267581639811, -54.141076347627276, -125.6565386443076, -58.734719450799794, -107.26860071577877, -113.88728998161294, -105.39712103131352, -104.61032969278159, -105.55543405189738, -94.69207191408589, -63.96502647039303, -111.21729339075027, -106.46517853673113, -105.50971071419741, -104.543976779071, -103.98708262562255, -106.85456126161975, -105.52015230913771, -110.34410659328972, -117.95443320296641, -116.52026042183675, -116.11903738848493, -59.16993945014352, -103.67691341047734, -110.22340051281515, -63.14091483816129, -107.25278824937902, -116.67541523982709, -60.32811049813404, -110.37014558175703, -106.88654560795612, -106.37628278559448, -105.90087862090145, -64.18428156733701, -203.20911796192976, -108.97736825882147, -112.8848333580047, -64.55263185197252, -62.03511045092715, -124.8183241031176, -61.42595226556003, -53.363377638731755, -108.92969663540089, -121.05462198823069, -90.53824864410774, -58.5035349681738, -109.90187249338503, -112.43772811047113, -111.49252700748667, -111.20310336533561, -98.53543142232927, -106.9659355833245, -113.62634108222463, -106.12998456388526, -108.69949044298754, -105.64094471606985, -107.0787436091397, -107.86320138770404, -111.84129532973965, -112.86016110944563, -111.80238976557243, -112.03253556749536, -110.69271845383011, -113.28176382522658, -110.27023149123353, -113.73793326770266, -113.92354816624646, -107.7750883827967, -66.21922176056971, -112.26377994458936, -116.5113734416794, -50.618513977153285, -103.99487027988894, -105.06891900899883, -126.94428606494392, -140.9447966452967, -110.52650568409575, -117.33568381134421, -111.71076670781152, -123.81420907253772, -62.35645416628753, -110.65595546768482, -114.42134048365554, -113.66934152454635, -124.27796856063102, -117.93272300028677, -61.627169076484996, -103.48841853707594, -61.51461389540502, -116.19792017456021], "episode_lengths": [104, 41, 1600, 76, 50, 1600, 1600, 190, 110, 56, 73, 1600, 85, 1600, 62, 62, 52, 84, 37, 1600, 1600, 47, 62, 54, 51, 64, 77, 58, 63, 95, 101, 68, 1600, 81, 43, 1600, 38, 80, 1600, 58, 48, 1600, 47, 1600, 1439, 57, 90, 1600, 1600, 128, 1600, 1600, 73, 46, 1600, 1600, 74, 54, 86, 49, 1600, 75, 123, 95, 85, 60, 77, 46, 59, 156, 95, 60, 51, 61, 115, 54, 72, 69, 1600, 78, 78, 1600, 89, 66, 94, 221, 47, 91, 79, 83, 1600, 55, 63, 53, 140, 100, 1600, 55, 1600, 98]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30028393709965284, "mean_inference_ms": 1.019481417068083, "mean_action_processing_ms": 0.1965386156844793, "mean_env_wait_ms": 0.40721921493214447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0056416988372802734, "StateBufferConnector_ms": 0.004197597503662109, "ViewRequirementAgentConnector_ms": 0.11295676231384277}}, "episode_reward_max": -50.02913184951549, "episode_reward_min": -203.20911796192976, "episode_reward_mean": -101.65012970827392, "episode_len_mean": 455.56, "episodes_this_iter": 4, "episodes_timesteps_total": 45556, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-120.03100246530897, -110.56671918536784, -62.25563284729668, -106.96380009263754, -108.37035977688245, -50.02913184951549, -54.47221205594577, -119.7236814537539, -110.03314156073768, -104.69437728262507, -104.56267581639811, -54.141076347627276, -125.6565386443076, -58.734719450799794, -107.26860071577877, -113.88728998161294, -105.39712103131352, -104.61032969278159, -105.55543405189738, -94.69207191408589, -63.96502647039303, -111.21729339075027, -106.46517853673113, -105.50971071419741, -104.543976779071, -103.98708262562255, -106.85456126161975, -105.52015230913771, -110.34410659328972, -117.95443320296641, -116.52026042183675, -116.11903738848493, -59.16993945014352, -103.67691341047734, -110.22340051281515, -63.14091483816129, -107.25278824937902, -116.67541523982709, -60.32811049813404, -110.37014558175703, -106.88654560795612, -106.37628278559448, -105.90087862090145, -64.18428156733701, -203.20911796192976, -108.97736825882147, -112.8848333580047, -64.55263185197252, -62.03511045092715, -124.8183241031176, -61.42595226556003, -53.363377638731755, -108.92969663540089, -121.05462198823069, -90.53824864410774, -58.5035349681738, -109.90187249338503, -112.43772811047113, -111.49252700748667, -111.20310336533561, -98.53543142232927, -106.9659355833245, -113.62634108222463, -106.12998456388526, -108.69949044298754, -105.64094471606985, -107.0787436091397, -107.86320138770404, -111.84129532973965, -112.86016110944563, -111.80238976557243, -112.03253556749536, -110.69271845383011, -113.28176382522658, -110.27023149123353, -113.73793326770266, -113.92354816624646, -107.7750883827967, -66.21922176056971, -112.26377994458936, -116.5113734416794, -50.618513977153285, -103.99487027988894, -105.06891900899883, -126.94428606494392, -140.9447966452967, -110.52650568409575, -117.33568381134421, -111.71076670781152, -123.81420907253772, -62.35645416628753, -110.65595546768482, -114.42134048365554, -113.66934152454635, -124.27796856063102, -117.93272300028677, -61.627169076484996, -103.48841853707594, -61.51461389540502, -116.19792017456021], "episode_lengths": [104, 41, 1600, 76, 50, 1600, 1600, 190, 110, 56, 73, 1600, 85, 1600, 62, 62, 52, 84, 37, 1600, 1600, 47, 62, 54, 51, 64, 77, 58, 63, 95, 101, 68, 1600, 81, 43, 1600, 38, 80, 1600, 58, 48, 1600, 47, 1600, 1439, 57, 90, 1600, 1600, 128, 1600, 1600, 73, 46, 1600, 1600, 74, 54, 86, 49, 1600, 75, 123, 95, 85, 60, 77, 46, 59, 156, 95, 60, 51, 61, 115, 54, 72, 69, 1600, 78, 78, 1600, 89, 66, 94, 221, 47, 91, 79, 83, 1600, 55, 63, 53, 140, 100, 1600, 55, 1600, 98]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30028393709965284, "mean_inference_ms": 1.019481417068083, "mean_action_processing_ms": 0.1965386156844793, "mean_env_wait_ms": 0.40721921493214447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0056416988372802734, "StateBufferConnector_ms": 0.004197597503662109, "ViewRequirementAgentConnector_ms": 0.11295676231384277}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 429.83206738569163, "num_env_steps_trained_throughput_per_sec": 429.83206738569163, "timesteps_total": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 9667.748, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9667.713, "sample_time_ms": 3620.816, "load_time_ms": 0.419, "load_throughput": 9556944.46, "learn_time_ms": 6038.067, "learn_throughput": 662.464, "synch_weights_time_ms": 7.849}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "episodes_total": 302, "training_iteration": 44, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-08-19", "timestamp": 1714270099, "time_this_iter_s": 9.310585975646973, "time_total_s": 452.13818526268005, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 452.13818526268005, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 23.69285714285714, "ram_util_percent": 62.39999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.273626384683835, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6336581485164452, "policy_loss": -0.026372457432475502, "vf_loss": 0.6562934774745216, "vf_explained_var": 0.42381844180886463, "kl": 0.0055364905914367145, "entropy": 5.214687944996742, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 41385.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": -50.02913184951549, "episode_reward_min": -203.20911796192976, "episode_reward_mean": -101.35127759471686, "episode_len_mean": 470.78, "episode_media": {}, "episodes_this_iter": 3, "episodes_timesteps_total": 47078, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-106.96380009263754, -108.37035977688245, -50.02913184951549, -54.47221205594577, -119.7236814537539, -110.03314156073768, -104.69437728262507, -104.56267581639811, -54.141076347627276, -125.6565386443076, -58.734719450799794, -107.26860071577877, -113.88728998161294, -105.39712103131352, -104.61032969278159, -105.55543405189738, -94.69207191408589, -63.96502647039303, -111.21729339075027, -106.46517853673113, -105.50971071419741, -104.543976779071, -103.98708262562255, -106.85456126161975, -105.52015230913771, -110.34410659328972, -117.95443320296641, -116.52026042183675, -116.11903738848493, -59.16993945014352, -103.67691341047734, -110.22340051281515, -63.14091483816129, -107.25278824937902, -116.67541523982709, -60.32811049813404, -110.37014558175703, -106.88654560795612, -106.37628278559448, -105.90087862090145, -64.18428156733701, -203.20911796192976, -108.97736825882147, -112.8848333580047, -64.55263185197252, -62.03511045092715, -124.8183241031176, -61.42595226556003, -53.363377638731755, -108.92969663540089, -121.05462198823069, -90.53824864410774, -58.5035349681738, -109.90187249338503, -112.43772811047113, -111.49252700748667, -111.20310336533561, -98.53543142232927, -106.9659355833245, -113.62634108222463, -106.12998456388526, -108.69949044298754, -105.64094471606985, -107.0787436091397, -107.86320138770404, -111.84129532973965, -112.86016110944563, -111.80238976557243, -112.03253556749536, -110.69271845383011, -113.28176382522658, -110.27023149123353, -113.73793326770266, -113.92354816624646, -107.7750883827967, -66.21922176056971, -112.26377994458936, -116.5113734416794, -50.618513977153285, -103.99487027988894, -105.06891900899883, -126.94428606494392, -140.9447966452967, -110.52650568409575, -117.33568381134421, -111.71076670781152, -123.81420907253772, -62.35645416628753, -110.65595546768482, -114.42134048365554, -113.66934152454635, -124.27796856063102, -117.93272300028677, -61.627169076484996, -103.48841853707594, -61.51461389540502, -116.19792017456021, -50.81436145182953, -109.07829168847451, -103.07549000195766], "episode_lengths": [76, 50, 1600, 1600, 190, 110, 56, 73, 1600, 85, 1600, 62, 62, 52, 84, 37, 1600, 1600, 47, 62, 54, 51, 64, 77, 58, 63, 95, 101, 68, 1600, 81, 43, 1600, 38, 80, 1600, 58, 48, 1600, 47, 1600, 1439, 57, 90, 1600, 1600, 128, 1600, 1600, 73, 46, 1600, 1600, 74, 54, 86, 49, 1600, 75, 123, 95, 85, 60, 77, 46, 59, 156, 95, 60, 51, 61, 115, 54, 72, 69, 1600, 78, 78, 1600, 89, 66, 94, 221, 47, 91, 79, 83, 1600, 55, 63, 53, 140, 100, 1600, 55, 1600, 98, 1600, 67, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3001711725555059, "mean_inference_ms": 1.01896357527411, "mean_action_processing_ms": 0.1964414643217144, "mean_env_wait_ms": 0.4070259495652076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00561976432800293, "StateBufferConnector_ms": 0.004192829132080078, "ViewRequirementAgentConnector_ms": 0.11279940605163574}}, "episode_reward_max": -50.02913184951549, "episode_reward_min": -203.20911796192976, "episode_reward_mean": -101.35127759471686, "episode_len_mean": 470.78, "episodes_this_iter": 3, "episodes_timesteps_total": 47078, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-106.96380009263754, -108.37035977688245, -50.02913184951549, -54.47221205594577, -119.7236814537539, -110.03314156073768, -104.69437728262507, -104.56267581639811, -54.141076347627276, -125.6565386443076, -58.734719450799794, -107.26860071577877, -113.88728998161294, -105.39712103131352, -104.61032969278159, -105.55543405189738, -94.69207191408589, -63.96502647039303, -111.21729339075027, -106.46517853673113, -105.50971071419741, -104.543976779071, -103.98708262562255, -106.85456126161975, -105.52015230913771, -110.34410659328972, -117.95443320296641, -116.52026042183675, -116.11903738848493, -59.16993945014352, -103.67691341047734, -110.22340051281515, -63.14091483816129, -107.25278824937902, -116.67541523982709, -60.32811049813404, -110.37014558175703, -106.88654560795612, -106.37628278559448, -105.90087862090145, -64.18428156733701, -203.20911796192976, -108.97736825882147, -112.8848333580047, -64.55263185197252, -62.03511045092715, -124.8183241031176, -61.42595226556003, -53.363377638731755, -108.92969663540089, -121.05462198823069, -90.53824864410774, -58.5035349681738, -109.90187249338503, -112.43772811047113, -111.49252700748667, -111.20310336533561, -98.53543142232927, -106.9659355833245, -113.62634108222463, -106.12998456388526, -108.69949044298754, -105.64094471606985, -107.0787436091397, -107.86320138770404, -111.84129532973965, -112.86016110944563, -111.80238976557243, -112.03253556749536, -110.69271845383011, -113.28176382522658, -110.27023149123353, -113.73793326770266, -113.92354816624646, -107.7750883827967, -66.21922176056971, -112.26377994458936, -116.5113734416794, -50.618513977153285, -103.99487027988894, -105.06891900899883, -126.94428606494392, -140.9447966452967, -110.52650568409575, -117.33568381134421, -111.71076670781152, -123.81420907253772, -62.35645416628753, -110.65595546768482, -114.42134048365554, -113.66934152454635, -124.27796856063102, -117.93272300028677, -61.627169076484996, -103.48841853707594, -61.51461389540502, -116.19792017456021, -50.81436145182953, -109.07829168847451, -103.07549000195766], "episode_lengths": [76, 50, 1600, 1600, 190, 110, 56, 73, 1600, 85, 1600, 62, 62, 52, 84, 37, 1600, 1600, 47, 62, 54, 51, 64, 77, 58, 63, 95, 101, 68, 1600, 81, 43, 1600, 38, 80, 1600, 58, 48, 1600, 47, 1600, 1439, 57, 90, 1600, 1600, 128, 1600, 1600, 73, 46, 1600, 1600, 74, 54, 86, 49, 1600, 75, 123, 95, 85, 60, 77, 46, 59, 156, 95, 60, 51, 61, 115, 54, 72, 69, 1600, 78, 78, 1600, 89, 66, 94, 221, 47, 91, 79, 83, 1600, 55, 63, 53, 140, 100, 1600, 55, 1600, 98, 1600, 67, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3001711725555059, "mean_inference_ms": 1.01896357527411, "mean_action_processing_ms": 0.1964414643217144, "mean_env_wait_ms": 0.4070259495652076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00561976432800293, "StateBufferConnector_ms": 0.004192829132080078, "ViewRequirementAgentConnector_ms": 0.11279940605163574}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 345.28403686648386, "num_env_steps_trained_throughput_per_sec": 345.28403686648386, "timesteps_total": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 9868.786, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9868.752, "sample_time_ms": 3706.526, "load_time_ms": 0.447, "load_throughput": 8954056.679, "learn_time_ms": 6153.477, "learn_throughput": 650.039, "synch_weights_time_ms": 7.741}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 305, "training_iteration": 45, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-08-30", "timestamp": 1714270110, "time_this_iter_s": 11.589135885238647, "time_total_s": 463.7273211479187, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 463.7273211479187, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 42.26875, "ram_util_percent": 63.5625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.701670502334514, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0136937672309876, "policy_loss": -0.031530250993467145, "vf_loss": 2.0370380900880343, "vf_explained_var": 0.26959330042203267, "kl": 0.012127325070347259, "entropy": 6.492113927615586, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 42315.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "sampler_results": {"episode_reward_max": -50.618513977153285, "episode_reward_min": -203.20911796192976, "episode_reward_mean": -102.06531625692944, "episode_len_mean": 454.29, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 45429, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113.88728998161294, -105.39712103131352, -104.61032969278159, -105.55543405189738, -94.69207191408589, -63.96502647039303, -111.21729339075027, -106.46517853673113, -105.50971071419741, -104.543976779071, -103.98708262562255, -106.85456126161975, -105.52015230913771, -110.34410659328972, -117.95443320296641, -116.52026042183675, -116.11903738848493, -59.16993945014352, -103.67691341047734, -110.22340051281515, -63.14091483816129, -107.25278824937902, -116.67541523982709, -60.32811049813404, -110.37014558175703, -106.88654560795612, -106.37628278559448, -105.90087862090145, -64.18428156733701, -203.20911796192976, -108.97736825882147, -112.8848333580047, -64.55263185197252, -62.03511045092715, -124.8183241031176, -61.42595226556003, -53.363377638731755, -108.92969663540089, -121.05462198823069, -90.53824864410774, -58.5035349681738, -109.90187249338503, -112.43772811047113, -111.49252700748667, -111.20310336533561, -98.53543142232927, -106.9659355833245, -113.62634108222463, -106.12998456388526, -108.69949044298754, -105.64094471606985, -107.0787436091397, -107.86320138770404, -111.84129532973965, -112.86016110944563, -111.80238976557243, -112.03253556749536, -110.69271845383011, -113.28176382522658, -110.27023149123353, -113.73793326770266, -113.92354816624646, -107.7750883827967, -66.21922176056971, -112.26377994458936, -116.5113734416794, -50.618513977153285, -103.99487027988894, -105.06891900899883, -126.94428606494392, -140.9447966452967, -110.52650568409575, -117.33568381134421, -111.71076670781152, -123.81420907253772, -62.35645416628753, -110.65595546768482, -114.42134048365554, -113.66934152454635, -124.27796856063102, -117.93272300028677, -61.627169076484996, -103.48841853707594, -61.51461389540502, -116.19792017456021, -50.81436145182953, -109.07829168847451, -103.07549000195766, -64.25804456847656, -118.85135961002237, -62.204218074022556, -108.36222978971713, -113.2576647131263, -58.612367824017234, -111.14987005812489, -104.07663072965232, -110.62842275988932, -112.2538872121858, -106.57118158426944, -105.82830434476335], "episode_lengths": [62, 52, 84, 37, 1600, 1600, 47, 62, 54, 51, 64, 77, 58, 63, 95, 101, 68, 1600, 81, 43, 1600, 38, 80, 1600, 58, 48, 1600, 47, 1600, 1439, 57, 90, 1600, 1600, 128, 1600, 1600, 73, 46, 1600, 1600, 74, 54, 86, 49, 1600, 75, 123, 95, 85, 60, 77, 46, 59, 156, 95, 60, 51, 61, 115, 54, 72, 69, 1600, 78, 78, 1600, 89, 66, 94, 221, 47, 91, 79, 83, 1600, 55, 63, 53, 140, 100, 1600, 55, 1600, 98, 1600, 67, 1600, 1600, 117, 1600, 130, 62, 1600, 70, 61, 60, 43, 48, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2995790032367275, "mean_inference_ms": 1.017084788020221, "mean_action_processing_ms": 0.19606102049357532, "mean_env_wait_ms": 0.4060512717870867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005427837371826172, "StateBufferConnector_ms": 0.0041849613189697266, "ViewRequirementAgentConnector_ms": 0.11216235160827637}}, "episode_reward_max": -50.618513977153285, "episode_reward_min": -203.20911796192976, "episode_reward_mean": -102.06531625692944, "episode_len_mean": 454.29, "episodes_this_iter": 12, "episodes_timesteps_total": 45429, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113.88728998161294, -105.39712103131352, -104.61032969278159, -105.55543405189738, -94.69207191408589, -63.96502647039303, -111.21729339075027, -106.46517853673113, -105.50971071419741, -104.543976779071, -103.98708262562255, -106.85456126161975, -105.52015230913771, -110.34410659328972, -117.95443320296641, -116.52026042183675, -116.11903738848493, -59.16993945014352, -103.67691341047734, -110.22340051281515, -63.14091483816129, -107.25278824937902, -116.67541523982709, -60.32811049813404, -110.37014558175703, -106.88654560795612, -106.37628278559448, -105.90087862090145, -64.18428156733701, -203.20911796192976, -108.97736825882147, -112.8848333580047, -64.55263185197252, -62.03511045092715, -124.8183241031176, -61.42595226556003, -53.363377638731755, -108.92969663540089, -121.05462198823069, -90.53824864410774, -58.5035349681738, -109.90187249338503, -112.43772811047113, -111.49252700748667, -111.20310336533561, -98.53543142232927, -106.9659355833245, -113.62634108222463, -106.12998456388526, -108.69949044298754, -105.64094471606985, -107.0787436091397, -107.86320138770404, -111.84129532973965, -112.86016110944563, -111.80238976557243, -112.03253556749536, -110.69271845383011, -113.28176382522658, -110.27023149123353, -113.73793326770266, -113.92354816624646, -107.7750883827967, -66.21922176056971, -112.26377994458936, -116.5113734416794, -50.618513977153285, -103.99487027988894, -105.06891900899883, -126.94428606494392, -140.9447966452967, -110.52650568409575, -117.33568381134421, -111.71076670781152, -123.81420907253772, -62.35645416628753, -110.65595546768482, -114.42134048365554, -113.66934152454635, -124.27796856063102, -117.93272300028677, -61.627169076484996, -103.48841853707594, -61.51461389540502, -116.19792017456021, -50.81436145182953, -109.07829168847451, -103.07549000195766, -64.25804456847656, -118.85135961002237, -62.204218074022556, -108.36222978971713, -113.2576647131263, -58.612367824017234, -111.14987005812489, -104.07663072965232, -110.62842275988932, -112.2538872121858, -106.57118158426944, -105.82830434476335], "episode_lengths": [62, 52, 84, 37, 1600, 1600, 47, 62, 54, 51, 64, 77, 58, 63, 95, 101, 68, 1600, 81, 43, 1600, 38, 80, 1600, 58, 48, 1600, 47, 1600, 1439, 57, 90, 1600, 1600, 128, 1600, 1600, 73, 46, 1600, 1600, 74, 54, 86, 49, 1600, 75, 123, 95, 85, 60, 77, 46, 59, 156, 95, 60, 51, 61, 115, 54, 72, 69, 1600, 78, 78, 1600, 89, 66, 94, 221, 47, 91, 79, 83, 1600, 55, 63, 53, 140, 100, 1600, 55, 1600, 98, 1600, 67, 1600, 1600, 117, 1600, 130, 62, 1600, 70, 61, 60, 43, 48, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2995790032367275, "mean_inference_ms": 1.017084788020221, "mean_action_processing_ms": 0.19606102049357532, "mean_env_wait_ms": 0.4060512717870867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005427837371826172, "StateBufferConnector_ms": 0.0041849613189697266, "ViewRequirementAgentConnector_ms": 0.11216235160827637}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 409.7816104876754, "num_env_steps_trained_throughput_per_sec": 409.7816104876754, "timesteps_total": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 9805.148, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9805.114, "sample_time_ms": 3687.666, "load_time_ms": 0.456, "load_throughput": 8777908.23, "learn_time_ms": 6108.659, "learn_throughput": 654.808, "synch_weights_time_ms": 7.776}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "episodes_total": 317, "training_iteration": 46, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-08-40", "timestamp": 1714270120, "time_this_iter_s": 9.766093015670776, "time_total_s": 473.4934141635895, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 473.4934141635895, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 28.835714285714285, "ram_util_percent": 64.20000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.772932597642304, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8683416592318975, "policy_loss": -0.031473754939212596, "vf_loss": 1.8935843489943973, "vf_explained_var": 0.21267880579476717, "kl": 0.009231215534421203, "entropy": 6.542047378068329, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 43245.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "sampler_results": {"episode_reward_max": -50.618513977153285, "episode_reward_min": -203.20911796192976, "episode_reward_mean": -101.88952602790809, "episode_len_mean": 455.91, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 45591, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-106.85456126161975, -105.52015230913771, -110.34410659328972, -117.95443320296641, -116.52026042183675, -116.11903738848493, -59.16993945014352, -103.67691341047734, -110.22340051281515, -63.14091483816129, -107.25278824937902, -116.67541523982709, -60.32811049813404, -110.37014558175703, -106.88654560795612, -106.37628278559448, -105.90087862090145, -64.18428156733701, -203.20911796192976, -108.97736825882147, -112.8848333580047, -64.55263185197252, -62.03511045092715, -124.8183241031176, -61.42595226556003, -53.363377638731755, -108.92969663540089, -121.05462198823069, -90.53824864410774, -58.5035349681738, -109.90187249338503, -112.43772811047113, -111.49252700748667, -111.20310336533561, -98.53543142232927, -106.9659355833245, -113.62634108222463, -106.12998456388526, -108.69949044298754, -105.64094471606985, -107.0787436091397, -107.86320138770404, -111.84129532973965, -112.86016110944563, -111.80238976557243, -112.03253556749536, -110.69271845383011, -113.28176382522658, -110.27023149123353, -113.73793326770266, -113.92354816624646, -107.7750883827967, -66.21922176056971, -112.26377994458936, -116.5113734416794, -50.618513977153285, -103.99487027988894, -105.06891900899883, -126.94428606494392, -140.9447966452967, -110.52650568409575, -117.33568381134421, -111.71076670781152, -123.81420907253772, -62.35645416628753, -110.65595546768482, -114.42134048365554, -113.66934152454635, -124.27796856063102, -117.93272300028677, -61.627169076484996, -103.48841853707594, -61.51461389540502, -116.19792017456021, -50.81436145182953, -109.07829168847451, -103.07549000195766, -64.25804456847656, -118.85135961002237, -62.204218074022556, -108.36222978971713, -113.2576647131263, -58.612367824017234, -111.14987005812489, -104.07663072965232, -110.62842275988932, -112.2538872121858, -106.57118158426944, -105.82830434476335, -110.95634334195344, -109.56373581414856, -56.23947399006858, -116.85552653791072, -104.38372309493336, -52.368364470086334, -115.62106012177095, -108.31611798111535, -102.72003529074168, -118.37180613566127, -106.85530550793125], "episode_lengths": [77, 58, 63, 95, 101, 68, 1600, 81, 43, 1600, 38, 80, 1600, 58, 48, 1600, 47, 1600, 1439, 57, 90, 1600, 1600, 128, 1600, 1600, 73, 46, 1600, 1600, 74, 54, 86, 49, 1600, 75, 123, 95, 85, 60, 77, 46, 59, 156, 95, 60, 51, 61, 115, 54, 72, 69, 1600, 78, 78, 1600, 89, 66, 94, 221, 47, 91, 79, 83, 1600, 55, 63, 53, 140, 100, 1600, 55, 1600, 98, 1600, 67, 1600, 1600, 117, 1600, 130, 62, 1600, 70, 61, 60, 43, 48, 62, 86, 49, 1600, 80, 88, 1600, 58, 80, 86, 99, 49]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2988822697658983, "mean_inference_ms": 1.0159327911709735, "mean_action_processing_ms": 0.19577479075525323, "mean_env_wait_ms": 0.4048841137563843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005381107330322266, "StateBufferConnector_ms": 0.004223823547363281, "ViewRequirementAgentConnector_ms": 0.11174774169921875}}, "episode_reward_max": -50.618513977153285, "episode_reward_min": -203.20911796192976, "episode_reward_mean": -101.88952602790809, "episode_len_mean": 455.91, "episodes_this_iter": 11, "episodes_timesteps_total": 45591, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-106.85456126161975, -105.52015230913771, -110.34410659328972, -117.95443320296641, -116.52026042183675, -116.11903738848493, -59.16993945014352, -103.67691341047734, -110.22340051281515, -63.14091483816129, -107.25278824937902, -116.67541523982709, -60.32811049813404, -110.37014558175703, -106.88654560795612, -106.37628278559448, -105.90087862090145, -64.18428156733701, -203.20911796192976, -108.97736825882147, -112.8848333580047, -64.55263185197252, -62.03511045092715, -124.8183241031176, -61.42595226556003, -53.363377638731755, -108.92969663540089, -121.05462198823069, -90.53824864410774, -58.5035349681738, -109.90187249338503, -112.43772811047113, -111.49252700748667, -111.20310336533561, -98.53543142232927, -106.9659355833245, -113.62634108222463, -106.12998456388526, -108.69949044298754, -105.64094471606985, -107.0787436091397, -107.86320138770404, -111.84129532973965, -112.86016110944563, -111.80238976557243, -112.03253556749536, -110.69271845383011, -113.28176382522658, -110.27023149123353, -113.73793326770266, -113.92354816624646, -107.7750883827967, -66.21922176056971, -112.26377994458936, -116.5113734416794, -50.618513977153285, -103.99487027988894, -105.06891900899883, -126.94428606494392, -140.9447966452967, -110.52650568409575, -117.33568381134421, -111.71076670781152, -123.81420907253772, -62.35645416628753, -110.65595546768482, -114.42134048365554, -113.66934152454635, -124.27796856063102, -117.93272300028677, -61.627169076484996, -103.48841853707594, -61.51461389540502, -116.19792017456021, -50.81436145182953, -109.07829168847451, -103.07549000195766, -64.25804456847656, -118.85135961002237, -62.204218074022556, -108.36222978971713, -113.2576647131263, -58.612367824017234, -111.14987005812489, -104.07663072965232, -110.62842275988932, -112.2538872121858, -106.57118158426944, -105.82830434476335, -110.95634334195344, -109.56373581414856, -56.23947399006858, -116.85552653791072, -104.38372309493336, -52.368364470086334, -115.62106012177095, -108.31611798111535, -102.72003529074168, -118.37180613566127, -106.85530550793125], "episode_lengths": [77, 58, 63, 95, 101, 68, 1600, 81, 43, 1600, 38, 80, 1600, 58, 48, 1600, 47, 1600, 1439, 57, 90, 1600, 1600, 128, 1600, 1600, 73, 46, 1600, 1600, 74, 54, 86, 49, 1600, 75, 123, 95, 85, 60, 77, 46, 59, 156, 95, 60, 51, 61, 115, 54, 72, 69, 1600, 78, 78, 1600, 89, 66, 94, 221, 47, 91, 79, 83, 1600, 55, 63, 53, 140, 100, 1600, 55, 1600, 98, 1600, 67, 1600, 1600, 117, 1600, 130, 62, 1600, 70, 61, 60, 43, 48, 62, 86, 49, 1600, 80, 88, 1600, 58, 80, 86, 99, 49]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2988822697658983, "mean_inference_ms": 1.0159327911709735, "mean_action_processing_ms": 0.19577479075525323, "mean_env_wait_ms": 0.4048841137563843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005381107330322266, "StateBufferConnector_ms": 0.004223823547363281, "ViewRequirementAgentConnector_ms": 0.11174774169921875}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 402.9114050845819, "num_env_steps_trained_throughput_per_sec": 402.9114050845819, "timesteps_total": 188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 188000, "timers": {"training_iteration_time_ms": 9754.212, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9754.177, "sample_time_ms": 3633.623, "load_time_ms": 0.453, "load_throughput": 8824076.158, "learn_time_ms": 6111.566, "learn_throughput": 654.497, "synch_weights_time_ms": 7.967}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "done": false, "episodes_total": 328, "training_iteration": 47, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-08-50", "timestamp": 1714270130, "time_this_iter_s": 9.934185981750488, "time_total_s": 483.42760014533997, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 483.42760014533997, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 30.12857142857143, "ram_util_percent": 64.04285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.832402146118943, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7118832644307986, "policy_loss": -0.050742969385558556, "vf_loss": 1.7565519803073457, "vf_explained_var": 0.26647517033802565, "kl": 0.008998881817536879, "entropy": 8.684174618669735, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 44175.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "sampler_results": {"episode_reward_max": -50.618513977153285, "episode_reward_min": -203.20911796192976, "episode_reward_mean": -101.58987894903474, "episode_len_mean": 470.19, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 47019, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-107.25278824937902, -116.67541523982709, -60.32811049813404, -110.37014558175703, -106.88654560795612, -106.37628278559448, -105.90087862090145, -64.18428156733701, -203.20911796192976, -108.97736825882147, -112.8848333580047, -64.55263185197252, -62.03511045092715, -124.8183241031176, -61.42595226556003, -53.363377638731755, -108.92969663540089, -121.05462198823069, -90.53824864410774, -58.5035349681738, -109.90187249338503, -112.43772811047113, -111.49252700748667, -111.20310336533561, -98.53543142232927, -106.9659355833245, -113.62634108222463, -106.12998456388526, -108.69949044298754, -105.64094471606985, -107.0787436091397, -107.86320138770404, -111.84129532973965, -112.86016110944563, -111.80238976557243, -112.03253556749536, -110.69271845383011, -113.28176382522658, -110.27023149123353, -113.73793326770266, -113.92354816624646, -107.7750883827967, -66.21922176056971, -112.26377994458936, -116.5113734416794, -50.618513977153285, -103.99487027988894, -105.06891900899883, -126.94428606494392, -140.9447966452967, -110.52650568409575, -117.33568381134421, -111.71076670781152, -123.81420907253772, -62.35645416628753, -110.65595546768482, -114.42134048365554, -113.66934152454635, -124.27796856063102, -117.93272300028677, -61.627169076484996, -103.48841853707594, -61.51461389540502, -116.19792017456021, -50.81436145182953, -109.07829168847451, -103.07549000195766, -64.25804456847656, -118.85135961002237, -62.204218074022556, -108.36222978971713, -113.2576647131263, -58.612367824017234, -111.14987005812489, -104.07663072965232, -110.62842275988932, -112.2538872121858, -106.57118158426944, -105.82830434476335, -110.95634334195344, -109.56373581414856, -56.23947399006858, -116.85552653791072, -104.38372309493336, -52.368364470086334, -115.62106012177095, -108.31611798111535, -102.72003529074168, -118.37180613566127, -106.85530550793125, -108.87759537766068, -107.08720459702114, -55.391051035300485, -113.07199897285862, -106.09685436874007, -109.34628087357184, -104.92284774636104, -104.96873230664619, -66.89588098845384, -102.90056523498583], "episode_lengths": [38, 80, 1600, 58, 48, 1600, 47, 1600, 1439, 57, 90, 1600, 1600, 128, 1600, 1600, 73, 46, 1600, 1600, 74, 54, 86, 49, 1600, 75, 123, 95, 85, 60, 77, 46, 59, 156, 95, 60, 51, 61, 115, 54, 72, 69, 1600, 78, 78, 1600, 89, 66, 94, 221, 47, 91, 79, 83, 1600, 55, 63, 53, 140, 100, 1600, 55, 1600, 98, 1600, 67, 1600, 1600, 117, 1600, 130, 62, 1600, 70, 61, 60, 43, 48, 62, 86, 49, 1600, 80, 88, 1600, 58, 80, 86, 99, 49, 1600, 57, 1600, 64, 53, 73, 65, 48, 1600, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29826066039849414, "mean_inference_ms": 1.0151413551511352, "mean_action_processing_ms": 0.1955559292574335, "mean_env_wait_ms": 0.40384354699112424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005509138107299805, "StateBufferConnector_ms": 0.004331350326538086, "ViewRequirementAgentConnector_ms": 0.11306476593017578}}, "episode_reward_max": -50.618513977153285, "episode_reward_min": -203.20911796192976, "episode_reward_mean": -101.58987894903474, "episode_len_mean": 470.19, "episodes_this_iter": 10, "episodes_timesteps_total": 47019, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-107.25278824937902, -116.67541523982709, -60.32811049813404, -110.37014558175703, -106.88654560795612, -106.37628278559448, -105.90087862090145, -64.18428156733701, -203.20911796192976, -108.97736825882147, -112.8848333580047, -64.55263185197252, -62.03511045092715, -124.8183241031176, -61.42595226556003, -53.363377638731755, -108.92969663540089, -121.05462198823069, -90.53824864410774, -58.5035349681738, -109.90187249338503, -112.43772811047113, -111.49252700748667, -111.20310336533561, -98.53543142232927, -106.9659355833245, -113.62634108222463, -106.12998456388526, -108.69949044298754, -105.64094471606985, -107.0787436091397, -107.86320138770404, -111.84129532973965, -112.86016110944563, -111.80238976557243, -112.03253556749536, -110.69271845383011, -113.28176382522658, -110.27023149123353, -113.73793326770266, -113.92354816624646, -107.7750883827967, -66.21922176056971, -112.26377994458936, -116.5113734416794, -50.618513977153285, -103.99487027988894, -105.06891900899883, -126.94428606494392, -140.9447966452967, -110.52650568409575, -117.33568381134421, -111.71076670781152, -123.81420907253772, -62.35645416628753, -110.65595546768482, -114.42134048365554, -113.66934152454635, -124.27796856063102, -117.93272300028677, -61.627169076484996, -103.48841853707594, -61.51461389540502, -116.19792017456021, -50.81436145182953, -109.07829168847451, -103.07549000195766, -64.25804456847656, -118.85135961002237, -62.204218074022556, -108.36222978971713, -113.2576647131263, -58.612367824017234, -111.14987005812489, -104.07663072965232, -110.62842275988932, -112.2538872121858, -106.57118158426944, -105.82830434476335, -110.95634334195344, -109.56373581414856, -56.23947399006858, -116.85552653791072, -104.38372309493336, -52.368364470086334, -115.62106012177095, -108.31611798111535, -102.72003529074168, -118.37180613566127, -106.85530550793125, -108.87759537766068, -107.08720459702114, -55.391051035300485, -113.07199897285862, -106.09685436874007, -109.34628087357184, -104.92284774636104, -104.96873230664619, -66.89588098845384, -102.90056523498583], "episode_lengths": [38, 80, 1600, 58, 48, 1600, 47, 1600, 1439, 57, 90, 1600, 1600, 128, 1600, 1600, 73, 46, 1600, 1600, 74, 54, 86, 49, 1600, 75, 123, 95, 85, 60, 77, 46, 59, 156, 95, 60, 51, 61, 115, 54, 72, 69, 1600, 78, 78, 1600, 89, 66, 94, 221, 47, 91, 79, 83, 1600, 55, 63, 53, 140, 100, 1600, 55, 1600, 98, 1600, 67, 1600, 1600, 117, 1600, 130, 62, 1600, 70, 61, 60, 43, 48, 62, 86, 49, 1600, 80, 88, 1600, 58, 80, 86, 99, 49, 1600, 57, 1600, 64, 53, 73, 65, 48, 1600, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29826066039849414, "mean_inference_ms": 1.0151413551511352, "mean_action_processing_ms": 0.1955559292574335, "mean_env_wait_ms": 0.40384354699112424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005509138107299805, "StateBufferConnector_ms": 0.004331350326538086, "ViewRequirementAgentConnector_ms": 0.11306476593017578}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 369.5173294061968, "num_env_steps_trained_throughput_per_sec": 369.5173294061968, "timesteps_total": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 9859.572, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9859.537, "sample_time_ms": 3670.286, "load_time_ms": 0.441, "load_throughput": 9061907.745, "learn_time_ms": 6180.314, "learn_throughput": 647.216, "synch_weights_time_ms": 7.942}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "episodes_total": 338, "training_iteration": 48, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-09-01", "timestamp": 1714270141, "time_this_iter_s": 10.83128309249878, "time_total_s": 494.25888323783875, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 494.25888323783875, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 35.70625, "ram_util_percent": 63.912499999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.251238920098992, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3135597798953293, "policy_loss": -0.03383731522387074, "vf_loss": 2.3402549887476587, "vf_explained_var": 0.20177117111862347, "kl": 0.010580899853695024, "entropy": 6.570927518157549, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 45105.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "sampler_results": {"episode_reward_max": -50.618513977153285, "episode_reward_min": -150.6667931829816, "episode_reward_mean": -101.03533986548497, "episode_len_mean": 447.78, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 44778, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-64.55263185197252, -62.03511045092715, -124.8183241031176, -61.42595226556003, -53.363377638731755, -108.92969663540089, -121.05462198823069, -90.53824864410774, -58.5035349681738, -109.90187249338503, -112.43772811047113, -111.49252700748667, -111.20310336533561, -98.53543142232927, -106.9659355833245, -113.62634108222463, -106.12998456388526, -108.69949044298754, -105.64094471606985, -107.0787436091397, -107.86320138770404, -111.84129532973965, -112.86016110944563, -111.80238976557243, -112.03253556749536, -110.69271845383011, -113.28176382522658, -110.27023149123353, -113.73793326770266, -113.92354816624646, -107.7750883827967, -66.21922176056971, -112.26377994458936, -116.5113734416794, -50.618513977153285, -103.99487027988894, -105.06891900899883, -126.94428606494392, -140.9447966452967, -110.52650568409575, -117.33568381134421, -111.71076670781152, -123.81420907253772, -62.35645416628753, -110.65595546768482, -114.42134048365554, -113.66934152454635, -124.27796856063102, -117.93272300028677, -61.627169076484996, -103.48841853707594, -61.51461389540502, -116.19792017456021, -50.81436145182953, -109.07829168847451, -103.07549000195766, -64.25804456847656, -118.85135961002237, -62.204218074022556, -108.36222978971713, -113.2576647131263, -58.612367824017234, -111.14987005812489, -104.07663072965232, -110.62842275988932, -112.2538872121858, -106.57118158426944, -105.82830434476335, -110.95634334195344, -109.56373581414856, -56.23947399006858, -116.85552653791072, -104.38372309493336, -52.368364470086334, -115.62106012177095, -108.31611798111535, -102.72003529074168, -118.37180613566127, -106.85530550793125, -108.87759537766068, -107.08720459702114, -55.391051035300485, -113.07199897285862, -106.09685436874007, -109.34628087357184, -104.92284774636104, -104.96873230664619, -66.89588098845384, -102.90056523498583, -150.6667931829816, -111.10262177492368, -111.25390494354566, -52.17933990054772, -110.0695654446644, -114.08587793047664, -53.982381587766156, -117.56675032269148, -111.32237252081185, -108.99697453491018, -106.3652772313431], "episode_lengths": [1600, 1600, 128, 1600, 1600, 73, 46, 1600, 1600, 74, 54, 86, 49, 1600, 75, 123, 95, 85, 60, 77, 46, 59, 156, 95, 60, 51, 61, 115, 54, 72, 69, 1600, 78, 78, 1600, 89, 66, 94, 221, 47, 91, 79, 83, 1600, 55, 63, 53, 140, 100, 1600, 55, 1600, 98, 1600, 67, 1600, 1600, 117, 1600, 130, 62, 1600, 70, 61, 60, 43, 48, 62, 86, 49, 1600, 80, 88, 1600, 58, 80, 86, 99, 49, 1600, 57, 1600, 64, 53, 73, 65, 48, 1600, 54, 740, 65, 50, 1600, 43, 51, 1600, 78, 72, 47, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2979810106666636, "mean_inference_ms": 1.0137974941393375, "mean_action_processing_ms": 0.19529729872252793, "mean_env_wait_ms": 0.4033269086293221, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005523681640625, "StateBufferConnector_ms": 0.0043485164642333984, "ViewRequirementAgentConnector_ms": 0.11432957649230957}}, "episode_reward_max": -50.618513977153285, "episode_reward_min": -150.6667931829816, "episode_reward_mean": -101.03533986548497, "episode_len_mean": 447.78, "episodes_this_iter": 11, "episodes_timesteps_total": 44778, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.55263185197252, -62.03511045092715, -124.8183241031176, -61.42595226556003, -53.363377638731755, -108.92969663540089, -121.05462198823069, -90.53824864410774, -58.5035349681738, -109.90187249338503, -112.43772811047113, -111.49252700748667, -111.20310336533561, -98.53543142232927, -106.9659355833245, -113.62634108222463, -106.12998456388526, -108.69949044298754, -105.64094471606985, -107.0787436091397, -107.86320138770404, -111.84129532973965, -112.86016110944563, -111.80238976557243, -112.03253556749536, -110.69271845383011, -113.28176382522658, -110.27023149123353, -113.73793326770266, -113.92354816624646, -107.7750883827967, -66.21922176056971, -112.26377994458936, -116.5113734416794, -50.618513977153285, -103.99487027988894, -105.06891900899883, -126.94428606494392, -140.9447966452967, -110.52650568409575, -117.33568381134421, -111.71076670781152, -123.81420907253772, -62.35645416628753, -110.65595546768482, -114.42134048365554, -113.66934152454635, -124.27796856063102, -117.93272300028677, -61.627169076484996, -103.48841853707594, -61.51461389540502, -116.19792017456021, -50.81436145182953, -109.07829168847451, -103.07549000195766, -64.25804456847656, -118.85135961002237, -62.204218074022556, -108.36222978971713, -113.2576647131263, -58.612367824017234, -111.14987005812489, -104.07663072965232, -110.62842275988932, -112.2538872121858, -106.57118158426944, -105.82830434476335, -110.95634334195344, -109.56373581414856, -56.23947399006858, -116.85552653791072, -104.38372309493336, -52.368364470086334, -115.62106012177095, -108.31611798111535, -102.72003529074168, -118.37180613566127, -106.85530550793125, -108.87759537766068, -107.08720459702114, -55.391051035300485, -113.07199897285862, -106.09685436874007, -109.34628087357184, -104.92284774636104, -104.96873230664619, -66.89588098845384, -102.90056523498583, -150.6667931829816, -111.10262177492368, -111.25390494354566, -52.17933990054772, -110.0695654446644, -114.08587793047664, -53.982381587766156, -117.56675032269148, -111.32237252081185, -108.99697453491018, -106.3652772313431], "episode_lengths": [1600, 1600, 128, 1600, 1600, 73, 46, 1600, 1600, 74, 54, 86, 49, 1600, 75, 123, 95, 85, 60, 77, 46, 59, 156, 95, 60, 51, 61, 115, 54, 72, 69, 1600, 78, 78, 1600, 89, 66, 94, 221, 47, 91, 79, 83, 1600, 55, 63, 53, 140, 100, 1600, 55, 1600, 98, 1600, 67, 1600, 1600, 117, 1600, 130, 62, 1600, 70, 61, 60, 43, 48, 62, 86, 49, 1600, 80, 88, 1600, 58, 80, 86, 99, 49, 1600, 57, 1600, 64, 53, 73, 65, 48, 1600, 54, 740, 65, 50, 1600, 43, 51, 1600, 78, 72, 47, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2979810106666636, "mean_inference_ms": 1.0137974941393375, "mean_action_processing_ms": 0.19529729872252793, "mean_env_wait_ms": 0.4033269086293221, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005523681640625, "StateBufferConnector_ms": 0.0043485164642333984, "ViewRequirementAgentConnector_ms": 0.11432957649230957}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 365.73893661045616, "num_env_steps_trained_throughput_per_sec": 365.73893661045616, "timesteps_total": 196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 196000, "timers": {"training_iteration_time_ms": 10033.587, "restore_workers_time_ms": 0.013, "training_step_time_ms": 10033.552, "sample_time_ms": 3720.76, "load_time_ms": 0.44, "load_throughput": 9088416.035, "learn_time_ms": 6303.722, "learn_throughput": 634.546, "synch_weights_time_ms": 8.066}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "done": false, "episodes_total": 349, "training_iteration": 49, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-09-12", "timestamp": 1714270152, "time_this_iter_s": 10.943995237350464, "time_total_s": 505.2028784751892, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 505.2028784751892, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 35.013333333333335, "ram_util_percent": 63.97333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.964397483551375, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6095366201797872, "policy_loss": -0.03549081204078531, "vf_loss": 1.637470551331838, "vf_explained_var": 0.2168037643355708, "kl": 0.011195391618975899, "entropy": 5.889364540448753, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 46035.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "sampler_results": {"episode_reward_max": -48.07614971738817, "episode_reward_min": -150.6667931829816, "episode_reward_mean": -102.05376636674251, "episode_len_mean": 419.25, "episode_media": {}, "episodes_this_iter": 5, "episodes_timesteps_total": 41925, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-108.92969663540089, -121.05462198823069, -90.53824864410774, -58.5035349681738, -109.90187249338503, -112.43772811047113, -111.49252700748667, -111.20310336533561, -98.53543142232927, -106.9659355833245, -113.62634108222463, -106.12998456388526, -108.69949044298754, -105.64094471606985, -107.0787436091397, -107.86320138770404, -111.84129532973965, -112.86016110944563, -111.80238976557243, -112.03253556749536, -110.69271845383011, -113.28176382522658, -110.27023149123353, -113.73793326770266, -113.92354816624646, -107.7750883827967, -66.21922176056971, -112.26377994458936, -116.5113734416794, -50.618513977153285, -103.99487027988894, -105.06891900899883, -126.94428606494392, -140.9447966452967, -110.52650568409575, -117.33568381134421, -111.71076670781152, -123.81420907253772, -62.35645416628753, -110.65595546768482, -114.42134048365554, -113.66934152454635, -124.27796856063102, -117.93272300028677, -61.627169076484996, -103.48841853707594, -61.51461389540502, -116.19792017456021, -50.81436145182953, -109.07829168847451, -103.07549000195766, -64.25804456847656, -118.85135961002237, -62.204218074022556, -108.36222978971713, -113.2576647131263, -58.612367824017234, -111.14987005812489, -104.07663072965232, -110.62842275988932, -112.2538872121858, -106.57118158426944, -105.82830434476335, -110.95634334195344, -109.56373581414856, -56.23947399006858, -116.85552653791072, -104.38372309493336, -52.368364470086334, -115.62106012177095, -108.31611798111535, -102.72003529074168, -118.37180613566127, -106.85530550793125, -108.87759537766068, -107.08720459702114, -55.391051035300485, -113.07199897285862, -106.09685436874007, -109.34628087357184, -104.92284774636104, -104.96873230664619, -66.89588098845384, -102.90056523498583, -150.6667931829816, -111.10262177492368, -111.25390494354566, -52.17933990054772, -110.0695654446644, -114.08587793047664, -53.982381587766156, -117.56675032269148, -111.32237252081185, -108.99697453491018, -106.3652772313431, -53.866143721014964, -143.6552441043636, -111.31770422943744, -111.12280466385931, -48.07614971738817], "episode_lengths": [73, 46, 1600, 1600, 74, 54, 86, 49, 1600, 75, 123, 95, 85, 60, 77, 46, 59, 156, 95, 60, 51, 61, 115, 54, 72, 69, 1600, 78, 78, 1600, 89, 66, 94, 221, 47, 91, 79, 83, 1600, 55, 63, 53, 140, 100, 1600, 55, 1600, 98, 1600, 67, 1600, 1600, 117, 1600, 130, 62, 1600, 70, 61, 60, 43, 48, 62, 86, 49, 1600, 80, 88, 1600, 58, 80, 86, 99, 49, 1600, 57, 1600, 64, 53, 73, 65, 48, 1600, 54, 740, 65, 50, 1600, 43, 51, 1600, 78, 72, 47, 70, 1600, 332, 62, 81, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2979582868228262, "mean_inference_ms": 1.013255152913398, "mean_action_processing_ms": 0.19520584555637222, "mean_env_wait_ms": 0.40324959076858485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0054967403411865234, "StateBufferConnector_ms": 0.0042760372161865234, "ViewRequirementAgentConnector_ms": 0.11407899856567383}}, "episode_reward_max": -48.07614971738817, "episode_reward_min": -150.6667931829816, "episode_reward_mean": -102.05376636674251, "episode_len_mean": 419.25, "episodes_this_iter": 5, "episodes_timesteps_total": 41925, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-108.92969663540089, -121.05462198823069, -90.53824864410774, -58.5035349681738, -109.90187249338503, -112.43772811047113, -111.49252700748667, -111.20310336533561, -98.53543142232927, -106.9659355833245, -113.62634108222463, -106.12998456388526, -108.69949044298754, -105.64094471606985, -107.0787436091397, -107.86320138770404, -111.84129532973965, -112.86016110944563, -111.80238976557243, -112.03253556749536, -110.69271845383011, -113.28176382522658, -110.27023149123353, -113.73793326770266, -113.92354816624646, -107.7750883827967, -66.21922176056971, -112.26377994458936, -116.5113734416794, -50.618513977153285, -103.99487027988894, -105.06891900899883, -126.94428606494392, -140.9447966452967, -110.52650568409575, -117.33568381134421, -111.71076670781152, -123.81420907253772, -62.35645416628753, -110.65595546768482, -114.42134048365554, -113.66934152454635, -124.27796856063102, -117.93272300028677, -61.627169076484996, -103.48841853707594, -61.51461389540502, -116.19792017456021, -50.81436145182953, -109.07829168847451, -103.07549000195766, -64.25804456847656, -118.85135961002237, -62.204218074022556, -108.36222978971713, -113.2576647131263, -58.612367824017234, -111.14987005812489, -104.07663072965232, -110.62842275988932, -112.2538872121858, -106.57118158426944, -105.82830434476335, -110.95634334195344, -109.56373581414856, -56.23947399006858, -116.85552653791072, -104.38372309493336, -52.368364470086334, -115.62106012177095, -108.31611798111535, -102.72003529074168, -118.37180613566127, -106.85530550793125, -108.87759537766068, -107.08720459702114, -55.391051035300485, -113.07199897285862, -106.09685436874007, -109.34628087357184, -104.92284774636104, -104.96873230664619, -66.89588098845384, -102.90056523498583, -150.6667931829816, -111.10262177492368, -111.25390494354566, -52.17933990054772, -110.0695654446644, -114.08587793047664, -53.982381587766156, -117.56675032269148, -111.32237252081185, -108.99697453491018, -106.3652772313431, -53.866143721014964, -143.6552441043636, -111.31770422943744, -111.12280466385931, -48.07614971738817], "episode_lengths": [73, 46, 1600, 1600, 74, 54, 86, 49, 1600, 75, 123, 95, 85, 60, 77, 46, 59, 156, 95, 60, 51, 61, 115, 54, 72, 69, 1600, 78, 78, 1600, 89, 66, 94, 221, 47, 91, 79, 83, 1600, 55, 63, 53, 140, 100, 1600, 55, 1600, 98, 1600, 67, 1600, 1600, 117, 1600, 130, 62, 1600, 70, 61, 60, 43, 48, 62, 86, 49, 1600, 80, 88, 1600, 58, 80, 86, 99, 49, 1600, 57, 1600, 64, 53, 73, 65, 48, 1600, 54, 740, 65, 50, 1600, 43, 51, 1600, 78, 72, 47, 70, 1600, 332, 62, 81, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2979582868228262, "mean_inference_ms": 1.013255152913398, "mean_action_processing_ms": 0.19520584555637222, "mean_env_wait_ms": 0.40324959076858485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0054967403411865234, "StateBufferConnector_ms": 0.0042760372161865234, "ViewRequirementAgentConnector_ms": 0.11407899856567383}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 412.5345751750182, "num_env_steps_trained_throughput_per_sec": 412.5345751750182, "timesteps_total": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 10034.687, "restore_workers_time_ms": 0.013, "training_step_time_ms": 10034.649, "sample_time_ms": 3749.213, "load_time_ms": 0.435, "load_throughput": 9199043.755, "learn_time_ms": 6276.067, "learn_throughput": 637.342, "synch_weights_time_ms": 8.326}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "episodes_total": 354, "training_iteration": 50, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-09-22", "timestamp": 1714270162, "time_this_iter_s": 9.70087218284607, "time_total_s": 514.9037506580353, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 514.9037506580353, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 27.657142857142855, "ram_util_percent": 63.921428571428564}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.845479460813666, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8819007808123516, "policy_loss": -0.031530713386112644, "vf_loss": 1.907509690082522, "vf_explained_var": 0.2895536609875259, "kl": 0.008773035930207002, "entropy": 6.025380440168483, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 46965.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "sampler_results": {"episode_reward_max": -48.07614971738817, "episode_reward_min": -165.68566928387742, "episode_reward_mean": -102.19772766906857, "episode_len_mean": 426.07, "episode_media": {}, "episodes_this_iter": 3, "episodes_timesteps_total": 42607, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-58.5035349681738, -109.90187249338503, -112.43772811047113, -111.49252700748667, -111.20310336533561, -98.53543142232927, -106.9659355833245, -113.62634108222463, -106.12998456388526, -108.69949044298754, -105.64094471606985, -107.0787436091397, -107.86320138770404, -111.84129532973965, -112.86016110944563, -111.80238976557243, -112.03253556749536, -110.69271845383011, -113.28176382522658, -110.27023149123353, -113.73793326770266, -113.92354816624646, -107.7750883827967, -66.21922176056971, -112.26377994458936, -116.5113734416794, -50.618513977153285, -103.99487027988894, -105.06891900899883, -126.94428606494392, -140.9447966452967, -110.52650568409575, -117.33568381134421, -111.71076670781152, -123.81420907253772, -62.35645416628753, -110.65595546768482, -114.42134048365554, -113.66934152454635, -124.27796856063102, -117.93272300028677, -61.627169076484996, -103.48841853707594, -61.51461389540502, -116.19792017456021, -50.81436145182953, -109.07829168847451, -103.07549000195766, -64.25804456847656, -118.85135961002237, -62.204218074022556, -108.36222978971713, -113.2576647131263, -58.612367824017234, -111.14987005812489, -104.07663072965232, -110.62842275988932, -112.2538872121858, -106.57118158426944, -105.82830434476335, -110.95634334195344, -109.56373581414856, -56.23947399006858, -116.85552653791072, -104.38372309493336, -52.368364470086334, -115.62106012177095, -108.31611798111535, -102.72003529074168, -118.37180613566127, -106.85530550793125, -108.87759537766068, -107.08720459702114, -55.391051035300485, -113.07199897285862, -106.09685436874007, -109.34628087357184, -104.92284774636104, -104.96873230664619, -66.89588098845384, -102.90056523498583, -150.6667931829816, -111.10262177492368, -111.25390494354566, -52.17933990054772, -110.0695654446644, -114.08587793047664, -53.982381587766156, -117.56675032269148, -111.32237252081185, -108.99697453491018, -106.3652772313431, -53.866143721014964, -143.6552441043636, -111.31770422943744, -111.12280466385931, -48.07614971738817, -165.68566928387742, -105.39684620246602, -63.83618201400592], "episode_lengths": [1600, 74, 54, 86, 49, 1600, 75, 123, 95, 85, 60, 77, 46, 59, 156, 95, 60, 51, 61, 115, 54, 72, 69, 1600, 78, 78, 1600, 89, 66, 94, 221, 47, 91, 79, 83, 1600, 55, 63, 53, 140, 100, 1600, 55, 1600, 98, 1600, 67, 1600, 1600, 117, 1600, 130, 62, 1600, 70, 61, 60, 43, 48, 62, 86, 49, 1600, 80, 88, 1600, 58, 80, 86, 99, 49, 1600, 57, 1600, 64, 53, 73, 65, 48, 1600, 54, 740, 65, 50, 1600, 43, 51, 1600, 78, 72, 47, 70, 1600, 332, 62, 81, 1600, 729, 72, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2979825884801285, "mean_inference_ms": 1.0129567484325388, "mean_action_processing_ms": 0.19516072350655303, "mean_env_wait_ms": 0.4032685095952214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005554914474487305, "StateBufferConnector_ms": 0.004290342330932617, "ViewRequirementAgentConnector_ms": 0.11447739601135254}}, "episode_reward_max": -48.07614971738817, "episode_reward_min": -165.68566928387742, "episode_reward_mean": -102.19772766906857, "episode_len_mean": 426.07, "episodes_this_iter": 3, "episodes_timesteps_total": 42607, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-58.5035349681738, -109.90187249338503, -112.43772811047113, -111.49252700748667, -111.20310336533561, -98.53543142232927, -106.9659355833245, -113.62634108222463, -106.12998456388526, -108.69949044298754, -105.64094471606985, -107.0787436091397, -107.86320138770404, -111.84129532973965, -112.86016110944563, -111.80238976557243, -112.03253556749536, -110.69271845383011, -113.28176382522658, -110.27023149123353, -113.73793326770266, -113.92354816624646, -107.7750883827967, -66.21922176056971, -112.26377994458936, -116.5113734416794, -50.618513977153285, -103.99487027988894, -105.06891900899883, -126.94428606494392, -140.9447966452967, -110.52650568409575, -117.33568381134421, -111.71076670781152, -123.81420907253772, -62.35645416628753, -110.65595546768482, -114.42134048365554, -113.66934152454635, -124.27796856063102, -117.93272300028677, -61.627169076484996, -103.48841853707594, -61.51461389540502, -116.19792017456021, -50.81436145182953, -109.07829168847451, -103.07549000195766, -64.25804456847656, -118.85135961002237, -62.204218074022556, -108.36222978971713, -113.2576647131263, -58.612367824017234, -111.14987005812489, -104.07663072965232, -110.62842275988932, -112.2538872121858, -106.57118158426944, -105.82830434476335, -110.95634334195344, -109.56373581414856, -56.23947399006858, -116.85552653791072, -104.38372309493336, -52.368364470086334, -115.62106012177095, -108.31611798111535, -102.72003529074168, -118.37180613566127, -106.85530550793125, -108.87759537766068, -107.08720459702114, -55.391051035300485, -113.07199897285862, -106.09685436874007, -109.34628087357184, -104.92284774636104, -104.96873230664619, -66.89588098845384, -102.90056523498583, -150.6667931829816, -111.10262177492368, -111.25390494354566, -52.17933990054772, -110.0695654446644, -114.08587793047664, -53.982381587766156, -117.56675032269148, -111.32237252081185, -108.99697453491018, -106.3652772313431, -53.866143721014964, -143.6552441043636, -111.31770422943744, -111.12280466385931, -48.07614971738817, -165.68566928387742, -105.39684620246602, -63.83618201400592], "episode_lengths": [1600, 74, 54, 86, 49, 1600, 75, 123, 95, 85, 60, 77, 46, 59, 156, 95, 60, 51, 61, 115, 54, 72, 69, 1600, 78, 78, 1600, 89, 66, 94, 221, 47, 91, 79, 83, 1600, 55, 63, 53, 140, 100, 1600, 55, 1600, 98, 1600, 67, 1600, 1600, 117, 1600, 130, 62, 1600, 70, 61, 60, 43, 48, 62, 86, 49, 1600, 80, 88, 1600, 58, 80, 86, 99, 49, 1600, 57, 1600, 64, 53, 73, 65, 48, 1600, 54, 740, 65, 50, 1600, 43, 51, 1600, 78, 72, 47, 70, 1600, 332, 62, 81, 1600, 729, 72, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2979825884801285, "mean_inference_ms": 1.0129567484325388, "mean_action_processing_ms": 0.19516072350655303, "mean_env_wait_ms": 0.4032685095952214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005554914474487305, "StateBufferConnector_ms": 0.004290342330932617, "ViewRequirementAgentConnector_ms": 0.11447739601135254}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 410.8160395483153, "num_env_steps_trained_throughput_per_sec": 410.8160395483153, "timesteps_total": 204000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 204000, "timers": {"training_iteration_time_ms": 10070.629, "restore_workers_time_ms": 0.012, "training_step_time_ms": 10070.593, "sample_time_ms": 3783.091, "load_time_ms": 0.432, "load_throughput": 9249250.786, "learn_time_ms": 6278.213, "learn_throughput": 637.124, "synch_weights_time_ms": 8.25}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "done": false, "episodes_total": 357, "training_iteration": 51, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-09-31", "timestamp": 1714270171, "time_this_iter_s": 9.741091012954712, "time_total_s": 524.64484167099, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 524.64484167099, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 26.7, "ram_util_percent": 63.83571428571427}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.224247609671727, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.287941511386695, "policy_loss": -0.03916938248821484, "vf_loss": 2.3173325636574336, "vf_explained_var": 0.18222125928889038, "kl": 0.014486419090084681, "entropy": 7.0349770671577865, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 47895.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "sampler_results": {"episode_reward_max": -48.07614971738817, "episode_reward_min": -165.68566928387742, "episode_reward_mean": -101.97002197071052, "episode_len_mean": 425.95, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 42595, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-111.84129532973965, -112.86016110944563, -111.80238976557243, -112.03253556749536, -110.69271845383011, -113.28176382522658, -110.27023149123353, -113.73793326770266, -113.92354816624646, -107.7750883827967, -66.21922176056971, -112.26377994458936, -116.5113734416794, -50.618513977153285, -103.99487027988894, -105.06891900899883, -126.94428606494392, -140.9447966452967, -110.52650568409575, -117.33568381134421, -111.71076670781152, -123.81420907253772, -62.35645416628753, -110.65595546768482, -114.42134048365554, -113.66934152454635, -124.27796856063102, -117.93272300028677, -61.627169076484996, -103.48841853707594, -61.51461389540502, -116.19792017456021, -50.81436145182953, -109.07829168847451, -103.07549000195766, -64.25804456847656, -118.85135961002237, -62.204218074022556, -108.36222978971713, -113.2576647131263, -58.612367824017234, -111.14987005812489, -104.07663072965232, -110.62842275988932, -112.2538872121858, -106.57118158426944, -105.82830434476335, -110.95634334195344, -109.56373581414856, -56.23947399006858, -116.85552653791072, -104.38372309493336, -52.368364470086334, -115.62106012177095, -108.31611798111535, -102.72003529074168, -118.37180613566127, -106.85530550793125, -108.87759537766068, -107.08720459702114, -55.391051035300485, -113.07199897285862, -106.09685436874007, -109.34628087357184, -104.92284774636104, -104.96873230664619, -66.89588098845384, -102.90056523498583, -150.6667931829816, -111.10262177492368, -111.25390494354566, -52.17933990054772, -110.0695654446644, -114.08587793047664, -53.982381587766156, -117.56675032269148, -111.32237252081185, -108.99697453491018, -106.3652772313431, -53.866143721014964, -143.6552441043636, -111.31770422943744, -111.12280466385931, -48.07614971738817, -165.68566928387742, -105.39684620246602, -63.83618201400592, -52.41271925740449, -108.30367420515108, -109.65603437533355, -105.50098744331238, -118.75420581540094, -106.60282707851628, -106.98909457849774, -59.50480483766821, -106.69177010903508, -114.8174796759331, -120.32637691969984, -110.01097356591995, -115.73732105483488], "episode_lengths": [59, 156, 95, 60, 51, 61, 115, 54, 72, 69, 1600, 78, 78, 1600, 89, 66, 94, 221, 47, 91, 79, 83, 1600, 55, 63, 53, 140, 100, 1600, 55, 1600, 98, 1600, 67, 1600, 1600, 117, 1600, 130, 62, 1600, 70, 61, 60, 43, 48, 62, 86, 49, 1600, 80, 88, 1600, 58, 80, 86, 99, 49, 1600, 57, 1600, 64, 53, 73, 65, 48, 1600, 54, 740, 65, 50, 1600, 43, 51, 1600, 78, 72, 47, 70, 1600, 332, 62, 81, 1600, 729, 72, 1600, 1600, 54, 42, 58, 103, 97, 53, 1600, 50, 62, 107, 104, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2979071686747228, "mean_inference_ms": 1.0117889430949911, "mean_action_processing_ms": 0.19495700921545278, "mean_env_wait_ms": 0.4030741112233387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00564265251159668, "StateBufferConnector_ms": 0.004357099533081055, "ViewRequirementAgentConnector_ms": 0.11426520347595215}}, "episode_reward_max": -48.07614971738817, "episode_reward_min": -165.68566928387742, "episode_reward_mean": -101.97002197071052, "episode_len_mean": 425.95, "episodes_this_iter": 13, "episodes_timesteps_total": 42595, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-111.84129532973965, -112.86016110944563, -111.80238976557243, -112.03253556749536, -110.69271845383011, -113.28176382522658, -110.27023149123353, -113.73793326770266, -113.92354816624646, -107.7750883827967, -66.21922176056971, -112.26377994458936, -116.5113734416794, -50.618513977153285, -103.99487027988894, -105.06891900899883, -126.94428606494392, -140.9447966452967, -110.52650568409575, -117.33568381134421, -111.71076670781152, -123.81420907253772, -62.35645416628753, -110.65595546768482, -114.42134048365554, -113.66934152454635, -124.27796856063102, -117.93272300028677, -61.627169076484996, -103.48841853707594, -61.51461389540502, -116.19792017456021, -50.81436145182953, -109.07829168847451, -103.07549000195766, -64.25804456847656, -118.85135961002237, -62.204218074022556, -108.36222978971713, -113.2576647131263, -58.612367824017234, -111.14987005812489, -104.07663072965232, -110.62842275988932, -112.2538872121858, -106.57118158426944, -105.82830434476335, -110.95634334195344, -109.56373581414856, -56.23947399006858, -116.85552653791072, -104.38372309493336, -52.368364470086334, -115.62106012177095, -108.31611798111535, -102.72003529074168, -118.37180613566127, -106.85530550793125, -108.87759537766068, -107.08720459702114, -55.391051035300485, -113.07199897285862, -106.09685436874007, -109.34628087357184, -104.92284774636104, -104.96873230664619, -66.89588098845384, -102.90056523498583, -150.6667931829816, -111.10262177492368, -111.25390494354566, -52.17933990054772, -110.0695654446644, -114.08587793047664, -53.982381587766156, -117.56675032269148, -111.32237252081185, -108.99697453491018, -106.3652772313431, -53.866143721014964, -143.6552441043636, -111.31770422943744, -111.12280466385931, -48.07614971738817, -165.68566928387742, -105.39684620246602, -63.83618201400592, -52.41271925740449, -108.30367420515108, -109.65603437533355, -105.50098744331238, -118.75420581540094, -106.60282707851628, -106.98909457849774, -59.50480483766821, -106.69177010903508, -114.8174796759331, -120.32637691969984, -110.01097356591995, -115.73732105483488], "episode_lengths": [59, 156, 95, 60, 51, 61, 115, 54, 72, 69, 1600, 78, 78, 1600, 89, 66, 94, 221, 47, 91, 79, 83, 1600, 55, 63, 53, 140, 100, 1600, 55, 1600, 98, 1600, 67, 1600, 1600, 117, 1600, 130, 62, 1600, 70, 61, 60, 43, 48, 62, 86, 49, 1600, 80, 88, 1600, 58, 80, 86, 99, 49, 1600, 57, 1600, 64, 53, 73, 65, 48, 1600, 54, 740, 65, 50, 1600, 43, 51, 1600, 78, 72, 47, 70, 1600, 332, 62, 81, 1600, 729, 72, 1600, 1600, 54, 42, 58, 103, 97, 53, 1600, 50, 62, 107, 104, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2979071686747228, "mean_inference_ms": 1.0117889430949911, "mean_action_processing_ms": 0.19495700921545278, "mean_env_wait_ms": 0.4030741112233387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00564265251159668, "StateBufferConnector_ms": 0.004357099533081055, "ViewRequirementAgentConnector_ms": 0.11426520347595215}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 443.1367071687223, "num_env_steps_trained_throughput_per_sec": 443.1367071687223, "timesteps_total": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 10039.333, "restore_workers_time_ms": 0.012, "training_step_time_ms": 10039.297, "sample_time_ms": 3772.777, "load_time_ms": 0.431, "load_throughput": 9272253.786, "learn_time_ms": 6257.412, "learn_throughput": 639.242, "synch_weights_time_ms": 8.073}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "episodes_total": 370, "training_iteration": 52, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-09-41", "timestamp": 1714270181, "time_this_iter_s": 9.031199932098389, "time_total_s": 533.6760416030884, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 533.6760416030884, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 22.407692307692304, "ram_util_percent": 63.76153846153844}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.674132625005578, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5898790328638248, "policy_loss": -0.03824748878357231, "vf_loss": 1.6204745403260634, "vf_explained_var": 0.27026103427333215, "kl": 0.01133626301804429, "entropy": 6.077225784588886, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 48825.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "sampler_results": {"episode_reward_max": -48.07614971738817, "episode_reward_min": -165.68566928387742, "episode_reward_mean": -100.96314375612978, "episode_len_mean": 456.55, "episode_media": {}, "episodes_this_iter": 8, "episodes_timesteps_total": 45655, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113.92354816624646, -107.7750883827967, -66.21922176056971, -112.26377994458936, -116.5113734416794, -50.618513977153285, -103.99487027988894, -105.06891900899883, -126.94428606494392, -140.9447966452967, -110.52650568409575, -117.33568381134421, -111.71076670781152, -123.81420907253772, -62.35645416628753, -110.65595546768482, -114.42134048365554, -113.66934152454635, -124.27796856063102, -117.93272300028677, -61.627169076484996, -103.48841853707594, -61.51461389540502, -116.19792017456021, -50.81436145182953, -109.07829168847451, -103.07549000195766, -64.25804456847656, -118.85135961002237, -62.204218074022556, -108.36222978971713, -113.2576647131263, -58.612367824017234, -111.14987005812489, -104.07663072965232, -110.62842275988932, -112.2538872121858, -106.57118158426944, -105.82830434476335, -110.95634334195344, -109.56373581414856, -56.23947399006858, -116.85552653791072, -104.38372309493336, -52.368364470086334, -115.62106012177095, -108.31611798111535, -102.72003529074168, -118.37180613566127, -106.85530550793125, -108.87759537766068, -107.08720459702114, -55.391051035300485, -113.07199897285862, -106.09685436874007, -109.34628087357184, -104.92284774636104, -104.96873230664619, -66.89588098845384, -102.90056523498583, -150.6667931829816, -111.10262177492368, -111.25390494354566, -52.17933990054772, -110.0695654446644, -114.08587793047664, -53.982381587766156, -117.56675032269148, -111.32237252081185, -108.99697453491018, -106.3652772313431, -53.866143721014964, -143.6552441043636, -111.31770422943744, -111.12280466385931, -48.07614971738817, -165.68566928387742, -105.39684620246602, -63.83618201400592, -52.41271925740449, -108.30367420515108, -109.65603437533355, -105.50098744331238, -118.75420581540094, -106.60282707851628, -106.98909457849774, -59.50480483766821, -106.69177010903508, -114.8174796759331, -120.32637691969984, -110.01097356591995, -115.73732105483488, -62.89303407330372, -100.99788431574653, -59.2698007568393, -111.54456218201977, -111.65944025088288, -108.75359550283538, -115.76055085721178, -124.95233941333244], "episode_lengths": [72, 69, 1600, 78, 78, 1600, 89, 66, 94, 221, 47, 91, 79, 83, 1600, 55, 63, 53, 140, 100, 1600, 55, 1600, 98, 1600, 67, 1600, 1600, 117, 1600, 130, 62, 1600, 70, 61, 60, 43, 48, 62, 86, 49, 1600, 80, 88, 1600, 58, 80, 86, 99, 49, 1600, 57, 1600, 64, 53, 73, 65, 48, 1600, 54, 740, 65, 50, 1600, 43, 51, 1600, 78, 72, 47, 70, 1600, 332, 62, 81, 1600, 729, 72, 1600, 1600, 54, 42, 58, 103, 97, 53, 1600, 50, 62, 107, 104, 82, 1600, 108, 1600, 56, 62, 43, 125, 117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29748542268549627, "mean_inference_ms": 1.0116630340410295, "mean_action_processing_ms": 0.19485936556978334, "mean_env_wait_ms": 0.40227855482927594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005692005157470703, "StateBufferConnector_ms": 0.0043904781341552734, "ViewRequirementAgentConnector_ms": 0.11340832710266113}}, "episode_reward_max": -48.07614971738817, "episode_reward_min": -165.68566928387742, "episode_reward_mean": -100.96314375612978, "episode_len_mean": 456.55, "episodes_this_iter": 8, "episodes_timesteps_total": 45655, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113.92354816624646, -107.7750883827967, -66.21922176056971, -112.26377994458936, -116.5113734416794, -50.618513977153285, -103.99487027988894, -105.06891900899883, -126.94428606494392, -140.9447966452967, -110.52650568409575, -117.33568381134421, -111.71076670781152, -123.81420907253772, -62.35645416628753, -110.65595546768482, -114.42134048365554, -113.66934152454635, -124.27796856063102, -117.93272300028677, -61.627169076484996, -103.48841853707594, -61.51461389540502, -116.19792017456021, -50.81436145182953, -109.07829168847451, -103.07549000195766, -64.25804456847656, -118.85135961002237, -62.204218074022556, -108.36222978971713, -113.2576647131263, -58.612367824017234, -111.14987005812489, -104.07663072965232, -110.62842275988932, -112.2538872121858, -106.57118158426944, -105.82830434476335, -110.95634334195344, -109.56373581414856, -56.23947399006858, -116.85552653791072, -104.38372309493336, -52.368364470086334, -115.62106012177095, -108.31611798111535, -102.72003529074168, -118.37180613566127, -106.85530550793125, -108.87759537766068, -107.08720459702114, -55.391051035300485, -113.07199897285862, -106.09685436874007, -109.34628087357184, -104.92284774636104, -104.96873230664619, -66.89588098845384, -102.90056523498583, -150.6667931829816, -111.10262177492368, -111.25390494354566, -52.17933990054772, -110.0695654446644, -114.08587793047664, -53.982381587766156, -117.56675032269148, -111.32237252081185, -108.99697453491018, -106.3652772313431, -53.866143721014964, -143.6552441043636, -111.31770422943744, -111.12280466385931, -48.07614971738817, -165.68566928387742, -105.39684620246602, -63.83618201400592, -52.41271925740449, -108.30367420515108, -109.65603437533355, -105.50098744331238, -118.75420581540094, -106.60282707851628, -106.98909457849774, -59.50480483766821, -106.69177010903508, -114.8174796759331, -120.32637691969984, -110.01097356591995, -115.73732105483488, -62.89303407330372, -100.99788431574653, -59.2698007568393, -111.54456218201977, -111.65944025088288, -108.75359550283538, -115.76055085721178, -124.95233941333244], "episode_lengths": [72, 69, 1600, 78, 78, 1600, 89, 66, 94, 221, 47, 91, 79, 83, 1600, 55, 63, 53, 140, 100, 1600, 55, 1600, 98, 1600, 67, 1600, 1600, 117, 1600, 130, 62, 1600, 70, 61, 60, 43, 48, 62, 86, 49, 1600, 80, 88, 1600, 58, 80, 86, 99, 49, 1600, 57, 1600, 64, 53, 73, 65, 48, 1600, 54, 740, 65, 50, 1600, 43, 51, 1600, 78, 72, 47, 70, 1600, 332, 62, 81, 1600, 729, 72, 1600, 1600, 54, 42, 58, 103, 97, 53, 1600, 50, 62, 107, 104, 82, 1600, 108, 1600, 56, 62, 43, 125, 117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29748542268549627, "mean_inference_ms": 1.0116630340410295, "mean_action_processing_ms": 0.19485936556978334, "mean_env_wait_ms": 0.40227855482927594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005692005157470703, "StateBufferConnector_ms": 0.0043904781341552734, "ViewRequirementAgentConnector_ms": 0.11340832710266113}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 425.09158911997446, "num_env_steps_trained_throughput_per_sec": 425.09158911997446, "timesteps_total": 212000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 212000, "timers": {"training_iteration_time_ms": 10021.063, "restore_workers_time_ms": 0.013, "training_step_time_ms": 10021.025, "sample_time_ms": 3749.179, "load_time_ms": 0.45, "load_throughput": 8894717.421, "learn_time_ms": 6262.678, "learn_throughput": 638.704, "synch_weights_time_ms": 8.116}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "done": false, "episodes_total": 378, "training_iteration": 53, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-09-50", "timestamp": 1714270190, "time_this_iter_s": 9.414484977722168, "time_total_s": 543.0905265808105, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 543.0905265808105, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 25.47692307692308, "ram_util_percent": 63.74615384615386}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.325094140088686, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3603806842816994, "policy_loss": -0.04244302900568132, "vf_loss": 2.3925335531433425, "vf_explained_var": 0.3064076737690997, "kl": 0.01524469020963658, "entropy": 7.366209667728794, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 49755.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "sampler_results": {"episode_reward_max": -48.07614971738817, "episode_reward_min": -165.68566928387742, "episode_reward_mean": -100.47098230886414, "episode_len_mean": 472.19, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 47219, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-140.9447966452967, -110.52650568409575, -117.33568381134421, -111.71076670781152, -123.81420907253772, -62.35645416628753, -110.65595546768482, -114.42134048365554, -113.66934152454635, -124.27796856063102, -117.93272300028677, -61.627169076484996, -103.48841853707594, -61.51461389540502, -116.19792017456021, -50.81436145182953, -109.07829168847451, -103.07549000195766, -64.25804456847656, -118.85135961002237, -62.204218074022556, -108.36222978971713, -113.2576647131263, -58.612367824017234, -111.14987005812489, -104.07663072965232, -110.62842275988932, -112.2538872121858, -106.57118158426944, -105.82830434476335, -110.95634334195344, -109.56373581414856, -56.23947399006858, -116.85552653791072, -104.38372309493336, -52.368364470086334, -115.62106012177095, -108.31611798111535, -102.72003529074168, -118.37180613566127, -106.85530550793125, -108.87759537766068, -107.08720459702114, -55.391051035300485, -113.07199897285862, -106.09685436874007, -109.34628087357184, -104.92284774636104, -104.96873230664619, -66.89588098845384, -102.90056523498583, -150.6667931829816, -111.10262177492368, -111.25390494354566, -52.17933990054772, -110.0695654446644, -114.08587793047664, -53.982381587766156, -117.56675032269148, -111.32237252081185, -108.99697453491018, -106.3652772313431, -53.866143721014964, -143.6552441043636, -111.31770422943744, -111.12280466385931, -48.07614971738817, -165.68566928387742, -105.39684620246602, -63.83618201400592, -52.41271925740449, -108.30367420515108, -109.65603437533355, -105.50098744331238, -118.75420581540094, -106.60282707851628, -106.98909457849774, -59.50480483766821, -106.69177010903508, -114.8174796759331, -120.32637691969984, -110.01097356591995, -115.73732105483488, -62.89303407330372, -100.99788431574653, -59.2698007568393, -111.54456218201977, -111.65944025088288, -108.75359550283538, -115.76055085721178, -124.95233941333244, -63.50857467782301, -62.67225362174885, -107.77699090047119, -111.7620656174235, -107.71156977486115, -115.82656296715452, -54.329677197314204, -123.2082801860397, -107.30748135746829], "episode_lengths": [221, 47, 91, 79, 83, 1600, 55, 63, 53, 140, 100, 1600, 55, 1600, 98, 1600, 67, 1600, 1600, 117, 1600, 130, 62, 1600, 70, 61, 60, 43, 48, 62, 86, 49, 1600, 80, 88, 1600, 58, 80, 86, 99, 49, 1600, 57, 1600, 64, 53, 73, 65, 48, 1600, 54, 740, 65, 50, 1600, 43, 51, 1600, 78, 72, 47, 70, 1600, 332, 62, 81, 1600, 729, 72, 1600, 1600, 54, 42, 58, 103, 97, 53, 1600, 50, 62, 107, 104, 82, 1600, 108, 1600, 56, 62, 43, 125, 117, 1600, 1600, 101, 59, 88, 94, 1600, 122, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2973466184154635, "mean_inference_ms": 1.01096177573024, "mean_action_processing_ms": 0.1947195755191485, "mean_env_wait_ms": 0.4019828975370594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005733966827392578, "StateBufferConnector_ms": 0.004353761672973633, "ViewRequirementAgentConnector_ms": 0.11372137069702148}}, "episode_reward_max": -48.07614971738817, "episode_reward_min": -165.68566928387742, "episode_reward_mean": -100.47098230886414, "episode_len_mean": 472.19, "episodes_this_iter": 9, "episodes_timesteps_total": 47219, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-140.9447966452967, -110.52650568409575, -117.33568381134421, -111.71076670781152, -123.81420907253772, -62.35645416628753, -110.65595546768482, -114.42134048365554, -113.66934152454635, -124.27796856063102, -117.93272300028677, -61.627169076484996, -103.48841853707594, -61.51461389540502, -116.19792017456021, -50.81436145182953, -109.07829168847451, -103.07549000195766, -64.25804456847656, -118.85135961002237, -62.204218074022556, -108.36222978971713, -113.2576647131263, -58.612367824017234, -111.14987005812489, -104.07663072965232, -110.62842275988932, -112.2538872121858, -106.57118158426944, -105.82830434476335, -110.95634334195344, -109.56373581414856, -56.23947399006858, -116.85552653791072, -104.38372309493336, -52.368364470086334, -115.62106012177095, -108.31611798111535, -102.72003529074168, -118.37180613566127, -106.85530550793125, -108.87759537766068, -107.08720459702114, -55.391051035300485, -113.07199897285862, -106.09685436874007, -109.34628087357184, -104.92284774636104, -104.96873230664619, -66.89588098845384, -102.90056523498583, -150.6667931829816, -111.10262177492368, -111.25390494354566, -52.17933990054772, -110.0695654446644, -114.08587793047664, -53.982381587766156, -117.56675032269148, -111.32237252081185, -108.99697453491018, -106.3652772313431, -53.866143721014964, -143.6552441043636, -111.31770422943744, -111.12280466385931, -48.07614971738817, -165.68566928387742, -105.39684620246602, -63.83618201400592, -52.41271925740449, -108.30367420515108, -109.65603437533355, -105.50098744331238, -118.75420581540094, -106.60282707851628, -106.98909457849774, -59.50480483766821, -106.69177010903508, -114.8174796759331, -120.32637691969984, -110.01097356591995, -115.73732105483488, -62.89303407330372, -100.99788431574653, -59.2698007568393, -111.54456218201977, -111.65944025088288, -108.75359550283538, -115.76055085721178, -124.95233941333244, -63.50857467782301, -62.67225362174885, -107.77699090047119, -111.7620656174235, -107.71156977486115, -115.82656296715452, -54.329677197314204, -123.2082801860397, -107.30748135746829], "episode_lengths": [221, 47, 91, 79, 83, 1600, 55, 63, 53, 140, 100, 1600, 55, 1600, 98, 1600, 67, 1600, 1600, 117, 1600, 130, 62, 1600, 70, 61, 60, 43, 48, 62, 86, 49, 1600, 80, 88, 1600, 58, 80, 86, 99, 49, 1600, 57, 1600, 64, 53, 73, 65, 48, 1600, 54, 740, 65, 50, 1600, 43, 51, 1600, 78, 72, 47, 70, 1600, 332, 62, 81, 1600, 729, 72, 1600, 1600, 54, 42, 58, 103, 97, 53, 1600, 50, 62, 107, 104, 82, 1600, 108, 1600, 56, 62, 43, 125, 117, 1600, 1600, 101, 59, 88, 94, 1600, 122, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2973466184154635, "mean_inference_ms": 1.01096177573024, "mean_action_processing_ms": 0.1947195755191485, "mean_env_wait_ms": 0.4019828975370594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005733966827392578, "StateBufferConnector_ms": 0.004353761672973633, "ViewRequirementAgentConnector_ms": 0.11372137069702148}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 421.61821910073564, "num_env_steps_trained_throughput_per_sec": 421.61821910073564, "timesteps_total": 216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 10039.192, "restore_workers_time_ms": 0.013, "training_step_time_ms": 10039.155, "sample_time_ms": 3772.875, "load_time_ms": 0.452, "load_throughput": 8847809.303, "learn_time_ms": 6257.33, "learn_throughput": 639.25, "synch_weights_time_ms": 7.938}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "episodes_total": 387, "training_iteration": 54, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-09-59", "timestamp": 1714270199, "time_this_iter_s": 9.491690397262573, "time_total_s": 552.5822169780731, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 552.5822169780731, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 26.77142857142857, "ram_util_percent": 63.71428571428573}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.536804553385704, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.9165329992916353, "policy_loss": -0.03519429782385467, "vf_loss": 2.942325585864244, "vf_explained_var": 0.2101874287410449, "kl": 0.01392844989947763, "entropy": 8.824934058804665, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 50685.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "sampler_results": {"episode_reward_max": -48.07614971738817, "episode_reward_min": -165.68566928387742, "episode_reward_mean": -100.49067891457207, "episode_len_mean": 469.35, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 46935, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-103.48841853707594, -61.51461389540502, -116.19792017456021, -50.81436145182953, -109.07829168847451, -103.07549000195766, -64.25804456847656, -118.85135961002237, -62.204218074022556, -108.36222978971713, -113.2576647131263, -58.612367824017234, -111.14987005812489, -104.07663072965232, -110.62842275988932, -112.2538872121858, -106.57118158426944, -105.82830434476335, -110.95634334195344, -109.56373581414856, -56.23947399006858, -116.85552653791072, -104.38372309493336, -52.368364470086334, -115.62106012177095, -108.31611798111535, -102.72003529074168, -118.37180613566127, -106.85530550793125, -108.87759537766068, -107.08720459702114, -55.391051035300485, -113.07199897285862, -106.09685436874007, -109.34628087357184, -104.92284774636104, -104.96873230664619, -66.89588098845384, -102.90056523498583, -150.6667931829816, -111.10262177492368, -111.25390494354566, -52.17933990054772, -110.0695654446644, -114.08587793047664, -53.982381587766156, -117.56675032269148, -111.32237252081185, -108.99697453491018, -106.3652772313431, -53.866143721014964, -143.6552441043636, -111.31770422943744, -111.12280466385931, -48.07614971738817, -165.68566928387742, -105.39684620246602, -63.83618201400592, -52.41271925740449, -108.30367420515108, -109.65603437533355, -105.50098744331238, -118.75420581540094, -106.60282707851628, -106.98909457849774, -59.50480483766821, -106.69177010903508, -114.8174796759331, -120.32637691969984, -110.01097356591995, -115.73732105483488, -62.89303407330372, -100.99788431574653, -59.2698007568393, -111.54456218201977, -111.65944025088288, -108.75359550283538, -115.76055085721178, -124.95233941333244, -63.50857467782301, -62.67225362174885, -107.77699090047119, -111.7620656174235, -107.71156977486115, -115.82656296715452, -54.329677197314204, -123.2082801860397, -107.30748135746829, -108.78894611246139, -109.13952458872585, -64.61820734235525, -107.47661972323371, -116.601157032306, -106.21092119570076, -145.72970080000962, -118.26421575604999, -107.99706662400875, -111.8238238918384, -105.86275962901985, -108.72963207574747], "episode_lengths": [55, 1600, 98, 1600, 67, 1600, 1600, 117, 1600, 130, 62, 1600, 70, 61, 60, 43, 48, 62, 86, 49, 1600, 80, 88, 1600, 58, 80, 86, 99, 49, 1600, 57, 1600, 64, 53, 73, 65, 48, 1600, 54, 740, 65, 50, 1600, 43, 51, 1600, 78, 72, 47, 70, 1600, 332, 62, 81, 1600, 729, 72, 1600, 1600, 54, 42, 58, 103, 97, 53, 1600, 50, 62, 107, 104, 82, 1600, 108, 1600, 56, 62, 43, 125, 117, 1600, 1600, 101, 59, 88, 94, 1600, 122, 46, 75, 49, 1600, 64, 54, 65, 1600, 69, 95, 68, 46, 63]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2971855308950447, "mean_inference_ms": 1.010094704734228, "mean_action_processing_ms": 0.19454665689752215, "mean_env_wait_ms": 0.40161675284138837, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005832672119140625, "StateBufferConnector_ms": 0.004439830780029297, "ViewRequirementAgentConnector_ms": 0.11486172676086426}}, "episode_reward_max": -48.07614971738817, "episode_reward_min": -165.68566928387742, "episode_reward_mean": -100.49067891457207, "episode_len_mean": 469.35, "episodes_this_iter": 12, "episodes_timesteps_total": 46935, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-103.48841853707594, -61.51461389540502, -116.19792017456021, -50.81436145182953, -109.07829168847451, -103.07549000195766, -64.25804456847656, -118.85135961002237, -62.204218074022556, -108.36222978971713, -113.2576647131263, -58.612367824017234, -111.14987005812489, -104.07663072965232, -110.62842275988932, -112.2538872121858, -106.57118158426944, -105.82830434476335, -110.95634334195344, -109.56373581414856, -56.23947399006858, -116.85552653791072, -104.38372309493336, -52.368364470086334, -115.62106012177095, -108.31611798111535, -102.72003529074168, -118.37180613566127, -106.85530550793125, -108.87759537766068, -107.08720459702114, -55.391051035300485, -113.07199897285862, -106.09685436874007, -109.34628087357184, -104.92284774636104, -104.96873230664619, -66.89588098845384, -102.90056523498583, -150.6667931829816, -111.10262177492368, -111.25390494354566, -52.17933990054772, -110.0695654446644, -114.08587793047664, -53.982381587766156, -117.56675032269148, -111.32237252081185, -108.99697453491018, -106.3652772313431, -53.866143721014964, -143.6552441043636, -111.31770422943744, -111.12280466385931, -48.07614971738817, -165.68566928387742, -105.39684620246602, -63.83618201400592, -52.41271925740449, -108.30367420515108, -109.65603437533355, -105.50098744331238, -118.75420581540094, -106.60282707851628, -106.98909457849774, -59.50480483766821, -106.69177010903508, -114.8174796759331, -120.32637691969984, -110.01097356591995, -115.73732105483488, -62.89303407330372, -100.99788431574653, -59.2698007568393, -111.54456218201977, -111.65944025088288, -108.75359550283538, -115.76055085721178, -124.95233941333244, -63.50857467782301, -62.67225362174885, -107.77699090047119, -111.7620656174235, -107.71156977486115, -115.82656296715452, -54.329677197314204, -123.2082801860397, -107.30748135746829, -108.78894611246139, -109.13952458872585, -64.61820734235525, -107.47661972323371, -116.601157032306, -106.21092119570076, -145.72970080000962, -118.26421575604999, -107.99706662400875, -111.8238238918384, -105.86275962901985, -108.72963207574747], "episode_lengths": [55, 1600, 98, 1600, 67, 1600, 1600, 117, 1600, 130, 62, 1600, 70, 61, 60, 43, 48, 62, 86, 49, 1600, 80, 88, 1600, 58, 80, 86, 99, 49, 1600, 57, 1600, 64, 53, 73, 65, 48, 1600, 54, 740, 65, 50, 1600, 43, 51, 1600, 78, 72, 47, 70, 1600, 332, 62, 81, 1600, 729, 72, 1600, 1600, 54, 42, 58, 103, 97, 53, 1600, 50, 62, 107, 104, 82, 1600, 108, 1600, 56, 62, 43, 125, 117, 1600, 1600, 101, 59, 88, 94, 1600, 122, 46, 75, 49, 1600, 64, 54, 65, 1600, 69, 95, 68, 46, 63]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2971855308950447, "mean_inference_ms": 1.010094704734228, "mean_action_processing_ms": 0.19454665689752215, "mean_env_wait_ms": 0.40161675284138837, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005832672119140625, "StateBufferConnector_ms": 0.004439830780029297, "ViewRequirementAgentConnector_ms": 0.11486172676086426}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 407.9581675738393, "num_env_steps_trained_throughput_per_sec": 407.9581675738393, "timesteps_total": 220000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 220000, "timers": {"training_iteration_time_ms": 9861.218, "restore_workers_time_ms": 0.012, "training_step_time_ms": 9861.182, "sample_time_ms": 3714.433, "load_time_ms": 0.425, "load_throughput": 9406905.523, "learn_time_ms": 6137.699, "learn_throughput": 651.71, "synch_weights_time_ms": 8.059}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "done": false, "episodes_total": 399, "training_iteration": 55, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-10-09", "timestamp": 1714270209, "time_this_iter_s": 9.809779167175293, "time_total_s": 562.3919961452484, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 562.3919961452484, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 30.728571428571428, "ram_util_percent": 63.700000000000024}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.75762796248159, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1503635184077035, "policy_loss": -0.03346891550607579, "vf_loss": 2.1771434084542336, "vf_explained_var": 0.20932865431231837, "kl": 0.009909676718370584, "entropy": 8.977795274283297, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 51615.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "sampler_results": {"episode_reward_max": -48.07614971738817, "episode_reward_min": -165.68566928387742, "episode_reward_mean": -101.93073004940717, "episode_len_mean": 439.11, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 43911, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-118.85135961002237, -62.204218074022556, -108.36222978971713, -113.2576647131263, -58.612367824017234, -111.14987005812489, -104.07663072965232, -110.62842275988932, -112.2538872121858, -106.57118158426944, -105.82830434476335, -110.95634334195344, -109.56373581414856, -56.23947399006858, -116.85552653791072, -104.38372309493336, -52.368364470086334, -115.62106012177095, -108.31611798111535, -102.72003529074168, -118.37180613566127, -106.85530550793125, -108.87759537766068, -107.08720459702114, -55.391051035300485, -113.07199897285862, -106.09685436874007, -109.34628087357184, -104.92284774636104, -104.96873230664619, -66.89588098845384, -102.90056523498583, -150.6667931829816, -111.10262177492368, -111.25390494354566, -52.17933990054772, -110.0695654446644, -114.08587793047664, -53.982381587766156, -117.56675032269148, -111.32237252081185, -108.99697453491018, -106.3652772313431, -53.866143721014964, -143.6552441043636, -111.31770422943744, -111.12280466385931, -48.07614971738817, -165.68566928387742, -105.39684620246602, -63.83618201400592, -52.41271925740449, -108.30367420515108, -109.65603437533355, -105.50098744331238, -118.75420581540094, -106.60282707851628, -106.98909457849774, -59.50480483766821, -106.69177010903508, -114.8174796759331, -120.32637691969984, -110.01097356591995, -115.73732105483488, -62.89303407330372, -100.99788431574653, -59.2698007568393, -111.54456218201977, -111.65944025088288, -108.75359550283538, -115.76055085721178, -124.95233941333244, -63.50857467782301, -62.67225362174885, -107.77699090047119, -111.7620656174235, -107.71156977486115, -115.82656296715452, -54.329677197314204, -123.2082801860397, -107.30748135746829, -108.78894611246139, -109.13952458872585, -64.61820734235525, -107.47661972323371, -116.601157032306, -106.21092119570076, -145.72970080000962, -118.26421575604999, -107.99706662400875, -111.8238238918384, -105.86275962901985, -108.72963207574747, -124.6114050739654, -126.73341219165425, -114.36952677708616, -109.51241045324878, -63.71915305454226, -102.55106783441082, -110.93527841638215], "episode_lengths": [117, 1600, 130, 62, 1600, 70, 61, 60, 43, 48, 62, 86, 49, 1600, 80, 88, 1600, 58, 80, 86, 99, 49, 1600, 57, 1600, 64, 53, 73, 65, 48, 1600, 54, 740, 65, 50, 1600, 43, 51, 1600, 78, 72, 47, 70, 1600, 332, 62, 81, 1600, 729, 72, 1600, 1600, 54, 42, 58, 103, 97, 53, 1600, 50, 62, 107, 104, 82, 1600, 108, 1600, 56, 62, 43, 125, 117, 1600, 1600, 101, 59, 88, 94, 1600, 122, 46, 75, 49, 1600, 64, 54, 65, 1600, 69, 95, 68, 46, 63, 1600, 99, 80, 75, 1600, 63, 79]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29711619671063344, "mean_inference_ms": 1.009669644615933, "mean_action_processing_ms": 0.19445874671685992, "mean_env_wait_ms": 0.40140820671404787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005858182907104492, "StateBufferConnector_ms": 0.004445552825927734, "ViewRequirementAgentConnector_ms": 0.11472964286804199}}, "episode_reward_max": -48.07614971738817, "episode_reward_min": -165.68566928387742, "episode_reward_mean": -101.93073004940717, "episode_len_mean": 439.11, "episodes_this_iter": 7, "episodes_timesteps_total": 43911, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-118.85135961002237, -62.204218074022556, -108.36222978971713, -113.2576647131263, -58.612367824017234, -111.14987005812489, -104.07663072965232, -110.62842275988932, -112.2538872121858, -106.57118158426944, -105.82830434476335, -110.95634334195344, -109.56373581414856, -56.23947399006858, -116.85552653791072, -104.38372309493336, -52.368364470086334, -115.62106012177095, -108.31611798111535, -102.72003529074168, -118.37180613566127, -106.85530550793125, -108.87759537766068, -107.08720459702114, -55.391051035300485, -113.07199897285862, -106.09685436874007, -109.34628087357184, -104.92284774636104, -104.96873230664619, -66.89588098845384, -102.90056523498583, -150.6667931829816, -111.10262177492368, -111.25390494354566, -52.17933990054772, -110.0695654446644, -114.08587793047664, -53.982381587766156, -117.56675032269148, -111.32237252081185, -108.99697453491018, -106.3652772313431, -53.866143721014964, -143.6552441043636, -111.31770422943744, -111.12280466385931, -48.07614971738817, -165.68566928387742, -105.39684620246602, -63.83618201400592, -52.41271925740449, -108.30367420515108, -109.65603437533355, -105.50098744331238, -118.75420581540094, -106.60282707851628, -106.98909457849774, -59.50480483766821, -106.69177010903508, -114.8174796759331, -120.32637691969984, -110.01097356591995, -115.73732105483488, -62.89303407330372, -100.99788431574653, -59.2698007568393, -111.54456218201977, -111.65944025088288, -108.75359550283538, -115.76055085721178, -124.95233941333244, -63.50857467782301, -62.67225362174885, -107.77699090047119, -111.7620656174235, -107.71156977486115, -115.82656296715452, -54.329677197314204, -123.2082801860397, -107.30748135746829, -108.78894611246139, -109.13952458872585, -64.61820734235525, -107.47661972323371, -116.601157032306, -106.21092119570076, -145.72970080000962, -118.26421575604999, -107.99706662400875, -111.8238238918384, -105.86275962901985, -108.72963207574747, -124.6114050739654, -126.73341219165425, -114.36952677708616, -109.51241045324878, -63.71915305454226, -102.55106783441082, -110.93527841638215], "episode_lengths": [117, 1600, 130, 62, 1600, 70, 61, 60, 43, 48, 62, 86, 49, 1600, 80, 88, 1600, 58, 80, 86, 99, 49, 1600, 57, 1600, 64, 53, 73, 65, 48, 1600, 54, 740, 65, 50, 1600, 43, 51, 1600, 78, 72, 47, 70, 1600, 332, 62, 81, 1600, 729, 72, 1600, 1600, 54, 42, 58, 103, 97, 53, 1600, 50, 62, 107, 104, 82, 1600, 108, 1600, 56, 62, 43, 125, 117, 1600, 1600, 101, 59, 88, 94, 1600, 122, 46, 75, 49, 1600, 64, 54, 65, 1600, 69, 95, 68, 46, 63, 1600, 99, 80, 75, 1600, 63, 79]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29711619671063344, "mean_inference_ms": 1.009669644615933, "mean_action_processing_ms": 0.19445874671685992, "mean_env_wait_ms": 0.40140820671404787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005858182907104492, "StateBufferConnector_ms": 0.004445552825927734, "ViewRequirementAgentConnector_ms": 0.11472964286804199}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 406.8275043278668, "num_env_steps_trained_throughput_per_sec": 406.8275043278668, "timesteps_total": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 9868.306, "restore_workers_time_ms": 0.012, "training_step_time_ms": 9868.269, "sample_time_ms": 3730.181, "load_time_ms": 0.435, "load_throughput": 9204595.38, "learn_time_ms": 6129.146, "learn_throughput": 652.619, "synch_weights_time_ms": 7.933}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "episodes_total": 406, "training_iteration": 56, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-10-19", "timestamp": 1714270219, "time_this_iter_s": 9.836760997772217, "time_total_s": 572.2287571430206, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 572.2287571430206, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 29.27142857142858, "ram_util_percent": 63.83571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.18646758192329, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5188856204676253, "policy_loss": -0.03910919457513799, "vf_loss": 2.5498335203015676, "vf_explained_var": 0.2183942271176205, "kl": 0.012090773626598115, "entropy": 11.30374906832172, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 52545.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "sampler_results": {"episode_reward_max": -48.07614971738817, "episode_reward_min": -165.68566928387742, "episode_reward_mean": -102.85983001380124, "episode_len_mean": 455.21, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 45521, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-110.95634334195344, -109.56373581414856, -56.23947399006858, -116.85552653791072, -104.38372309493336, -52.368364470086334, -115.62106012177095, -108.31611798111535, -102.72003529074168, -118.37180613566127, -106.85530550793125, -108.87759537766068, -107.08720459702114, -55.391051035300485, -113.07199897285862, -106.09685436874007, -109.34628087357184, -104.92284774636104, -104.96873230664619, -66.89588098845384, -102.90056523498583, -150.6667931829816, -111.10262177492368, -111.25390494354566, -52.17933990054772, -110.0695654446644, -114.08587793047664, -53.982381587766156, -117.56675032269148, -111.32237252081185, -108.99697453491018, -106.3652772313431, -53.866143721014964, -143.6552441043636, -111.31770422943744, -111.12280466385931, -48.07614971738817, -165.68566928387742, -105.39684620246602, -63.83618201400592, -52.41271925740449, -108.30367420515108, -109.65603437533355, -105.50098744331238, -118.75420581540094, -106.60282707851628, -106.98909457849774, -59.50480483766821, -106.69177010903508, -114.8174796759331, -120.32637691969984, -110.01097356591995, -115.73732105483488, -62.89303407330372, -100.99788431574653, -59.2698007568393, -111.54456218201977, -111.65944025088288, -108.75359550283538, -115.76055085721178, -124.95233941333244, -63.50857467782301, -62.67225362174885, -107.77699090047119, -111.7620656174235, -107.71156977486115, -115.82656296715452, -54.329677197314204, -123.2082801860397, -107.30748135746829, -108.78894611246139, -109.13952458872585, -64.61820734235525, -107.47661972323371, -116.601157032306, -106.21092119570076, -145.72970080000962, -118.26421575604999, -107.99706662400875, -111.8238238918384, -105.86275962901985, -108.72963207574747, -124.6114050739654, -126.73341219165425, -114.36952677708616, -109.51241045324878, -63.71915305454226, -102.55106783441082, -110.93527841638215, -112.93666259993286, -118.94048611549164, -113.06971010632876, -122.74875003780299, -120.61600159100009, -110.55885487254399, -118.11221774164588, -109.8633291462517, -53.09694711008607, -110.56370310522554, -114.19947071288614], "episode_lengths": [86, 49, 1600, 80, 88, 1600, 58, 80, 86, 99, 49, 1600, 57, 1600, 64, 53, 73, 65, 48, 1600, 54, 740, 65, 50, 1600, 43, 51, 1600, 78, 72, 47, 70, 1600, 332, 62, 81, 1600, 729, 72, 1600, 1600, 54, 42, 58, 103, 97, 53, 1600, 50, 62, 107, 104, 82, 1600, 108, 1600, 56, 62, 43, 125, 117, 1600, 1600, 101, 59, 88, 94, 1600, 122, 46, 75, 49, 1600, 64, 54, 65, 1600, 69, 95, 68, 46, 63, 1600, 99, 80, 75, 1600, 63, 79, 1600, 205, 54, 89, 104, 58, 59, 44, 1600, 50, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29739504699540825, "mean_inference_ms": 1.0090868440220064, "mean_action_processing_ms": 0.19437733789196873, "mean_env_wait_ms": 0.4016269537273976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0060346126556396484, "StateBufferConnector_ms": 0.004549741744995117, "ViewRequirementAgentConnector_ms": 0.1196138858795166}}, "episode_reward_max": -48.07614971738817, "episode_reward_min": -165.68566928387742, "episode_reward_mean": -102.85983001380124, "episode_len_mean": 455.21, "episodes_this_iter": 11, "episodes_timesteps_total": 45521, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-110.95634334195344, -109.56373581414856, -56.23947399006858, -116.85552653791072, -104.38372309493336, -52.368364470086334, -115.62106012177095, -108.31611798111535, -102.72003529074168, -118.37180613566127, -106.85530550793125, -108.87759537766068, -107.08720459702114, -55.391051035300485, -113.07199897285862, -106.09685436874007, -109.34628087357184, -104.92284774636104, -104.96873230664619, -66.89588098845384, -102.90056523498583, -150.6667931829816, -111.10262177492368, -111.25390494354566, -52.17933990054772, -110.0695654446644, -114.08587793047664, -53.982381587766156, -117.56675032269148, -111.32237252081185, -108.99697453491018, -106.3652772313431, -53.866143721014964, -143.6552441043636, -111.31770422943744, -111.12280466385931, -48.07614971738817, -165.68566928387742, -105.39684620246602, -63.83618201400592, -52.41271925740449, -108.30367420515108, -109.65603437533355, -105.50098744331238, -118.75420581540094, -106.60282707851628, -106.98909457849774, -59.50480483766821, -106.69177010903508, -114.8174796759331, -120.32637691969984, -110.01097356591995, -115.73732105483488, -62.89303407330372, -100.99788431574653, -59.2698007568393, -111.54456218201977, -111.65944025088288, -108.75359550283538, -115.76055085721178, -124.95233941333244, -63.50857467782301, -62.67225362174885, -107.77699090047119, -111.7620656174235, -107.71156977486115, -115.82656296715452, -54.329677197314204, -123.2082801860397, -107.30748135746829, -108.78894611246139, -109.13952458872585, -64.61820734235525, -107.47661972323371, -116.601157032306, -106.21092119570076, -145.72970080000962, -118.26421575604999, -107.99706662400875, -111.8238238918384, -105.86275962901985, -108.72963207574747, -124.6114050739654, -126.73341219165425, -114.36952677708616, -109.51241045324878, -63.71915305454226, -102.55106783441082, -110.93527841638215, -112.93666259993286, -118.94048611549164, -113.06971010632876, -122.74875003780299, -120.61600159100009, -110.55885487254399, -118.11221774164588, -109.8633291462517, -53.09694711008607, -110.56370310522554, -114.19947071288614], "episode_lengths": [86, 49, 1600, 80, 88, 1600, 58, 80, 86, 99, 49, 1600, 57, 1600, 64, 53, 73, 65, 48, 1600, 54, 740, 65, 50, 1600, 43, 51, 1600, 78, 72, 47, 70, 1600, 332, 62, 81, 1600, 729, 72, 1600, 1600, 54, 42, 58, 103, 97, 53, 1600, 50, 62, 107, 104, 82, 1600, 108, 1600, 56, 62, 43, 125, 117, 1600, 1600, 101, 59, 88, 94, 1600, 122, 46, 75, 49, 1600, 64, 54, 65, 1600, 69, 95, 68, 46, 63, 1600, 99, 80, 75, 1600, 63, 79, 1600, 205, 54, 89, 104, 58, 59, 44, 1600, 50, 1600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29739504699540825, "mean_inference_ms": 1.0090868440220064, "mean_action_processing_ms": 0.19437733789196873, "mean_env_wait_ms": 0.4016269537273976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0060346126556396484, "StateBufferConnector_ms": 0.004549741744995117, "ViewRequirementAgentConnector_ms": 0.1196138858795166}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 342.9872251016396, "num_env_steps_trained_throughput_per_sec": 342.9872251016396, "timesteps_total": 228000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 228000, "timers": {"training_iteration_time_ms": 10041.756, "restore_workers_time_ms": 0.013, "training_step_time_ms": 10041.719, "sample_time_ms": 3836.792, "load_time_ms": 0.428, "load_throughput": 9338314.594, "learn_time_ms": 6196.052, "learn_throughput": 645.572, "synch_weights_time_ms": 7.88}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "done": false, "episodes_total": 417, "training_iteration": 57, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-10-31", "timestamp": 1714270231, "time_this_iter_s": 11.666803121566772, "time_total_s": 583.8955602645874, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 583.8955602645874, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 39.39411764705883, "ram_util_percent": 64.3941176470588}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.843102650232213, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.310990746691948, "policy_loss": -0.040449605353416934, "vf_loss": 2.341223952001942, "vf_explained_var": 0.21374847779991807, "kl": 0.015135415227045935, "entropy": 7.495244185129802, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 53475.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "sampler_results": {"episode_reward_max": -48.07614971738817, "episode_reward_min": -165.68566928387742, "episode_reward_mean": -104.11161343579974, "episode_len_mean": 408.51, "episode_media": {}, "episodes_this_iter": 14, "episodes_timesteps_total": 40851, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113.07199897285862, -106.09685436874007, -109.34628087357184, -104.92284774636104, -104.96873230664619, -66.89588098845384, -102.90056523498583, -150.6667931829816, -111.10262177492368, -111.25390494354566, -52.17933990054772, -110.0695654446644, -114.08587793047664, -53.982381587766156, -117.56675032269148, -111.32237252081185, -108.99697453491018, -106.3652772313431, -53.866143721014964, -143.6552441043636, -111.31770422943744, -111.12280466385931, -48.07614971738817, -165.68566928387742, -105.39684620246602, -63.83618201400592, -52.41271925740449, -108.30367420515108, -109.65603437533355, -105.50098744331238, -118.75420581540094, -106.60282707851628, -106.98909457849774, -59.50480483766821, -106.69177010903508, -114.8174796759331, -120.32637691969984, -110.01097356591995, -115.73732105483488, -62.89303407330372, -100.99788431574653, -59.2698007568393, -111.54456218201977, -111.65944025088288, -108.75359550283538, -115.76055085721178, -124.95233941333244, -63.50857467782301, -62.67225362174885, -107.77699090047119, -111.7620656174235, -107.71156977486115, -115.82656296715452, -54.329677197314204, -123.2082801860397, -107.30748135746829, -108.78894611246139, -109.13952458872585, -64.61820734235525, -107.47661972323371, -116.601157032306, -106.21092119570076, -145.72970080000962, -118.26421575604999, -107.99706662400875, -111.8238238918384, -105.86275962901985, -108.72963207574747, -124.6114050739654, -126.73341219165425, -114.36952677708616, -109.51241045324878, -63.71915305454226, -102.55106783441082, -110.93527841638215, -112.93666259993286, -118.94048611549164, -113.06971010632876, -122.74875003780299, -120.61600159100009, -110.55885487254399, -118.11221774164588, -109.8633291462517, -53.09694711008607, -110.56370310522554, -114.19947071288614, -110.72568042622197, -113.19695729130942, -104.42657040887389, -104.30671186024261, -123.463980265636, -52.49850141155527, -111.08431787983888, -108.50884623968975, -110.19056777029112, -110.67866538684257, -106.7548919952785, -103.70908212263696, -125.80656099468035, -113.43435144305603], "episode_lengths": [64, 53, 73, 65, 48, 1600, 54, 740, 65, 50, 1600, 43, 51, 1600, 78, 72, 47, 70, 1600, 332, 62, 81, 1600, 729, 72, 1600, 1600, 54, 42, 58, 103, 97, 53, 1600, 50, 62, 107, 104, 82, 1600, 108, 1600, 56, 62, 43, 125, 117, 1600, 1600, 101, 59, 88, 94, 1600, 122, 46, 75, 49, 1600, 64, 54, 65, 1600, 69, 95, 68, 46, 63, 1600, 99, 80, 75, 1600, 63, 79, 1600, 205, 54, 89, 104, 58, 59, 44, 1600, 50, 1600, 65, 40, 66, 51, 69, 1600, 76, 60, 49, 58, 53, 56, 92, 127]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29753751733510525, "mean_inference_ms": 1.0092513258870008, "mean_action_processing_ms": 0.19438263231429917, "mean_env_wait_ms": 0.40150947151034816, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00615692138671875, "StateBufferConnector_ms": 0.00450444221496582, "ViewRequirementAgentConnector_ms": 0.12081670761108398}}, "episode_reward_max": -48.07614971738817, "episode_reward_min": -165.68566928387742, "episode_reward_mean": -104.11161343579974, "episode_len_mean": 408.51, "episodes_this_iter": 14, "episodes_timesteps_total": 40851, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113.07199897285862, -106.09685436874007, -109.34628087357184, -104.92284774636104, -104.96873230664619, -66.89588098845384, -102.90056523498583, -150.6667931829816, -111.10262177492368, -111.25390494354566, -52.17933990054772, -110.0695654446644, -114.08587793047664, -53.982381587766156, -117.56675032269148, -111.32237252081185, -108.99697453491018, -106.3652772313431, -53.866143721014964, -143.6552441043636, -111.31770422943744, -111.12280466385931, -48.07614971738817, -165.68566928387742, -105.39684620246602, -63.83618201400592, -52.41271925740449, -108.30367420515108, -109.65603437533355, -105.50098744331238, -118.75420581540094, -106.60282707851628, -106.98909457849774, -59.50480483766821, -106.69177010903508, -114.8174796759331, -120.32637691969984, -110.01097356591995, -115.73732105483488, -62.89303407330372, -100.99788431574653, -59.2698007568393, -111.54456218201977, -111.65944025088288, -108.75359550283538, -115.76055085721178, -124.95233941333244, -63.50857467782301, -62.67225362174885, -107.77699090047119, -111.7620656174235, -107.71156977486115, -115.82656296715452, -54.329677197314204, -123.2082801860397, -107.30748135746829, -108.78894611246139, -109.13952458872585, -64.61820734235525, -107.47661972323371, -116.601157032306, -106.21092119570076, -145.72970080000962, -118.26421575604999, -107.99706662400875, -111.8238238918384, -105.86275962901985, -108.72963207574747, -124.6114050739654, -126.73341219165425, -114.36952677708616, -109.51241045324878, -63.71915305454226, -102.55106783441082, -110.93527841638215, -112.93666259993286, -118.94048611549164, -113.06971010632876, -122.74875003780299, -120.61600159100009, -110.55885487254399, -118.11221774164588, -109.8633291462517, -53.09694711008607, -110.56370310522554, -114.19947071288614, -110.72568042622197, -113.19695729130942, -104.42657040887389, -104.30671186024261, -123.463980265636, -52.49850141155527, -111.08431787983888, -108.50884623968975, -110.19056777029112, -110.67866538684257, -106.7548919952785, -103.70908212263696, -125.80656099468035, -113.43435144305603], "episode_lengths": [64, 53, 73, 65, 48, 1600, 54, 740, 65, 50, 1600, 43, 51, 1600, 78, 72, 47, 70, 1600, 332, 62, 81, 1600, 729, 72, 1600, 1600, 54, 42, 58, 103, 97, 53, 1600, 50, 62, 107, 104, 82, 1600, 108, 1600, 56, 62, 43, 125, 117, 1600, 1600, 101, 59, 88, 94, 1600, 122, 46, 75, 49, 1600, 64, 54, 65, 1600, 69, 95, 68, 46, 63, 1600, 99, 80, 75, 1600, 63, 79, 1600, 205, 54, 89, 104, 58, 59, 44, 1600, 50, 1600, 65, 40, 66, 51, 69, 1600, 76, 60, 49, 58, 53, 56, 92, 127]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29753751733510525, "mean_inference_ms": 1.0092513258870008, "mean_action_processing_ms": 0.19438263231429917, "mean_env_wait_ms": 0.40150947151034816, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00615692138671875, "StateBufferConnector_ms": 0.00450444221496582, "ViewRequirementAgentConnector_ms": 0.12081670761108398}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 371.6440132579753, "num_env_steps_trained_throughput_per_sec": 371.6440132579753, "timesteps_total": 232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 232000, "timers": {"training_iteration_time_ms": 10035.562, "restore_workers_time_ms": 0.013, "training_step_time_ms": 10035.525, "sample_time_ms": 3847.827, "load_time_ms": 0.435, "load_throughput": 9195514.388, "learn_time_ms": 6178.777, "learn_throughput": 647.377, "synch_weights_time_ms": 7.922}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "done": false, "episodes_total": 431, "training_iteration": 58, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-10-42", "timestamp": 1714270242, "time_this_iter_s": 10.76756501197815, "time_total_s": 594.6631252765656, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 594.6631252765656, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 37.33333333333334, "ram_util_percent": 64.38666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.10362635418292, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.359434667694312, "policy_loss": -0.03343879781583304, "vf_loss": 3.384955639540348, "vf_explained_var": 0.23175981640815735, "kl": 0.011730125182156876, "entropy": 9.494682038214899, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 54405.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000}, "sampler_results": {"episode_reward_max": -48.07614971738817, "episode_reward_min": -249.51697509686971, "episode_reward_mean": -104.84785568975585, "episode_len_mean": 433.89, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 43389, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-52.17933990054772, -110.0695654446644, -114.08587793047664, -53.982381587766156, -117.56675032269148, -111.32237252081185, -108.99697453491018, -106.3652772313431, -53.866143721014964, -143.6552441043636, -111.31770422943744, -111.12280466385931, -48.07614971738817, -165.68566928387742, -105.39684620246602, -63.83618201400592, -52.41271925740449, -108.30367420515108, -109.65603437533355, -105.50098744331238, -118.75420581540094, -106.60282707851628, -106.98909457849774, -59.50480483766821, -106.69177010903508, -114.8174796759331, -120.32637691969984, -110.01097356591995, -115.73732105483488, -62.89303407330372, -100.99788431574653, -59.2698007568393, -111.54456218201977, -111.65944025088288, -108.75359550283538, -115.76055085721178, -124.95233941333244, -63.50857467782301, -62.67225362174885, -107.77699090047119, -111.7620656174235, -107.71156977486115, -115.82656296715452, -54.329677197314204, -123.2082801860397, -107.30748135746829, -108.78894611246139, -109.13952458872585, -64.61820734235525, -107.47661972323371, -116.601157032306, -106.21092119570076, -145.72970080000962, -118.26421575604999, -107.99706662400875, -111.8238238918384, -105.86275962901985, -108.72963207574747, -124.6114050739654, -126.73341219165425, -114.36952677708616, -109.51241045324878, -63.71915305454226, -102.55106783441082, -110.93527841638215, -112.93666259993286, -118.94048611549164, -113.06971010632876, -122.74875003780299, -120.61600159100009, -110.55885487254399, -118.11221774164588, -109.8633291462517, -53.09694711008607, -110.56370310522554, -114.19947071288614, -110.72568042622197, -113.19695729130942, -104.42657040887389, -104.30671186024261, -123.463980265636, -52.49850141155527, -111.08431787983888, -108.50884623968975, -110.19056777029112, -110.67866538684257, -106.7548919952785, -103.70908212263696, -125.80656099468035, -113.43435144305603, -117.58629248821053, -113.64390199298909, -105.15200657687524, -58.91445080538404, -121.05043554396306, -119.02105626362562, -56.287161275795384, -107.12514629832904, -106.55327944663912, -249.51697509686971], "episode_lengths": [1600, 43, 51, 1600, 78, 72, 47, 70, 1600, 332, 62, 81, 1600, 729, 72, 1600, 1600, 54, 42, 58, 103, 97, 53, 1600, 50, 62, 107, 104, 82, 1600, 108, 1600, 56, 62, 43, 125, 117, 1600, 1600, 101, 59, 88, 94, 1600, 122, 46, 75, 49, 1600, 64, 54, 65, 1600, 69, 95, 68, 46, 63, 1600, 99, 80, 75, 1600, 63, 79, 1600, 205, 54, 89, 104, 58, 59, 44, 1600, 50, 1600, 65, 40, 66, 51, 69, 1600, 76, 60, 49, 58, 53, 56, 92, 127, 75, 68, 122, 1600, 70, 60, 1600, 102, 65, 1588]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2977492137748093, "mean_inference_ms": 1.0088231227792372, "mean_action_processing_ms": 0.19432032102510552, "mean_env_wait_ms": 0.4016900428891867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006188154220581055, "StateBufferConnector_ms": 0.004472255706787109, "ViewRequirementAgentConnector_ms": 0.11886930465698242}}, "episode_reward_max": -48.07614971738817, "episode_reward_min": -249.51697509686971, "episode_reward_mean": -104.84785568975585, "episode_len_mean": 433.89, "episodes_this_iter": 10, "episodes_timesteps_total": 43389, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-52.17933990054772, -110.0695654446644, -114.08587793047664, -53.982381587766156, -117.56675032269148, -111.32237252081185, -108.99697453491018, -106.3652772313431, -53.866143721014964, -143.6552441043636, -111.31770422943744, -111.12280466385931, -48.07614971738817, -165.68566928387742, -105.39684620246602, -63.83618201400592, -52.41271925740449, -108.30367420515108, -109.65603437533355, -105.50098744331238, -118.75420581540094, -106.60282707851628, -106.98909457849774, -59.50480483766821, -106.69177010903508, -114.8174796759331, -120.32637691969984, -110.01097356591995, -115.73732105483488, -62.89303407330372, -100.99788431574653, -59.2698007568393, -111.54456218201977, -111.65944025088288, -108.75359550283538, -115.76055085721178, -124.95233941333244, -63.50857467782301, -62.67225362174885, -107.77699090047119, -111.7620656174235, -107.71156977486115, -115.82656296715452, -54.329677197314204, -123.2082801860397, -107.30748135746829, -108.78894611246139, -109.13952458872585, -64.61820734235525, -107.47661972323371, -116.601157032306, -106.21092119570076, -145.72970080000962, -118.26421575604999, -107.99706662400875, -111.8238238918384, -105.86275962901985, -108.72963207574747, -124.6114050739654, -126.73341219165425, -114.36952677708616, -109.51241045324878, -63.71915305454226, -102.55106783441082, -110.93527841638215, -112.93666259993286, -118.94048611549164, -113.06971010632876, -122.74875003780299, -120.61600159100009, -110.55885487254399, -118.11221774164588, -109.8633291462517, -53.09694711008607, -110.56370310522554, -114.19947071288614, -110.72568042622197, -113.19695729130942, -104.42657040887389, -104.30671186024261, -123.463980265636, -52.49850141155527, -111.08431787983888, -108.50884623968975, -110.19056777029112, -110.67866538684257, -106.7548919952785, -103.70908212263696, -125.80656099468035, -113.43435144305603, -117.58629248821053, -113.64390199298909, -105.15200657687524, -58.91445080538404, -121.05043554396306, -119.02105626362562, -56.287161275795384, -107.12514629832904, -106.55327944663912, -249.51697509686971], "episode_lengths": [1600, 43, 51, 1600, 78, 72, 47, 70, 1600, 332, 62, 81, 1600, 729, 72, 1600, 1600, 54, 42, 58, 103, 97, 53, 1600, 50, 62, 107, 104, 82, 1600, 108, 1600, 56, 62, 43, 125, 117, 1600, 1600, 101, 59, 88, 94, 1600, 122, 46, 75, 49, 1600, 64, 54, 65, 1600, 69, 95, 68, 46, 63, 1600, 99, 80, 75, 1600, 63, 79, 1600, 205, 54, 89, 104, 58, 59, 44, 1600, 50, 1600, 65, 40, 66, 51, 69, 1600, 76, 60, 49, 58, 53, 56, 92, 127, 75, 68, 122, 1600, 70, 60, 1600, 102, 65, 1588]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2977492137748093, "mean_inference_ms": 1.0088231227792372, "mean_action_processing_ms": 0.19432032102510552, "mean_env_wait_ms": 0.4016900428891867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006188154220581055, "StateBufferConnector_ms": 0.004472255706787109, "ViewRequirementAgentConnector_ms": 0.11886930465698242}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 415.83409005967565, "num_env_steps_trained_throughput_per_sec": 415.83409005967565, "timesteps_total": 236000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 236000, "timers": {"training_iteration_time_ms": 9903.808, "restore_workers_time_ms": 0.012, "training_step_time_ms": 9903.771, "sample_time_ms": 3803.834, "load_time_ms": 0.441, "load_throughput": 9077106.53, "learn_time_ms": 6091.152, "learn_throughput": 656.69, "synch_weights_time_ms": 7.791}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000}, "done": false, "episodes_total": 441, "training_iteration": 59, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-10-51", "timestamp": 1714270251, "time_this_iter_s": 9.623594045639038, "time_total_s": 604.2867193222046, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 604.2867193222046, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 22.785714285714285, "ram_util_percent": 63.9642857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.082927015904458, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8445741140413203, "policy_loss": -0.032877035919697054, "vf_loss": 0.8716995756712652, "vf_explained_var": 0.20748956818734446, "kl": 0.008520855947203865, "entropy": 6.13029644848198, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 55335.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "sampler_results": {"episode_reward_max": -48.07614971738817, "episode_reward_min": -249.51697509686971, "episode_reward_mean": -104.98462030169004, "episode_len_mean": 434.23, "episode_media": {}, "episodes_this_iter": 5, "episodes_timesteps_total": 43423, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-111.32237252081185, -108.99697453491018, -106.3652772313431, -53.866143721014964, -143.6552441043636, -111.31770422943744, -111.12280466385931, -48.07614971738817, -165.68566928387742, -105.39684620246602, -63.83618201400592, -52.41271925740449, -108.30367420515108, -109.65603437533355, -105.50098744331238, -118.75420581540094, -106.60282707851628, -106.98909457849774, -59.50480483766821, -106.69177010903508, -114.8174796759331, -120.32637691969984, -110.01097356591995, -115.73732105483488, -62.89303407330372, -100.99788431574653, -59.2698007568393, -111.54456218201977, -111.65944025088288, -108.75359550283538, -115.76055085721178, -124.95233941333244, -63.50857467782301, -62.67225362174885, -107.77699090047119, -111.7620656174235, -107.71156977486115, -115.82656296715452, -54.329677197314204, -123.2082801860397, -107.30748135746829, -108.78894611246139, -109.13952458872585, -64.61820734235525, -107.47661972323371, -116.601157032306, -106.21092119570076, -145.72970080000962, -118.26421575604999, -107.99706662400875, -111.8238238918384, -105.86275962901985, -108.72963207574747, -124.6114050739654, -126.73341219165425, -114.36952677708616, -109.51241045324878, -63.71915305454226, -102.55106783441082, -110.93527841638215, -112.93666259993286, -118.94048611549164, -113.06971010632876, -122.74875003780299, -120.61600159100009, -110.55885487254399, -118.11221774164588, -109.8633291462517, -53.09694711008607, -110.56370310522554, -114.19947071288614, -110.72568042622197, -113.19695729130942, -104.42657040887389, -104.30671186024261, -123.463980265636, -52.49850141155527, -111.08431787983888, -108.50884623968975, -110.19056777029112, -110.67866538684257, -106.7548919952785, -103.70908212263696, -125.80656099468035, -113.43435144305603, -117.58629248821053, -113.64390199298909, -105.15200657687524, -58.91445080538404, -121.05043554396306, -119.02105626362562, -56.287161275795384, -107.12514629832904, -106.55327944663912, -249.51697509686971, -56.99209901656282, -66.57460750808688, -111.1432762486736, -122.86187369013825, -103.98851991610601], "episode_lengths": [72, 47, 70, 1600, 332, 62, 81, 1600, 729, 72, 1600, 1600, 54, 42, 58, 103, 97, 53, 1600, 50, 62, 107, 104, 82, 1600, 108, 1600, 56, 62, 43, 125, 117, 1600, 1600, 101, 59, 88, 94, 1600, 122, 46, 75, 49, 1600, 64, 54, 65, 1600, 69, 95, 68, 46, 63, 1600, 99, 80, 75, 1600, 63, 79, 1600, 205, 54, 89, 104, 58, 59, 44, 1600, 50, 1600, 65, 40, 66, 51, 69, 1600, 76, 60, 49, 58, 53, 56, 92, 127, 75, 68, 122, 1600, 70, 60, 1600, 102, 65, 1588, 1600, 1600, 52, 89, 65]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29773200525402904, "mean_inference_ms": 1.0086981775026171, "mean_action_processing_ms": 0.19428829377802395, "mean_env_wait_ms": 0.4016186666241448, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006256103515625, "StateBufferConnector_ms": 0.004466056823730469, "ViewRequirementAgentConnector_ms": 0.11836957931518555}}, "episode_reward_max": -48.07614971738817, "episode_reward_min": -249.51697509686971, "episode_reward_mean": -104.98462030169004, "episode_len_mean": 434.23, "episodes_this_iter": 5, "episodes_timesteps_total": 43423, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-111.32237252081185, -108.99697453491018, -106.3652772313431, -53.866143721014964, -143.6552441043636, -111.31770422943744, -111.12280466385931, -48.07614971738817, -165.68566928387742, -105.39684620246602, -63.83618201400592, -52.41271925740449, -108.30367420515108, -109.65603437533355, -105.50098744331238, -118.75420581540094, -106.60282707851628, -106.98909457849774, -59.50480483766821, -106.69177010903508, -114.8174796759331, -120.32637691969984, -110.01097356591995, -115.73732105483488, -62.89303407330372, -100.99788431574653, -59.2698007568393, -111.54456218201977, -111.65944025088288, -108.75359550283538, -115.76055085721178, -124.95233941333244, -63.50857467782301, -62.67225362174885, -107.77699090047119, -111.7620656174235, -107.71156977486115, -115.82656296715452, -54.329677197314204, -123.2082801860397, -107.30748135746829, -108.78894611246139, -109.13952458872585, -64.61820734235525, -107.47661972323371, -116.601157032306, -106.21092119570076, -145.72970080000962, -118.26421575604999, -107.99706662400875, -111.8238238918384, -105.86275962901985, -108.72963207574747, -124.6114050739654, -126.73341219165425, -114.36952677708616, -109.51241045324878, -63.71915305454226, -102.55106783441082, -110.93527841638215, -112.93666259993286, -118.94048611549164, -113.06971010632876, -122.74875003780299, -120.61600159100009, -110.55885487254399, -118.11221774164588, -109.8633291462517, -53.09694711008607, -110.56370310522554, -114.19947071288614, -110.72568042622197, -113.19695729130942, -104.42657040887389, -104.30671186024261, -123.463980265636, -52.49850141155527, -111.08431787983888, -108.50884623968975, -110.19056777029112, -110.67866538684257, -106.7548919952785, -103.70908212263696, -125.80656099468035, -113.43435144305603, -117.58629248821053, -113.64390199298909, -105.15200657687524, -58.91445080538404, -121.05043554396306, -119.02105626362562, -56.287161275795384, -107.12514629832904, -106.55327944663912, -249.51697509686971, -56.99209901656282, -66.57460750808688, -111.1432762486736, -122.86187369013825, -103.98851991610601], "episode_lengths": [72, 47, 70, 1600, 332, 62, 81, 1600, 729, 72, 1600, 1600, 54, 42, 58, 103, 97, 53, 1600, 50, 62, 107, 104, 82, 1600, 108, 1600, 56, 62, 43, 125, 117, 1600, 1600, 101, 59, 88, 94, 1600, 122, 46, 75, 49, 1600, 64, 54, 65, 1600, 69, 95, 68, 46, 63, 1600, 99, 80, 75, 1600, 63, 79, 1600, 205, 54, 89, 104, 58, 59, 44, 1600, 50, 1600, 65, 40, 66, 51, 69, 1600, 76, 60, 49, 58, 53, 56, 92, 127, 75, 68, 122, 1600, 70, 60, 1600, 102, 65, 1588, 1600, 1600, 52, 89, 65]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29773200525402904, "mean_inference_ms": 1.0086981775026171, "mean_action_processing_ms": 0.19428829377802395, "mean_env_wait_ms": 0.4016186666241448, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006256103515625, "StateBufferConnector_ms": 0.004466056823730469, "ViewRequirementAgentConnector_ms": 0.11836957931518555}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 400.20109744858325, "num_env_steps_trained_throughput_per_sec": 400.20109744858325, "timesteps_total": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 9933.689, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9933.655, "sample_time_ms": 3806.794, "load_time_ms": 0.459, "load_throughput": 8716795.345, "learn_time_ms": 6118.321, "learn_throughput": 653.774, "synch_weights_time_ms": 7.56}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "episodes_total": 446, "training_iteration": 60, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-11-01", "timestamp": 1714270261, "time_this_iter_s": 10.000378847122192, "time_total_s": 614.2870981693268, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 614.2870981693268, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 28.12857142857143, "ram_util_percent": 63.90714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.515021334860915, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8824855890901138, "policy_loss": -0.022143066366032887, "vf_loss": 1.9003040021786126, "vf_explained_var": 0.22718961283724795, "kl": 0.00640689458902084, "entropy": 8.410447709791121, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 56265.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000}, "sampler_results": {"episode_reward_max": -48.07614971738817, "episode_reward_min": -249.51697509686971, "episode_reward_mean": -105.45246062596216, "episode_len_mean": 461.32, "episode_media": {}, "episodes_this_iter": 2, "episodes_timesteps_total": 46132, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-106.3652772313431, -53.866143721014964, -143.6552441043636, -111.31770422943744, -111.12280466385931, -48.07614971738817, -165.68566928387742, -105.39684620246602, -63.83618201400592, -52.41271925740449, -108.30367420515108, -109.65603437533355, -105.50098744331238, -118.75420581540094, -106.60282707851628, -106.98909457849774, -59.50480483766821, -106.69177010903508, -114.8174796759331, -120.32637691969984, -110.01097356591995, -115.73732105483488, -62.89303407330372, -100.99788431574653, -59.2698007568393, -111.54456218201977, -111.65944025088288, -108.75359550283538, -115.76055085721178, -124.95233941333244, -63.50857467782301, -62.67225362174885, -107.77699090047119, -111.7620656174235, -107.71156977486115, -115.82656296715452, -54.329677197314204, -123.2082801860397, -107.30748135746829, -108.78894611246139, -109.13952458872585, -64.61820734235525, -107.47661972323371, -116.601157032306, -106.21092119570076, -145.72970080000962, -118.26421575604999, -107.99706662400875, -111.8238238918384, -105.86275962901985, -108.72963207574747, -124.6114050739654, -126.73341219165425, -114.36952677708616, -109.51241045324878, -63.71915305454226, -102.55106783441082, -110.93527841638215, -112.93666259993286, -118.94048611549164, -113.06971010632876, -122.74875003780299, -120.61600159100009, -110.55885487254399, -118.11221774164588, -109.8633291462517, -53.09694711008607, -110.56370310522554, -114.19947071288614, -110.72568042622197, -113.19695729130942, -104.42657040887389, -104.30671186024261, -123.463980265636, -52.49850141155527, -111.08431787983888, -108.50884623968975, -110.19056777029112, -110.67866538684257, -106.7548919952785, -103.70908212263696, -125.80656099468035, -113.43435144305603, -117.58629248821053, -113.64390199298909, -105.15200657687524, -58.91445080538404, -121.05043554396306, -119.02105626362562, -56.287161275795384, -107.12514629832904, -106.55327944663912, -249.51697509686971, -56.99209901656282, -66.57460750808688, -111.1432762486736, -122.86187369013825, -103.98851991610601, -57.25618479792544, -209.84719468500674], "episode_lengths": [70, 1600, 332, 62, 81, 1600, 729, 72, 1600, 1600, 54, 42, 58, 103, 97, 53, 1600, 50, 62, 107, 104, 82, 1600, 108, 1600, 56, 62, 43, 125, 117, 1600, 1600, 101, 59, 88, 94, 1600, 122, 46, 75, 49, 1600, 64, 54, 65, 1600, 69, 95, 68, 46, 63, 1600, 99, 80, 75, 1600, 63, 79, 1600, 205, 54, 89, 104, 58, 59, 44, 1600, 50, 1600, 65, 40, 66, 51, 69, 1600, 76, 60, 49, 58, 53, 56, 92, 127, 75, 68, 122, 1600, 70, 60, 1600, 102, 65, 1588, 1600, 1600, 52, 89, 65, 1600, 1228]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29778978730955913, "mean_inference_ms": 1.0085609102864996, "mean_action_processing_ms": 0.19427199273984233, "mean_env_wait_ms": 0.40169693616805824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006165981292724609, "StateBufferConnector_ms": 0.004425525665283203, "ViewRequirementAgentConnector_ms": 0.11817646026611328}}, "episode_reward_max": -48.07614971738817, "episode_reward_min": -249.51697509686971, "episode_reward_mean": -105.45246062596216, "episode_len_mean": 461.32, "episodes_this_iter": 2, "episodes_timesteps_total": 46132, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-106.3652772313431, -53.866143721014964, -143.6552441043636, -111.31770422943744, -111.12280466385931, -48.07614971738817, -165.68566928387742, -105.39684620246602, -63.83618201400592, -52.41271925740449, -108.30367420515108, -109.65603437533355, -105.50098744331238, -118.75420581540094, -106.60282707851628, -106.98909457849774, -59.50480483766821, -106.69177010903508, -114.8174796759331, -120.32637691969984, -110.01097356591995, -115.73732105483488, -62.89303407330372, -100.99788431574653, -59.2698007568393, -111.54456218201977, -111.65944025088288, -108.75359550283538, -115.76055085721178, -124.95233941333244, -63.50857467782301, -62.67225362174885, -107.77699090047119, -111.7620656174235, -107.71156977486115, -115.82656296715452, -54.329677197314204, -123.2082801860397, -107.30748135746829, -108.78894611246139, -109.13952458872585, -64.61820734235525, -107.47661972323371, -116.601157032306, -106.21092119570076, -145.72970080000962, -118.26421575604999, -107.99706662400875, -111.8238238918384, -105.86275962901985, -108.72963207574747, -124.6114050739654, -126.73341219165425, -114.36952677708616, -109.51241045324878, -63.71915305454226, -102.55106783441082, -110.93527841638215, -112.93666259993286, -118.94048611549164, -113.06971010632876, -122.74875003780299, -120.61600159100009, -110.55885487254399, -118.11221774164588, -109.8633291462517, -53.09694711008607, -110.56370310522554, -114.19947071288614, -110.72568042622197, -113.19695729130942, -104.42657040887389, -104.30671186024261, -123.463980265636, -52.49850141155527, -111.08431787983888, -108.50884623968975, -110.19056777029112, -110.67866538684257, -106.7548919952785, -103.70908212263696, -125.80656099468035, -113.43435144305603, -117.58629248821053, -113.64390199298909, -105.15200657687524, -58.91445080538404, -121.05043554396306, -119.02105626362562, -56.287161275795384, -107.12514629832904, -106.55327944663912, -249.51697509686971, -56.99209901656282, -66.57460750808688, -111.1432762486736, -122.86187369013825, -103.98851991610601, -57.25618479792544, -209.84719468500674], "episode_lengths": [70, 1600, 332, 62, 81, 1600, 729, 72, 1600, 1600, 54, 42, 58, 103, 97, 53, 1600, 50, 62, 107, 104, 82, 1600, 108, 1600, 56, 62, 43, 125, 117, 1600, 1600, 101, 59, 88, 94, 1600, 122, 46, 75, 49, 1600, 64, 54, 65, 1600, 69, 95, 68, 46, 63, 1600, 99, 80, 75, 1600, 63, 79, 1600, 205, 54, 89, 104, 58, 59, 44, 1600, 50, 1600, 65, 40, 66, 51, 69, 1600, 76, 60, 49, 58, 53, 56, 92, 127, 75, 68, 122, 1600, 70, 60, 1600, 102, 65, 1588, 1600, 1600, 52, 89, 65, 1600, 1228]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29778978730955913, "mean_inference_ms": 1.0085609102864996, "mean_action_processing_ms": 0.19427199273984233, "mean_env_wait_ms": 0.40169693616805824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006165981292724609, "StateBufferConnector_ms": 0.004425525665283203, "ViewRequirementAgentConnector_ms": 0.11817646026611328}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 389.41579771102033, "num_env_steps_trained_throughput_per_sec": 389.41579771102033, "timesteps_total": 244000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 244000, "timers": {"training_iteration_time_ms": 9987.197, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9987.162, "sample_time_ms": 3822.364, "load_time_ms": 0.468, "load_throughput": 8555002.805, "learn_time_ms": 6155.843, "learn_throughput": 649.789, "synch_weights_time_ms": 7.929}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000}, "done": false, "episodes_total": 448, "training_iteration": 61, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-11-12", "timestamp": 1714270272, "time_this_iter_s": 10.27746295928955, "time_total_s": 624.5645611286163, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 624.5645611286163, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 32.642857142857146, "ram_util_percent": 63.87142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.716585541925122, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4263411193780642, "policy_loss": -0.033458984507027494, "vf_loss": 1.4541969661270417, "vf_explained_var": 0.23689714189498656, "kl": 0.008300923636162586, "entropy": 8.231253704460718, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 57195.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "sampler_results": {"episode_reward_max": -52.41271925740449, "episode_reward_min": -249.51697509686971, "episode_reward_mean": -106.27920071137805, "episode_len_mean": 458.55, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 45855, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-165.68566928387742, -105.39684620246602, -63.83618201400592, -52.41271925740449, -108.30367420515108, -109.65603437533355, -105.50098744331238, -118.75420581540094, -106.60282707851628, -106.98909457849774, -59.50480483766821, -106.69177010903508, -114.8174796759331, -120.32637691969984, -110.01097356591995, -115.73732105483488, -62.89303407330372, -100.99788431574653, -59.2698007568393, -111.54456218201977, -111.65944025088288, -108.75359550283538, -115.76055085721178, -124.95233941333244, -63.50857467782301, -62.67225362174885, -107.77699090047119, -111.7620656174235, -107.71156977486115, -115.82656296715452, -54.329677197314204, -123.2082801860397, -107.30748135746829, -108.78894611246139, -109.13952458872585, -64.61820734235525, -107.47661972323371, -116.601157032306, -106.21092119570076, -145.72970080000962, -118.26421575604999, -107.99706662400875, -111.8238238918384, -105.86275962901985, -108.72963207574747, -124.6114050739654, -126.73341219165425, -114.36952677708616, -109.51241045324878, -63.71915305454226, -102.55106783441082, -110.93527841638215, -112.93666259993286, -118.94048611549164, -113.06971010632876, -122.74875003780299, -120.61600159100009, -110.55885487254399, -118.11221774164588, -109.8633291462517, -53.09694711008607, -110.56370310522554, -114.19947071288614, -110.72568042622197, -113.19695729130942, -104.42657040887389, -104.30671186024261, -123.463980265636, -52.49850141155527, -111.08431787983888, -108.50884623968975, -110.19056777029112, -110.67866538684257, -106.7548919952785, -103.70908212263696, -125.80656099468035, -113.43435144305603, -117.58629248821053, -113.64390199298909, -105.15200657687524, -58.91445080538404, -121.05043554396306, -119.02105626362562, -56.287161275795384, -107.12514629832904, -106.55327944663912, -249.51697509686971, -56.99209901656282, -66.57460750808688, -111.1432762486736, -122.86187369013825, -103.98851991610601, -57.25618479792544, -209.84719468500674, -67.50826928543799, -118.49411780941921, -114.98282949216043, -107.09638324039057, -141.15067378151545, -107.8450586000712], "episode_lengths": [729, 72, 1600, 1600, 54, 42, 58, 103, 97, 53, 1600, 50, 62, 107, 104, 82, 1600, 108, 1600, 56, 62, 43, 125, 117, 1600, 1600, 101, 59, 88, 94, 1600, 122, 46, 75, 49, 1600, 64, 54, 65, 1600, 69, 95, 68, 46, 63, 1600, 99, 80, 75, 1600, 63, 79, 1600, 205, 54, 89, 104, 58, 59, 44, 1600, 50, 1600, 65, 40, 66, 51, 69, 1600, 76, 60, 49, 58, 53, 56, 92, 127, 75, 68, 122, 1600, 70, 60, 1600, 102, 65, 1588, 1600, 1600, 52, 89, 65, 1600, 1228, 1600, 68, 90, 51, 1600, 59]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2978369847421771, "mean_inference_ms": 1.008298543450251, "mean_action_processing_ms": 0.194224514838495, "mean_env_wait_ms": 0.40170161628404144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006109714508056641, "StateBufferConnector_ms": 0.004403591156005859, "ViewRequirementAgentConnector_ms": 0.11760258674621582}}, "episode_reward_max": -52.41271925740449, "episode_reward_min": -249.51697509686971, "episode_reward_mean": -106.27920071137805, "episode_len_mean": 458.55, "episodes_this_iter": 6, "episodes_timesteps_total": 45855, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-165.68566928387742, -105.39684620246602, -63.83618201400592, -52.41271925740449, -108.30367420515108, -109.65603437533355, -105.50098744331238, -118.75420581540094, -106.60282707851628, -106.98909457849774, -59.50480483766821, -106.69177010903508, -114.8174796759331, -120.32637691969984, -110.01097356591995, -115.73732105483488, -62.89303407330372, -100.99788431574653, -59.2698007568393, -111.54456218201977, -111.65944025088288, -108.75359550283538, -115.76055085721178, -124.95233941333244, -63.50857467782301, -62.67225362174885, -107.77699090047119, -111.7620656174235, -107.71156977486115, -115.82656296715452, -54.329677197314204, -123.2082801860397, -107.30748135746829, -108.78894611246139, -109.13952458872585, -64.61820734235525, -107.47661972323371, -116.601157032306, -106.21092119570076, -145.72970080000962, -118.26421575604999, -107.99706662400875, -111.8238238918384, -105.86275962901985, -108.72963207574747, -124.6114050739654, -126.73341219165425, -114.36952677708616, -109.51241045324878, -63.71915305454226, -102.55106783441082, -110.93527841638215, -112.93666259993286, -118.94048611549164, -113.06971010632876, -122.74875003780299, -120.61600159100009, -110.55885487254399, -118.11221774164588, -109.8633291462517, -53.09694711008607, -110.56370310522554, -114.19947071288614, -110.72568042622197, -113.19695729130942, -104.42657040887389, -104.30671186024261, -123.463980265636, -52.49850141155527, -111.08431787983888, -108.50884623968975, -110.19056777029112, -110.67866538684257, -106.7548919952785, -103.70908212263696, -125.80656099468035, -113.43435144305603, -117.58629248821053, -113.64390199298909, -105.15200657687524, -58.91445080538404, -121.05043554396306, -119.02105626362562, -56.287161275795384, -107.12514629832904, -106.55327944663912, -249.51697509686971, -56.99209901656282, -66.57460750808688, -111.1432762486736, -122.86187369013825, -103.98851991610601, -57.25618479792544, -209.84719468500674, -67.50826928543799, -118.49411780941921, -114.98282949216043, -107.09638324039057, -141.15067378151545, -107.8450586000712], "episode_lengths": [729, 72, 1600, 1600, 54, 42, 58, 103, 97, 53, 1600, 50, 62, 107, 104, 82, 1600, 108, 1600, 56, 62, 43, 125, 117, 1600, 1600, 101, 59, 88, 94, 1600, 122, 46, 75, 49, 1600, 64, 54, 65, 1600, 69, 95, 68, 46, 63, 1600, 99, 80, 75, 1600, 63, 79, 1600, 205, 54, 89, 104, 58, 59, 44, 1600, 50, 1600, 65, 40, 66, 51, 69, 1600, 76, 60, 49, 58, 53, 56, 92, 127, 75, 68, 122, 1600, 70, 60, 1600, 102, 65, 1588, 1600, 1600, 52, 89, 65, 1600, 1228, 1600, 68, 90, 51, 1600, 59]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2978369847421771, "mean_inference_ms": 1.008298543450251, "mean_action_processing_ms": 0.194224514838495, "mean_env_wait_ms": 0.40170161628404144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006109714508056641, "StateBufferConnector_ms": 0.004403591156005859, "ViewRequirementAgentConnector_ms": 0.11760258674621582}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 394.03967529406805, "num_env_steps_trained_throughput_per_sec": 394.03967529406805, "timesteps_total": 248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 248000, "timers": {"training_iteration_time_ms": 10099.668, "restore_workers_time_ms": 0.013, "training_step_time_ms": 10099.632, "sample_time_ms": 3851.638, "load_time_ms": 0.47, "load_throughput": 8508147.472, "learn_time_ms": 6238.922, "learn_throughput": 641.136, "synch_weights_time_ms": 8.038}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "done": false, "episodes_total": 454, "training_iteration": 62, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-11-22", "timestamp": 1714270282, "time_this_iter_s": 10.15749979019165, "time_total_s": 634.722060918808, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 634.722060918808, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 31.053333333333335, "ram_util_percent": 64.07333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.038393446322411, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1676220883849397, "policy_loss": -0.0358239490018096, "vf_loss": 1.1978635038539607, "vf_explained_var": 0.22368473718243262, "kl": 0.008270409697418383, "entropy": 6.855186389082221, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 58125.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "sampler_results": {"episode_reward_max": -52.49850141155527, "episode_reward_min": -249.51697509686971, "episode_reward_mean": -106.18194306960645, "episode_len_mean": 467.39, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 46739, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-118.75420581540094, -106.60282707851628, -106.98909457849774, -59.50480483766821, -106.69177010903508, -114.8174796759331, -120.32637691969984, -110.01097356591995, -115.73732105483488, -62.89303407330372, -100.99788431574653, -59.2698007568393, -111.54456218201977, -111.65944025088288, -108.75359550283538, -115.76055085721178, -124.95233941333244, -63.50857467782301, -62.67225362174885, -107.77699090047119, -111.7620656174235, -107.71156977486115, -115.82656296715452, -54.329677197314204, -123.2082801860397, -107.30748135746829, -108.78894611246139, -109.13952458872585, -64.61820734235525, -107.47661972323371, -116.601157032306, -106.21092119570076, -145.72970080000962, -118.26421575604999, -107.99706662400875, -111.8238238918384, -105.86275962901985, -108.72963207574747, -124.6114050739654, -126.73341219165425, -114.36952677708616, -109.51241045324878, -63.71915305454226, -102.55106783441082, -110.93527841638215, -112.93666259993286, -118.94048611549164, -113.06971010632876, -122.74875003780299, -120.61600159100009, -110.55885487254399, -118.11221774164588, -109.8633291462517, -53.09694711008607, -110.56370310522554, -114.19947071288614, -110.72568042622197, -113.19695729130942, -104.42657040887389, -104.30671186024261, -123.463980265636, -52.49850141155527, -111.08431787983888, -108.50884623968975, -110.19056777029112, -110.67866538684257, -106.7548919952785, -103.70908212263696, -125.80656099468035, -113.43435144305603, -117.58629248821053, -113.64390199298909, -105.15200657687524, -58.91445080538404, -121.05043554396306, -119.02105626362562, -56.287161275795384, -107.12514629832904, -106.55327944663912, -249.51697509686971, -56.99209901656282, -66.57460750808688, -111.1432762486736, -122.86187369013825, -103.98851991610601, -57.25618479792544, -209.84719468500674, -67.50826928543799, -118.49411780941921, -114.98282949216043, -107.09638324039057, -141.15067378151545, -107.8450586000712, -135.83488441720587, -67.59783894099672, -110.0147370807007, -104.39088769466306, -108.57450127489493, -57.120931417457214, -117.53256777847062], "episode_lengths": [103, 97, 53, 1600, 50, 62, 107, 104, 82, 1600, 108, 1600, 56, 62, 43, 125, 117, 1600, 1600, 101, 59, 88, 94, 1600, 122, 46, 75, 49, 1600, 64, 54, 65, 1600, 69, 95, 68, 46, 63, 1600, 99, 80, 75, 1600, 63, 79, 1600, 205, 54, 89, 104, 58, 59, 44, 1600, 50, 1600, 65, 40, 66, 51, 69, 1600, 76, 60, 49, 58, 53, 56, 92, 127, 75, 68, 122, 1600, 70, 60, 1600, 102, 65, 1588, 1600, 1600, 52, 89, 65, 1600, 1228, 1600, 68, 90, 51, 1600, 59, 1600, 1600, 63, 63, 60, 1600, 53]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29756022591178133, "mean_inference_ms": 1.00881956023903, "mean_action_processing_ms": 0.1942456261482543, "mean_env_wait_ms": 0.4011633477071514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006020545959472656, "StateBufferConnector_ms": 0.004392862319946289, "ViewRequirementAgentConnector_ms": 0.1190500259399414}}, "episode_reward_max": -52.49850141155527, "episode_reward_min": -249.51697509686971, "episode_reward_mean": -106.18194306960645, "episode_len_mean": 467.39, "episodes_this_iter": 7, "episodes_timesteps_total": 46739, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-118.75420581540094, -106.60282707851628, -106.98909457849774, -59.50480483766821, -106.69177010903508, -114.8174796759331, -120.32637691969984, -110.01097356591995, -115.73732105483488, -62.89303407330372, -100.99788431574653, -59.2698007568393, -111.54456218201977, -111.65944025088288, -108.75359550283538, -115.76055085721178, -124.95233941333244, -63.50857467782301, -62.67225362174885, -107.77699090047119, -111.7620656174235, -107.71156977486115, -115.82656296715452, -54.329677197314204, -123.2082801860397, -107.30748135746829, -108.78894611246139, -109.13952458872585, -64.61820734235525, -107.47661972323371, -116.601157032306, -106.21092119570076, -145.72970080000962, -118.26421575604999, -107.99706662400875, -111.8238238918384, -105.86275962901985, -108.72963207574747, -124.6114050739654, -126.73341219165425, -114.36952677708616, -109.51241045324878, -63.71915305454226, -102.55106783441082, -110.93527841638215, -112.93666259993286, -118.94048611549164, -113.06971010632876, -122.74875003780299, -120.61600159100009, -110.55885487254399, -118.11221774164588, -109.8633291462517, -53.09694711008607, -110.56370310522554, -114.19947071288614, -110.72568042622197, -113.19695729130942, -104.42657040887389, -104.30671186024261, -123.463980265636, -52.49850141155527, -111.08431787983888, -108.50884623968975, -110.19056777029112, -110.67866538684257, -106.7548919952785, -103.70908212263696, -125.80656099468035, -113.43435144305603, -117.58629248821053, -113.64390199298909, -105.15200657687524, -58.91445080538404, -121.05043554396306, -119.02105626362562, -56.287161275795384, -107.12514629832904, -106.55327944663912, -249.51697509686971, -56.99209901656282, -66.57460750808688, -111.1432762486736, -122.86187369013825, -103.98851991610601, -57.25618479792544, -209.84719468500674, -67.50826928543799, -118.49411780941921, -114.98282949216043, -107.09638324039057, -141.15067378151545, -107.8450586000712, -135.83488441720587, -67.59783894099672, -110.0147370807007, -104.39088769466306, -108.57450127489493, -57.120931417457214, -117.53256777847062], "episode_lengths": [103, 97, 53, 1600, 50, 62, 107, 104, 82, 1600, 108, 1600, 56, 62, 43, 125, 117, 1600, 1600, 101, 59, 88, 94, 1600, 122, 46, 75, 49, 1600, 64, 54, 65, 1600, 69, 95, 68, 46, 63, 1600, 99, 80, 75, 1600, 63, 79, 1600, 205, 54, 89, 104, 58, 59, 44, 1600, 50, 1600, 65, 40, 66, 51, 69, 1600, 76, 60, 49, 58, 53, 56, 92, 127, 75, 68, 122, 1600, 70, 60, 1600, 102, 65, 1588, 1600, 1600, 52, 89, 65, 1600, 1228, 1600, 68, 90, 51, 1600, 59, 1600, 1600, 63, 63, 60, 1600, 53]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29756022591178133, "mean_inference_ms": 1.00881956023903, "mean_action_processing_ms": 0.1942456261482543, "mean_env_wait_ms": 0.4011633477071514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006020545959472656, "StateBufferConnector_ms": 0.004392862319946289, "ViewRequirementAgentConnector_ms": 0.1190500259399414}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 390.81548610128056, "num_env_steps_trained_throughput_per_sec": 390.81548610128056, "timesteps_total": 252000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 10182.195, "restore_workers_time_ms": 0.013, "training_step_time_ms": 10182.16, "sample_time_ms": 3932.536, "load_time_ms": 0.442, "load_throughput": 9048711.504, "learn_time_ms": 6240.564, "learn_throughput": 640.968, "synch_weights_time_ms": 8.055}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": true, "episodes_total": 461, "training_iteration": 63, "trial_id": "0e6e3_00000", "date": "2024-04-27_19-11-32", "timestamp": 1714270292, "time_this_iter_s": 10.240007162094116, "time_total_s": 644.9620680809021, "pid": 61848, "hostname": "Alexandrs-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "BipedalWalker-v3", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "enable_connectors": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15aa8f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 644.9620680809021, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 31.29333333333333, "ram_util_percent": 64.36}}
